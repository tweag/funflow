<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_37jcGmpSmhW1yOScEYBAZc"></span><span class="hs-pragma">{-# LANGUAGE CPP                   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns          #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Aws.Aws</span><span>
</span><span id="line-7"></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Logging</span></span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Aws.Aws.html#LogLevel"><span class="hs-identifier">LogLevel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#Logger"><span class="hs-identifier">Logger</span></a></span><span>
</span><span id="line-10"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#defaultLog"><span class="hs-identifier">defaultLog</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Configuration</span></span><span>
</span><span id="line-12"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier">Configuration</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#baseConfiguration"><span class="hs-identifier">baseConfiguration</span></a></span><span>
</span><span id="line-14"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#dbgConfiguration"><span class="hs-identifier">dbgConfiguration</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Transaction runners</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Safe runners</span></span><span>
</span><span id="line-17"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#aws"><span class="hs-identifier">aws</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsRef"><span class="hs-identifier">awsRef</span></a></span><span>
</span><span id="line-19"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#pureAws"><span class="hs-identifier">pureAws</span></a></span><span>
</span><span id="line-20"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#memoryAws"><span class="hs-identifier">memoryAws</span></a></span><span>
</span><span id="line-21"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#simpleAws"><span class="hs-identifier">simpleAws</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Unsafe runners</span></span><span>
</span><span id="line-23"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#unsafeAws"><span class="hs-identifier">unsafeAws</span></a></span><span>
</span><span id="line-24"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#unsafeAwsRef"><span class="hs-identifier">unsafeAwsRef</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** URI runners</span></span><span>
</span><span id="line-26"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsUri"><span class="hs-identifier">awsUri</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Iterated runners</span></span><span>
</span><span id="line-28"></span><span class="hs-comment">--, awsIteratedAll</span><span>
</span><span id="line-29"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsIteratedSource"><span class="hs-identifier">awsIteratedSource</span></a></span><span>
</span><span id="line-30"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsIteratedSource%27"><span class="hs-identifier">awsIteratedSource'</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsIteratedList"><span class="hs-identifier">awsIteratedList</span></a></span><span>
</span><span id="line-32"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Aws.html#awsIteratedList%27"><span class="hs-identifier">awsIteratedList'</span></a></span><span>
</span><span id="line-33"></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Aws.Core.html"><span class="hs-identifier">Aws.Core</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Resource</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.List</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CL</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client.TLS</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | The severity of a log message, in rising order.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="LogLevel"><span class="annot"><a href="Aws.Aws.html#LogLevel"><span class="hs-identifier hs-var">LogLevel</span></a></span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Debug"><span class="annot"><a href="Aws.Aws.html#Debug"><span class="hs-identifier hs-var">Debug</span></a></span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Info"><span class="annot"><a href="Aws.Aws.html#Info"><span class="hs-identifier hs-var">Info</span></a></span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Warning"><span class="annot"><a href="Aws.Aws.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Error"><span class="annot"><a href="Aws.Aws.html#Error"><span class="hs-identifier hs-var">Error</span></a></span></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228972"><span id="local-6989586621679228974"><span id="local-6989586621679228976"><span class="annot"><span class="annottext">Int -&gt; LogLevel -&gt; ShowS
[LogLevel] -&gt; ShowS
LogLevel -&gt; String
(Int -&gt; LogLevel -&gt; ShowS)
-&gt; (LogLevel -&gt; String) -&gt; ([LogLevel] -&gt; ShowS) -&gt; Show LogLevel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LogLevel] -&gt; ShowS
$cshowList :: [LogLevel] -&gt; ShowS
show :: LogLevel -&gt; String
$cshow :: LogLevel -&gt; String
showsPrec :: Int -&gt; LogLevel -&gt; ShowS
$cshowsPrec :: Int -&gt; LogLevel -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228967"><span id="local-6989586621679228969"><span class="annot"><span class="annottext">LogLevel -&gt; LogLevel -&gt; Bool
(LogLevel -&gt; LogLevel -&gt; Bool)
-&gt; (LogLevel -&gt; LogLevel -&gt; Bool) -&gt; Eq LogLevel
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LogLevel -&gt; LogLevel -&gt; Bool
$c/= :: LogLevel -&gt; LogLevel -&gt; Bool
== :: LogLevel -&gt; LogLevel -&gt; Bool
$c== :: LogLevel -&gt; LogLevel -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228951"><span id="local-6989586621679228953"><span id="local-6989586621679228955"><span id="local-6989586621679228957"><span id="local-6989586621679228959"><span id="local-6989586621679228961"><span id="local-6989586621679228963"><span class="annot"><span class="annottext">Eq LogLevel
Eq LogLevel
-&gt; (LogLevel -&gt; LogLevel -&gt; Ordering)
-&gt; (LogLevel -&gt; LogLevel -&gt; Bool)
-&gt; (LogLevel -&gt; LogLevel -&gt; Bool)
-&gt; (LogLevel -&gt; LogLevel -&gt; Bool)
-&gt; (LogLevel -&gt; LogLevel -&gt; Bool)
-&gt; (LogLevel -&gt; LogLevel -&gt; LogLevel)
-&gt; (LogLevel -&gt; LogLevel -&gt; LogLevel)
-&gt; Ord LogLevel
LogLevel -&gt; LogLevel -&gt; Bool
LogLevel -&gt; LogLevel -&gt; Ordering
LogLevel -&gt; LogLevel -&gt; LogLevel
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LogLevel -&gt; LogLevel -&gt; LogLevel
$cmin :: LogLevel -&gt; LogLevel -&gt; LogLevel
max :: LogLevel -&gt; LogLevel -&gt; LogLevel
$cmax :: LogLevel -&gt; LogLevel -&gt; LogLevel
&gt;= :: LogLevel -&gt; LogLevel -&gt; Bool
$c&gt;= :: LogLevel -&gt; LogLevel -&gt; Bool
&gt; :: LogLevel -&gt; LogLevel -&gt; Bool
$c&gt; :: LogLevel -&gt; LogLevel -&gt; Bool
&lt;= :: LogLevel -&gt; LogLevel -&gt; Bool
$c&lt;= :: LogLevel -&gt; LogLevel -&gt; Bool
&lt; :: LogLevel -&gt; LogLevel -&gt; Bool
$c&lt; :: LogLevel -&gt; LogLevel -&gt; Bool
compare :: LogLevel -&gt; LogLevel -&gt; Ordering
$ccompare :: LogLevel -&gt; LogLevel -&gt; Ordering
$cp1Ord :: Eq LogLevel
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | The interface for any logging function. Takes log level and a log message, and can perform an arbitrary</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- IO action.</span><span>
</span><span id="line-68"></span><span class="hs-keyword">type</span><span> </span><span id="Logger"><span class="annot"><a href="Aws.Aws.html#Logger"><span class="hs-identifier hs-var">Logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Aws.Aws.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | The default logger @defaultLog minLevel@, which prints log messages above level @minLevel@ to @stderr@.</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Aws.Aws.html#defaultLog"><span class="hs-identifier hs-type">defaultLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Aws.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-72"></span><span id="defaultLog"><span class="annot"><span class="annottext">defaultLog :: LogLevel -&gt; Logger
</span><a href="Aws.Aws.html#defaultLog"><span class="hs-identifier hs-var hs-var">defaultLog</span></a></span></span><span> </span><span id="local-6989586621679228949"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679228949"><span class="hs-identifier hs-var">minLevel</span></a></span></span><span> </span><span id="local-6989586621679228948"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679228948"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span id="local-6989586621679228947"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679228947"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679228948"><span class="hs-identifier hs-var">lev</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; LogLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679228949"><span class="hs-identifier hs-var">minLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">T.hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679228948"><span class="hs-identifier hs-var">lev</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679228947"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | The configuration for an AWS request. You can use multiple configurations in parallel, even over the same HTTP</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- connection manager.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="Configuration"><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-var">Configuration</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Configuration"><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-var">Configuration</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-79"></span><span>        </span><span class="hs-comment">-- | Whether to restrict the signature validity with a plain timestamp, or with explicit expiration</span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-comment">-- (absolute or relative).</span><span>
</span><span id="line-81"></span><span>        </span><span id="timeInfo"><span class="annot"><span class="annottext">Configuration -&gt; TimeInfo
</span><a href="Aws.Aws.html#timeInfo"><span class="hs-identifier hs-var hs-var">timeInfo</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#TimeInfo"><span class="hs-identifier hs-type">TimeInfo</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-comment">-- | AWS access credentials.</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="credentials"><span class="annot"><span class="annottext">Configuration -&gt; Credentials
</span><a href="Aws.Aws.html#credentials"><span class="hs-identifier hs-var hs-var">credentials</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-comment">-- | The error / message logger.</span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="logger"><span class="annot"><span class="annottext">Configuration -&gt; Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var hs-var">logger</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Aws.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="proxy"><span class="annot"><span class="annottext">Configuration -&gt; Maybe Proxy
</span><a href="Aws.Aws.html#proxy"><span class="hs-identifier hs-var hs-var">proxy</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Proxy</span></span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | The default configuration, with credentials loaded from environment variable or configuration file</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- (see 'loadCredentialsDefault').</span><span>
</span><span id="line-91"></span><span id="local-6989586621679229156"><span class="annot"><a href="Aws.Aws.html#baseConfiguration"><span class="hs-identifier hs-type">baseConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679229156"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229156"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span></span><span>
</span><span id="line-92"></span><span id="baseConfiguration"><span class="annot"><span class="annottext">baseConfiguration :: io Configuration
</span><a href="Aws.Aws.html#baseConfiguration"><span class="hs-identifier hs-var hs-var">baseConfiguration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Configuration -&gt; io Configuration
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Configuration -&gt; io Configuration)
-&gt; IO Configuration -&gt; io Configuration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679228936"><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679228936"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Credentials)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsDefault"><span class="hs-identifier hs-var">loadCredentialsDefault</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679228936"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">Maybe Credentials
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NoCredentialsException -&gt; IO Configuration
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">E.throwM</span></span><span> </span><span class="annot"><span class="annottext">(NoCredentialsException -&gt; IO Configuration)
-&gt; NoCredentialsException -&gt; IO Configuration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NoCredentialsException
</span><a href="Aws.Core.html#NoCredentialsException"><span class="hs-identifier hs-var">NoCredentialsException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;could not locate aws credentials&quot;</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679228932"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679228932"><span class="hs-identifier hs-var">cr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; IO Configuration
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Configuration :: TimeInfo -&gt; Credentials -&gt; Logger -&gt; Maybe Proxy -&gt; Configuration
</span><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-97"></span><span>                      </span><span class="annot"><span class="annottext">timeInfo :: TimeInfo
</span><a href="Aws.Aws.html#timeInfo"><span class="hs-identifier hs-var">timeInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeInfo
</span><a href="Aws.Core.html#Timestamp"><span class="hs-identifier hs-var">Timestamp</span></a></span><span>
</span><span id="line-98"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">credentials :: Credentials
</span><a href="Aws.Aws.html#credentials"><span class="hs-identifier hs-var">credentials</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679228932"><span class="hs-identifier hs-var">cr'</span></a></span><span>
</span><span id="line-99"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">logger :: Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; Logger
</span><a href="Aws.Aws.html#defaultLog"><span class="hs-identifier hs-var">defaultLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Warning"><span class="hs-identifier hs-var">Warning</span></a></span><span>
</span><span id="line-100"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">proxy :: Maybe Proxy
</span><a href="Aws.Aws.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-101"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Debug configuration, which logs much more verbosely.</span><span>
</span><span id="line-104"></span><span id="local-6989586621679228930"><span class="annot"><a href="Aws.Aws.html#dbgConfiguration"><span class="hs-identifier hs-type">dbgConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228930"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228930"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span></span><span>
</span><span id="line-105"></span><span id="dbgConfiguration"><span class="annot"><span class="annottext">dbgConfiguration :: io Configuration
</span><a href="Aws.Aws.html#dbgConfiguration"><span class="hs-identifier hs-var hs-var">dbgConfiguration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679228929"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228929"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">io Configuration
forall (io :: * -&gt; *). MonadIO io =&gt; io Configuration
</span><a href="Aws.Aws.html#baseConfiguration"><span class="hs-identifier hs-var">baseConfiguration</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">Configuration -&gt; io Configuration
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228929"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">logger :: Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; Logger
</span><a href="Aws.Aws.html#defaultLog"><span class="hs-identifier hs-var">defaultLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Debug"><span class="hs-identifier hs-var">Debug</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Run an AWS transaction, with HTTP manager and metadata wrapped in a 'Response'.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- All errors are caught and wrapped in the 'Response' value.</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Metadata is logged at level 'Info'.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Usage (with existing 'HTTP.Manager'):</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-117"></span><span class="hs-comment">--     resp &lt;- aws cfg serviceCfg manager request</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-119"></span><span id="local-6989586621679229128"><span id="local-6989586621679229129"><span class="annot"><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-type">aws</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229129"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229128"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229129"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229129"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229128"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679229128"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-125"></span><span id="aws"><span class="annot"><span class="annottext">aws :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var hs-var">aws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
(ResponseConsumer r a, Loggable (ResponseMetadata a),
 SignQuery r) =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#unsafeAws"><span class="hs-identifier hs-var">unsafeAws</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Run an AWS transaction, with HTTP manager and metadata returned in an 'IORef'.</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Errors are not caught, and need to be handled with exception handlers.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Metadata is not logged.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- Usage (with existing 'HTTP.Manager'):</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-135"></span><span class="hs-comment">--     ref &lt;- newIORef mempty;</span><span>
</span><span id="line-136"></span><span class="hs-comment">--     resp &lt;- awsRef cfg serviceCfg manager request</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- Unfortunately, the &quot;;&quot; above seems necessary, as haddock does not want to split lines for me.</span><span>
</span><span id="line-140"></span><span id="local-6989586621679228927"><span id="local-6989586621679228928"><span class="annot"><a href="Aws.Aws.html#awsRef"><span class="hs-identifier hs-type">awsRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228928"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228928"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228928"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228927"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-147"></span><span id="awsRef"><span class="annot"><span class="annottext">awsRef :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
</span><a href="Aws.Aws.html#awsRef"><span class="hs-identifier hs-var hs-var">awsRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
forall r a.
(ResponseConsumer r a, SignQuery r) =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
</span><a href="Aws.Aws.html#unsafeAwsRef"><span class="hs-identifier hs-var">unsafeAwsRef</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Run an AWS transaction, with HTTP manager and without metadata.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- Metadata is logged at level 'Info'.</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- Usage (with existing 'HTTP.Manager'):</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-155"></span><span class="hs-comment">--     resp &lt;- aws cfg serviceCfg manager request</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-157"></span><span id="local-6989586621679228925"><span id="local-6989586621679228926"><span class="annot"><a href="Aws.Aws.html#pureAws"><span class="hs-identifier hs-type">pureAws</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228926"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228926"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228926"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228925"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-163"></span><span id="pureAws"><span class="annot"><span class="annottext">pureAws :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO a
</span><a href="Aws.Aws.html#pureAws"><span class="hs-identifier hs-var hs-var">pureAws</span></a></span></span><span> </span><span id="local-6989586621679228924"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228924"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228923"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228923"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228922"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228922"><span class="hs-identifier hs-var">mgr</span></a></span></span><span> </span><span id="local-6989586621679228921"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228921"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a -&gt; ResourceT IO a
forall (io :: * -&gt; *) m a. MonadIO io =&gt; Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var">readResponseIO</span></a></span><span> </span><span class="annot"><span class="annottext">(Response (ResponseMetadata a) a -&gt; ResourceT IO a)
-&gt; ResourceT IO (Response (ResponseMetadata a) a) -&gt; ResourceT IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
Transaction r a =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var">aws</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228924"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228923"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228922"><span class="hs-identifier hs-var">mgr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228921"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Run an AWS transaction, with HTTP manager and without metadata.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Metadata is logged at level 'Info'.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Usage (with existing 'HTTP.Manager'):</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-171"></span><span class="hs-comment">--     resp &lt;- aws cfg serviceCfg manager request</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-173"></span><span id="local-6989586621679228916"><span id="local-6989586621679228917"><span id="local-6989586621679228918"><span class="annot"><a href="Aws.Aws.html#memoryAws"><span class="hs-identifier hs-type">memoryAws</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#AsMemoryResponse"><span class="hs-identifier hs-type">AsMemoryResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228916"><span class="hs-identifier hs-type">io</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228918"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228916"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#MemoryResponse"><span class="hs-identifier hs-type">MemoryResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-179"></span><span id="memoryAws"><span class="annot"><span class="annottext">memoryAws :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; io (MemoryResponse a)
</span><a href="Aws.Aws.html#memoryAws"><span class="hs-identifier hs-var hs-var">memoryAws</span></a></span></span><span> </span><span id="local-6989586621679228915"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228915"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228914"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228914"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228913"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228913"><span class="hs-identifier hs-var">mgr</span></a></span></span><span> </span><span id="local-6989586621679228912"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228912"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (MemoryResponse a) -&gt; io (MemoryResponse a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (MemoryResponse a) -&gt; io (MemoryResponse a))
-&gt; IO (MemoryResponse a) -&gt; io (MemoryResponse a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a))
-&gt; ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ResourceT IO (MemoryResponse a)
forall resp.
AsMemoryResponse resp =&gt;
resp -&gt; ResourceT IO (MemoryResponse resp)
</span><a href="Aws.Core.html#loadToMemory"><span class="hs-identifier hs-var">loadToMemory</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ResourceT IO (MemoryResponse a))
-&gt; ResourceT IO a -&gt; ResourceT IO (MemoryResponse a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a -&gt; ResourceT IO a
forall (io :: * -&gt; *) m a. MonadIO io =&gt; Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var">readResponseIO</span></a></span><span> </span><span class="annot"><span class="annottext">(Response (ResponseMetadata a) a -&gt; ResourceT IO a)
-&gt; ResourceT IO (Response (ResponseMetadata a) a) -&gt; ResourceT IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
Transaction r a =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var">aws</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228915"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228914"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228913"><span class="hs-identifier hs-var">mgr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228912"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Run an AWS transaction, /without/ HTTP manager and without metadata.</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Metadata is logged at level 'Info'.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- Note that this is potentially less efficient than using 'aws', because HTTP connections cannot be re-used.</span><span>
</span><span id="line-186"></span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Usage:</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-189"></span><span class="hs-comment">--     resp &lt;- simpleAws cfg serviceCfg request</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-191"></span><span id="local-6989586621679228907"><span id="local-6989586621679228908"><span id="local-6989586621679228909"><span class="annot"><a href="Aws.Aws.html#simpleAws"><span class="hs-identifier hs-type">simpleAws</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228909"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228908"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#AsMemoryResponse"><span class="hs-identifier hs-type">AsMemoryResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228908"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228907"><span class="hs-identifier hs-type">io</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228909"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228909"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228907"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#MemoryResponse"><span class="hs-identifier hs-type">MemoryResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228908"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-196"></span><span id="simpleAws"><span class="annot"><span class="annottext">simpleAws :: Configuration
-&gt; ServiceConfiguration r NormalQuery -&gt; r -&gt; io (MemoryResponse a)
</span><a href="Aws.Aws.html#simpleAws"><span class="hs-identifier hs-var hs-var">simpleAws</span></a></span></span><span> </span><span id="local-6989586621679228906"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228906"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228905"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228905"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228904"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228904"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (MemoryResponse a) -&gt; io (MemoryResponse a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (MemoryResponse a) -&gt; io (MemoryResponse a))
-&gt; IO (MemoryResponse a) -&gt; io (MemoryResponse a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a))
-&gt; ResourceT IO (MemoryResponse a) -&gt; IO (MemoryResponse a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679228903"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228903"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Manager -&gt; ResourceT IO Manager
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO Manager
</span><span class="hs-identifier hs-var">HTTP.getGlobalManager</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; ResourceT IO (MemoryResponse a)
forall resp.
AsMemoryResponse resp =&gt;
resp -&gt; ResourceT IO (MemoryResponse resp)
</span><a href="Aws.Core.html#loadToMemory"><span class="hs-identifier hs-var">loadToMemory</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ResourceT IO (MemoryResponse a))
-&gt; ResourceT IO a -&gt; ResourceT IO (MemoryResponse a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a -&gt; ResourceT IO a
forall (io :: * -&gt; *) m a. MonadIO io =&gt; Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var">readResponseIO</span></a></span><span> </span><span class="annot"><span class="annottext">(Response (ResponseMetadata a) a -&gt; ResourceT IO a)
-&gt; ResourceT IO (Response (ResponseMetadata a) a) -&gt; ResourceT IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
Transaction r a =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var">aws</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228906"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228905"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228903"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228904"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Run an AWS transaction, without enforcing that response and request type form a valid transaction pair.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- This is especially useful for debugging and development, you should not have to use it in production.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- All errors are caught and wrapped in the 'Response' value.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Metadata is wrapped in the Response, and also logged at level 'Info'.</span><span>
</span><span id="line-207"></span><span id="local-6989586621679229146"><span id="local-6989586621679229147"><span class="annot"><a href="Aws.Aws.html#unsafeAws"><span class="hs-identifier hs-type">unsafeAws</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier hs-type">ResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229147"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><a href="Aws.Core.html#Loggable"><span class="hs-identifier hs-type">Loggable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier hs-type">SignQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229147"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-211"></span><span>     </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229147"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229147"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679229146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-212"></span><span id="unsafeAws"><span class="annot"><span class="annottext">unsafeAws :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#unsafeAws"><span class="hs-identifier hs-var hs-var">unsafeAws</span></a></span></span><span> </span><span id="local-6989586621679228901"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228901"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228900"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228900"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228899"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228899"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679228898"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228898"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679228897"><span class="annot"><span class="annottext">IORef (ResponseMetadata a)
</span><a href="#local-6989586621679228897"><span class="hs-identifier hs-var">metadataRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (IORef (ResponseMetadata a))
-&gt; ResourceT IO (IORef (ResponseMetadata a))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (IORef (ResponseMetadata a))
 -&gt; ResourceT IO (IORef (ResponseMetadata a)))
-&gt; IO (IORef (ResponseMetadata a))
-&gt; ResourceT IO (IORef (ResponseMetadata a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a -&gt; IO (IORef (ResponseMetadata a))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679229096"><span class="annot"><a href="#local-6989586621679228895"><span class="hs-identifier hs-type">catchAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679229096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span> </span><span class="annot"><a href="#local-6989586621679229096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span>      </span><span id="local-6989586621679228895"><span class="annot"><span class="annottext">catchAll :: ResourceT IO a -&gt; ResourceT IO (Either SomeException a)
</span><a href="#local-6989586621679228895"><span class="hs-identifier hs-var hs-var">catchAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; ResourceT IO (Either SomeException a))
-&gt; ResourceT IO (Either SomeException a)
-&gt; ResourceT IO (Either SomeException a)
forall (m :: * -&gt; *) e a.
(MonadCatch m, Exception e) =&gt;
(e -&gt; m a) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">E.handle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either SomeException a -&gt; ResourceT IO (Either SomeException a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either SomeException a -&gt; ResourceT IO (Either SomeException a))
-&gt; (SomeException -&gt; Either SomeException a)
-&gt; SomeException
-&gt; ResourceT IO (Either SomeException a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Either SomeException a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (Either SomeException a)
 -&gt; ResourceT IO (Either SomeException a))
-&gt; (ResourceT IO a -&gt; ResourceT IO (Either SomeException a))
-&gt; ResourceT IO a
-&gt; ResourceT IO (Either SomeException a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either SomeException a)
-&gt; ResourceT IO a -&gt; ResourceT IO (Either SomeException a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either SomeException a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679228892"><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679228892"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ResourceT IO a -&gt; ResourceT IO (Either SomeException a)
forall a. ResourceT IO a -&gt; ResourceT IO (Either SomeException a)
</span><a href="#local-6989586621679228895"><span class="hs-identifier hs-var">catchAll</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO a -&gt; ResourceT IO (Either SomeException a))
-&gt; ResourceT IO a -&gt; ResourceT IO (Either SomeException a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-219"></span><span>            </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
forall r a.
(ResponseConsumer r a, SignQuery r) =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
</span><a href="Aws.Aws.html#unsafeAwsRef"><span class="hs-identifier hs-var">unsafeAwsRef</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228901"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228900"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228899"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (ResponseMetadata a)
</span><a href="#local-6989586621679228897"><span class="hs-identifier hs-var">metadataRef</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228898"><span class="hs-identifier hs-var">request</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679228891"><span class="annot"><span class="annottext">ResponseMetadata a
</span><a href="#local-6989586621679228891"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (ResponseMetadata a) -&gt; ResourceT IO (ResponseMetadata a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (ResponseMetadata a) -&gt; ResourceT IO (ResponseMetadata a))
-&gt; IO (ResponseMetadata a) -&gt; ResourceT IO (ResponseMetadata a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef (ResponseMetadata a) -&gt; IO (ResponseMetadata a)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (ResponseMetadata a)
</span><a href="#local-6989586621679228897"><span class="hs-identifier hs-var">metadataRef</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228901"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Info"><span class="hs-identifier hs-var">Info</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Response metadata: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a -&gt; Text
forall a. Loggable a =&gt; a -&gt; Text
</span><a href="Aws.Core.html#toLogText"><span class="hs-identifier hs-var">toLogText</span></a></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a
</span><a href="#local-6989586621679228891"><span class="hs-identifier hs-var">metadata</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Response (ResponseMetadata a) a
 -&gt; ResourceT IO (Response (ResponseMetadata a) a))
-&gt; Response (ResponseMetadata a) a
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a
-&gt; Either SomeException a -&gt; Response (ResponseMetadata a) a
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">ResponseMetadata a
</span><a href="#local-6989586621679228891"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679228892"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Run an AWS transaction, without enforcing that response and request type form a valid transaction pair.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- This is especially useful for debugging and development, you should not have to use it in production.</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- Errors are not caught, and need to be handled with exception handlers.</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Metadata is put in the 'IORef', but not logged.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679229138"><span id="local-6989586621679229139"><span class="annot"><a href="Aws.Aws.html#unsafeAwsRef"><span class="hs-identifier hs-type">unsafeAwsRef</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier hs-type">ResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229138"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier hs-type">SignQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229139"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-234"></span><span>     </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229138"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229139"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679229138"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-235"></span><span id="unsafeAwsRef"><span class="annot"><span class="annottext">unsafeAwsRef :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; IORef (ResponseMetadata a)
-&gt; r
-&gt; ResourceT IO a
</span><a href="Aws.Aws.html#unsafeAwsRef"><span class="hs-identifier hs-var hs-var">unsafeAwsRef</span></a></span></span><span> </span><span id="local-6989586621679228887"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228887"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228886"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228886"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679228885"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228885"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679228884"><span class="annot"><span class="annottext">IORef (ResponseMetadata a)
</span><a href="#local-6989586621679228884"><span class="hs-identifier hs-var">metadataRef</span></a></span></span><span> </span><span id="local-6989586621679228883"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228883"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679228882"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679228882"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO SignatureData -&gt; ResourceT IO SignatureData
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO SignatureData -&gt; ResourceT IO SignatureData)
-&gt; IO SignatureData -&gt; ResourceT IO SignatureData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeInfo -&gt; Credentials -&gt; IO SignatureData
</span><a href="Aws.Core.html#signatureData"><span class="hs-identifier hs-var">signatureData</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeInfo -&gt; Credentials -&gt; IO SignatureData)
-&gt; (Configuration -&gt; TimeInfo)
-&gt; Configuration
-&gt; Credentials
-&gt; IO SignatureData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; TimeInfo
</span><a href="Aws.Aws.html#timeInfo"><span class="hs-identifier hs-var hs-var">timeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Configuration -&gt; Credentials -&gt; IO SignatureData)
-&gt; (Configuration -&gt; Credentials)
-&gt; Configuration
-&gt; IO SignatureData
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; Credentials
</span><a href="Aws.Aws.html#credentials"><span class="hs-identifier hs-var hs-var">credentials</span></a></span><span> </span><span class="annot"><span class="annottext">(Configuration -&gt; IO SignatureData)
-&gt; Configuration -&gt; IO SignatureData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228887"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679228879"><span class="annot"><span class="annottext">q :: SignedQuery
</span><a href="#local-6989586621679228879"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;unsafeAwsRef:signQuery&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><span class="annottext">r
-&gt; ServiceConfiguration r NormalQuery
-&gt; SignatureData
-&gt; SignedQuery
forall request queryType.
SignQuery request =&gt;
request
-&gt; ServiceConfiguration request queryType
-&gt; SignatureData
-&gt; SignedQuery
</span><a href="Aws.Core.html#signQuery"><span class="hs-identifier hs-var">signQuery</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228883"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228886"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679228882"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679228877"><span class="annot"><span class="annottext">logDebug :: String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var hs-var">logDebug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ())
-&gt; (String -&gt; IO ()) -&gt; String -&gt; ResourceT IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228887"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Debug"><span class="hs-identifier hs-var">Debug</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; (String -&gt; Text) -&gt; String -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;String to sign: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#sqStringToSign"><span class="hs-identifier hs-var hs-var">sqStringToSign</span></a></span><span> </span><span class="annot"><span class="annottext">SignedQuery
</span><a href="#local-6989586621679228879"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">!</span><span id="local-6989586621679228875"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;unsafeAwsRef:httpRequest&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><span class="annottext">IO Request -&gt; ResourceT IO Request
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Request -&gt; ResourceT IO Request)
-&gt; IO Request -&gt; ResourceT IO Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679228874"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228874"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SignedQuery -&gt; IO Request
</span><a href="Aws.Core.html#queryToHttpRequest"><span class="hs-identifier hs-var">queryToHttpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">SignedQuery
</span><a href="#local-6989586621679228879"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Request -&gt; IO Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228874"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Maybe Proxy
</span><span class="hs-identifier hs-var">HTTP.proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; Maybe Proxy
</span><a href="Aws.Aws.html#proxy"><span class="hs-identifier hs-var hs-var">proxy</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228887"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Host: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">HTTP.host</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Path: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">HTTP.path</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Query string: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">HTTP.queryString</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Header: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RequestHeaders -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">HTTP.requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestBody
</span><span class="hs-identifier hs-var hs-var">HTTP.requestBody</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HTTP.RequestBodyLBS</span></span><span> </span><span id="local-6989586621679228865"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228865"><span class="hs-identifier hs-var">lbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">L.take</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228865"><span class="hs-identifier hs-var">lbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HTTP.RequestBodyBS</span></span><span> </span><span id="local-6989586621679228862"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228862"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228862"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">RequestBody
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621679228860"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679228860"><span class="hs-identifier hs-var">hresp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;unsafeAwsRef:http&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><span class="annottext">Request
-&gt; Manager
-&gt; ResourceT
     IO (Response (ConduitM () ByteString (ResourceT IO) ()))
forall (m :: * -&gt; *) i.
MonadResource m =&gt;
Request -&gt; Manager -&gt; m (Response (ConduitM i ByteString m ()))
</span><span class="hs-identifier hs-var">HTTP.http</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228885"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ResourceT IO ()
</span><a href="#local-6989586621679228877"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ResourceT IO ()) -&gt; String -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Response status: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ()) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">HTTP.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679228860"><span class="hs-identifier hs-var">hresp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="annottext">RequestHeaders -&gt; (Header -&gt; ResourceT IO ()) -&gt; ResourceT IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; RequestHeaders
forall body. Response body -&gt; RequestHeaders
</span><span class="hs-identifier hs-var hs-var">HTTP.responseHeaders</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679228860"><span class="hs-identifier hs-var">hresp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Header -&gt; ResourceT IO ()) -&gt; ResourceT IO ())
-&gt; (Header -&gt; ResourceT IO ()) -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679228855"><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621679228855"><span class="hs-identifier hs-var">hname</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679228854"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228854"><span class="hs-identifier hs-var">hvalue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">Configuration -&gt; Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228887"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Debug"><span class="hs-identifier hs-var">Debug</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">T.decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Response header '&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621679228855"><span class="hs-identifier hs-var">hname</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;': '&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679228854"><span class="hs-identifier hs-var">hvalue</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-pragma">{-# SCC</span><span> </span><span class="hs-pragma">&quot;unsafeAwsRef:responseConsumer&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><span class="annottext">Request
-&gt; r -&gt; IORef (ResponseMetadata a) -&gt; HTTPResponseConsumer a
forall req resp.
ResponseConsumer req resp =&gt;
Request
-&gt; req
-&gt; IORef (ResponseMetadata resp)
-&gt; HTTPResponseConsumer resp
</span><a href="Aws.Core.html#responseConsumer"><span class="hs-identifier hs-var">responseConsumer</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679228875"><span class="hs-identifier hs-var">httpRequest</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228883"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">IORef (ResponseMetadata a)
</span><a href="#local-6989586621679228884"><span class="hs-identifier hs-var">metadataRef</span></a></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679228860"><span class="hs-identifier hs-var">hresp</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Run a URI-only AWS transaction. Returns a URI that can be sent anywhere. Does not work with all requests.</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Usage:</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-261"></span><span class="hs-comment">--     uri &lt;- awsUri cfg request</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-263"></span><span id="local-6989586621679228849"><span id="local-6989586621679228850"><span class="annot"><a href="Aws.Aws.html#awsUri"><span class="hs-identifier hs-type">awsUri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier hs-type">SignQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228850"><span class="hs-identifier hs-type">request</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679228849"><span class="hs-identifier hs-type">io</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228850"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#UriOnlyQuery"><span class="hs-identifier hs-type">UriOnlyQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228850"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228849"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span></span><span>
</span><span id="line-265"></span><span id="awsUri"><span class="annot"><span class="annottext">awsUri :: Configuration
-&gt; ServiceConfiguration request UriOnlyQuery
-&gt; request
-&gt; io ByteString
</span><a href="Aws.Aws.html#awsUri"><span class="hs-identifier hs-var hs-var">awsUri</span></a></span></span><span> </span><span id="local-6989586621679228848"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228847"><span class="annot"><span class="annottext">ServiceConfiguration request UriOnlyQuery
</span><a href="#local-6989586621679228847"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679228846"><span class="annot"><span class="annottext">request
</span><a href="#local-6989586621679228846"><span class="hs-identifier hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; io ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; io ByteString) -&gt; IO ByteString -&gt; io ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679228845"><span class="annot"><span class="annottext">ti :: TimeInfo
</span><a href="#local-6989586621679228845"><span class="hs-identifier hs-var hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; TimeInfo
</span><a href="Aws.Aws.html#timeInfo"><span class="hs-identifier hs-var hs-var">timeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span id="local-6989586621679228844"><span class="annot"><span class="annottext">cr :: Credentials
</span><a href="#local-6989586621679228844"><span class="hs-identifier hs-var hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Configuration -&gt; Credentials
</span><a href="Aws.Aws.html#credentials"><span class="hs-identifier hs-var hs-var">credentials</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679228843"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679228843"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TimeInfo -&gt; Credentials -&gt; IO SignatureData
</span><a href="Aws.Core.html#signatureData"><span class="hs-identifier hs-var">signatureData</span></a></span><span> </span><span class="annot"><span class="annottext">TimeInfo
</span><a href="#local-6989586621679228845"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679228844"><span class="hs-identifier hs-var">cr</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679228842"><span class="annot"><span class="annottext">q :: SignedQuery
</span><a href="#local-6989586621679228842"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">request
-&gt; ServiceConfiguration request UriOnlyQuery
-&gt; SignatureData
-&gt; SignedQuery
forall request queryType.
SignQuery request =&gt;
request
-&gt; ServiceConfiguration request queryType
-&gt; SignatureData
-&gt; SignedQuery
</span><a href="Aws.Core.html#signQuery"><span class="hs-identifier hs-var">signQuery</span></a></span><span> </span><span class="annot"><span class="annottext">request
</span><a href="#local-6989586621679228846"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration request UriOnlyQuery
</span><a href="#local-6989586621679228847"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679228843"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">Configuration -&gt; Logger
</span><a href="Aws.Aws.html#logger"><span class="hs-identifier hs-var hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Aws.Aws.html#Debug"><span class="hs-identifier hs-var">Debug</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;String to sign: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#sqStringToSign"><span class="hs-identifier hs-var hs-var">sqStringToSign</span></a></span><span> </span><span class="annot"><span class="annottext">SignedQuery
</span><a href="#local-6989586621679228842"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ByteString) -&gt; ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#queryToUri"><span class="hs-identifier hs-var">queryToUri</span></a></span><span> </span><span class="annot"><span class="annottext">SignedQuery
</span><a href="#local-6989586621679228842"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">{-
-- | Run an iterated AWS transaction. May make multiple HTTP requests.
awsIteratedAll :: (IteratedTransaction r a)
                  =&gt; Configuration
                  -&gt; ServiceConfiguration r NormalQuery
                  -&gt; HTTP.Manager
                  -&gt; r
                  -&gt; ResourceT IO (Response [ResponseMetadata a] a)
awsIteratedAll cfg scfg manager req_ = go req_ Nothing
  where go request prevResp = do Response meta respAttempt &lt;- aws cfg scfg manager request
                                 case maybeCombineIteratedResponse prevResp &lt;$&gt; respAttempt of
                                   f@(Failure _) -&gt; return (Response [meta] f)
                                   s@(Success resp) -&gt;
                                     case nextIteratedRequest request resp of
                                       Nothing -&gt;
                                         return (Response [meta] s)
                                       Just nextRequest -&gt;
                                         mapMetadata (meta:) `liftM` go nextRequest (Just resp)
-}</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621679228839"><span id="local-6989586621679228840"><span class="annot"><a href="Aws.Aws.html#awsIteratedSource"><span class="hs-identifier hs-type">awsIteratedSource</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier hs-type">IteratedTransaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228840"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228840"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228840"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Producer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679228839"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-300"></span><span id="awsIteratedSource"><span class="annot"><span class="annottext">awsIteratedSource :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; Producer (ResourceT IO) (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#awsIteratedSource"><span class="hs-identifier hs-var hs-var">awsIteratedSource</span></a></span></span><span> </span><span id="local-6989586621679228838"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228838"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228837"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228837"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228836"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228836"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679228835"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228835"><span class="hs-identifier hs-var">req_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; ResourceT IO (a, Response (ResponseMetadata a) a))
-&gt; r -&gt; Producer (ResourceT IO) (Response (ResponseMetadata a) a)
forall (m :: * -&gt; *) r a b.
(Monad m, IteratedTransaction r a) =&gt;
(r -&gt; m (a, b)) -&gt; r -&gt; Producer m b
</span><a href="Aws.Aws.html#awsIteratedSource%27"><span class="hs-identifier hs-var">awsIteratedSource'</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; ResourceT IO (a, Response (ResponseMetadata a) a)
</span><a href="#local-6989586621679228834"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228835"><span class="hs-identifier hs-var">req_</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679228834"><span class="annot"><span class="annottext">run :: r -&gt; ResourceT IO (a, Response (ResponseMetadata a) a)
</span><a href="#local-6989586621679228834"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679228833"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228833"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621679228832"><span class="annot"><span class="annottext">Response (ResponseMetadata a) a
</span><a href="#local-6989586621679228832"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
Transaction r a =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var">aws</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228838"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228837"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228836"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228833"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621679228831"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228831"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a -&gt; ResourceT IO a
forall (io :: * -&gt; *) m a. MonadIO io =&gt; Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var">readResponseIO</span></a></span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a
</span><a href="#local-6989586621679228832"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">(a, Response (ResponseMetadata a) a)
-&gt; ResourceT IO (a, Response (ResponseMetadata a) a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228831"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a
</span><a href="#local-6989586621679228832"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span id="local-6989586621679228828"><span id="local-6989586621679228829"><span id="local-6989586621679228830"><span class="annot"><a href="Aws.Aws.html#awsIteratedList"><span class="hs-identifier hs-type">awsIteratedList</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier hs-type">IteratedTransaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228830"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228829"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#ListResponse"><span class="hs-identifier hs-type">ListResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228829"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228828"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Aws.html#Configuration"><span class="hs-identifier hs-type">Configuration</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228830"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-type">NormalQuery</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679228830"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Producer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679228828"><span class="hs-identifier hs-type">i</span></a></span></span></span></span><span>
</span><span id="line-315"></span><span id="awsIteratedList"><span class="annot"><span class="annottext">awsIteratedList :: Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; Producer (ResourceT IO) i
</span><a href="Aws.Aws.html#awsIteratedList"><span class="hs-identifier hs-var hs-var">awsIteratedList</span></a></span></span><span> </span><span id="local-6989586621679228827"><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228827"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679228826"><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228826"><span class="hs-identifier hs-var">scfg</span></a></span></span><span> </span><span id="local-6989586621679228825"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228825"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679228824"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228824"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; ResourceT IO a) -&gt; r -&gt; Producer (ResourceT IO) i
forall (m :: * -&gt; *) r b c.
(Monad m, IteratedTransaction r b, ListResponse b c) =&gt;
(r -&gt; m b) -&gt; r -&gt; Producer m c
</span><a href="Aws.Aws.html#awsIteratedList%27"><span class="hs-identifier hs-var">awsIteratedList'</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; ResourceT IO a
</span><a href="#local-6989586621679228823"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228824"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679228823"><span class="annot"><span class="annottext">run :: r -&gt; ResourceT IO a
</span><a href="#local-6989586621679228823"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679228822"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228822"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ResponseMetadata a) a -&gt; ResourceT IO a
forall (io :: * -&gt; *) m a. MonadIO io =&gt; Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var">readResponseIO</span></a></span><span> </span><span class="annot"><span class="annottext">(Response (ResponseMetadata a) a -&gt; ResourceT IO a)
-&gt; ResourceT IO (Response (ResponseMetadata a) a) -&gt; ResourceT IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
forall r a.
Transaction r a =&gt;
Configuration
-&gt; ServiceConfiguration r NormalQuery
-&gt; Manager
-&gt; r
-&gt; ResourceT IO (Response (ResponseMetadata a) a)
</span><a href="Aws.Aws.html#aws"><span class="hs-identifier hs-var">aws</span></a></span><span> </span><span class="annot"><span class="annottext">Configuration
</span><a href="#local-6989586621679228827"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ServiceConfiguration r NormalQuery
</span><a href="#local-6989586621679228826"><span class="hs-identifier hs-var">scfg</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679228825"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228822"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | A more flexible version of 'awsIteratedSource' that uses a</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- user-supplied run function. Useful for embedding AWS functionality</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- within application specific monadic contexts.</span><span>
</span><span id="line-324"></span><span id="local-6989586621679229042"><span id="local-6989586621679229044"><span id="local-6989586621679229045"><span id="local-6989586621679229046"><span class="annot"><a href="Aws.Aws.html#awsIteratedSource%27"><span class="hs-identifier hs-type">awsIteratedSource'</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679229046"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier hs-type">IteratedTransaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229044"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679229042"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">-- ^ A runner function for executing transactions.</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229045"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">-- ^ An initial request</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Producer</span></span><span> </span><span class="annot"><a href="#local-6989586621679229046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229042"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-331"></span><span id="awsIteratedSource%27"><span class="annot"><span class="annottext">awsIteratedSource' :: (r -&gt; m (a, b)) -&gt; r -&gt; Producer m b
</span><a href="Aws.Aws.html#awsIteratedSource%27"><span class="hs-identifier hs-var hs-var">awsIteratedSource'</span></a></span></span><span> </span><span id="local-6989586621679228821"><span class="annot"><span class="annottext">r -&gt; m (a, b)
</span><a href="#local-6989586621679228821"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679228820"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228820"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; ConduitT i b m ()
</span><a href="#local-6989586621679228819"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228820"><span class="hs-identifier hs-var">r0</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679228819"><span class="annot"><span class="annottext">go :: r -&gt; ConduitT i b m ()
</span><a href="#local-6989586621679228819"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679228818"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228818"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679228817"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228817"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679228816"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679228816"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (a, b) -&gt; ConduitT i b m (a, b)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (a, b) -&gt; ConduitT i b m (a, b))
-&gt; m (a, b) -&gt; ConduitT i b m (a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; m (a, b)
</span><a href="#local-6989586621679228821"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228818"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-335"></span><span>          </span><span class="annot"><span class="annottext">b -&gt; ConduitT i b m ()
forall (m :: * -&gt; *) o i. Monad m =&gt; o -&gt; ConduitT i o m ()
</span><span class="hs-identifier hs-var">C.yield</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679228816"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-336"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">r -&gt; a -&gt; Maybe r
forall r a. IteratedTransaction r a =&gt; r -&gt; a -&gt; Maybe r
</span><a href="Aws.Core.html#nextIteratedRequest"><span class="hs-identifier hs-var">nextIteratedRequest</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228818"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228817"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><span class="annottext">Maybe r
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ConduitT i b m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679228812"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228812"><span class="hs-identifier hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; ConduitT i b m ()
</span><a href="#local-6989586621679228819"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228812"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | A more flexible version of 'awsIteratedList' that uses a</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- user-supplied run function. Useful for embedding AWS functionality</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- within application specific monadic contexts.</span><span>
</span><span id="line-345"></span><span id="local-6989586621679229034"><span id="local-6989586621679229035"><span id="local-6989586621679229036"><span id="local-6989586621679229037"><span class="annot"><a href="Aws.Aws.html#awsIteratedList%27"><span class="hs-identifier hs-type">awsIteratedList'</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679229037"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier hs-type">IteratedTransaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229036"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#ListResponse"><span class="hs-identifier hs-type">ListResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229035"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229034"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229036"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229037"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229035"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- ^ A runner function for executing transactions.</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679229036"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-comment">-- ^ An initial request</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Producer</span></span><span> </span><span class="annot"><a href="#local-6989586621679229037"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229034"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-352"></span><span id="awsIteratedList%27"><span class="annot"><span class="annottext">awsIteratedList' :: (r -&gt; m b) -&gt; r -&gt; Producer m c
</span><a href="Aws.Aws.html#awsIteratedList%27"><span class="hs-identifier hs-var hs-var">awsIteratedList'</span></a></span></span><span> </span><span id="local-6989586621679228811"><span class="annot"><span class="annottext">r -&gt; m b
</span><a href="#local-6989586621679228811"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679228810"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228810"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">(r -&gt; m (b, b)) -&gt; r -&gt; Producer m b
forall (m :: * -&gt; *) r a b.
(Monad m, IteratedTransaction r a) =&gt;
(r -&gt; m (a, b)) -&gt; r -&gt; Producer m b
</span><a href="Aws.Aws.html#awsIteratedSource%27"><span class="hs-identifier hs-var">awsIteratedSource'</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; m (b, b)
</span><a href="#local-6989586621679228809"><span class="hs-identifier hs-var">run'</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228810"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT i b m () -&gt; ConduitT b c m () -&gt; ConduitT i c m ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
Conduit a m b -&gt; ConduitT b c m r -&gt; ConduitT a c m r
</span><span class="hs-operator hs-var">C.=$=</span></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="annottext">(b -&gt; [c]) -&gt; ConduitT b c m ()
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; [b]) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">CL.concatMap</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; [c]
forall resp item. ListResponse resp item =&gt; resp -&gt; [item]
</span><a href="Aws.Core.html#listResponse"><span class="hs-identifier hs-var">listResponse</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679228805"><span class="annot"><span class="annottext">dupl :: b -&gt; (b, b)
</span><a href="#local-6989586621679228805"><span class="hs-identifier hs-var hs-var">dupl</span></a></span></span><span> </span><span id="local-6989586621679228804"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679228804"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679228804"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679228804"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679228809"><span class="annot"><span class="annottext">run' :: r -&gt; m (b, b)
</span><a href="#local-6989586621679228809"><span class="hs-identifier hs-var hs-var">run'</span></a></span></span><span> </span><span id="local-6989586621679228803"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228803"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; (b, b)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679228805"><span class="hs-identifier hs-var">dupl</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; (b, b)) -&gt; m b -&gt; m (b, b)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; m b
</span><a href="#local-6989586621679228811"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679228803"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-358"></span></pre></body></html>