<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span class="hs-cpp">

#ifndef HASKELL98
</span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span class="hs-cpp">

# if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">
# if __GLASGOW_HASKELL__ &gt;= 706
</span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">
# if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-deprecations #-}</span><span>
</span><span id="line-26"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Module      :  Control.Monad.Trans.Instances</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Copyright   :  (C) 2012-16 Edward Kmett</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Backports orphan instances which are not provided by other modules in</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- @transformers-compat@.</span><span>
</span><span id="line-37"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-38"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Instances</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#ifndef MIN_VERSION_base
</span><span class="hs-cpp">#define MIN_VERSION_base(a,b,c) 1
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#ifndef MIN_VERSION_transformers
</span><span class="hs-cpp">#define MIN_VERSION_transformers(a,b,c) 1
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative.Backwards</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Backwards</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative.Lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Lift</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Accum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AccumT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Cont</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ContT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Error</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ErrorT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IdentityT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ListT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapListT</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RWST</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RWST</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Select</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SelectT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Classes</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Compose</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Constant</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constant</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Product</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Product</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reverse</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Sum</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arrow</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadPlus</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Fix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFix</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ix</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Traversable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Storable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">castPtr</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_base(4,4,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadZip</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,7,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,9,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base(4,10,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifoldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifoldable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bitraversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bitraversable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#ifndef HASKELL98
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span class="hs-cpp">

# ifdef GENERIC_DERIVING
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Generics.Deriving.Base</span><span class="hs-cpp">
# elif __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,3,0))
</span><span class="hs-comment">-- Foldable/Traversable instances</span><span>
</span><span id="line-123"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">mempty</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Left</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Right</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fst</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Lazy.runWriterT</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Lazy.runWriterT</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>       </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fst</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Strict.runWriterT</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">traverse</span><span> </span><span class="hs-identifier">f'</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Strict.runWriterT</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>       </span><span class="hs-identifier">f'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- MonadFix instances for IdentityT and MaybeT</span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runIdentityT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runMaybeT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">bomb</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">bomb</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;mfix (MaybeT): inner computation returned Nothing&quot;</span><span class="hs-cpp">

# if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-comment">-- Monad instances for Product</span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">fstP</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">sndP</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-identifier">fstP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-identifier">sndP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-identifier">mzero</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">mzero</span><span> </span><span class="hs-identifier">mzero</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">y2</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">y1</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fstP</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sndP</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-identifier">fstP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-identifier">sndP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">b</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,4,0))
</span><span class="hs-comment">-- Alternative IO instance</span><span class="hs-cpp">
# if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-comment">-- The version bounds of transformers prior to 0.4.0.0 should prevent this</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- instance from being compiled on base-4.8.0.0 and later, but we'll put</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- a check here just to be safe.</span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Alternative</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mzero</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span class="hs-operator">&lt;|&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mplus</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if MIN_VERSION_transformers(0,4,0) &amp;&amp; !(MIN_VERSION_transformers(0,4,3))
</span><span class="hs-comment">-- transformers-0.4-specific Eq1, Ord1, Read1, and Show1 instances for Const</span><span>
</span><span id="line-205"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Eq1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-identifier">eq1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">y</span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ord</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Ord1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-identifier">compare1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Read</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Read1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-identifier">readsPrec1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readsData</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">readsUnary</span><span> </span><span class="hs-string">&quot;Const&quot;</span><span> </span><span class="hs-identifier">Const</span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Show1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-identifier">showsPrec1</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Const</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsUnary</span><span> </span><span class="hs-string">&quot;Const&quot;</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,0)) \
  || (MIN_VERSION_transformers(0,5,0) &amp;&amp; !(MIN_VERSION_base(4,9,0)))
</span><span class="hs-comment">-- MonadFail instances</span><span>
</span><span id="line-218"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ContT</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ContT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Error</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strMsg</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.RWST</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Lazy.RWST</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.RWST</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.RWST</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.StateT</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Lazy.StateT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.StateT</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.StateT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">str</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">

# if MIN_VERSION_transformers(0,4,0) &amp;&amp; !(MIN_VERSION_base(4,9,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ExceptT</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ExceptT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Fail.fail</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">
# if MIN_VERSION_transformers(0,5,3) &amp;&amp; !(MIN_VERSION_base(4,9,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AccumT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AccumT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SelectT</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,0))
</span><span class="hs-comment">-- Monoid Constant instance</span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-identifier">mempty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- MonadZip instances</span><span class="hs-cpp">
# if MIN_VERSION_base(4,4,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IdentityT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">zipWith</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">MaybeT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">liftA2</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Lazy.WriterT</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">w'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mappend</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">w'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-cpp">

#  if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-identifier">munzip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span class="hs-cpp">
#  endif
</span><span class="hs-cpp">
#  if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadZip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">y1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">x2</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x1</span><span> </span><span class="hs-identifier">x2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mzipWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">y1</span><span> </span><span class="hs-identifier">y2</span><span class="hs-special">)</span><span class="hs-cpp">
#  endif
</span><span class="hs-cpp"># endif
</span><span class="hs-cpp">
# if MIN_VERSION_base(4,8,0)
</span><span class="hs-comment">-- Bifunctor Constant instance</span><span>
</span><span id="line-325"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Bifunctor</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-identifier">first</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-identifier">second</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
# else
</span><span class="hs-comment">-- Monoid Identity instance</span><span>
</span><span id="line-330"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-identifier">mempty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">mempty</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mappend</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">
# ifndef HASKELL98
</span><span class="hs-comment">-- Typeable instances</span><span class="hs-cpp">
#  if __GLASGOW_HASKELL__ &gt;= 708 &amp;&amp; __GLASGOW_HASKELL__ &lt; 710
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Backwards</span><span>
</span><span id="line-339"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Constant</span><span>
</span><span id="line-340"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">ContT</span><span>
</span><span id="line-341"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">ErrorT</span><span>
</span><span id="line-342"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">IdentityT</span><span>
</span><span id="line-343"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Lift</span><span>
</span><span id="line-344"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">ListT</span><span>
</span><span id="line-345"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">MaybeT</span><span>
</span><span id="line-346"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">MonadTrans</span><span>
</span><span id="line-347"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Lazy.RWST</span><span>
</span><span id="line-348"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Strict.RWST</span><span>
</span><span id="line-349"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">ReaderT</span><span>
</span><span id="line-350"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Reverse</span><span>
</span><span id="line-351"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Lazy.StateT</span><span>
</span><span id="line-352"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Strict.StateT</span><span class="hs-cpp">

#   if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Compose</span><span>
</span><span id="line-356"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">MonadIO</span><span>
</span><span id="line-357"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Product</span><span class="hs-cpp">
#   endif
</span><span class="hs-cpp">#  endif
</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- Identity instances</span><span class="hs-cpp">
#  if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable1</span><span> </span><span class="hs-identifier">Identity</span><span>
</span><span id="line-364"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-cpp">
#   if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Identity</span><span class="hs-cpp">
#   endif
</span><span class="hs-cpp">#  endif
</span><span class="hs-cpp">
#  if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-cpp">#   if __GLASGOW_HASKELL__ &gt;= 708
</span><span class="hs-comment">-- Data instances for Compose and Product</span><span>
</span><span id="line-373"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">

#    if MIN_VERSION_transformers(0,4,0)
</span><span class="hs-comment">-- Typeable/Data instances for Sum</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- These are also present in Data.Functor.Sum in transformers-compat, but only</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- these are reachable if using @transformers-0.4.0.0@</span><span>
</span><span id="line-382"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">Sum</span><span>
</span><span id="line-383"></span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#    endif
</span><span class="hs-cpp">#   endif
</span><span class="hs-cpp">#  endif
</span><span class="hs-cpp"># endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,1))
</span><span class="hs-cpp"># if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bounded</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Bounded</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-identifier">minBound</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">minBound</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-identifier">maxBound</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">maxBound</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Enum</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Enum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-identifier">succ</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">succ</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-identifier">pred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">pred</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-identifier">toEnum</span><span> </span><span class="hs-identifier">i</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toEnum</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromEnum</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-identifier">enumFrom</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">enumFrom</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-identifier">enumFromThen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">enumFromThen</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-identifier">enumFromTo</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">enumFromTo</span><span>   </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-identifier">enumFromThenTo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">enumFromThenTo</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">z</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ix</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Ix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-identifier">range</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">range</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-identifier">index</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">index</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-identifier">inRange</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">inRange</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">e</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-identifier">rangeSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">rangeSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Storable</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Storable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-identifier">sizeOf</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sizeOf</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-identifier">alignment</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">alignment</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-identifier">peekElemOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peekElemOff</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-identifier">pokeElemOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pokeElemOff</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-identifier">peekByteOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peekByteOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-identifier">pokeByteOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pokeByteOff</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-identifier">peek</span><span> </span><span class="hs-identifier">p</span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peek</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-identifier">poke</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">poke</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,3))
</span><span class="hs-cpp"># if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-cpp">#  if MIN_VERSION_base(4,7,0)
</span><span class="hs-comment">-- Data.Proxy</span><span class="hs-cpp">
#   if defined(TRANSFORMERS_FOUR)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Eq1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-identifier">eq1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Ord1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-identifier">compare1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EQ</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-identifier">showsPrec1</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-string">&quot;Proxy&quot;</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Read1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-identifier">readsPrec1</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Proxy&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-cpp">
#   elif MIN_VERSION_transformers(0,5,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Eq1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-identifier">liftEq</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Ord1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-identifier">liftCompare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EQ</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-identifier">liftShowsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-string">&quot;Proxy&quot;</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Read1</span><span> </span><span class="hs-identifier">Proxy</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-identifier">liftReadsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">d</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">d</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">Proxy</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Proxy&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-cpp">
#   endif
</span><span class="hs-cpp">#  endif
</span><span class="hs-cpp"># endif
</span><span class="hs-cpp">
# if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-comment">-- Data.Functor.Identity</span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">.&amp;.</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">.|.</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-identifier">xor</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">xor</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-identifier">complement</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">complement</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-identifier">shift</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shift</span><span>    </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-identifier">rotate</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rotate</span><span>   </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-identifier">setBit</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">setBit</span><span>   </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-identifier">clearBit</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">clearBit</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-identifier">shiftL</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shiftL</span><span>   </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-identifier">shiftR</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">shiftR</span><span>   </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-identifier">rotateL</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rotateL</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-identifier">rotateR</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rotateR</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-identifier">testBit</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">testBit</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-identifier">bitSize</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bitSize</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-identifier">isSigned</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isSigned</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-identifier">bit</span><span> </span><span class="hs-identifier">i</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bit</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-cpp">
#  if MIN_VERSION_base(4,5,0)
</span><span>    </span><span class="hs-identifier">unsafeShiftL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafeShiftL</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-identifier">unsafeShiftR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafeShiftR</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-identifier">popCount</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">popCount</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#  endif
</span><span class="hs-cpp">#  if MIN_VERSION_base(4,7,0)
</span><span>    </span><span class="hs-identifier">zeroBits</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">zeroBits</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-identifier">bitSizeMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bitSizeMaybe</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#  endif
</span><span class="hs-cpp">
#  if MIN_VERSION_base(4,7,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FiniteBits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">FiniteBits</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-identifier">finiteBitSize</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">finiteBitSize</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#  endif
</span><span>
</span><span id="line-494"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Floating</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Floating</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-identifier">pi</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">pi</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-identifier">exp</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">exp</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-identifier">log</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">log</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-identifier">sqrt</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sqrt</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-identifier">sin</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sin</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-identifier">cos</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cos</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-identifier">tan</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tan</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-identifier">asin</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">asin</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-identifier">acos</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">acos</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-identifier">atan</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atan</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-identifier">sinh</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sinh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-identifier">cosh</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cosh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-identifier">tanh</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tanh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-identifier">asinh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">asinh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-identifier">acosh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">acosh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-identifier">atanh</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atanh</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">**</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">**</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-identifier">logBase</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">logBase</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fractional</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fractional</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">/</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-identifier">recip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">recip</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">r</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromRational</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IsString</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IsString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-identifier">fromString</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromString</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Integral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-identifier">quot</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">quot</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-identifier">rem</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rem</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-identifier">div</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">div</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-identifier">mod</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mod</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-identifier">quotRem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">Identity</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">quotRem</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-identifier">divMod</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">Identity</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">divMod</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Num</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Num</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-identifier">negate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">negate</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-identifier">abs</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">abs</span><span>    </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-identifier">signum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">signum</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-identifier">n</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromInteger</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Real</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Real</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-identifier">toRational</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toRational</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealFloat</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">RealFloat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-identifier">floatRadix</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">floatRadix</span><span>     </span><span class="hs-identifier">x</span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-identifier">floatDigits</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">floatDigits</span><span>    </span><span class="hs-identifier">x</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-identifier">floatRange</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">floatRange</span><span>     </span><span class="hs-identifier">x</span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-identifier">decodeFloat</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">decodeFloat</span><span>    </span><span class="hs-identifier">x</span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-identifier">exponent</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">exponent</span><span>       </span><span class="hs-identifier">x</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-identifier">isNaN</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isNaN</span><span>          </span><span class="hs-identifier">x</span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-identifier">isInfinite</span><span>     </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isInfinite</span><span>     </span><span class="hs-identifier">x</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-identifier">isDenormalized</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isDenormalized</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-identifier">isNegativeZero</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isNegativeZero</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-identifier">isIEEE</span><span>         </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">isIEEE</span><span>         </span><span class="hs-identifier">x</span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-identifier">significand</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">significand</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-identifier">scaleFloat</span><span> </span><span class="hs-identifier">s</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">scaleFloat</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-identifier">encodeFloat</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">n</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">encodeFloat</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-identifier">atan2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">atan2</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RealFrac</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">RealFrac</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-identifier">properFraction</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">id</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">Identity</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">properFraction</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-identifier">truncate</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">truncate</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-identifier">round</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">round</span><span>    </span><span class="hs-identifier">x</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-identifier">ceiling</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ceiling</span><span>  </span><span class="hs-identifier">x</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-identifier">floor</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">floor</span><span>    </span><span class="hs-identifier">x</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">
# if MIN_VERSION_transformers(0,3,0)
</span><span class="hs-comment">-- Data.Functor.Reverse</span><span>
</span><span id="line-569"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">return</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getReverse</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">getReverse</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&gt;&gt;=</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Fail.MonadFail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-identifier">fail</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Fail.fail</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">fail</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadPlus</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-identifier">mzero</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">mzero</span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mzero</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-584"></span><span>    </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Reverse</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mplus</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,4))
</span><span class="hs-cpp"># if MIN_VERSION_base(4,10,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Bifoldable</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-identifier">bifoldMap</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-593"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">bifoldMap</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Bitraversable</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-identifier">bitraverse</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">bitraverse</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if !(MIN_VERSION_transformers(0,5,5))
</span><span class="hs-cpp"># if MIN_VERSION_base(4,9,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Semigroup.Semigroup</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Semigroup.Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">&lt;&gt;</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Constant</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span> </span><span class="hs-operator">Semigroup.&lt;&gt;</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
# endif
</span><span>
</span><span id="line-608"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadFix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runListT</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">head</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-610"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runListT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mfix</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mapListT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">liftM</span><span> </span><span class="hs-identifier">tail</span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">mfix</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- Generic(1) instances</span><span class="hs-cpp">
#ifndef HASKELL98
</span><span class="hs-cpp"># if (!(MIN_VERSION_transformers(0,5,0)) &amp;&amp; (__GLASGOW_HASKELL__ &gt;= 702 || defined(GENERIC_DERIVING))) \
    || (MIN_VERSION_transformers(0,5,0)  &amp;&amp;  __GLASGOW_HASKELL__ &lt; 702  &amp;&amp; defined(GENERIC_DERIVING))
</span><span class="hs-cpp">
#  if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">MSIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-identifier">from</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-identifier">to</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep1</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCIdentity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">MSIdentity</span><span> </span><span class="hs-identifier">Par1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-identifier">from1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Par1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-identifier">to1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unPar1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MDIdentity</span><span>
</span><span id="line-632"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MCIdentity</span><span>
</span><span id="line-633"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MSIdentity</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Datatype</span><span> </span><span class="hs-identifier">MDIdentity</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-identifier">datatypeName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Identity&quot;</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-identifier">moduleName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data.Functor.Identity&quot;</span><span class="hs-cpp">
#   if __GLASGOW_HASKELL__ &gt;= 708
</span><span>  </span><span class="hs-identifier">isNewtype</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-cpp">
#   endif
</span><span>
</span><span id="line-642"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Constructor</span><span> </span><span class="hs-identifier">MCIdentity</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-identifier">conName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Identity&quot;</span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-identifier">conIsRecord</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Selector</span><span> </span><span class="hs-identifier">MSIdentity</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-identifier">selName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;runIdentity&quot;</span><span class="hs-cpp">
#  endif
</span><span class="hs-cpp">
#  if !(MIN_VERSION_base(4,9,0))
</span><span class="hs-comment">-- Generic(1) instances for Compose</span><span>
</span><span id="line-652"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDCompose</span><span>
</span><span id="line-655"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCCompose</span><span>
</span><span id="line-656"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">MSCompose</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-identifier">from</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-identifier">to</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Functor</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDCompose</span><span>
</span><span id="line-663"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCCompose</span><span>
</span><span id="line-664"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">MSCompose</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">:.:</span><span> </span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-identifier">from1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Compose</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Comp1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-identifier">to1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Compose</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">unRec1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unComp1</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MDCompose</span><span>
</span><span id="line-669"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MCCompose</span><span>
</span><span id="line-670"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MSCompose</span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Datatype</span><span> </span><span class="hs-identifier">MDCompose</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-identifier">datatypeName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Compose&quot;</span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-identifier">moduleName</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data.Functor.Compose&quot;</span><span class="hs-cpp">
#   if __GLASGOW_HASKELL__ &gt;= 708
</span><span>    </span><span class="hs-identifier">isNewtype</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-cpp">
#   endif
</span><span>
</span><span id="line-679"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Constructor</span><span> </span><span class="hs-identifier">MCCompose</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-identifier">conName</span><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Compose&quot;</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-identifier">conIsRecord</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Selector</span><span> </span><span class="hs-identifier">MSCompose</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-identifier">selName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;getCompose&quot;</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">-- Generic(1) instances for Product</span><span>
</span><span id="line-687"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDProduct</span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCPair</span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-identifier">from</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-identifier">to</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Product</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDProduct</span><span>
</span><span id="line-698"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCPair</span><span>
</span><span id="line-699"></span><span>          </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-identifier">from1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Pair</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-identifier">to1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">:*:</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pair</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unRec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unRec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MDProduct</span><span>
</span><span id="line-704"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MCPair</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Datatype</span><span> </span><span class="hs-identifier">MDProduct</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>    </span><span class="hs-identifier">datatypeName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Product&quot;</span><span>
</span><span id="line-708"></span><span>    </span><span class="hs-identifier">moduleName</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data.Functor.Product&quot;</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Constructor</span><span> </span><span class="hs-identifier">MCPair</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-identifier">conName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Pair&quot;</span><span class="hs-cpp">

#   if MIN_VERSION_transformers(0,4,0)
</span><span class="hs-comment">-- Generic(1) instances for Sum</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- These are also present in Data.Functor.Sum in transformers-compat, but only</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- these are reachable if using @transformers-0.4.0.0@ or later</span><span>
</span><span id="line-717"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDSum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCInL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>            </span><span class="hs-operator">:+:</span><span> </span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCInR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-identifier">from</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InL</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>    </span><span class="hs-identifier">from</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InR</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">R1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>    </span><span class="hs-identifier">to</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InL</span><span> </span><span class="hs-identifier">f</span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-identifier">to</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">R1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">K1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InR</span><span> </span><span class="hs-identifier">g</span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Generic1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-727"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">Rep1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Sum</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-728"></span><span>      </span><span class="hs-identifier">D1</span><span> </span><span class="hs-identifier">MDSum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCInL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>            </span><span class="hs-operator">:+:</span><span> </span><span class="hs-identifier">C1</span><span> </span><span class="hs-identifier">MCInR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">S1</span><span> </span><span class="hs-identifier">NoSelector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>    </span><span class="hs-identifier">from1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InL</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-identifier">from1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InR</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">R1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Rec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>    </span><span class="hs-identifier">to1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">L1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unRec1</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-identifier">to1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">R1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">M1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InR</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unRec1</span><span> </span><span class="hs-identifier">g</span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MDSum</span><span>
</span><span id="line-736"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MCInL</span><span>
</span><span id="line-737"></span><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MCInR</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Datatype</span><span> </span><span class="hs-identifier">MDSum</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-identifier">datatypeName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Sum&quot;</span><span>
</span><span id="line-741"></span><span>    </span><span class="hs-identifier">moduleName</span><span>   </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;Data.Functor.Sum&quot;</span><span>
</span><span id="line-742"></span><span>
</span><span id="line-743"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Constructor</span><span> </span><span class="hs-identifier">MCInL</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-744"></span><span>    </span><span class="hs-identifier">conName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;InL&quot;</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Constructor</span><span> </span><span class="hs-identifier">MCInR</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-747"></span><span>    </span><span class="hs-identifier">conName</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;InR&quot;</span><span class="hs-cpp">
#   endif
</span><span class="hs-cpp">#  endif
</span><span class="hs-cpp">
# endif
</span><span class="hs-cpp">#endif
</span></pre></body></html>