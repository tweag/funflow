<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_LSNSSd1qLjNFeMsXLduqC4"><span id="%24con2tag_EpXiFrfbmZn5yDFPqrGrWr"></span></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Aws.Core</span><span>
</span><span id="line-3"></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Logging</span></span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Aws.Core.html#Loggable"><span class="hs-identifier">Loggable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Response</span></span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Metadata in responses</span></span><span>
</span><span id="line-7"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier">Response</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#readResponse"><span class="hs-identifier">readResponse</span></a></span><span>
</span><span id="line-9"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier">readResponseIO</span></a></span><span>
</span><span id="line-10"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#tellMetadata"><span class="hs-identifier">tellMetadata</span></a></span><span>
</span><span id="line-11"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#tellMetadataRef"><span class="hs-identifier">tellMetadataRef</span></a></span><span>
</span><span id="line-12"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#mapMetadata"><span class="hs-identifier">mapMetadata</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Response data consumers</span></span><span>
</span><span id="line-14"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#HTTPResponseConsumer"><span class="hs-identifier">HTTPResponseConsumer</span></a></span><span>
</span><span id="line-15"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier">ResponseConsumer</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Memory response</span></span><span>
</span><span id="line-17"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#AsMemoryResponse"><span class="hs-identifier">AsMemoryResponse</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** List response</span></span><span>
</span><span id="line-19"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#ListResponse"><span class="hs-identifier">ListResponse</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Exception types</span></span><span>
</span><span id="line-21"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#XmlException"><span class="hs-identifier">XmlException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#HeaderException"><span class="hs-identifier">HeaderException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#FormException"><span class="hs-identifier">FormException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#NoCredentialsException"><span class="hs-identifier">NoCredentialsException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#throwStatusCodeException"><span class="hs-identifier">throwStatusCodeException</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Response deconstruction helpers</span></span><span>
</span><span id="line-27"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#readHex2"><span class="hs-identifier">readHex2</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- *** XML</span></span><span>
</span><span id="line-29"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#elContent"><span class="hs-identifier">elContent</span></a></span><span>
</span><span id="line-30"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#elCont"><span class="hs-identifier">elCont</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#force"><span class="hs-identifier">force</span></a></span><span>
</span><span id="line-32"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#forceM"><span class="hs-identifier">forceM</span></a></span><span>
</span><span id="line-33"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#textReadBool"><span class="hs-identifier">textReadBool</span></a></span><span>
</span><span id="line-34"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#textReadInt"><span class="hs-identifier">textReadInt</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#readInt"><span class="hs-identifier">readInt</span></a></span><span>
</span><span id="line-36"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#xmlCursorConsumer"><span class="hs-identifier">xmlCursorConsumer</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Query</span></span><span>
</span><span id="line-38"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier">SignedQuery</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier">NormalQuery</span></a></span><span>
</span><span id="line-40"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#UriOnlyQuery"><span class="hs-identifier">UriOnlyQuery</span></a></span><span>
</span><span id="line-41"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#queryToHttpRequest"><span class="hs-identifier">queryToHttpRequest</span></a></span><span>
</span><span id="line-42"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#queryToUri"><span class="hs-identifier">queryToUri</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Expiration</span></span><span>
</span><span id="line-44"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#TimeInfo"><span class="hs-identifier">TimeInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#AbsoluteTimeInfo"><span class="hs-identifier">AbsoluteTimeInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#fromAbsoluteTimeInfo"><span class="hs-identifier">fromAbsoluteTimeInfo</span></a></span><span>
</span><span id="line-47"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier">makeAbsoluteTimeInfo</span></a></span><span>
</span><span id="line-48"></span><span> </span><span class="annot"><span class="hs-comment">-- ** Signature</span></span><span>
</span><span id="line-49"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier">SignatureData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#signatureData"><span class="hs-identifier">signatureData</span></a></span><span>
</span><span id="line-51"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier">SignQuery</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier">AuthorizationHash</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#amzHash"><span class="hs-identifier">amzHash</span></a></span><span>
</span><span id="line-54"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#signature"><span class="hs-keyword">signature</span></a></span><span>
</span><span id="line-55"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#credentialV4"><span class="hs-identifier">credentialV4</span></a></span><span>
</span><span id="line-56"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#authorizationV4"><span class="hs-identifier">authorizationV4</span></a></span><span>
</span><span id="line-57"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#authorizationV4%27"><span class="hs-identifier">authorizationV4'</span></a></span><span>
</span><span id="line-58"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#signatureV4"><span class="hs-identifier">signatureV4</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Query construction helpers</span></span><span>
</span><span id="line-60"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#queryList"><span class="hs-identifier">queryList</span></a></span><span>
</span><span id="line-61"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#awsBool"><span class="hs-identifier">awsBool</span></a></span><span>
</span><span id="line-62"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#awsTrue"><span class="hs-identifier">awsTrue</span></a></span><span>
</span><span id="line-63"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#awsFalse"><span class="hs-identifier">awsFalse</span></a></span><span>
</span><span id="line-64"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#fmtTime"><span class="hs-identifier">fmtTime</span></a></span><span>
</span><span id="line-65"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#fmtRfc822Time"><span class="hs-identifier">fmtRfc822Time</span></a></span><span>
</span><span id="line-66"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#rfc822Time"><span class="hs-identifier">rfc822Time</span></a></span><span>
</span><span id="line-67"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#fmtAmzTime"><span class="hs-identifier">fmtAmzTime</span></a></span><span>
</span><span id="line-68"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#fmtTimeEpochSeconds"><span class="hs-identifier">fmtTimeEpochSeconds</span></a></span><span>
</span><span id="line-69"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#parseHttpDate"><span class="hs-identifier">parseHttpDate</span></a></span><span>
</span><span id="line-70"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#httpDate1"><span class="hs-identifier">httpDate1</span></a></span><span>
</span><span id="line-71"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#textHttpDate"><span class="hs-identifier">textHttpDate</span></a></span><span>
</span><span id="line-72"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#iso8601UtcDate"><span class="hs-identifier">iso8601UtcDate</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Transactions</span></span><span>
</span><span id="line-74"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier">Transaction</span></a></span><span>
</span><span id="line-75"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier">IteratedTransaction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Credentials</span></span><span>
</span><span id="line-77"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier">Credentials</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#makeCredentials"><span class="hs-identifier">makeCredentials</span></a></span><span>
</span><span id="line-79"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#credentialsDefaultFile"><span class="hs-identifier">credentialsDefaultFile</span></a></span><span>
</span><span id="line-80"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#credentialsDefaultKey"><span class="hs-identifier">credentialsDefaultKey</span></a></span><span>
</span><span id="line-81"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsFromFile"><span class="hs-identifier">loadCredentialsFromFile</span></a></span><span>
</span><span id="line-82"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier">loadCredentialsFromEnv</span></a></span><span>
</span><span id="line-83"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsFromInstanceMetadata"><span class="hs-identifier">loadCredentialsFromInstanceMetadata</span></a></span><span>
</span><span id="line-84"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnvOrFile"><span class="hs-identifier">loadCredentialsFromEnvOrFile</span></a></span><span>
</span><span id="line-85"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnvOrFileOrInstanceMetadata"><span class="hs-identifier">loadCredentialsFromEnvOrFileOrInstanceMetadata</span></a></span><span>
</span><span id="line-86"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#loadCredentialsDefault"><span class="hs-identifier">loadCredentialsDefault</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Service configuration</span></span><span>
</span><span id="line-88"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#DefaultServiceConfiguration"><span class="hs-identifier">DefaultServiceConfiguration</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="hs-comment">-- * HTTP types</span></span><span>
</span><span id="line-90"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Protocol"><span class="hs-identifier">Protocol</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#defaultPort"><span class="hs-identifier">defaultPort</span></a></span><span>
</span><span id="line-92"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Method"><span class="hs-identifier">Method</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier">httpMethod</span></a></span><span>
</span><span id="line-94"></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Aws.Ec2.InstanceMetadata.html"><span class="hs-identifier">Aws.Ec2.InstanceMetadata</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Aws.Network.html"><span class="hs-identifier">Aws.Network</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Blaze</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Resource</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ResourceT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadThrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwM</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CH</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.MAC.HMAC</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CMH</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ByteArray</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base16</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base16</span></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base64</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base64</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>    </span><span class="hs-special">(</span><span class="hs-comment">{- IsString -}</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.UTF8</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BU</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Conduit</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.|)</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span class="hs-cpp">
#if MIN_VERSION_http_conduit(2,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.Binary</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CB</span></span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.List</span></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CL</span></span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Traversable</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client.TLS</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span>       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_time(1,5,0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System.Locale</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.XML</span></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XML</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.XML.Cursor</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cu</span></span><span>
</span><span id="line-147"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.XML.Cursor</span></span><span>          </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">force</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forceM</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-149"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Types that can be logged (textually).</span><span>
</span><span id="line-152"></span><span class="hs-keyword">class</span><span> </span><span id="Loggable"><span class="annot"><a href="Aws.Core.html#Loggable"><span class="hs-identifier hs-var">Loggable</span></a></span></span><span> </span><span id="local-6989586621679225704"><span class="annot"><a href="#local-6989586621679225704"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="toLogText"><span class="annot"><a href="Aws.Core.html#toLogText"><span class="hs-identifier hs-type">toLogText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225704"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | A response with metadata. Can also contain an error response, or</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- an internal error, via 'Attempt'.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- Response forms a Writer-like monad.</span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="Response"><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span></span><span> </span><span id="local-6989586621679226022"><span class="annot"><a href="#local-6989586621679226022"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679226021"><span class="annot"><a href="#local-6989586621679226021"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Response"><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="responseMetadata"><span class="annot"><span class="annottext">Response m a -&gt; m
</span><a href="Aws.Core.html#responseMetadata"><span class="hs-identifier hs-var hs-var">responseMetadata</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679226022"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-160"></span><span>                             </span><span class="hs-special">,</span><span> </span><span id="responseResult"><span class="annot"><span class="annottext">Response m a -&gt; Either SomeException a
</span><a href="Aws.Core.html#responseResult"><span class="hs-identifier hs-var hs-var">responseResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span> </span><span class="annot"><a href="#local-6989586621679226021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225694"><span id="local-6989586621679225696"><span id="local-6989586621679225698"><span class="annot"><span class="annottext">Int -&gt; Response m a -&gt; ShowS
[Response m a] -&gt; ShowS
Response m a -&gt; String
(Int -&gt; Response m a -&gt; ShowS)
-&gt; (Response m a -&gt; String)
-&gt; ([Response m a] -&gt; ShowS)
-&gt; Show (Response m a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall m a. (Show m, Show a) =&gt; Int -&gt; Response m a -&gt; ShowS
forall m a. (Show m, Show a) =&gt; [Response m a] -&gt; ShowS
forall m a. (Show m, Show a) =&gt; Response m a -&gt; String
showList :: [Response m a] -&gt; ShowS
$cshowList :: forall m a. (Show m, Show a) =&gt; [Response m a] -&gt; ShowS
show :: Response m a -&gt; String
$cshow :: forall m a. (Show m, Show a) =&gt; Response m a -&gt; String
showsPrec :: Int -&gt; Response m a -&gt; ShowS
$cshowsPrec :: forall m a. (Show m, Show a) =&gt; Int -&gt; Response m a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225689"><span id="local-6989586621679225691"><span class="annot"><span class="annottext">a -&gt; Response m b -&gt; Response m a
(a -&gt; b) -&gt; Response m a -&gt; Response m b
(forall a b. (a -&gt; b) -&gt; Response m a -&gt; Response m b)
-&gt; (forall a b. a -&gt; Response m b -&gt; Response m a)
-&gt; Functor (Response m)
forall a b. a -&gt; Response m b -&gt; Response m a
forall a b. (a -&gt; b) -&gt; Response m a -&gt; Response m b
forall m a b. a -&gt; Response m b -&gt; Response m a
forall m a b. (a -&gt; b) -&gt; Response m a -&gt; Response m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Response m b -&gt; Response m a
$c&lt;$ :: forall m a b. a -&gt; Response m b -&gt; Response m a
fmap :: (a -&gt; b) -&gt; Response m a -&gt; Response m b
$cfmap :: forall m a b. (a -&gt; b) -&gt; Response m a -&gt; Response m b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Read a response result (if it's a success response, fail otherwise).</span><span>
</span><span id="line-164"></span><span id="local-6989586621679226012"><span id="local-6989586621679226013"><span id="local-6989586621679226014"><span class="annot"><a href="Aws.Core.html#readResponse"><span class="hs-identifier hs-type">readResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679226014"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226013"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226014"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226012"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-165"></span><span id="readResponse"><span class="annot"><span class="annottext">readResponse :: Response m a -&gt; n a
</span><a href="Aws.Core.html#readResponse"><span class="hs-identifier hs-var hs-var">readResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; n a)
-&gt; (a -&gt; n a) -&gt; Either SomeException a -&gt; n a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; n a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; n a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either SomeException a -&gt; n a)
-&gt; (Response m a -&gt; Either SomeException a) -&gt; Response m a -&gt; n a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response m a -&gt; Either SomeException a
forall m a. Response m a -&gt; Either SomeException a
</span><a href="Aws.Core.html#responseResult"><span class="hs-identifier hs-var hs-var">responseResult</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Read a response result (if it's a success response, fail otherwise). In MonadIO.</span><span>
</span><span id="line-168"></span><span id="local-6989586621679225683"><span id="local-6989586621679225684"><span id="local-6989586621679225685"><span class="annot"><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-type">readResponseIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225685"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225683"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225685"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225683"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-169"></span><span id="readResponseIO"><span class="annot"><span class="annottext">readResponseIO :: Response m a -&gt; io a
</span><a href="Aws.Core.html#readResponseIO"><span class="hs-identifier hs-var hs-var">readResponseIO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; io a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; io a) -&gt; (Response m a -&gt; IO a) -&gt; Response m a -&gt; io a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response m a -&gt; IO a
forall (n :: * -&gt; *) m a. MonadThrow n =&gt; Response m a -&gt; n a
</span><a href="Aws.Core.html#readResponse"><span class="hs-identifier hs-var">readResponse</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | An empty response with some metadata.</span><span>
</span><span id="line-172"></span><span id="local-6989586621679225681"><span class="annot"><a href="Aws.Core.html#tellMetadata"><span class="hs-identifier hs-type">tellMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225681"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225681"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-173"></span><span id="tellMetadata"><span class="annot"><span class="annottext">tellMetadata :: m -&gt; Response m ()
</span><a href="Aws.Core.html#tellMetadata"><span class="hs-identifier hs-var hs-var">tellMetadata</span></a></span></span><span> </span><span id="local-6989586621679225680"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225680"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException () -&gt; Response m ()
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225680"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either SomeException ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Apply a function to the metadata.</span><span>
</span><span id="line-176"></span><span id="local-6989586621679225677"><span id="local-6989586621679225678"><span id="local-6989586621679225679"><span class="annot"><a href="Aws.Core.html#mapMetadata"><span class="hs-identifier hs-type">mapMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679225679"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225678"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225679"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225677"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225678"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225677"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-177"></span><span id="mapMetadata"><span class="annot"><span class="annottext">mapMetadata :: (m -&gt; n) -&gt; Response m a -&gt; Response n a
</span><a href="Aws.Core.html#mapMetadata"><span class="hs-identifier hs-var hs-var">mapMetadata</span></a></span></span><span> </span><span id="local-6989586621679225676"><span class="annot"><span class="annottext">m -&gt; n
</span><a href="#local-6989586621679225676"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span id="local-6989586621679225675"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225675"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679225674"><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679225674"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n -&gt; Either SomeException a -&gt; Response n a
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; n
</span><a href="#local-6989586621679225676"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225675"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679225674"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">--multiResponse :: Monoid m =&gt; Response m a -&gt; Response [m] a -&gt;</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679225673"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225664"><span id="local-6989586621679225666"><span id="local-6989586621679225668"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679225673"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225673"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679225662"><span class="annot"><span class="annottext">pure :: a -&gt; Response m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679225661"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225661"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException a -&gt; Response m a
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either SomeException a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225661"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679225660"><span class="annot"><span class="annottext">&lt;*&gt; :: Response m (a -&gt; b) -&gt; Response m a -&gt; Response m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response m (a -&gt; b) -&gt; Response m a -&gt; Response m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span id="local-6989586621679225658"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225654"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679225658"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225658"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679225651"><span class="annot"><span class="annottext">return :: a -&gt; Response m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679225650"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225650"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException a -&gt; Response m a
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either SomeException a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225650"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span id="local-6989586621679225649"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225649"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679225648"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679225648"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679225647"><span class="annot"><span class="annottext">&gt;&gt;= :: Response m a -&gt; (a -&gt; Response m b) -&gt; Response m b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Response m b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException b -&gt; Response m b
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225649"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; Either SomeException b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679225648"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span id="local-6989586621679225646"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225646"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679225645"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225645"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span id="local-6989586621679225644"><span class="annot"><span class="annottext">a -&gt; Response m b
</span><a href="#local-6989586621679225644"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span id="local-6989586621679225643"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225643"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span id="local-6989586621679225642"><span class="annot"><span class="annottext">Either SomeException b
</span><a href="#local-6989586621679225642"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Response m b
</span><a href="#local-6989586621679225644"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225645"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-189"></span><span>                                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException b -&gt; Response m b
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225646"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225643"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either SomeException b
</span><a href="#local-6989586621679225642"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-comment">-- currently using First-semantics, Last SHOULD work too</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621679225641"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679225641"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225641"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679225637"><span class="annot"><span class="annottext">throwM :: e -&gt; Response m a
</span><a href="#local-6989586621679225637"><span class="hs-identifier hs-var hs-var hs-var hs-var">throwM</span></a></span></span><span> </span><span id="local-6989586621679225636"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679225636"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Either SomeException a -&gt; Response m a
forall m a. m -&gt; Either SomeException a -&gt; Response m a
</span><a href="Aws.Core.html#Response"><span class="hs-identifier hs-var">Response</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Either SomeException a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679225636"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Add metadata to an 'IORef' (using 'mappend').</span><span>
</span><span id="line-195"></span><span id="local-6989586621679225770"><span class="annot"><a href="Aws.Core.html#tellMetadataRef"><span class="hs-identifier hs-type">tellMetadataRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679225770"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="#local-6989586621679225770"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225770"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-196"></span><span id="tellMetadataRef"><span class="annot"><span class="annottext">tellMetadataRef :: IORef m -&gt; m -&gt; IO ()
</span><a href="Aws.Core.html#tellMetadataRef"><span class="hs-identifier hs-var hs-var">tellMetadataRef</span></a></span></span><span> </span><span id="local-6989586621679225635"><span class="annot"><span class="annottext">IORef m
</span><a href="#local-6989586621679225635"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679225634"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225634"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef m -&gt; (m -&gt; m) -&gt; IO ()
forall a. IORef a -&gt; (a -&gt; a) -&gt; IO ()
</span><span class="hs-identifier hs-var">modifyIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef m
</span><a href="#local-6989586621679225635"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225634"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | A full HTTP response parser. Takes HTTP status, response headers, and response body.</span><span>
</span><span id="line-199"></span><span class="hs-keyword">type</span><span> </span><span id="HTTPResponseConsumer"><span class="annot"><a href="Aws.Core.html#HTTPResponseConsumer"><span class="hs-identifier hs-var">HTTPResponseConsumer</span></a></span></span><span> </span><span id="local-6989586621679225632"><span class="annot"><a href="#local-6989586621679225632"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Response</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.ConduitM</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225632"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Class for types that AWS HTTP responses can be parsed into.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- The request is also passed for possibly required additional metadata.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Note that for debugging, there is an instance for 'L.ByteString'.</span><span>
</span><span id="line-207"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225956"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ResponseConsumer"><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier hs-var">ResponseConsumer</span></a></span></span><span> </span><span id="local-6989586621679225955"><span class="annot"><a href="#local-6989586621679225955"><span class="hs-identifier hs-type">req</span></a></span></span><span> </span><span id="local-6989586621679225956"><span class="annot"><a href="#local-6989586621679225956"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- | Metadata associated with a response. Typically there is one</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- metadata type for each AWS service.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ResponseMetadata"><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-var">ResponseMetadata</span></a></span></span><span> </span><span id="local-6989586621679225956"><span class="annot"><a href="#local-6989586621679225956"><span class="hs-identifier hs-type">resp</span></a></span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- | Response parser. Takes the corresponding AWS request, the derived</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- @http-client@ request (for error reporting), an 'IORef' for metadata, and</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-comment">-- HTTP response data.</span><span>
</span><span id="line-215"></span><span>    </span><span id="responseConsumer"><span class="annot"><a href="Aws.Core.html#responseConsumer"><span class="hs-identifier hs-type">responseConsumer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225955"><span class="hs-identifier hs-type">req</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225956"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#HTTPResponseConsumer"><span class="hs-identifier hs-type">HTTPResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225956"><span class="hs-identifier hs-type">resp</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Does not parse response. For debugging.</span><span>
</span><span id="line-218"></span><span id="local-6989586621679225630"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier hs-type">ResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225630"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ResponseMetadata"><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-var">ResponseMetadata</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679225626"><span class="annot"><span class="annottext">responseConsumer :: Request
-&gt; r
-&gt; IORef (ResponseMetadata (Response ByteString))
-&gt; HTTPResponseConsumer (Response ByteString)
</span><a href="#local-6989586621679225626"><span class="hs-identifier hs-var hs-var hs-var hs-var">responseConsumer</span></a></span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IORef (ResponseMetadata (Response ByteString))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679225625"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679225625"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>        </span><span id="local-6989586621679225624"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679225624"><span class="hs-identifier hs-var">bss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConduitT () Void (ResourceT IO) [ByteString]
-&gt; ResourceT IO [ByteString]
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">C.runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void (ResourceT IO) [ByteString]
 -&gt; ResourceT IO [ByteString])
-&gt; ConduitT () Void (ResourceT IO) [ByteString]
-&gt; ResourceT IO [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; ConduitM () ByteString (ResourceT IO) ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTP.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679225625"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) [ByteString]
-&gt; ConduitT () Void (ResourceT IO) [ByteString]
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitM ByteString Void (ResourceT IO) [ByteString]
forall (m :: * -&gt; *) a o. Monad m =&gt; ConduitT a o m [a]
</span><span class="hs-identifier hs-var">CL.consume</span></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">Response ByteString -&gt; ResourceT IO (Response ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679225625"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">responseBody :: ByteString
</span><span class="hs-identifier hs-var">HTTP.responseBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">L.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679225624"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-224"></span><span>            </span><span class="hs-special">}</span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Class for responses that are fully loaded into memory</span><span>
</span><span id="line-227"></span><span class="hs-keyword">class</span><span> </span><span id="AsMemoryResponse"><span class="annot"><a href="Aws.Core.html#AsMemoryResponse"><span class="hs-identifier hs-var">AsMemoryResponse</span></a></span></span><span> </span><span id="local-6989586621679225619"><span class="annot"><a href="#local-6989586621679225619"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="MemoryResponse"><span class="annot"><a href="Aws.Core.html#MemoryResponse"><span class="hs-identifier hs-var">MemoryResponse</span></a></span></span><span> </span><span id="local-6989586621679225619"><span class="annot"><a href="#local-6989586621679225619"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-229"></span><span>    </span><span id="loadToMemory"><span class="annot"><a href="Aws.Core.html#loadToMemory"><span class="hs-identifier hs-type">loadToMemory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225619"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ResourceT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#MemoryResponse"><span class="hs-identifier hs-type">MemoryResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225619"><span class="hs-identifier hs-type">resp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Responses that have one main list in them, and perhaps some decoration.</span><span>
</span><span id="line-232"></span><span class="hs-keyword">class</span><span> </span><span id="ListResponse"><span class="annot"><a href="Aws.Core.html#ListResponse"><span class="hs-identifier hs-var">ListResponse</span></a></span></span><span> </span><span id="local-6989586621679225616"><span class="annot"><a href="#local-6989586621679225616"><span class="hs-identifier hs-type">resp</span></a></span></span><span> </span><span id="local-6989586621679225615"><span class="annot"><a href="#local-6989586621679225615"><span class="hs-identifier hs-type">item</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679225616"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225615"><span class="hs-identifier hs-type">item</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="listResponse"><span class="annot"><a href="Aws.Core.html#listResponse"><span class="hs-identifier hs-type">listResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225616"><span class="hs-identifier hs-type">resp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225615"><span class="hs-identifier hs-type">item</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Associates a request type and a response type in a bi-directional way.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- This allows the type-checker to infer the response type when given</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- the request type and vice versa.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Note that the actual request generation and response parsing</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- resides in 'SignQuery' and 'ResponseConsumer' respectively.</span><span>
</span><span id="line-243"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier hs-type">SignQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225613"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#ResponseConsumer"><span class="hs-identifier hs-type">ResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225613"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Aws.Core.html#Loggable"><span class="hs-identifier hs-type">Loggable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ResponseMetadata"><span class="hs-identifier hs-type">ResponseMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Transaction"><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-var">Transaction</span></a></span></span><span> </span><span id="local-6989586621679225613"><span class="annot"><a href="#local-6989586621679225613"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679225612"><span class="annot"><a href="#local-6989586621679225612"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679225613"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225612"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | A transaction that may need to be split over multiple requests, for example because of upstream response size limits.</span><span>
</span><span id="line-248"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Aws.Core.html#Transaction"><span class="hs-identifier hs-type">Transaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225611"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IteratedTransaction"><span class="annot"><a href="Aws.Core.html#IteratedTransaction"><span class="hs-identifier hs-var">IteratedTransaction</span></a></span></span><span> </span><span id="local-6989586621679225611"><span class="annot"><a href="#local-6989586621679225611"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679225610"><span class="annot"><a href="#local-6989586621679225610"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679225611"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>    </span><span id="nextIteratedRequest"><span class="annot"><a href="Aws.Core.html#nextIteratedRequest"><span class="hs-identifier hs-type">nextIteratedRequest</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225611"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679225611"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Signature version 4: ((region, service),(date,key))</span><span>
</span><span id="line-252"></span><span class="hs-keyword">type</span><span> </span><span id="V4Key"><span class="annot"><a href="Aws.Core.html#V4Key"><span class="hs-identifier hs-var">V4Key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | AWS access credentials.</span><span>
</span><span id="line-255"></span><span class="hs-keyword">data</span><span> </span><span id="Credentials"><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Credentials"><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-comment">-- | AWS Access Key ID.</span><span>
</span><span id="line-258"></span><span>        </span><span id="accessKeyID"><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#accessKeyID"><span class="hs-identifier hs-var hs-var">accessKeyID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-comment">-- | AWS Secret Access Key.</span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="secretAccessKey"><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#secretAccessKey"><span class="hs-identifier hs-var hs-var">secretAccessKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-comment">-- | Signing keys for signature version 4</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="v4SigningKeys"><span class="annot"><span class="annottext">Credentials -&gt; IORef [V4Key]
</span><a href="Aws.Core.html#v4SigningKeys"><span class="hs-identifier hs-var hs-var">v4SigningKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Aws.Core.html#V4Key"><span class="hs-identifier hs-type">V4Key</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-comment">-- | Signed IAM token</span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="iamToken"><span class="annot"><span class="annottext">Credentials -&gt; Maybe ByteString
</span><a href="Aws.Core.html#iamToken"><span class="hs-identifier hs-var hs-var">iamToken</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-266"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225599"><span id="local-6989586621679225602"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679225598"><span class="annot"><span class="annottext">show :: Credentials -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span id="local-6989586621679225596"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225596"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Credentials{accessKeyID=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#accessKeyID"><span class="hs-identifier hs-var hs-var">accessKeyID</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225596"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,secretAccessKey=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#secretAccessKey"><span class="hs-identifier hs-var hs-var">secretAccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225596"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,iamToken=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Maybe ByteString
</span><a href="Aws.Core.html#iamToken"><span class="hs-identifier hs-var hs-var">iamToken</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225596"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621679225908"><span class="annot"><a href="Aws.Core.html#makeCredentials"><span class="hs-identifier hs-type">makeCredentials</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225908"><span class="hs-identifier hs-type">io</span></a></span><span>
</span><span id="line-270"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ AWS Access Key ID</span><span>
</span><span id="line-271"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ AWS Secret Access Key</span><span>
</span><span id="line-272"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225908"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span></span><span>
</span><span id="line-273"></span><span id="makeCredentials"><span class="annot"><span class="annottext">makeCredentials :: ByteString -&gt; ByteString -&gt; io Credentials
</span><a href="Aws.Core.html#makeCredentials"><span class="hs-identifier hs-var hs-var">makeCredentials</span></a></span></span><span> </span><span id="local-6989586621679225595"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225595"><span class="hs-identifier hs-var">accessKeyID</span></a></span></span><span> </span><span id="local-6989586621679225594"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225594"><span class="hs-identifier hs-var">secretAccessKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Credentials -&gt; io Credentials
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Credentials -&gt; io Credentials)
-&gt; IO Credentials -&gt; io Credentials
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679225593"><span class="annot"><span class="annottext">IORef [V4Key]
</span><a href="#local-6989586621679225593"><span class="hs-identifier hs-var">v4SigningKeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[V4Key] -&gt; IO (IORef [V4Key])
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225591"><span class="annot"><span class="annottext">iamToken :: Maybe a
</span><a href="#local-6989586621679225591"><span class="hs-identifier hs-var hs-var">iamToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">Credentials -&gt; IO Credentials
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Credentials :: ByteString
-&gt; ByteString -&gt; IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials
</span><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
ByteString
IORef [V4Key]
forall a. Maybe a
iamToken :: forall a. Maybe a
v4SigningKeys :: IORef [V4Key]
secretAccessKey :: ByteString
accessKeyID :: ByteString
iamToken :: Maybe ByteString
v4SigningKeys :: IORef [V4Key]
secretAccessKey :: ByteString
accessKeyID :: ByteString
</span><a href="#local-6989586621679225591"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | The file where access credentials are loaded, when using 'loadCredentialsDefault'.</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- May return 'Nothing' if @HOME@ is unset.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- Value: /&lt;user directory&gt;/@/.aws-keys@</span><span>
</span><span id="line-282"></span><span id="local-6989586621679225882"><span class="annot"><a href="Aws.Core.html#credentialsDefaultFile"><span class="hs-identifier hs-type">credentialsDefaultFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225882"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225882"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-283"></span><span id="credentialsDefaultFile"><span class="annot"><span class="annottext">credentialsDefaultFile :: io (Maybe String)
</span><a href="Aws.Core.html#credentialsDefaultFile"><span class="hs-identifier hs-var hs-var">credentialsDefaultFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe String) -&gt; io (Maybe String)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe String) -&gt; io (Maybe String))
-&gt; IO (Maybe String) -&gt; io (Maybe String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; IO (Maybe String)
forall a. IO a -&gt; IO (Maybe a)
</span><a href="Aws.Core.html#tryMaybe"><span class="hs-identifier hs-var">tryMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.aws-keys&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; IO String -&gt; IO String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getHomeDirectory</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span id="local-6989586621679225927"><span class="annot"><a href="Aws.Core.html#tryMaybe"><span class="hs-identifier hs-type">tryMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225927"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679225927"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-286"></span><span id="tryMaybe"><span class="annot"><span class="annottext">tryMaybe :: IO a -&gt; IO (Maybe a)
</span><a href="Aws.Core.html#tryMaybe"><span class="hs-identifier hs-var hs-var">tryMaybe</span></a></span></span><span> </span><span id="local-6989586621679225586"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679225586"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe a) -&gt; (SomeException -&gt; IO (Maybe a)) -&gt; IO (Maybe a)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">E.catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; IO a -&gt; IO (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679225586"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO (Maybe a)
forall a. SomeException -&gt; IO (Maybe a)
</span><a href="#local-6989586621679225584"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679225920"><span class="annot"><a href="#local-6989586621679225584"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">E.SomeException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679225920"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679225584"><span class="annot"><span class="annottext">f :: SomeException -&gt; IO (Maybe a)
</span><a href="#local-6989586621679225584"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-- | The key to be used in the access credential file that is loaded, when using 'loadCredentialsDefault'.</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- Value: @default@</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Aws.Core.html#credentialsDefaultKey"><span class="hs-identifier hs-type">credentialsDefaultKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-295"></span><span id="credentialsDefaultKey"><span class="annot"><span class="annottext">credentialsDefaultKey :: Text
</span><a href="Aws.Core.html#credentialsDefaultKey"><span class="hs-identifier hs-var hs-var">credentialsDefaultKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;default&quot;</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Load credentials from a (text) file given a key name.</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- The file consists of a sequence of lines, each in the following format:</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- @keyName awsKeyID awsKeySecret@</span><span>
</span><span id="line-302"></span><span id="local-6989586621679225885"><span class="annot"><a href="Aws.Core.html#loadCredentialsFromFile"><span class="hs-identifier hs-type">loadCredentialsFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225885"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225885"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-303"></span><span id="loadCredentialsFromFile"><span class="annot"><span class="annottext">loadCredentialsFromFile :: String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromFile"><span class="hs-identifier hs-var hs-var">loadCredentialsFromFile</span></a></span></span><span> </span><span id="local-6989586621679225583"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225583"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679225582"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225582"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Credentials) -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Credentials) -&gt; io (Maybe Credentials))
-&gt; IO (Maybe Credentials) -&gt; io (Maybe Credentials)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621679225581"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679225581"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225583"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679225581"><span class="hs-identifier hs-var">exists</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621679225579"><span class="annot"><span class="annottext">[[Text]]
</span><a href="#local-6989586621679225579"><span class="hs-identifier hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text]) -&gt; [Text] -&gt; [[Text]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.words</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; [[Text]]) -&gt; (Text -&gt; [Text]) -&gt; Text -&gt; [[Text]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.lines</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [[Text]]) -&gt; IO Text -&gt; IO [[Text]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Text
</span><span class="hs-identifier hs-var">T.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225583"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><span class="annottext">Maybe (IO Credentials) -&gt; IO (Maybe Credentials)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">Traversable.sequence</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (IO Credentials) -&gt; IO (Maybe Credentials))
-&gt; Maybe (IO Credentials) -&gt; IO (Maybe Credentials)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679225574"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225574"><span class="hs-identifier hs-var">_key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225573"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225573"><span class="hs-identifier hs-var">keyID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225572"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225572"><span class="hs-identifier hs-var">secret</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Bool) -&gt; [[Text]] -&gt; Maybe [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679225570"><span class="hs-identifier hs-var">hasKey</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225582"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Text]]
</span><a href="#local-6989586621679225579"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">IO Credentials -&gt; Maybe (IO Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO Credentials
forall (io :: * -&gt; *).
MonadIO io =&gt;
ByteString -&gt; ByteString -&gt; io Credentials
</span><a href="Aws.Core.html#makeCredentials"><span class="hs-identifier hs-var">makeCredentials</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225573"><span class="hs-identifier hs-var">keyID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225572"><span class="hs-identifier hs-var">secret</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; IO (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621679225570"><span class="annot"><span class="annottext">hasKey :: a -&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679225570"><span class="hs-identifier hs-var hs-var">hasKey</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="#local-6989586621679225570"><span class="hs-identifier hs-var">hasKey</span></a></span><span> </span><span id="local-6989586621679225568"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225568"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225567"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225567"><span class="hs-identifier hs-var">k2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225568"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225567"><span class="hs-identifier hs-var">k2</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- | Load credentials from the environment variables @AWS_ACCESS_KEY_ID@ and @AWS_ACCESS_KEY_SECRET@</span><span>
</span><span id="line-317"></span><span class="hs-comment">--   (or @AWS_SECRET_ACCESS_KEY@), if possible.</span><span>
</span><span id="line-318"></span><span id="local-6989586621679225886"><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier hs-type">loadCredentialsFromEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225886"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225886"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-319"></span><span id="loadCredentialsFromEnv"><span class="annot"><span class="annottext">loadCredentialsFromEnv :: io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier hs-var hs-var">loadCredentialsFromEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Credentials) -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Credentials) -&gt; io (Maybe Credentials))
-&gt; IO (Maybe Credentials) -&gt; io (Maybe Credentials)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679225566"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679225566"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(String, String)]
</span><span class="hs-identifier hs-var">getEnvironment</span></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225564"><span class="annot"><span class="annottext">lk :: String -&gt; Maybe ByteString
</span><a href="#local-6989586621679225564"><span class="hs-identifier hs-var hs-var">lk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; Maybe String -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (String -&gt; Text) -&gt; String -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Maybe ByteString)
-&gt; (String -&gt; Maybe String) -&gt; String -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [(String, String)] -&gt; Maybe String)
-&gt; [(String, String)] -&gt; String -&gt; Maybe String
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679225566"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621679225560"><span class="annot"><span class="annottext">keyID :: Maybe ByteString
</span><a href="#local-6989586621679225560"><span class="hs-identifier hs-var hs-var">keyID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ByteString
</span><a href="#local-6989586621679225564"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AWS_ACCESS_KEY_ID&quot;</span></span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679225559"><span class="annot"><span class="annottext">secret :: Maybe ByteString
</span><a href="#local-6989586621679225559"><span class="hs-identifier hs-var hs-var">secret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ByteString
</span><a href="#local-6989586621679225564"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AWS_ACCESS_KEY_SECRET&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Maybe ByteString -&gt; Maybe ByteString
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ByteString
</span><a href="#local-6989586621679225564"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AWS_SECRET_ACCESS_KEY&quot;</span></span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621679225557"><span class="annot"><span class="annottext">setSession :: Credentials -&gt; Credentials
</span><a href="#local-6989586621679225557"><span class="hs-identifier hs-var hs-var">setSession</span></a></span></span><span> </span><span id="local-6989586621679225556"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225556"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225556"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iamToken :: Maybe ByteString
</span><a href="Aws.Core.html#iamToken"><span class="hs-identifier hs-var">iamToken</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ByteString
</span><a href="#local-6989586621679225564"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AWS_SESSION_TOKEN&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-325"></span><span>      </span><span id="local-6989586621679225555"><span class="annot"><span class="annottext">makeCredentials' :: ByteString -&gt; ByteString -&gt; IO Credentials
</span><a href="#local-6989586621679225555"><span class="hs-identifier hs-var hs-var">makeCredentials'</span></a></span></span><span> </span><span id="local-6989586621679225554"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225554"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679225553"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225553"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; Credentials
</span><a href="#local-6989586621679225557"><span class="hs-identifier hs-var">setSession</span></a></span><span> </span><span class="annot"><span class="annottext">(Credentials -&gt; Credentials) -&gt; IO Credentials -&gt; IO Credentials
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO Credentials
forall (io :: * -&gt; *).
MonadIO io =&gt;
ByteString -&gt; ByteString -&gt; io Credentials
</span><a href="Aws.Core.html#makeCredentials"><span class="hs-identifier hs-var">makeCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225554"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225553"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="annottext">Maybe (IO Credentials) -&gt; IO (Maybe Credentials)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">Traversable.sequence</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (IO Credentials) -&gt; IO (Maybe Credentials))
-&gt; Maybe (IO Credentials) -&gt; IO (Maybe Credentials)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; IO Credentials
</span><a href="#local-6989586621679225555"><span class="hs-identifier hs-var">makeCredentials'</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString -&gt; IO Credentials)
-&gt; Maybe ByteString -&gt; Maybe (ByteString -&gt; IO Credentials)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225560"><span class="hs-identifier hs-var">keyID</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ByteString -&gt; IO Credentials)
-&gt; Maybe ByteString -&gt; Maybe (IO Credentials)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225559"><span class="hs-identifier hs-var">secret</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span id="local-6989586621679225552"><span class="annot"><a href="Aws.Core.html#loadCredentialsFromInstanceMetadata"><span class="hs-identifier hs-type">loadCredentialsFromInstanceMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225552"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225552"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-329"></span><span id="loadCredentialsFromInstanceMetadata"><span class="annot"><span class="annottext">loadCredentialsFromInstanceMetadata :: io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromInstanceMetadata"><span class="hs-identifier hs-var hs-var">loadCredentialsFromInstanceMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679225551"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679225551"><span class="hs-identifier hs-var">mgr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Manager -&gt; io Manager
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO Manager
</span><span class="hs-identifier hs-var">HTTP.getGlobalManager</span></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-comment">-- check if the path is routable</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679225549"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679225549"><span class="hs-identifier hs-var">avail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; io Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; io Bool) -&gt; IO Bool -&gt; io Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><a href="Aws.Network.html#hostAvailable"><span class="hs-identifier hs-var">hostAvailable</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;169.254.169.254&quot;</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679225549"><span class="hs-identifier hs-var">avail</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621679225546"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225546"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString) -&gt; io (Maybe ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe ByteString) -&gt; io (Maybe ByteString))
-&gt; IO (Maybe ByteString) -&gt; io (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (HttpException -&gt; IO (Maybe ByteString))
-&gt; IO (Maybe ByteString)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">E.catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; String -&gt; String -&gt; IO ByteString
</span><a href="Aws.Ec2.InstanceMetadata.html#getInstanceMetadata"><span class="hs-identifier hs-var">getInstanceMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679225551"><span class="hs-identifier hs-var">mgr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;latest/meta-data/iam&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;info&quot;</span></span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; IO (Maybe ByteString)) -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; IO (Maybe ByteString))
-&gt; (ByteString -&gt; Maybe ByteString)
-&gt; ByteString
-&gt; IO (Maybe ByteString)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.HttpException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225544"><span class="annot"><span class="annottext">infodict :: Maybe (Map String String)
</span><a href="#local-6989586621679225544"><span class="hs-identifier hs-var hs-var">infodict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225546"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
-&gt; (ByteString -&gt; Maybe (Map String String))
-&gt; Maybe (Map String String)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Map String String)
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">A.decode</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>            </span><span id="local-6989586621679225542"><span class="annot"><span class="annottext">info' :: Maybe String
</span><a href="#local-6989586621679225542"><span class="hs-identifier hs-var hs-var">info'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map String String)
</span><a href="#local-6989586621679225544"><span class="hs-identifier hs-var">infodict</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Map String String)
-&gt; (Map String String -&gt; Maybe String) -&gt; Maybe String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InstanceProfileArn&quot;</span></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225542"><span class="hs-identifier hs-var">info'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225540"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225540"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>            </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225539"><span class="annot"><span class="annottext">name' :: String
</span><a href="#local-6989586621679225539"><span class="hs-identifier hs-var hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225540"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span id="local-6989586621679225535"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225535"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString) -&gt; io (Maybe ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe ByteString) -&gt; io (Maybe ByteString))
-&gt; IO (Maybe ByteString) -&gt; io (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (HttpException -&gt; IO (Maybe ByteString))
-&gt; IO (Maybe ByteString)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">E.catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; String -&gt; String -&gt; IO ByteString
</span><a href="Aws.Ec2.InstanceMetadata.html#getInstanceMetadata"><span class="hs-identifier hs-var">getInstanceMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679225551"><span class="hs-identifier hs-var">mgr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;latest/meta-data/iam/security-credentials&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225539"><span class="hs-identifier hs-var">name'</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; IO (Maybe ByteString)) -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; IO (Maybe ByteString))
-&gt; (ByteString -&gt; Maybe ByteString)
-&gt; ByteString
-&gt; IO (Maybe ByteString)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.HttpException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-comment">-- this token lasts ~6 hours</span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225534"><span class="annot"><span class="annottext">dict :: Maybe (Map String String)
</span><a href="#local-6989586621679225534"><span class="hs-identifier hs-var hs-var">dict</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225535"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
-&gt; (ByteString -&gt; Maybe (Map String String))
-&gt; Maybe (Map String String)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Map String String)
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">A.decode</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                  </span><span id="local-6989586621679225533"><span class="annot"><span class="annottext">keyID :: Maybe String
</span><a href="#local-6989586621679225533"><span class="hs-identifier hs-var hs-var">keyID</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map String String)
</span><a href="#local-6989586621679225534"><span class="hs-identifier hs-var">dict</span></a></span><span>  </span><span class="annot"><span class="annottext">Maybe (Map String String)
-&gt; (Map String String -&gt; Maybe String) -&gt; Maybe String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AccessKeyId&quot;</span></span><span>
</span><span id="line-347"></span><span>                  </span><span id="local-6989586621679225532"><span class="annot"><span class="annottext">secret :: Maybe String
</span><a href="#local-6989586621679225532"><span class="hs-identifier hs-var hs-var">secret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map String String)
</span><a href="#local-6989586621679225534"><span class="hs-identifier hs-var">dict</span></a></span><span>  </span><span class="annot"><span class="annottext">Maybe (Map String String)
-&gt; (Map String String -&gt; Maybe String) -&gt; Maybe String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SecretAccessKey&quot;</span></span><span>
</span><span id="line-348"></span><span>                  </span><span id="local-6989586621679225531"><span class="annot"><span class="annottext">token :: Maybe String
</span><a href="#local-6989586621679225531"><span class="hs-identifier hs-var hs-var">token</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map String String)
</span><a href="#local-6989586621679225534"><span class="hs-identifier hs-var">dict</span></a></span><span>  </span><span class="annot"><span class="annottext">Maybe (Map String String)
-&gt; (Map String String -&gt; Maybe String) -&gt; Maybe String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Map String String -&gt; Maybe String
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Token&quot;</span></span><span>
</span><span id="line-349"></span><span>              </span><span id="local-6989586621679225530"><span class="annot"><span class="annottext">IORef [V4Key]
</span><a href="#local-6989586621679225530"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (IORef [V4Key]) -&gt; io (IORef [V4Key])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (IORef [V4Key]) -&gt; io (IORef [V4Key]))
-&gt; IO (IORef [V4Key]) -&gt; io (IORef [V4Key])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V4Key] -&gt; IO (IORef [V4Key])
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>              </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
-&gt; ByteString -&gt; IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials
</span><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; ByteString -&gt; IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials)
-&gt; Maybe ByteString
-&gt; Maybe
     (ByteString -&gt; IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (String -&gt; Text) -&gt; String -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; Maybe String -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225533"><span class="hs-identifier hs-var">keyID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe
  (ByteString -&gt; IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials)
-&gt; Maybe ByteString
-&gt; Maybe (IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (String -&gt; Text) -&gt; String -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; Maybe String -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225532"><span class="hs-identifier hs-var">secret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe (IORef [V4Key] -&gt; Maybe ByteString -&gt; Credentials)
-&gt; Maybe (IORef [V4Key]) -&gt; Maybe (Maybe ByteString -&gt; Credentials)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">IORef [V4Key] -&gt; Maybe (IORef [V4Key])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IORef [V4Key]
</span><a href="#local-6989586621679225530"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-353"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe (Maybe ByteString -&gt; Credentials)
-&gt; Maybe (Maybe ByteString) -&gt; Maybe Credentials
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; (String -&gt; ByteString) -&gt; String -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (String -&gt; Text) -&gt; String -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe ByteString)
-&gt; Maybe String -&gt; Maybe (Maybe ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225531"><span class="hs-identifier hs-var">token</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>          </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Load credentials from environment variables if possible, or alternatively from a file with a given key name.</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- See 'loadCredentialsFromEnv' and 'loadCredentialsFromFile' for details.</span><span>
</span><span id="line-359"></span><span id="local-6989586621679225529"><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnvOrFile"><span class="hs-identifier hs-type">loadCredentialsFromEnvOrFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225529"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225529"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-360"></span><span id="loadCredentialsFromEnvOrFile"><span class="annot"><span class="annottext">loadCredentialsFromEnvOrFile :: String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnvOrFile"><span class="hs-identifier hs-var hs-var">loadCredentialsFromEnvOrFile</span></a></span></span><span> </span><span id="local-6989586621679225528"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225528"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679225527"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225527"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679225526"><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225526"><span class="hs-identifier hs-var">envcr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">io (Maybe Credentials)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier hs-var">loadCredentialsFromEnv</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225526"><span class="hs-identifier hs-var">envcr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225525"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225525"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Maybe Credentials
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225525"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">Maybe Credentials
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; io (Maybe Credentials)
forall (io :: * -&gt; *).
MonadIO io =&gt;
String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromFile"><span class="hs-identifier hs-var">loadCredentialsFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225528"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225527"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Load credentials from environment variables if possible, or alternatively from the instance metadata store, or alternatively from a file with a given key name.</span><span>
</span><span id="line-368"></span><span class="hs-comment">--</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- See 'loadCredentialsFromEnv', 'loadCredentialsFromFile' and 'loadCredentialsFromInstanceMetadata' for details.</span><span>
</span><span id="line-370"></span><span id="local-6989586621679225524"><span class="annot"><a href="Aws.Core.html#loadCredentialsFromEnvOrFileOrInstanceMetadata"><span class="hs-identifier hs-type">loadCredentialsFromEnvOrFileOrInstanceMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225524"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225524"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-371"></span><span id="loadCredentialsFromEnvOrFileOrInstanceMetadata"><span class="annot"><span class="annottext">loadCredentialsFromEnvOrFileOrInstanceMetadata :: String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnvOrFileOrInstanceMetadata"><span class="hs-identifier hs-var hs-var">loadCredentialsFromEnvOrFileOrInstanceMetadata</span></a></span></span><span> </span><span id="local-6989586621679225523"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225523"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679225522"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225522"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679225521"><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225521"><span class="hs-identifier hs-var">envcr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">io (Maybe Credentials)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier hs-var">loadCredentialsFromEnv</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225521"><span class="hs-identifier hs-var">envcr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225520"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225520"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Maybe Credentials
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225520"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><span class="annottext">Maybe Credentials
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>          </span><span id="local-6989586621679225519"><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225519"><span class="hs-identifier hs-var">filecr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; io (Maybe Credentials)
forall (io :: * -&gt; *).
MonadIO io =&gt;
String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromFile"><span class="hs-identifier hs-var">loadCredentialsFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225523"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225522"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-379"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials
</span><a href="#local-6989586621679225519"><span class="hs-identifier hs-var">filecr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225518"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225518"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Credentials -&gt; io (Maybe Credentials)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Maybe Credentials
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225518"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>            </span><span class="annot"><span class="annottext">Maybe Credentials
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">io (Maybe Credentials)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromInstanceMetadata"><span class="hs-identifier hs-var">loadCredentialsFromInstanceMetadata</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Load credentials from environment variables if possible, or alternative from the default file with the default</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- key name.</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- Default file: /&lt;user directory&gt;/@/.aws-keys@</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- Default key name: @default@</span><span>
</span><span id="line-388"></span><span class="hs-comment">--</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- See 'loadCredentialsFromEnv' and 'loadCredentialsFromFile' for details.</span><span>
</span><span id="line-390"></span><span id="local-6989586621679225517"><span class="annot"><a href="Aws.Core.html#loadCredentialsDefault"><span class="hs-identifier hs-type">loadCredentialsDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679225517"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225517"><span class="hs-identifier hs-type">io</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-391"></span><span id="loadCredentialsDefault"><span class="annot"><span class="annottext">loadCredentialsDefault :: io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsDefault"><span class="hs-identifier hs-var hs-var">loadCredentialsDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679225516"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225516"><span class="hs-identifier hs-var">mfile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">io (Maybe String)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe String)
</span><a href="Aws.Core.html#credentialsDefaultFile"><span class="hs-identifier hs-var">credentialsDefaultFile</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679225516"><span class="hs-identifier hs-var">mfile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225515"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225515"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text -&gt; io (Maybe Credentials)
forall (io :: * -&gt; *).
MonadIO io =&gt;
String -&gt; Text -&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnvOrFileOrInstanceMetadata"><span class="hs-identifier hs-var">loadCredentialsFromEnvOrFileOrInstanceMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225515"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Aws.Core.html#credentialsDefaultKey"><span class="hs-identifier hs-var">credentialsDefaultKey</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">io (Maybe Credentials)
forall (io :: * -&gt; *). MonadIO io =&gt; io (Maybe Credentials)
</span><a href="Aws.Core.html#loadCredentialsFromEnv"><span class="hs-identifier hs-var">loadCredentialsFromEnv</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Protocols supported by AWS. Currently, all AWS services use the HTTP or HTTPS protocols.</span><span>
</span><span id="line-398"></span><span class="hs-keyword">data</span><span> </span><span id="Protocol"><span class="annot"><a href="Aws.Core.html#Protocol"><span class="hs-identifier hs-var">Protocol</span></a></span></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="HTTP"><span class="annot"><a href="Aws.Core.html#HTTP"><span class="hs-identifier hs-var">HTTP</span></a></span></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HTTPS"><span class="annot"><a href="Aws.Core.html#HTTPS"><span class="hs-identifier hs-var">HTTPS</span></a></span></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225509"><span id="local-6989586621679225511"><span class="annot"><span class="annottext">Protocol -&gt; Protocol -&gt; Bool
(Protocol -&gt; Protocol -&gt; Bool)
-&gt; (Protocol -&gt; Protocol -&gt; Bool) -&gt; Eq Protocol
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Protocol -&gt; Protocol -&gt; Bool
$c/= :: Protocol -&gt; Protocol -&gt; Bool
== :: Protocol -&gt; Protocol -&gt; Bool
$c== :: Protocol -&gt; Protocol -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679225500"><span id="local-6989586621679225502"><span id="local-6989586621679225504"><span id="local-6989586621679225506"><span class="annot"><span class="annottext">ReadPrec [Protocol]
ReadPrec Protocol
Int -&gt; ReadS Protocol
ReadS [Protocol]
(Int -&gt; ReadS Protocol)
-&gt; ReadS [Protocol]
-&gt; ReadPrec Protocol
-&gt; ReadPrec [Protocol]
-&gt; Read Protocol
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Protocol]
$creadListPrec :: ReadPrec [Protocol]
readPrec :: ReadPrec Protocol
$creadPrec :: ReadPrec Protocol
readList :: ReadS [Protocol]
$creadList :: ReadS [Protocol]
readsPrec :: Int -&gt; ReadS Protocol
$creadsPrec :: Int -&gt; ReadS Protocol
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679225493"><span id="local-6989586621679225495"><span id="local-6989586621679225497"><span class="annot"><span class="annottext">Int -&gt; Protocol -&gt; ShowS
[Protocol] -&gt; ShowS
Protocol -&gt; String
(Int -&gt; Protocol -&gt; ShowS)
-&gt; (Protocol -&gt; String) -&gt; ([Protocol] -&gt; ShowS) -&gt; Show Protocol
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Protocol] -&gt; ShowS
$cshowList :: [Protocol] -&gt; ShowS
show :: Protocol -&gt; String
$cshow :: Protocol -&gt; String
showsPrec :: Int -&gt; Protocol -&gt; ShowS
$cshowsPrec :: Int -&gt; Protocol -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679225478"><span id="local-6989586621679225480"><span id="local-6989586621679225482"><span id="local-6989586621679225484"><span id="local-6989586621679225486"><span id="local-6989586621679225488"><span id="local-6989586621679225490"><span class="annot"><span class="annottext">Eq Protocol
Eq Protocol
-&gt; (Protocol -&gt; Protocol -&gt; Ordering)
-&gt; (Protocol -&gt; Protocol -&gt; Bool)
-&gt; (Protocol -&gt; Protocol -&gt; Bool)
-&gt; (Protocol -&gt; Protocol -&gt; Bool)
-&gt; (Protocol -&gt; Protocol -&gt; Bool)
-&gt; (Protocol -&gt; Protocol -&gt; Protocol)
-&gt; (Protocol -&gt; Protocol -&gt; Protocol)
-&gt; Ord Protocol
Protocol -&gt; Protocol -&gt; Bool
Protocol -&gt; Protocol -&gt; Ordering
Protocol -&gt; Protocol -&gt; Protocol
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Protocol -&gt; Protocol -&gt; Protocol
$cmin :: Protocol -&gt; Protocol -&gt; Protocol
max :: Protocol -&gt; Protocol -&gt; Protocol
$cmax :: Protocol -&gt; Protocol -&gt; Protocol
&gt;= :: Protocol -&gt; Protocol -&gt; Bool
$c&gt;= :: Protocol -&gt; Protocol -&gt; Bool
&gt; :: Protocol -&gt; Protocol -&gt; Bool
$c&gt; :: Protocol -&gt; Protocol -&gt; Bool
&lt;= :: Protocol -&gt; Protocol -&gt; Bool
$c&lt;= :: Protocol -&gt; Protocol -&gt; Bool
&lt; :: Protocol -&gt; Protocol -&gt; Bool
$c&lt; :: Protocol -&gt; Protocol -&gt; Bool
compare :: Protocol -&gt; Protocol -&gt; Ordering
$ccompare :: Protocol -&gt; Protocol -&gt; Ordering
$cp1Ord :: Eq Protocol
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | The default port to be used for a protocol if no specific port is specified.</span><span>
</span><span id="line-404"></span><span class="annot"><a href="Aws.Core.html#defaultPort"><span class="hs-identifier hs-type">defaultPort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#Protocol"><span class="hs-identifier hs-type">Protocol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-405"></span><span id="defaultPort"><span class="annot"><span class="annottext">defaultPort :: Protocol -&gt; Int
</span><a href="Aws.Core.html#defaultPort"><span class="hs-identifier hs-var hs-var">defaultPort</span></a></span></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTP"><span class="hs-identifier hs-var">HTTP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Aws.Core.html#defaultPort"><span class="hs-identifier hs-var">defaultPort</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTPS"><span class="hs-identifier hs-var">HTTPS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">443</span></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | Request method. Not all request methods are supported by all services.</span><span>
</span><span id="line-409"></span><span class="hs-keyword">data</span><span> </span><span id="Method"><span class="annot"><a href="Aws.Core.html#Method"><span class="hs-identifier hs-var">Method</span></a></span></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Head"><span class="annot"><a href="Aws.Core.html#Head"><span class="hs-identifier hs-var">Head</span></a></span></span><span>      </span><span class="hs-comment">-- ^ HEAD method. Put all request parameters in a query string and HTTP headers.</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Get"><span class="annot"><a href="Aws.Core.html#Get"><span class="hs-identifier hs-var">Get</span></a></span></span><span>       </span><span class="hs-comment">-- ^ GET method. Put all request parameters in a query string and HTTP headers.</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PostQuery"><span class="annot"><a href="Aws.Core.html#PostQuery"><span class="hs-identifier hs-var">PostQuery</span></a></span></span><span> </span><span class="hs-comment">-- ^ POST method. Put all request parameters in a query string and HTTP headers, but send the query string</span><span>
</span><span id="line-413"></span><span>                </span><span class="hs-comment">--   as a POST payload</span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Post"><span class="annot"><a href="Aws.Core.html#Post"><span class="hs-identifier hs-var">Post</span></a></span></span><span>      </span><span class="hs-comment">-- ^ POST method. Sends a service- and request-specific request body.</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Put"><span class="annot"><a href="Aws.Core.html#Put"><span class="hs-identifier hs-var">Put</span></a></span></span><span>       </span><span class="hs-comment">-- ^ PUT method.</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Delete"><span class="annot"><a href="Aws.Core.html#Delete"><span class="hs-identifier hs-var">Delete</span></a></span></span><span>    </span><span class="hs-comment">-- ^ DELETE method.</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225465"><span id="local-6989586621679225467"><span id="local-6989586621679225469"><span class="annot"><span class="annottext">Int -&gt; Method -&gt; ShowS
[Method] -&gt; ShowS
Method -&gt; String
(Int -&gt; Method -&gt; ShowS)
-&gt; (Method -&gt; String) -&gt; ([Method] -&gt; ShowS) -&gt; Show Method
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Method] -&gt; ShowS
$cshowList :: [Method] -&gt; ShowS
show :: Method -&gt; String
$cshow :: Method -&gt; String
showsPrec :: Int -&gt; Method -&gt; ShowS
$cshowsPrec :: Int -&gt; Method -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225461"><span id="local-6989586621679225463"><span class="annot"><span class="annottext">Method -&gt; Method -&gt; Bool
(Method -&gt; Method -&gt; Bool)
-&gt; (Method -&gt; Method -&gt; Bool) -&gt; Eq Method
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Method -&gt; Method -&gt; Bool
$c/= :: Method -&gt; Method -&gt; Bool
== :: Method -&gt; Method -&gt; Bool
$c== :: Method -&gt; Method -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679225446"><span id="local-6989586621679225448"><span id="local-6989586621679225450"><span id="local-6989586621679225452"><span id="local-6989586621679225454"><span id="local-6989586621679225456"><span id="local-6989586621679225458"><span class="annot"><span class="annottext">Eq Method
Eq Method
-&gt; (Method -&gt; Method -&gt; Ordering)
-&gt; (Method -&gt; Method -&gt; Bool)
-&gt; (Method -&gt; Method -&gt; Bool)
-&gt; (Method -&gt; Method -&gt; Bool)
-&gt; (Method -&gt; Method -&gt; Bool)
-&gt; (Method -&gt; Method -&gt; Method)
-&gt; (Method -&gt; Method -&gt; Method)
-&gt; Ord Method
Method -&gt; Method -&gt; Bool
Method -&gt; Method -&gt; Ordering
Method -&gt; Method -&gt; Method
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Method -&gt; Method -&gt; Method
$cmin :: Method -&gt; Method -&gt; Method
max :: Method -&gt; Method -&gt; Method
$cmax :: Method -&gt; Method -&gt; Method
&gt;= :: Method -&gt; Method -&gt; Bool
$c&gt;= :: Method -&gt; Method -&gt; Bool
&gt; :: Method -&gt; Method -&gt; Bool
$c&gt; :: Method -&gt; Method -&gt; Bool
&lt;= :: Method -&gt; Method -&gt; Bool
$c&lt;= :: Method -&gt; Method -&gt; Bool
&lt; :: Method -&gt; Method -&gt; Bool
$c&lt; :: Method -&gt; Method -&gt; Bool
compare :: Method -&gt; Method -&gt; Ordering
$ccompare :: Method -&gt; Method -&gt; Ordering
$cp1Ord :: Eq Method
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- | HTTP method associated with a request method.</span><span>
</span><span id="line-420"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-type">httpMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Method</span></span><span>
</span><span id="line-421"></span><span id="httpMethod"><span class="annot"><span class="annottext">httpMethod :: Method -&gt; ByteString
</span><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var hs-var">httpMethod</span></a></span></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#Head"><span class="hs-identifier hs-var">Head</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HEAD&quot;</span></span><span>
</span><span id="line-422"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#Get"><span class="hs-identifier hs-var">Get</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#PostQuery"><span class="hs-identifier hs-var">PostQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#Post"><span class="hs-identifier hs-var">Post</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#Put"><span class="hs-identifier hs-var">Put</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PUT&quot;</span></span><span>
</span><span id="line-426"></span><span class="annot"><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#Delete"><span class="hs-identifier hs-var">Delete</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | A pre-signed medium-level request object.</span><span>
</span><span id="line-429"></span><span class="hs-keyword">data</span><span> </span><span id="SignedQuery"><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-var">SignedQuery</span></a></span></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SignedQuery"><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-var">SignedQuery</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-431"></span><span>        </span><span class="hs-comment">-- | Request method.</span><span>
</span><span id="line-432"></span><span>        </span><span id="sqMethod"><span class="annot"><span class="annottext">SignedQuery -&gt; Method
</span><a href="Aws.Core.html#sqMethod"><span class="hs-identifier hs-var hs-var">sqMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Aws.Core.html#Method"><span class="hs-identifier hs-type">Method</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-comment">-- | Protocol to be used.</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqProtocol"><span class="annot"><span class="annottext">SignedQuery -&gt; Protocol
</span><a href="Aws.Core.html#sqProtocol"><span class="hs-identifier hs-var hs-var">sqProtocol</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Aws.Core.html#Protocol"><span class="hs-identifier hs-type">Protocol</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-comment">-- | HTTP host.</span><span>
</span><span id="line-436"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqHost"><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#sqHost"><span class="hs-identifier hs-var hs-var">sqHost</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-437"></span><span>        </span><span class="hs-comment">-- | IP port.</span><span>
</span><span id="line-438"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqPort"><span class="annot"><span class="annottext">SignedQuery -&gt; Int
</span><a href="Aws.Core.html#sqPort"><span class="hs-identifier hs-var hs-var">sqPort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-439"></span><span>        </span><span class="hs-comment">-- | HTTP path.</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqPath"><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#sqPath"><span class="hs-identifier hs-var hs-var">sqPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-441"></span><span>        </span><span class="hs-comment">-- | Query string list (used with 'Get' and 'PostQuery').</span><span>
</span><span id="line-442"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqQuery"><span class="annot"><span class="annottext">SignedQuery -&gt; Query
</span><a href="Aws.Core.html#sqQuery"><span class="hs-identifier hs-var hs-var">sqQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Query</span></span><span>
</span><span id="line-443"></span><span>        </span><span class="hs-comment">-- | Request date/time.</span><span>
</span><span id="line-444"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqDate"><span class="annot"><span class="annottext">SignedQuery -&gt; Maybe UTCTime
</span><a href="Aws.Core.html#sqDate"><span class="hs-identifier hs-var hs-var">sqDate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-comment">-- | Authorization string (if applicable), for @Authorization@ header.  See 'authorizationV4'</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqAuthorization"><span class="annot"><span class="annottext">SignedQuery -&gt; Maybe (IO ByteString)
</span><a href="Aws.Core.html#sqAuthorization"><span class="hs-identifier hs-var hs-var">sqAuthorization</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-comment">-- | Request body content type.</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqContentType"><span class="annot"><span class="annottext">SignedQuery -&gt; Maybe ByteString
</span><a href="Aws.Core.html#sqContentType"><span class="hs-identifier hs-var hs-var">sqContentType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-comment">-- | Request body content MD5.</span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqContentMd5"><span class="annot"><span class="annottext">SignedQuery -&gt; Maybe (Digest MD5)
</span><a href="Aws.Core.html#sqContentMd5"><span class="hs-identifier hs-var hs-var">sqContentMd5</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CH.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.MD5</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-comment">-- | Additional Amazon &quot;amz&quot; headers.</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqAmzHeaders"><span class="annot"><span class="annottext">SignedQuery -&gt; RequestHeaders
</span><a href="Aws.Core.html#sqAmzHeaders"><span class="hs-identifier hs-var hs-var">sqAmzHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.RequestHeaders</span></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-comment">-- | Additional non-&quot;amz&quot; headers.</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqOtherHeaders"><span class="annot"><span class="annottext">SignedQuery -&gt; RequestHeaders
</span><a href="Aws.Core.html#sqOtherHeaders"><span class="hs-identifier hs-var hs-var">sqOtherHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.RequestHeaders</span></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-comment">-- | Request body (used with 'Post' and 'Put').</span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqBody"><span class="annot"><span class="annottext">SignedQuery -&gt; Maybe RequestBody
</span><a href="Aws.Core.html#sqBody"><span class="hs-identifier hs-var hs-var">sqBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.RequestBody</span></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-comment">-- | String to sign. Note that the string is already signed, this is passed mostly for debugging purposes.</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="sqStringToSign"><span class="annot"><span class="annottext">SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#sqStringToSign"><span class="hs-identifier hs-var hs-var">sqStringToSign</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-comment">--deriving (Show)</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | Create a HTTP request from a 'SignedQuery' object.</span><span>
</span><span id="line-463"></span><span class="annot"><a href="Aws.Core.html#queryToHttpRequest"><span class="hs-identifier hs-type">queryToHttpRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-type">SignedQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Request</span></span><span>
</span><span id="line-464"></span><span id="queryToHttpRequest"><span class="annot"><span class="annottext">queryToHttpRequest :: SignedQuery -&gt; IO Request
</span><a href="Aws.Core.html#queryToHttpRequest"><span class="hs-identifier hs-var hs-var">queryToHttpRequest</span></a></span></span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-type">SignedQuery</span></a></span><span class="hs-special">{</span><span id="local-6989586621679225416"><span id="local-6989586621679225417"><span id="local-6989586621679225418"><span id="local-6989586621679225419"><span id="local-6989586621679225420"><span id="local-6989586621679225421"><span id="local-6989586621679225422"><span id="local-6989586621679225423"><span id="local-6989586621679225424"><span id="local-6989586621679225425"><span id="local-6989586621679225426"><span id="local-6989586621679225427"><span id="local-6989586621679225428"><span id="local-6989586621679225429"><span class="annot"><span class="annottext">Int
Query
RequestHeaders
Maybe (IO ByteString)
Maybe ByteString
Maybe UTCTime
Maybe (Digest MD5)
Maybe RequestBody
ByteString
Method
Protocol
sqStringToSign :: ByteString
sqBody :: Maybe RequestBody
sqOtherHeaders :: RequestHeaders
sqAmzHeaders :: RequestHeaders
sqContentMd5 :: Maybe (Digest MD5)
sqContentType :: Maybe ByteString
sqAuthorization :: Maybe (IO ByteString)
sqDate :: Maybe UTCTime
sqQuery :: Query
sqPath :: ByteString
sqPort :: Int
sqHost :: ByteString
sqProtocol :: Protocol
sqMethod :: Method
sqStringToSign :: SignedQuery -&gt; ByteString
sqBody :: SignedQuery -&gt; Maybe RequestBody
sqOtherHeaders :: SignedQuery -&gt; RequestHeaders
sqAmzHeaders :: SignedQuery -&gt; RequestHeaders
sqContentMd5 :: SignedQuery -&gt; Maybe (Digest MD5)
sqContentType :: SignedQuery -&gt; Maybe ByteString
sqAuthorization :: SignedQuery -&gt; Maybe (IO ByteString)
sqDate :: SignedQuery -&gt; Maybe UTCTime
sqQuery :: SignedQuery -&gt; Query
sqPath :: SignedQuery -&gt; ByteString
sqPort :: SignedQuery -&gt; Int
sqHost :: SignedQuery -&gt; ByteString
sqProtocol :: SignedQuery -&gt; Protocol
sqMethod :: SignedQuery -&gt; Method
</span><a href="#local-6989586621679225416"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679225415"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225415"><span class="hs-identifier hs-var">mauth</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe ByteString)
-&gt; (IO ByteString -&gt; IO (Maybe ByteString))
-&gt; Maybe (IO ByteString)
-&gt; IO (Maybe ByteString)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ByteString -&gt; IO (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; IO ByteString -&gt; IO (Maybe ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (IO ByteString)
</span><a href="#local-6989586621679225422"><span class="hs-identifier hs-var">sqAuthorization</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Request -&gt; IO Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">HTTP.defaultRequest</span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-467"></span><span>        </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">HTTP.method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Method -&gt; ByteString
</span><a href="Aws.Core.html#httpMethod"><span class="hs-identifier hs-var">httpMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679225429"><span class="hs-identifier hs-var">sqMethod</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Bool
</span><span class="hs-identifier hs-var">HTTP.secure</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679225428"><span class="hs-identifier hs-var">sqProtocol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>                        </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTP"><span class="hs-identifier hs-var">HTTP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-470"></span><span>                        </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTPS"><span class="hs-identifier hs-var">HTTPS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">host :: ByteString
</span><span class="hs-identifier hs-var">HTTP.host</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225427"><span class="hs-identifier hs-var">sqHost</span></a></span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">port :: Int
</span><span class="hs-identifier hs-var">HTTP.port</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225426"><span class="hs-identifier hs-var">sqPort</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">HTTP.path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225425"><span class="hs-identifier hs-var">sqPath</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">queryString :: ByteString
</span><span class="hs-identifier hs-var">HTTP.queryString</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-475"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679225429"><span class="hs-identifier hs-var">sqMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Method -&gt; Method -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#PostQuery"><span class="hs-identifier hs-var">PostQuery</span></a></span><span>
</span><span id="line-476"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-477"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Query -&gt; ByteString
</span><span class="hs-identifier hs-var">HTTP.renderQuery</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679225424"><span class="hs-identifier hs-var">sqQuery</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><span class="hs-identifier hs-var">HTTP.requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (HeaderName, ByteString)] -&gt; RequestHeaders
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; (HeaderName, ByteString))
-&gt; Maybe UTCTime -&gt; Maybe (HeaderName, ByteString)
</span><a href="#local-6989586621679225403"><span class="hs-identifier hs-var">checkDate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679225402"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225402"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Date&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtRfc822Time"><span class="hs-identifier hs-var">fmtRfc822Time</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225402"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679225423"><span class="hs-identifier hs-var">sqDate</span></a></span><span>
</span><span id="line-480"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (HeaderName, ByteString))
-&gt; Maybe ByteString -&gt; Maybe (HeaderName, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679225401"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225401"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225401"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225400"><span class="hs-identifier hs-var">contentType</span></a></span><span>
</span><span id="line-481"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Digest MD5 -&gt; (HeaderName, ByteString))
-&gt; Maybe (Digest MD5) -&gt; Maybe (HeaderName, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679225399"><span class="annot"><span class="annottext">Digest MD5
</span><a href="#local-6989586621679225399"><span class="hs-identifier hs-var">md5</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-MD5&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base64.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Digest MD5 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="annot"><span class="annottext">Digest MD5
</span><a href="#local-6989586621679225399"><span class="hs-identifier hs-var">md5</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Digest MD5)
</span><a href="#local-6989586621679225420"><span class="hs-identifier hs-var">sqContentMd5</span></a></span><span>
</span><span id="line-482"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (HeaderName, ByteString))
-&gt; Maybe ByteString -&gt; Maybe (HeaderName, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679225396"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225396"><span class="hs-identifier hs-var">auth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Authorization&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225396"><span class="hs-identifier hs-var">auth</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225415"><span class="hs-identifier hs-var">mauth</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>                              </span><span class="annot"><span class="annottext">RequestHeaders -&gt; RequestHeaders -&gt; RequestHeaders
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679225419"><span class="hs-identifier hs-var">sqAmzHeaders</span></a></span><span>
</span><span id="line-484"></span><span>                              </span><span class="annot"><span class="annottext">RequestHeaders -&gt; RequestHeaders -&gt; RequestHeaders
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679225418"><span class="hs-identifier hs-var">sqOtherHeaders</span></a></span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">requestBody :: RequestBody
</span><span class="hs-identifier hs-var">HTTP.requestBody</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>        </span><span class="hs-comment">-- An explicityly defined body parameter should overwrite everything else.</span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe RequestBody
</span><a href="#local-6989586621679225417"><span class="hs-identifier hs-var">sqBody</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-489"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679225394"><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679225394"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679225394"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-490"></span><span>          </span><span class="annot"><span class="annottext">Maybe RequestBody
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-comment">-- a POST query should convert its query string into the body</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679225429"><span class="hs-identifier hs-var">sqMethod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-493"></span><span>              </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#PostQuery"><span class="hs-identifier hs-var">PostQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">HTTP.RequestBodyLBS</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RequestBody)
-&gt; (Builder -&gt; ByteString) -&gt; Builder -&gt; RequestBody
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">Blaze.toLazyByteString</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; RequestBody) -&gt; Builder -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-494"></span><span>                           </span><span class="annot"><span class="annottext">Bool -&gt; Query -&gt; Builder
</span><span class="hs-identifier hs-var">HTTP.renderQueryBuilder</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679225424"><span class="hs-identifier hs-var">sqQuery</span></a></span><span>
</span><span id="line-495"></span><span>              </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Builder -&gt; RequestBody
</span><span class="hs-identifier hs-var">HTTP.RequestBodyBuilder</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decompress :: ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">HTTP.decompress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">HTTP.alwaysDecompress</span></span><span class="hs-cpp">
#if MIN_VERSION_http_conduit(2,2,0)
</span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">checkResponse :: Request -&gt; Response (IO ByteString) -&gt; IO ()
</span><span class="hs-identifier hs-var">HTTP.checkResponse</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Response (IO ByteString)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">HTTP.checkStatus</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-504"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">redirectCount :: Int
</span><span class="hs-identifier hs-var">HTTP.redirectCount</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-506"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>      </span><span id="local-6989586621679225403"><span class="annot"><span class="annottext">checkDate :: (UTCTime -&gt; (HeaderName, ByteString))
-&gt; Maybe UTCTime -&gt; Maybe (HeaderName, ByteString)
</span><a href="#local-6989586621679225403"><span class="hs-identifier hs-var hs-var">checkDate</span></a></span></span><span> </span><span id="local-6989586621679225385"><span class="annot"><span class="annottext">UTCTime -&gt; (HeaderName, ByteString)
</span><a href="#local-6989586621679225385"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679225384"><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679225384"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderName, ByteString)
-&gt; (ByteString -&gt; Maybe (HeaderName, ByteString))
-&gt; Maybe ByteString
-&gt; Maybe (HeaderName, ByteString)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; (HeaderName, ByteString)
</span><a href="#local-6989586621679225385"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; (HeaderName, ByteString))
-&gt; Maybe UTCTime -&gt; Maybe (HeaderName, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679225384"><span class="hs-identifier hs-var">mb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (HeaderName, ByteString)
-&gt; ByteString -&gt; Maybe (HeaderName, ByteString)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderName, ByteString)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Maybe (HeaderName, ByteString))
-&gt; Maybe ByteString -&gt; Maybe (HeaderName, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; RequestHeaders -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;date&quot;</span></span><span> </span><span class="annot"><span class="annottext">RequestHeaders
</span><a href="#local-6989586621679225418"><span class="hs-identifier hs-var">sqOtherHeaders</span></a></span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-comment">-- An explicitly defined content-type should override everything else.</span><span>
</span><span id="line-509"></span><span>      </span><span id="local-6989586621679225400"><span class="annot"><span class="annottext">contentType :: Maybe ByteString
</span><a href="#local-6989586621679225400"><span class="hs-identifier hs-var hs-var">contentType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225421"><span class="hs-identifier hs-var">sqContentType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Maybe ByteString -&gt; Maybe ByteString
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225382"><span class="hs-identifier hs-var">defContentType</span></a></span><span>
</span><span id="line-510"></span><span>      </span><span id="local-6989586621679225382"><span class="annot"><span class="annottext">defContentType :: Maybe ByteString
</span><a href="#local-6989586621679225382"><span class="hs-identifier hs-var hs-var">defContentType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Method
</span><a href="#local-6989586621679225429"><span class="hs-identifier hs-var">sqMethod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-511"></span><span>                         </span><span class="annot"><span class="annottext">Method
</span><a href="Aws.Core.html#PostQuery"><span class="hs-identifier hs-var">PostQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-www-form-urlencoded; charset=utf-8&quot;</span></span><span>
</span><span id="line-512"></span><span>                         </span><span class="annot"><span class="annottext">Method
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- | Create a URI fro a 'SignedQuery' object.</span><span>
</span><span id="line-515"></span><span class="hs-comment">--</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- Unused / incompatible fields will be silently ignored.</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Aws.Core.html#queryToUri"><span class="hs-identifier hs-type">queryToUri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-type">SignedQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-518"></span><span id="queryToUri"><span class="annot"><span class="annottext">queryToUri :: SignedQuery -&gt; ByteString
</span><a href="Aws.Core.html#queryToUri"><span class="hs-identifier hs-var hs-var">queryToUri</span></a></span></span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-type">SignedQuery</span></a></span><span class="hs-special">{</span><span id="local-6989586621679225368"><span id="local-6989586621679225369"><span id="local-6989586621679225370"><span id="local-6989586621679225371"><span id="local-6989586621679225372"><span id="local-6989586621679225373"><span id="local-6989586621679225374"><span id="local-6989586621679225375"><span id="local-6989586621679225376"><span id="local-6989586621679225377"><span id="local-6989586621679225378"><span id="local-6989586621679225379"><span id="local-6989586621679225380"><span id="local-6989586621679225381"><span class="annot"><span class="annottext">Int
Query
RequestHeaders
Maybe (IO ByteString)
Maybe ByteString
Maybe UTCTime
Maybe (Digest MD5)
Maybe RequestBody
ByteString
Method
Protocol
sqStringToSign :: ByteString
sqBody :: Maybe RequestBody
sqOtherHeaders :: RequestHeaders
sqAmzHeaders :: RequestHeaders
sqContentMd5 :: Maybe (Digest MD5)
sqContentType :: Maybe ByteString
sqAuthorization :: Maybe (IO ByteString)
sqDate :: Maybe UTCTime
sqQuery :: Query
sqPath :: ByteString
sqPort :: Int
sqHost :: ByteString
sqProtocol :: Protocol
sqMethod :: Method
sqStringToSign :: SignedQuery -&gt; ByteString
sqBody :: SignedQuery -&gt; Maybe RequestBody
sqOtherHeaders :: SignedQuery -&gt; RequestHeaders
sqAmzHeaders :: SignedQuery -&gt; RequestHeaders
sqContentMd5 :: SignedQuery -&gt; Maybe (Digest MD5)
sqContentType :: SignedQuery -&gt; Maybe ByteString
sqAuthorization :: SignedQuery -&gt; Maybe (IO ByteString)
sqDate :: SignedQuery -&gt; Maybe UTCTime
sqQuery :: SignedQuery -&gt; Query
sqPath :: SignedQuery -&gt; ByteString
sqPort :: SignedQuery -&gt; Int
sqHost :: SignedQuery -&gt; ByteString
sqProtocol :: SignedQuery -&gt; Protocol
sqMethod :: SignedQuery -&gt; Method
</span><a href="#local-6989586621679225368"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-520"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679225380"><span class="hs-identifier hs-var">sqProtocol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-521"></span><span>         </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTP"><span class="hs-identifier hs-var">HTTP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;http://&quot;</span></span><span>
</span><span id="line-522"></span><span>         </span><span class="annot"><span class="annottext">Protocol
</span><a href="Aws.Core.html#HTTPS"><span class="hs-identifier hs-var">HTTPS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;https://&quot;</span></span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225379"><span class="hs-identifier hs-var">sqHost</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225378"><span class="hs-identifier hs-var">sqPort</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Protocol -&gt; Int
</span><a href="Aws.Core.html#defaultPort"><span class="hs-identifier hs-var">defaultPort</span></a></span><span> </span><span class="annot"><span class="annottext">Protocol
</span><a href="#local-6989586621679225380"><span class="hs-identifier hs-var">sqProtocol</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">T.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (String -&gt; Text) -&gt; String -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225378"><span class="hs-identifier hs-var">sqPort</span></a></span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225377"><span class="hs-identifier hs-var">sqPath</span></a></span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Query -&gt; ByteString
</span><span class="hs-identifier hs-var">HTTP.renderQuery</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679225376"><span class="hs-identifier hs-var">sqQuery</span></a></span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-comment">-- | Whether to restrict the signature validity with a plain timestamp, or with explicit expiration</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- (absolute or relative).</span><span>
</span><span id="line-531"></span><span class="hs-keyword">data</span><span> </span><span id="TimeInfo"><span class="annot"><a href="Aws.Core.html#TimeInfo"><span class="hs-identifier hs-var">TimeInfo</span></a></span></span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Timestamp"><span class="annot"><a href="Aws.Core.html#Timestamp"><span class="hs-identifier hs-var">Timestamp</span></a></span></span><span>                                      </span><span class="hs-comment">-- ^ Use a simple timestamp to let AWS check the request validity.</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ExpiresAt"><span class="annot"><a href="Aws.Core.html#ExpiresAt"><span class="hs-identifier hs-var">ExpiresAt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromExpiresAt"><span class="annot"><span class="annottext">TimeInfo -&gt; UTCTime
</span><a href="Aws.Core.html#fromExpiresAt"><span class="hs-identifier hs-var hs-var">fromExpiresAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-special">}</span><span>         </span><span class="hs-comment">-- ^ Let requests expire at a specific fixed time.</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ExpiresIn"><span class="annot"><a href="Aws.Core.html#ExpiresIn"><span class="hs-identifier hs-var">ExpiresIn</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromExpiresIn"><span class="annot"><span class="annottext">TimeInfo -&gt; NominalDiffTime
</span><a href="Aws.Core.html#fromExpiresIn"><span class="hs-identifier hs-var hs-var">fromExpiresIn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- ^ Let requests expire a specific number of seconds after they</span><span>
</span><span id="line-535"></span><span>                                                     </span><span class="hs-comment">-- were generated.</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225356"><span id="local-6989586621679225358"><span id="local-6989586621679225360"><span class="annot"><span class="annottext">Int -&gt; TimeInfo -&gt; ShowS
[TimeInfo] -&gt; ShowS
TimeInfo -&gt; String
(Int -&gt; TimeInfo -&gt; ShowS)
-&gt; (TimeInfo -&gt; String) -&gt; ([TimeInfo] -&gt; ShowS) -&gt; Show TimeInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TimeInfo] -&gt; ShowS
$cshowList :: [TimeInfo] -&gt; ShowS
show :: TimeInfo -&gt; String
$cshow :: TimeInfo -&gt; String
showsPrec :: Int -&gt; TimeInfo -&gt; ShowS
$cshowsPrec :: Int -&gt; TimeInfo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">-- | Like 'TimeInfo', but with all relative times replaced by absolute UTC.</span><span>
</span><span id="line-539"></span><span class="hs-keyword">data</span><span> </span><span id="AbsoluteTimeInfo"><span class="annot"><a href="Aws.Core.html#AbsoluteTimeInfo"><span class="hs-identifier hs-var">AbsoluteTimeInfo</span></a></span></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="AbsoluteTimestamp"><span class="annot"><a href="Aws.Core.html#AbsoluteTimestamp"><span class="hs-identifier hs-var">AbsoluteTimestamp</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromAbsoluteTimestamp"><span class="annot"><span class="annottext">AbsoluteTimeInfo -&gt; UTCTime
</span><a href="Aws.Core.html#fromAbsoluteTimestamp"><span class="hs-identifier hs-var hs-var">fromAbsoluteTimestamp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AbsoluteExpires"><span class="annot"><a href="Aws.Core.html#AbsoluteExpires"><span class="hs-identifier hs-var">AbsoluteExpires</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="fromAbsoluteExpires"><span class="annot"><span class="annottext">AbsoluteTimeInfo -&gt; UTCTime
</span><a href="Aws.Core.html#fromAbsoluteExpires"><span class="hs-identifier hs-var hs-var">fromAbsoluteExpires</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225346"><span id="local-6989586621679225348"><span id="local-6989586621679225350"><span class="annot"><span class="annottext">Int -&gt; AbsoluteTimeInfo -&gt; ShowS
[AbsoluteTimeInfo] -&gt; ShowS
AbsoluteTimeInfo -&gt; String
(Int -&gt; AbsoluteTimeInfo -&gt; ShowS)
-&gt; (AbsoluteTimeInfo -&gt; String)
-&gt; ([AbsoluteTimeInfo] -&gt; ShowS)
-&gt; Show AbsoluteTimeInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AbsoluteTimeInfo] -&gt; ShowS
$cshowList :: [AbsoluteTimeInfo] -&gt; ShowS
show :: AbsoluteTimeInfo -&gt; String
$cshow :: AbsoluteTimeInfo -&gt; String
showsPrec :: Int -&gt; AbsoluteTimeInfo -&gt; ShowS
$cshowsPrec :: Int -&gt; AbsoluteTimeInfo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-comment">-- | Just the UTC time value.</span><span>
</span><span id="line-545"></span><span class="annot"><a href="Aws.Core.html#fromAbsoluteTimeInfo"><span class="hs-identifier hs-type">fromAbsoluteTimeInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#AbsoluteTimeInfo"><span class="hs-identifier hs-type">AbsoluteTimeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-546"></span><span id="fromAbsoluteTimeInfo"><span class="annot"><span class="annottext">fromAbsoluteTimeInfo :: AbsoluteTimeInfo -&gt; UTCTime
</span><a href="Aws.Core.html#fromAbsoluteTimeInfo"><span class="hs-identifier hs-var hs-var">fromAbsoluteTimeInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#AbsoluteTimestamp"><span class="hs-identifier hs-type">AbsoluteTimestamp</span></a></span><span> </span><span id="local-6989586621679225345"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225345"><span class="hs-identifier hs-var">time</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225345"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-547"></span><span class="annot"><a href="Aws.Core.html#fromAbsoluteTimeInfo"><span class="hs-identifier hs-var">fromAbsoluteTimeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#AbsoluteExpires"><span class="hs-identifier hs-type">AbsoluteExpires</span></a></span><span> </span><span id="local-6989586621679225344"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225344"><span class="hs-identifier hs-var">time</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225344"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- | Convert 'TimeInfo' to 'AbsoluteTimeInfo' given the current UTC time.</span><span>
</span><span id="line-550"></span><span class="annot"><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier hs-type">makeAbsoluteTimeInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#TimeInfo"><span class="hs-identifier hs-type">TimeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AbsoluteTimeInfo"><span class="hs-identifier hs-type">AbsoluteTimeInfo</span></a></span><span>
</span><span id="line-551"></span><span id="makeAbsoluteTimeInfo"><span class="annot"><span class="annottext">makeAbsoluteTimeInfo :: TimeInfo -&gt; UTCTime -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier hs-var hs-var">makeAbsoluteTimeInfo</span></a></span></span><span> </span><span class="annot"><span class="annottext">TimeInfo
</span><a href="Aws.Core.html#Timestamp"><span class="hs-identifier hs-var">Timestamp</span></a></span><span>     </span><span id="local-6989586621679225343"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225343"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#AbsoluteTimestamp"><span class="hs-identifier hs-var">AbsoluteTimestamp</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225343"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier hs-var">makeAbsoluteTimeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ExpiresAt"><span class="hs-identifier hs-type">ExpiresAt</span></a></span><span> </span><span id="local-6989586621679225342"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225342"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#AbsoluteExpires"><span class="hs-identifier hs-var">AbsoluteExpires</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225342"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier hs-var">makeAbsoluteTimeInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Aws.Core.html#ExpiresIn"><span class="hs-identifier hs-type">ExpiresIn</span></a></span><span> </span><span id="local-6989586621679225341"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679225341"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679225340"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225340"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#AbsoluteExpires"><span class="hs-identifier hs-var">AbsoluteExpires</span></a></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; AbsoluteTimeInfo) -&gt; UTCTime -&gt; AbsoluteTimeInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679225341"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225340"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- | Data that is always required for signing requests.</span><span>
</span><span id="line-556"></span><span class="hs-keyword">data</span><span> </span><span id="SignatureData"><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-var">SignatureData</span></a></span></span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SignatureData"><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-var">SignatureData</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-558"></span><span>        </span><span class="hs-comment">-- | Expiration or timestamp.</span><span>
</span><span id="line-559"></span><span>        </span><span id="signatureTimeInfo"><span class="annot"><span class="annottext">SignatureData -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#signatureTimeInfo"><span class="hs-identifier hs-var hs-var">signatureTimeInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#AbsoluteTimeInfo"><span class="hs-identifier hs-type">AbsoluteTimeInfo</span></a></span><span>
</span><span id="line-560"></span><span>        </span><span class="hs-comment">-- | Current time.</span><span>
</span><span id="line-561"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="signatureTime"><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-comment">-- | Access credentials.</span><span>
</span><span id="line-563"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="signatureCredentials"><span class="annot"><span class="annottext">SignatureData -&gt; Credentials
</span><a href="Aws.Core.html#signatureCredentials"><span class="hs-identifier hs-var hs-var">signatureCredentials</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">-- | Create signature data using the current system time.</span><span>
</span><span id="line-567"></span><span class="annot"><a href="Aws.Core.html#signatureData"><span class="hs-identifier hs-type">signatureData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#TimeInfo"><span class="hs-identifier hs-type">TimeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-568"></span><span id="signatureData"><span class="annot"><span class="annottext">signatureData :: TimeInfo -&gt; Credentials -&gt; IO SignatureData
</span><a href="Aws.Core.html#signatureData"><span class="hs-identifier hs-var hs-var">signatureData</span></a></span></span><span> </span><span id="local-6989586621679225334"><span class="annot"><span class="annottext">TimeInfo
</span><a href="#local-6989586621679225334"><span class="hs-identifier hs-var">rti</span></a></span></span><span> </span><span id="local-6989586621679225333"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225333"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679225332"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225332"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225330"><span class="annot"><span class="annottext">ti :: AbsoluteTimeInfo
</span><a href="#local-6989586621679225330"><span class="hs-identifier hs-var hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeInfo -&gt; UTCTime -&gt; AbsoluteTimeInfo
</span><a href="Aws.Core.html#makeAbsoluteTimeInfo"><span class="hs-identifier hs-var">makeAbsoluteTimeInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TimeInfo
</span><a href="#local-6989586621679225334"><span class="hs-identifier hs-var">rti</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225332"><span class="hs-identifier hs-var">now</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><span class="annottext">SignatureData -&gt; IO SignatureData
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SignatureData :: AbsoluteTimeInfo -&gt; UTCTime -&gt; Credentials -&gt; SignatureData
</span><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">signatureTimeInfo :: AbsoluteTimeInfo
</span><a href="Aws.Core.html#signatureTimeInfo"><span class="hs-identifier hs-var">signatureTimeInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AbsoluteTimeInfo
</span><a href="#local-6989586621679225330"><span class="hs-identifier hs-var">ti</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signatureTime :: UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var">signatureTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225332"><span class="hs-identifier hs-var">now</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">signatureCredentials :: Credentials
</span><a href="Aws.Core.html#signatureCredentials"><span class="hs-identifier hs-var">signatureCredentials</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225333"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- | Tag type for normal queries.</span><span>
</span><span id="line-574"></span><span class="hs-keyword">data</span><span> </span><span id="NormalQuery"><span class="annot"><a href="Aws.Core.html#NormalQuery"><span class="hs-identifier hs-var">NormalQuery</span></a></span></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | Tag type for URI-only queries.</span><span>
</span><span id="line-576"></span><span class="hs-keyword">data</span><span> </span><span id="UriOnlyQuery"><span class="annot"><a href="Aws.Core.html#UriOnlyQuery"><span class="hs-identifier hs-var">UriOnlyQuery</span></a></span></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | A &quot;signable&quot; request object. Assembles together the Query, and signs it in one go.</span><span>
</span><span id="line-579"></span><span class="hs-keyword">class</span><span> </span><span id="SignQuery"><span class="annot"><a href="Aws.Core.html#SignQuery"><span class="hs-identifier hs-var">SignQuery</span></a></span></span><span> </span><span id="local-6989586621679225329"><span class="annot"><a href="#local-6989586621679225329"><span class="hs-identifier hs-type">request</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-comment">-- | Additional information, like API endpoints and service-specific preferences.</span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="ServiceConfiguration"><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-var">ServiceConfiguration</span></a></span></span><span> </span><span id="local-6989586621679225329"><span class="annot"><a href="#local-6989586621679225329"><span class="hs-identifier hs-type">request</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-comment">{- Query Type -}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-comment">-- | Create a 'SignedQuery' from a request, additional 'Info', and 'SignatureData'.</span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621679225327"><span id="signQuery"><span class="annot"><a href="Aws.Core.html#signQuery"><span class="hs-identifier hs-type">signQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225329"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#ServiceConfiguration"><span class="hs-identifier hs-type">ServiceConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225329"><span class="hs-identifier hs-type">request</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225327"><span class="hs-identifier hs-type">queryType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#SignedQuery"><span class="hs-identifier hs-type">SignedQuery</span></a></span></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- | Supported crypto hashes for the signature.</span><span>
</span><span id="line-587"></span><span class="hs-keyword">data</span><span> </span><span id="AuthorizationHash"><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-var">AuthorizationHash</span></a></span></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="HmacSHA1"><span class="annot"><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span></span><span>
</span><span id="line-589"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HmacSHA256"><span class="annot"><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span></span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225318"><span id="local-6989586621679225320"><span id="local-6989586621679225322"><span class="annot"><span class="annottext">Int -&gt; AuthorizationHash -&gt; ShowS
[AuthorizationHash] -&gt; ShowS
AuthorizationHash -&gt; String
(Int -&gt; AuthorizationHash -&gt; ShowS)
-&gt; (AuthorizationHash -&gt; String)
-&gt; ([AuthorizationHash] -&gt; ShowS)
-&gt; Show AuthorizationHash
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AuthorizationHash] -&gt; ShowS
$cshowList :: [AuthorizationHash] -&gt; ShowS
show :: AuthorizationHash -&gt; String
$cshow :: AuthorizationHash -&gt; String
showsPrec :: Int -&gt; AuthorizationHash -&gt; ShowS
$cshowsPrec :: Int -&gt; AuthorizationHash -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">-- | Authorization hash identifier as expected by Amazon.</span><span>
</span><span id="line-593"></span><span class="annot"><a href="Aws.Core.html#amzHash"><span class="hs-identifier hs-type">amzHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-594"></span><span id="amzHash"><span class="annot"><span class="annottext">amzHash :: AuthorizationHash -&gt; ByteString
</span><a href="Aws.Core.html#amzHash"><span class="hs-identifier hs-var hs-var">amzHash</span></a></span></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HmacSHA1&quot;</span></span><span>
</span><span id="line-595"></span><span class="annot"><a href="Aws.Core.html#amzHash"><span class="hs-identifier hs-var">amzHash</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HmacSHA256&quot;</span></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">-- | Create a signature. Usually, AWS wants a specifically constructed string to be signed.</span><span>
</span><span id="line-598"></span><span class="hs-comment">--</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- The signature is a HMAC-based hash of the string and the secret access key.</span><span>
</span><span id="line-600"></span><span class="annot"><a href="Aws.Core.html#signature"><span class="hs-keyword hs-type">signature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-601"></span><span id="signature"><span class="annot"><span class="annottext">signature :: Credentials -&gt; AuthorizationHash -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#signature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span id="local-6989586621679225317"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225317"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span id="local-6989586621679225316"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225316"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225315"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225315"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base64.encode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225314"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>      </span><span id="local-6989586621679225314"><span class="annot"><span class="annottext">sig :: ByteString
</span><a href="#local-6989586621679225314"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225316"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>              </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA1
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#secretAccessKey"><span class="hs-identifier hs-var hs-var">secretAccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225317"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225315"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>              </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA256
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#secretAccessKey"><span class="hs-identifier hs-var hs-var">secretAccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679225317"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225315"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- | Generates the Credential string, required for V4 signatures.</span><span>
</span><span id="line-609"></span><span class="annot"><a href="Aws.Core.html#credentialV4"><span class="hs-identifier hs-type">credentialV4</span></a></span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-614"></span><span id="credentialV4"><span class="annot"><span class="annottext">credentialV4 :: SignatureData -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#credentialV4"><span class="hs-identifier hs-var hs-var">credentialV4</span></a></span></span><span> </span><span id="local-6989586621679225312"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225312"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225311"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225311"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225310"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225310"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#accessKeyID"><span class="hs-identifier hs-var hs-var">accessKeyID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignatureData -&gt; Credentials
</span><a href="Aws.Core.html#signatureCredentials"><span class="hs-identifier hs-var hs-var">signatureCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225312"><span class="hs-identifier hs-var">sd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225309"><span class="hs-identifier hs-var">date</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225311"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225310"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/aws4_request&quot;</span></span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-625"></span><span>        </span><span id="local-6989586621679225309"><span class="annot"><span class="annottext">date :: ByteString
</span><a href="#local-6989586621679225309"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y%m%d&quot;</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225312"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- | Use this to create the Authorization header to set into 'sqAuthorization'.</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- See &lt;http://docs.aws.amazon.com/general/latest/gr/signature-version-4.html&gt;: you must create the</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- canonical request as explained by Step 1 and this function takes care of Steps 2 and 3.</span><span>
</span><span id="line-630"></span><span class="annot"><a href="Aws.Core.html#authorizationV4"><span class="hs-identifier hs-type">authorizationV4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-631"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-632"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-633"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-634"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ SignedHeaders, e.g. content-type;host;x-amz-date;x-amz-target</span><span>
</span><span id="line-635"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ canonicalRequest (before hashing)</span><span>
</span><span id="line-636"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-637"></span><span id="authorizationV4"><span class="annot"><span class="annottext">authorizationV4 :: SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; IO ByteString
</span><a href="Aws.Core.html#authorizationV4"><span class="hs-identifier hs-var hs-var">authorizationV4</span></a></span></span><span> </span><span id="local-6989586621679225308"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225307"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225307"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225306"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225305"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span id="local-6989586621679225304"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225304"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679225303"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225303"><span class="hs-identifier hs-var">canonicalRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225302"><span class="annot"><span class="annottext">ref :: IORef [V4Key]
</span><a href="#local-6989586621679225302"><span class="hs-identifier hs-var hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; IORef [V4Key]
</span><a href="Aws.Core.html#v4SigningKeys"><span class="hs-identifier hs-var hs-var">v4SigningKeys</span></a></span><span> </span><span class="annot"><span class="annottext">(Credentials -&gt; IORef [V4Key]) -&gt; Credentials -&gt; IORef [V4Key]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; Credentials
</span><a href="Aws.Core.html#signatureCredentials"><span class="hs-identifier hs-var hs-var">signatureCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679225301"><span class="annot"><span class="annottext">date :: ByteString
</span><a href="#local-6989586621679225301"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y%m%d&quot;</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>    </span><span class="hs-comment">-- Lookup existing signing key</span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679225300"><span class="annot"><span class="annottext">[V4Key]
</span><a href="#local-6989586621679225300"><span class="hs-identifier hs-var">allkeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef [V4Key] -&gt; IO [V4Key]
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef [V4Key]
</span><a href="#local-6989586621679225302"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225298"><span class="annot"><span class="annottext">mkey :: Maybe ByteString
</span><a href="#local-6989586621679225298"><span class="hs-identifier hs-var hs-var">mkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString)
-&gt; [V4Key] -&gt; Maybe (ByteString, ByteString)
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[V4Key]
</span><a href="#local-6989586621679225300"><span class="hs-identifier hs-var">allkeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225297"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225297"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679225296"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225296"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225297"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225301"><span class="hs-identifier hs-var">date</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-645"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225296"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-646"></span><span>            </span><span class="annot"><span class="annottext">Maybe (ByteString, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-comment">-- possibly create a new signing key</span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225295"><span class="annot"><span class="annottext">createNewKey :: IO ByteString
</span><a href="#local-6989586621679225295"><span class="hs-identifier hs-var hs-var">createNewKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef [V4Key]
-&gt; ([V4Key] -&gt; ([V4Key], ByteString)) -&gt; IO ByteString
forall a b. IORef a -&gt; (a -&gt; (a, b)) -&gt; IO b
</span><span class="hs-identifier hs-var">atomicModifyIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef [V4Key]
</span><a href="#local-6989586621679225302"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">(([V4Key] -&gt; ([V4Key], ByteString)) -&gt; IO ByteString)
-&gt; ([V4Key] -&gt; ([V4Key], ByteString)) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679225293"><span class="annot"><span class="annottext">[V4Key]
</span><a href="#local-6989586621679225293"><span class="hs-identifier hs-var">keylist</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-650"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225292"><span class="annot"><span class="annottext">kSigning :: ByteString
</span><a href="#local-6989586621679225292"><span class="hs-identifier hs-var hs-var">kSigning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#signingKeyV4"><span class="hs-identifier hs-var">signingKeyV4</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225307"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-651"></span><span>                </span><span id="local-6989586621679225290"><span class="annot"><span class="annottext">lstK :: (ByteString, ByteString)
</span><a href="#local-6989586621679225290"><span class="hs-identifier hs-var hs-var">lstK</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>                </span><span id="local-6989586621679225289"><span class="annot"><span class="annottext">keylist' :: [V4Key]
</span><a href="#local-6989586621679225289"><span class="hs-identifier hs-var hs-var">keylist'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString, ByteString)
</span><a href="#local-6989586621679225290"><span class="hs-identifier hs-var">lstK</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225301"><span class="hs-identifier hs-var">date</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225292"><span class="hs-identifier hs-var">kSigning</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V4Key -&gt; [V4Key] -&gt; [V4Key]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(V4Key -&gt; Bool) -&gt; [V4Key] -&gt; [V4Key]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString, ByteString)
</span><a href="#local-6989586621679225290"><span class="hs-identifier hs-var">lstK</span></a></span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; (ByteString, ByteString) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; Bool)
-&gt; (V4Key -&gt; (ByteString, ByteString)) -&gt; V4Key -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">V4Key -&gt; (ByteString, ByteString)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[V4Key]
</span><a href="#local-6989586621679225293"><span class="hs-identifier hs-var">keylist</span></a></span><span>
</span><span id="line-653"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[V4Key]
</span><a href="#local-6989586621679225289"><span class="hs-identifier hs-var">keylist'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225292"><span class="hs-identifier hs-var">kSigning</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-comment">-- finally, return the header</span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#constructAuthorizationV4Header"><span class="hs-identifier hs-var">constructAuthorizationV4Header</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225307"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225304"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-657"></span><span>         </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#signatureV4WithKey"><span class="hs-identifier hs-var">signatureV4WithKey</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225308"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225307"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225306"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225305"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225303"><span class="hs-identifier hs-var">canonicalRequest</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO ByteString
-&gt; (ByteString -&gt; IO ByteString)
-&gt; Maybe ByteString
-&gt; IO ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">IO ByteString
</span><a href="#local-6989586621679225295"><span class="hs-identifier hs-var">createNewKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679225298"><span class="hs-identifier hs-var">mkey</span></a></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- | IO free version of @authorizationV4@, use this if you need</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- to compute the signature outside of IO.</span><span>
</span><span id="line-662"></span><span class="annot"><a href="Aws.Core.html#authorizationV4%27"><span class="hs-identifier hs-type">authorizationV4'</span></a></span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ SignedHeaders, e.g. content-type;host;x-amz-date;x-amz-target</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ canonicalRequest (before hashing)</span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-670"></span><span id="authorizationV4%27"><span class="annot"><span class="annottext">authorizationV4' :: SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#authorizationV4%27"><span class="hs-identifier hs-var hs-var">authorizationV4'</span></a></span></span><span> </span><span id="local-6989586621679225286"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225286"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225285"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225285"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225284"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225284"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225283"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225283"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span id="local-6989586621679225282"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225282"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679225281"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225281"><span class="hs-identifier hs-var">canonicalRequest</span></a></span></span><span>
</span><span id="line-671"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#constructAuthorizationV4Header"><span class="hs-identifier hs-var">constructAuthorizationV4Header</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225286"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225285"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225284"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225283"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225282"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#signatureV4"><span class="hs-identifier hs-var">signatureV4</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225286"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225285"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225284"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225283"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225281"><span class="hs-identifier hs-var">canonicalRequest</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><a href="Aws.Core.html#constructAuthorizationV4Header"><span class="hs-identifier hs-type">constructAuthorizationV4Header</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-678"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-679"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ SignedHeaders, e.g. content-type;host;x-amz-date;x-amz-target</span><span>
</span><span id="line-680"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ signature</span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-682"></span><span id="constructAuthorizationV4Header"><span class="annot"><span class="annottext">constructAuthorizationV4Header :: SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#constructAuthorizationV4Header"><span class="hs-identifier hs-var hs-var">constructAuthorizationV4Header</span></a></span></span><span> </span><span id="local-6989586621679225280"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225280"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225279"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225279"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225278"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225278"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225277"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225277"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span id="local-6989586621679225276"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225276"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679225275"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225275"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225274"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; Credential=&quot;</span></span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#credentialV4"><span class="hs-identifier hs-var">credentialV4</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225280"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225278"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225277"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;,SignedHeaders=&quot;</span></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225276"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;,Signature=&quot;</span></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225275"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-692"></span><span>        </span><span id="local-6989586621679225274"><span class="annot"><span class="annottext">alg :: ByteString
</span><a href="#local-6989586621679225274"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225279"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-693"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;AWS4-HMAC-SHA1&quot;</span></span><span>
</span><span id="line-694"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;AWS4-HMAC-SHA256&quot;</span></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- | Compute the signature for V4</span><span>
</span><span id="line-697"></span><span class="annot"><a href="Aws.Core.html#signatureV4WithKey"><span class="hs-identifier hs-type">signatureV4WithKey</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ canonicalRequest (before hashing)</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ signing key</span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-705"></span><span id="signatureV4WithKey"><span class="annot"><span class="annottext">signatureV4WithKey :: SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#signatureV4WithKey"><span class="hs-identifier hs-var hs-var">signatureV4WithKey</span></a></span></span><span> </span><span id="local-6989586621679225273"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225273"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225272"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225272"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225271"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225271"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225270"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225270"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span id="local-6989586621679225269"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225269"><span class="hs-identifier hs-var">canonicalRequest</span></a></span></span><span> </span><span id="local-6989586621679225268"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225268"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base16.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225266"><span class="hs-identifier hs-var">mkHmac</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225268"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225265"><span class="hs-identifier hs-var">stringToSign</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>        </span><span id="local-6989586621679225264"><span class="annot"><span class="annottext">date :: ByteString
</span><a href="#local-6989586621679225264"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y%m%d&quot;</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225273"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-708"></span><span>        </span><span id="local-6989586621679225266"><span class="annot"><span class="annottext">mkHmac :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225266"><span class="hs-identifier hs-var hs-var">mkHmac</span></a></span></span><span> </span><span id="local-6989586621679225263"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225263"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679225262"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225262"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225272"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-709"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA1
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225263"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225262"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA256
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225263"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225262"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>        </span><span id="local-6989586621679225261"><span class="annot"><span class="annottext">mkHash :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679225261"><span class="hs-identifier hs-var hs-var">mkHash</span></a></span></span><span> </span><span id="local-6989586621679225260"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225260"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225272"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Digest SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">CH.hash</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Digest SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA256
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><span class="hs-identifier hs-var">CH.hash</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.Digest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>        </span><span id="local-6989586621679225258"><span class="annot"><span class="annottext">alg :: ByteString
</span><a href="#local-6989586621679225258"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225272"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-715"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;AWS4-HMAC-SHA1&quot;</span></span><span>
</span><span id="line-716"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;AWS4-HMAC-SHA256&quot;</span></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-comment">-- now do the signature</span><span>
</span><span id="line-719"></span><span>        </span><span id="local-6989586621679225257"><span class="annot"><span class="annottext">canonicalRequestHash :: ByteString
</span><a href="#local-6989586621679225257"><span class="hs-identifier hs-var hs-var">canonicalRequestHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base16.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679225261"><span class="hs-identifier hs-var">mkHash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225269"><span class="hs-identifier hs-var">canonicalRequest</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span id="local-6989586621679225265"><span class="annot"><span class="annottext">stringToSign :: ByteString
</span><a href="#local-6989586621679225265"><span class="hs-identifier hs-var hs-var">stringToSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span>
</span><span id="line-721"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225258"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-722"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-723"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y%m%dT%H%M%SZ&quot;</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225273"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-724"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-725"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225264"><span class="hs-identifier hs-var">date</span></a></span><span>
</span><span id="line-726"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-727"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225271"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-728"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-729"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225270"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-730"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;/aws4_request\n&quot;</span></span><span>
</span><span id="line-731"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225257"><span class="hs-identifier hs-var">canonicalRequestHash</span></a></span><span>
</span><span id="line-732"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="annot"><a href="Aws.Core.html#signingKeyV4"><span class="hs-identifier hs-type">signingKeyV4</span></a></span><span>
</span><span id="line-735"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-738"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-740"></span><span id="signingKeyV4"><span class="annot"><span class="annottext">signingKeyV4 :: SignatureData
-&gt; AuthorizationHash -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#signingKeyV4"><span class="hs-identifier hs-var hs-var">signingKeyV4</span></a></span></span><span> </span><span id="local-6989586621679225256"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225256"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225255"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225255"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225254"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225254"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225253"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225253"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225252"><span class="hs-identifier hs-var">kSigning</span></a></span><span>
</span><span id="line-741"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-742"></span><span>        </span><span id="local-6989586621679225251"><span class="annot"><span class="annottext">mkHmac :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225251"><span class="hs-identifier hs-var hs-var">mkHmac</span></a></span></span><span> </span><span id="local-6989586621679225250"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225250"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679225249"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225249"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225255"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-743"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA1"><span class="hs-identifier hs-var">HmacSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA1 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA1
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225250"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225249"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>            </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="Aws.Core.html#HmacSHA256"><span class="hs-identifier hs-var">HmacSHA256</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HMAC SHA256 -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">ByteArray.convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC SHA256
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">CMH.hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225250"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225249"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CMH.HMAC</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CH.SHA256</span></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>        </span><span id="local-6989586621679225248"><span class="annot"><span class="annottext">date :: ByteString
</span><a href="#local-6989586621679225248"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y%m%d&quot;</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; ByteString) -&gt; UTCTime -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; UTCTime
</span><a href="Aws.Core.html#signatureTime"><span class="hs-identifier hs-var hs-var">signatureTime</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225256"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-746"></span><span>        </span><span id="local-6989586621679225247"><span class="annot"><span class="annottext">secretKey :: ByteString
</span><a href="#local-6989586621679225247"><span class="hs-identifier hs-var hs-var">secretKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; ByteString
</span><a href="Aws.Core.html#secretAccessKey"><span class="hs-identifier hs-var hs-var">secretAccessKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Credentials -&gt; ByteString) -&gt; Credentials -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData -&gt; Credentials
</span><a href="Aws.Core.html#signatureCredentials"><span class="hs-identifier hs-var hs-var">signatureCredentials</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225256"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-747"></span><span>        </span><span id="local-6989586621679225246"><span class="annot"><span class="annottext">kDate :: ByteString
</span><a href="#local-6989586621679225246"><span class="hs-identifier hs-var hs-var">kDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225251"><span class="hs-identifier hs-var">mkHmac</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;AWS4&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225247"><span class="hs-identifier hs-var">secretKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225248"><span class="hs-identifier hs-var">date</span></a></span><span>
</span><span id="line-748"></span><span>        </span><span id="local-6989586621679225245"><span class="annot"><span class="annottext">kRegion :: ByteString
</span><a href="#local-6989586621679225245"><span class="hs-identifier hs-var hs-var">kRegion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225251"><span class="hs-identifier hs-var">mkHmac</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225246"><span class="hs-identifier hs-var">kDate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225254"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-749"></span><span>        </span><span id="local-6989586621679225244"><span class="annot"><span class="annottext">kService :: ByteString
</span><a href="#local-6989586621679225244"><span class="hs-identifier hs-var hs-var">kService</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225251"><span class="hs-identifier hs-var">mkHmac</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225245"><span class="hs-identifier hs-var">kRegion</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225253"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-750"></span><span>        </span><span id="local-6989586621679225252"><span class="annot"><span class="annottext">kSigning :: ByteString
</span><a href="#local-6989586621679225252"><span class="hs-identifier hs-var hs-var">kSigning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225251"><span class="hs-identifier hs-var">mkHmac</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225244"><span class="hs-identifier hs-var">kService</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;aws4_request&quot;</span></span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="annot"><a href="Aws.Core.html#signatureV4"><span class="hs-identifier hs-type">signatureV4</span></a></span><span>
</span><span id="line-753"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Aws.Core.html#SignatureData"><span class="hs-identifier hs-type">SignatureData</span></a></span><span>
</span><span id="line-754"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#AuthorizationHash"><span class="hs-identifier hs-type">AuthorizationHash</span></a></span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ region, e.g. us-east-1</span><span>
</span><span id="line-756"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ service, e.g. dynamodb</span><span>
</span><span id="line-757"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ^ canonicalRequest (before hashing)</span><span>
</span><span id="line-758"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-759"></span><span id="signatureV4"><span class="annot"><span class="annottext">signatureV4 :: SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#signatureV4"><span class="hs-identifier hs-var hs-var">signatureV4</span></a></span></span><span> </span><span id="local-6989586621679225243"><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225243"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span id="local-6989586621679225242"><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225242"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span id="local-6989586621679225241"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225241"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span id="local-6989586621679225240"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225240"><span class="hs-identifier hs-var">service</span></a></span></span><span> </span><span id="local-6989586621679225239"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225239"><span class="hs-identifier hs-var">canonicalRequest</span></a></span></span><span>
</span><span id="line-760"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
</span><a href="Aws.Core.html#signatureV4WithKey"><span class="hs-identifier hs-var">signatureV4WithKey</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225243"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225242"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225241"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225240"><span class="hs-identifier hs-var">service</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225239"><span class="hs-identifier hs-var">canonicalRequest</span></a></span><span>
</span><span id="line-761"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SignatureData
-&gt; AuthorizationHash -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Aws.Core.html#signingKeyV4"><span class="hs-identifier hs-var">signingKeyV4</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureData
</span><a href="#local-6989586621679225243"><span class="hs-identifier hs-var">sd</span></a></span><span> </span><span class="annot"><span class="annottext">AuthorizationHash
</span><a href="#local-6989586621679225242"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225241"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225240"><span class="hs-identifier hs-var">service</span></a></span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span class="hs-comment">-- | Default configuration for a specific service.</span><span>
</span><span id="line-764"></span><span class="hs-keyword">class</span><span> </span><span id="DefaultServiceConfiguration"><span class="annot"><a href="Aws.Core.html#DefaultServiceConfiguration"><span class="hs-identifier hs-var">DefaultServiceConfiguration</span></a></span></span><span> </span><span id="local-6989586621679225839"><span class="annot"><a href="#local-6989586621679225839"><span class="hs-identifier hs-type">config</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-765"></span><span>    </span><span class="hs-comment">-- | Default service configuration.</span><span>
</span><span id="line-766"></span><span>    </span><span id="defServiceConfig"><span class="annot"><a href="Aws.Core.html#defServiceConfig"><span class="hs-identifier hs-type">defServiceConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225839"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-comment">-- | Default debugging-only configuration. (Normally using HTTP instead of HTTPS for easier debugging.)</span><span>
</span><span id="line-769"></span><span>    </span><span id="debugServiceConfig"><span class="annot"><a href="Aws.Core.html#debugServiceConfig"><span class="hs-identifier hs-type">debugServiceConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679225839"><span class="hs-identifier hs-type">config</span></a></span><span>
</span><span id="line-770"></span><span>    </span><span id="local-6989586621679225236"><span class="annot"><a href="Aws.Core.html#debugServiceConfig"><span class="hs-identifier hs-var hs-var">debugServiceConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">config
forall config. DefaultServiceConfiguration config =&gt; config
</span><a href="Aws.Core.html#defServiceConfig"><span class="hs-identifier hs-var">defServiceConfig</span></a></span></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="hs-comment">-- | @queryList f prefix xs@ constructs a query list from a list of</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- elements @xs@, using a common prefix @prefix@, and a transformer</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- function @f@.</span><span>
</span><span id="line-775"></span><span class="hs-comment">--</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- A dot (@.@) is interspersed between prefix and generated key.</span><span>
</span><span id="line-777"></span><span class="hs-comment">--</span><span>
</span><span id="line-778"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-779"></span><span class="hs-comment">--</span><span>
</span><span id="line-780"></span><span class="hs-comment">-- @queryList swap \&quot;pfx\&quot; [(\&quot;a\&quot;, \&quot;b\&quot;), (\&quot;c\&quot;, \&quot;d\&quot;)]@ evaluates to @[(\&quot;pfx.b\&quot;, \&quot;a\&quot;), (\&quot;pfx.d\&quot;, \&quot;c\&quot;)]@</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- (except with ByteString instead of String, of course).</span><span>
</span><span id="line-782"></span><span id="local-6989586621679225235"><span class="annot"><a href="Aws.Core.html#queryList"><span class="hs-identifier hs-type">queryList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679225235"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225235"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-783"></span><span id="queryList"><span class="annot"><span class="annottext">queryList :: (a -&gt; [(ByteString, ByteString)])
-&gt; ByteString -&gt; [a] -&gt; [(ByteString, ByteString)]
</span><a href="Aws.Core.html#queryList"><span class="hs-identifier hs-var hs-var">queryList</span></a></span></span><span> </span><span id="local-6989586621679225234"><span class="annot"><span class="annottext">a -&gt; [(ByteString, ByteString)]
</span><a href="#local-6989586621679225234"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679225233"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225233"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679225232"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679225232"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(ByteString, ByteString)]] -&gt; [(ByteString, ByteString)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[(ByteString, ByteString)]] -&gt; [(ByteString, ByteString)])
-&gt; [[(ByteString, ByteString)]] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; [ByteString]
-&gt; [[(ByteString, ByteString)]]
-&gt; [[(ByteString, ByteString)]]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall d. ByteString -&gt; [(ByteString, d)] -&gt; [(ByteString, d)]
</span><a href="#local-6989586621679225229"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679225228"><span class="hs-identifier hs-var">prefixList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [(ByteString, ByteString)])
-&gt; [a] -&gt; [[(ByteString, ByteString)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [(ByteString, ByteString)]
</span><a href="#local-6989586621679225234"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679225232"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679225228"><span class="annot"><span class="annottext">prefixList :: [ByteString]
</span><a href="#local-6989586621679225228"><span class="hs-identifier hs-var hs-var">prefixList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ByteString) -&gt; [Int] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225227"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225233"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Int -&gt; ByteString) -&gt; Int -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BU.fromString</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; (Int -&gt; String) -&gt; Int -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-785"></span><span>          </span><span id="local-6989586621679225229"><span class="annot"><span class="annottext">combine :: ByteString -&gt; [(ByteString, d)] -&gt; [(ByteString, d)]
</span><a href="#local-6989586621679225229"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679225225"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225225"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ByteString, d) -&gt; (ByteString, d))
-&gt; [(ByteString, d)] -&gt; [(ByteString, d)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(((ByteString, d) -&gt; (ByteString, d))
 -&gt; [(ByteString, d)] -&gt; [(ByteString, d)])
-&gt; ((ByteString, d) -&gt; (ByteString, d))
-&gt; [(ByteString, d)]
-&gt; [(ByteString, d)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; (ByteString, d) -&gt; (ByteString, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225225"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225227"><span class="hs-operator hs-var">`dot`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>          </span><span id="local-6989586621679225227"><span class="annot"><span class="annottext">dot :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="#local-6989586621679225227"><span class="hs-identifier hs-var hs-var">dot</span></a></span></span><span> </span><span id="local-6989586621679225224"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225224"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679225223"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225223"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225224"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BU.fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225223"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="hs-comment">-- | A \&quot;true\&quot;/\&quot;false\&quot; boolean as requested by some services.</span><span>
</span><span id="line-789"></span><span class="annot"><a href="Aws.Core.html#awsBool"><span class="hs-identifier hs-type">awsBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-790"></span><span id="awsBool"><span class="annot"><span class="annottext">awsBool :: Bool -&gt; ByteString
</span><a href="Aws.Core.html#awsBool"><span class="hs-identifier hs-var hs-var">awsBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-791"></span><span class="annot"><a href="Aws.Core.html#awsBool"><span class="hs-identifier hs-var">awsBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- | \&quot;true\&quot;</span><span>
</span><span id="line-794"></span><span class="annot"><a href="Aws.Core.html#awsTrue"><span class="hs-identifier hs-type">awsTrue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-795"></span><span id="awsTrue"><span class="annot"><span class="annottext">awsTrue :: ByteString
</span><a href="Aws.Core.html#awsTrue"><span class="hs-identifier hs-var hs-var">awsTrue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ByteString
</span><a href="Aws.Core.html#awsBool"><span class="hs-identifier hs-var">awsBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-796"></span><span>
</span><span id="line-797"></span><span class="hs-comment">-- | \&quot;false\&quot;</span><span>
</span><span id="line-798"></span><span class="annot"><a href="Aws.Core.html#awsFalse"><span class="hs-identifier hs-type">awsFalse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-799"></span><span id="awsFalse"><span class="annot"><span class="annottext">awsFalse :: ByteString
</span><a href="Aws.Core.html#awsFalse"><span class="hs-identifier hs-var hs-var">awsFalse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ByteString
</span><a href="Aws.Core.html#awsBool"><span class="hs-identifier hs-var">awsBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-comment">-- | Format time according to a format string, as a ByteString.</span><span>
</span><span id="line-802"></span><span class="annot"><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-type">fmtTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-803"></span><span id="fmtTime"><span class="annot"><span class="annottext">fmtTime :: String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var hs-var">fmtTime</span></a></span></span><span> </span><span id="local-6989586621679225222"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225222"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679225221"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225221"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BU.fromString</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225222"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679225221"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="annot"><a href="Aws.Core.html#rfc822Time"><span class="hs-identifier hs-type">rfc822Time</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-806"></span><span id="rfc822Time"><span class="annot"><span class="annottext">rfc822Time :: String
</span><a href="Aws.Core.html#rfc822Time"><span class="hs-identifier hs-var hs-var">rfc822Time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%a, %0d %b %Y %H:%M:%S GMT&quot;</span></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="hs-comment">-- | Format time in RFC 822 format.</span><span>
</span><span id="line-809"></span><span class="annot"><a href="Aws.Core.html#fmtRfc822Time"><span class="hs-identifier hs-type">fmtRfc822Time</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-810"></span><span id="fmtRfc822Time"><span class="annot"><span class="annottext">fmtRfc822Time :: UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtRfc822Time"><span class="hs-identifier hs-var hs-var">fmtRfc822Time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Aws.Core.html#rfc822Time"><span class="hs-identifier hs-var">rfc822Time</span></a></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span class="hs-comment">-- | Format time in yyyy-mm-ddThh-mm-ss format.</span><span>
</span><span id="line-813"></span><span class="annot"><a href="Aws.Core.html#fmtAmzTime"><span class="hs-identifier hs-type">fmtAmzTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-814"></span><span id="fmtAmzTime"><span class="annot"><span class="annottext">fmtAmzTime :: UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtAmzTime"><span class="hs-identifier hs-var hs-var">fmtAmzTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%m-%dT%H:%M:%S&quot;</span></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="hs-comment">-- | Format time as seconds since the Unix epoch.</span><span>
</span><span id="line-817"></span><span class="annot"><a href="Aws.Core.html#fmtTimeEpochSeconds"><span class="hs-identifier hs-type">fmtTimeEpochSeconds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-818"></span><span id="fmtTimeEpochSeconds"><span class="annot"><span class="annottext">fmtTimeEpochSeconds :: UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTimeEpochSeconds"><span class="hs-identifier hs-var hs-var">fmtTimeEpochSeconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; UTCTime -&gt; ByteString
</span><a href="Aws.Core.html#fmtTime"><span class="hs-identifier hs-var">fmtTime</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%s&quot;</span></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="hs-comment">-- | Parse HTTP-date (section 3.3.1 of RFC 2616)</span><span>
</span><span id="line-821"></span><span class="annot"><a href="Aws.Core.html#parseHttpDate"><span class="hs-identifier hs-type">parseHttpDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-822"></span><span id="parseHttpDate"><span class="annot"><span class="annottext">parseHttpDate :: String -&gt; Maybe UTCTime
</span><a href="Aws.Core.html#parseHttpDate"><span class="hs-identifier hs-var hs-var">parseHttpDate</span></a></span></span><span> </span><span id="local-6989586621679225218"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>     </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- rfc1123-date</span><span>
</span><span id="line-823"></span><span>                  </span><span class="annot"><span class="annottext">Maybe UTCTime -&gt; Maybe UTCTime -&gt; Maybe UTCTime
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%A, %d-%b-%y %H:%M:%S GMT&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- rfc850-date</span><span>
</span><span id="line-824"></span><span>                  </span><span class="annot"><span class="annottext">Maybe UTCTime -&gt; Maybe UTCTime -&gt; Maybe UTCTime
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%a %b %_d %H:%M:%S %Y&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span><span>     </span><span class="hs-comment">-- asctime-date</span><span>
</span><span id="line-825"></span><span>                  </span><span class="annot"><span class="annottext">Maybe UTCTime -&gt; Maybe UTCTime -&gt; Maybe UTCTime
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%m-%dT%H:%M:%S%QZ&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span><span>      </span><span class="hs-comment">-- iso 8601</span><span>
</span><span id="line-826"></span><span>                  </span><span class="annot"><span class="annottext">Maybe UTCTime -&gt; Maybe UTCTime -&gt; Maybe UTCTime
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%m-%dT%H:%M:%S%Q%Z&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225218"><span class="hs-identifier hs-var">s</span></a></span><span>     </span><span class="hs-comment">-- iso 8601</span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679225217"><span class="annot"><span class="annottext">p :: String -&gt; String -&gt; Maybe UTCTime
</span><a href="#local-6989586621679225217"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; Maybe UTCTime
forall (m :: * -&gt; *) t.
(MonadFail m, ParseTime t) =&gt;
Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; m t
</span><span class="hs-identifier hs-var">parseTimeM</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="hs-comment">-- | HTTP-date (section 3.3.1 of RFC 2616, first type - RFC1123-style)</span><span>
</span><span id="line-830"></span><span class="annot"><a href="Aws.Core.html#httpDate1"><span class="hs-identifier hs-type">httpDate1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-831"></span><span id="httpDate1"><span class="annot"><span class="annottext">httpDate1 :: String
</span><a href="Aws.Core.html#httpDate1"><span class="hs-identifier hs-var hs-var">httpDate1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span></span><span> </span><span class="hs-comment">-- rfc1123-date</span><span>
</span><span id="line-832"></span><span>
</span><span id="line-833"></span><span class="hs-comment">-- | Format (as Text) HTTP-date (section 3.3.1 of RFC 2616, first type - RFC1123-style)</span><span>
</span><span id="line-834"></span><span class="annot"><a href="Aws.Core.html#textHttpDate"><span class="hs-identifier hs-type">textHttpDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-835"></span><span id="textHttpDate"><span class="annot"><span class="annottext">textHttpDate :: UTCTime -&gt; Text
</span><a href="Aws.Core.html#textHttpDate"><span class="hs-identifier hs-var hs-var">textHttpDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (UTCTime -&gt; String) -&gt; UTCTime -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Aws.Core.html#httpDate1"><span class="hs-identifier hs-var">httpDate1</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><a href="Aws.Core.html#iso8601UtcDate"><span class="hs-identifier hs-type">iso8601UtcDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-838"></span><span id="iso8601UtcDate"><span class="annot"><span class="annottext">iso8601UtcDate :: String
</span><a href="Aws.Core.html#iso8601UtcDate"><span class="hs-identifier hs-var hs-var">iso8601UtcDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%Y-%m-%dT%H:%M:%S%QZ&quot;</span></span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="hs-comment">-- | Parse a two-digit hex number.</span><span>
</span><span id="line-841"></span><span class="annot"><a href="Aws.Core.html#readHex2"><span class="hs-identifier hs-type">readHex2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-842"></span><span id="readHex2"><span class="annot"><span class="annottext">readHex2 :: String -&gt; Maybe Word8
</span><a href="Aws.Core.html#readHex2"><span class="hs-identifier hs-var hs-var">readHex2</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679225214"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225214"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679225213"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225213"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679225212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225212"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Int
</span><a href="#local-6989586621679225211"><span class="hs-identifier hs-var">readHex1</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225214"><span class="hs-identifier hs-var">c1</span></a></span><span>
</span><span id="line-843"></span><span>                      </span><span id="local-6989586621679225210"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225210"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Int
</span><a href="#local-6989586621679225211"><span class="hs-identifier hs-var">readHex1</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225213"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-844"></span><span>                      </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe Word8) -&gt; (Int -&gt; Word8) -&gt; Int -&gt; Maybe Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Word8) -&gt; Int -&gt; Maybe Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225212"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679225210"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-845"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-846"></span><span>      </span><span id="local-6989586621679225211"><span class="annot"><span class="annottext">readHex1 :: Char -&gt; Maybe Int
</span><a href="#local-6989586621679225211"><span class="hs-identifier hs-var hs-var">readHex1</span></a></span></span><span> </span><span id="local-6989586621679225207"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span>
</span><span id="line-847"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'F'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-848"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679225207"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-849"></span><span>      </span><span class="annot"><a href="#local-6989586621679225211"><span class="hs-identifier hs-var">readHex1</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-850"></span><span class="annot"><a href="Aws.Core.html#readHex2"><span class="hs-identifier hs-var">readHex2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="hs-comment">-- XML</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="hs-comment">-- | An error that occurred during XML parsing / validation.</span><span>
</span><span id="line-855"></span><span class="hs-keyword">newtype</span><span> </span><span id="XmlException"><span class="annot"><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XmlException"><span class="annot"><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="xmlErrorMessage"><span class="annot"><span class="annottext">XmlException -&gt; String
</span><a href="Aws.Core.html#xmlErrorMessage"><span class="hs-identifier hs-var hs-var">xmlErrorMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-856"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225196"><span id="local-6989586621679225198"><span id="local-6989586621679225200"><span class="annot"><span class="annottext">Int -&gt; XmlException -&gt; ShowS
[XmlException] -&gt; ShowS
XmlException -&gt; String
(Int -&gt; XmlException -&gt; ShowS)
-&gt; (XmlException -&gt; String)
-&gt; ([XmlException] -&gt; ShowS)
-&gt; Show XmlException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XmlException] -&gt; ShowS
$cshowList :: [XmlException] -&gt; ShowS
show :: XmlException -&gt; String
$cshow :: XmlException -&gt; String
showsPrec :: Int -&gt; XmlException -&gt; ShowS
$cshowsPrec :: Int -&gt; XmlException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225188"><span id="local-6989586621679225190"><span id="local-6989586621679225192"><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-type">XmlException</span></a></span></span></span></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="hs-comment">-- | An error that occurred during header parsing / validation.</span><span>
</span><span id="line-861"></span><span class="hs-keyword">newtype</span><span> </span><span id="HeaderException"><span class="annot"><a href="Aws.Core.html#HeaderException"><span class="hs-identifier hs-var">HeaderException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HeaderException"><span class="annot"><a href="Aws.Core.html#HeaderException"><span class="hs-identifier hs-var">HeaderException</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="headerErrorMessage"><span class="annot"><span class="annottext">HeaderException -&gt; String
</span><a href="Aws.Core.html#headerErrorMessage"><span class="hs-identifier hs-var hs-var">headerErrorMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225179"><span id="local-6989586621679225181"><span id="local-6989586621679225183"><span class="annot"><span class="annottext">Int -&gt; HeaderException -&gt; ShowS
[HeaderException] -&gt; ShowS
HeaderException -&gt; String
(Int -&gt; HeaderException -&gt; ShowS)
-&gt; (HeaderException -&gt; String)
-&gt; ([HeaderException] -&gt; ShowS)
-&gt; Show HeaderException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HeaderException] -&gt; ShowS
$cshowList :: [HeaderException] -&gt; ShowS
show :: HeaderException -&gt; String
$cshow :: HeaderException -&gt; String
showsPrec :: Int -&gt; HeaderException -&gt; ShowS
$cshowsPrec :: Int -&gt; HeaderException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225171"><span id="local-6989586621679225173"><span id="local-6989586621679225175"><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="Aws.Core.html#HeaderException"><span class="hs-identifier hs-type">HeaderException</span></a></span></span></span></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-comment">-- | An error that occurred during form parsing / validation.</span><span>
</span><span id="line-867"></span><span class="hs-keyword">newtype</span><span> </span><span id="FormException"><span class="annot"><a href="Aws.Core.html#FormException"><span class="hs-identifier hs-var">FormException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FormException"><span class="annot"><a href="Aws.Core.html#FormException"><span class="hs-identifier hs-var">FormException</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="formErrorMesage"><span class="annot"><span class="annottext">FormException -&gt; String
</span><a href="Aws.Core.html#formErrorMesage"><span class="hs-identifier hs-var hs-var">formErrorMesage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-868"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225163"><span id="local-6989586621679225165"><span id="local-6989586621679225167"><span class="annot"><span class="annottext">Int -&gt; FormException -&gt; ShowS
[FormException] -&gt; ShowS
FormException -&gt; String
(Int -&gt; FormException -&gt; ShowS)
-&gt; (FormException -&gt; String)
-&gt; ([FormException] -&gt; ShowS)
-&gt; Show FormException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FormException] -&gt; ShowS
$cshowList :: [FormException] -&gt; ShowS
show :: FormException -&gt; String
$cshow :: FormException -&gt; String
showsPrec :: Int -&gt; FormException -&gt; ShowS
$cshowsPrec :: Int -&gt; FormException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225155"><span id="local-6989586621679225157"><span id="local-6989586621679225159"><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="Aws.Core.html#FormException"><span class="hs-identifier hs-type">FormException</span></a></span></span></span></span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span class="hs-comment">-- | No credentials were found and an invariant was violated.</span><span>
</span><span id="line-873"></span><span class="hs-keyword">newtype</span><span> </span><span id="NoCredentialsException"><span class="annot"><a href="Aws.Core.html#NoCredentialsException"><span class="hs-identifier hs-var">NoCredentialsException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoCredentialsException"><span class="annot"><a href="Aws.Core.html#NoCredentialsException"><span class="hs-identifier hs-var">NoCredentialsException</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="noCredentialsErrorMessage"><span class="annot"><span class="annottext">NoCredentialsException -&gt; String
</span><a href="Aws.Core.html#noCredentialsErrorMessage"><span class="hs-identifier hs-var hs-var">noCredentialsErrorMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-874"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679225147"><span id="local-6989586621679225149"><span id="local-6989586621679225151"><span class="annot"><span class="annottext">Int -&gt; NoCredentialsException -&gt; ShowS
[NoCredentialsException] -&gt; ShowS
NoCredentialsException -&gt; String
(Int -&gt; NoCredentialsException -&gt; ShowS)
-&gt; (NoCredentialsException -&gt; String)
-&gt; ([NoCredentialsException] -&gt; ShowS)
-&gt; Show NoCredentialsException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NoCredentialsException] -&gt; ShowS
$cshowList :: [NoCredentialsException] -&gt; ShowS
show :: NoCredentialsException -&gt; String
$cshow :: NoCredentialsException -&gt; String
showsPrec :: Int -&gt; NoCredentialsException -&gt; ShowS
$cshowsPrec :: Int -&gt; NoCredentialsException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679225139"><span id="local-6989586621679225141"><span id="local-6989586621679225143"><span class="annot"><span class="hs-identifier hs-type">E.Exception</span></span><span> </span><span class="annot"><a href="Aws.Core.html#NoCredentialsException"><span class="hs-identifier hs-type">NoCredentialsException</span></a></span></span></span></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span class="hs-comment">-- | A helper to throw an 'HTTP.StatusCodeException'.</span><span>
</span><span id="line-879"></span><span id="local-6989586621679225137"><span id="local-6989586621679225138"><span class="annot"><a href="Aws.Core.html#throwStatusCodeException"><span class="hs-identifier hs-type">throwStatusCodeException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Response</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.ConduitM</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="annot"><a href="#local-6989586621679225138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225137"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-880"></span><span id="throwStatusCodeException"><span class="annot"><span class="annottext">throwStatusCodeException :: Request -&gt; Response (ConduitM () ByteString m ()) -&gt; m a
</span><a href="Aws.Core.html#throwStatusCodeException"><span class="hs-identifier hs-var hs-var">throwStatusCodeException</span></a></span></span><span> </span><span id="local-6989586621679225136"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679225136"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679225135"><span class="annot"><span class="annottext">Response (ConduitM () ByteString m ())
</span><a href="#local-6989586621679225135"><span class="hs-identifier hs-var">resp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-881"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225134"><span class="annot"><span class="annottext">resp' :: Response ()
</span><a href="#local-6989586621679225134"><span class="hs-identifier hs-var hs-var">resp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConduitM () ByteString m () -&gt; ())
-&gt; Response (ConduitM () ByteString m ()) -&gt; Response ()
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ConduitM () ByteString m () -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString m ())
</span><a href="#local-6989586621679225135"><span class="hs-identifier hs-var">resp</span></a></span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-comment">-- only take first 10kB of error response</span><span>
</span><span id="line-883"></span><span>    </span><span id="local-6989586621679225133"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225133"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConduitT () Void m ByteString -&gt; m ByteString
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">C.runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void m ByteString -&gt; m ByteString)
-&gt; ConduitT () Void m ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString m ())
-&gt; ConduitM () ByteString m ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTP.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString m ())
</span><a href="#local-6989586621679225135"><span class="hs-identifier hs-var">resp</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString m ()
-&gt; ConduitM ByteString Void m ByteString
-&gt; ConduitT () Void m ByteString
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ConduitM ByteString Void m ByteString
forall (m :: * -&gt; *) o.
Monad m =&gt;
Int -&gt; ConduitT ByteString o m ByteString
</span><span class="hs-identifier hs-var">CB.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225131"><span class="annot"><span class="annottext">sce :: HttpExceptionContent
</span><a href="#local-6989586621679225131"><span class="hs-identifier hs-var hs-var">sce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response () -&gt; ByteString -&gt; HttpExceptionContent
</span><span class="hs-identifier hs-var">HTTP.StatusCodeException</span></span><span> </span><span class="annot"><span class="annottext">Response ()
</span><a href="#local-6989586621679225134"><span class="hs-identifier hs-var">resp'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">L.toStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679225133"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-885"></span><span>    </span><span class="annot"><span class="annottext">HttpException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; m a) -&gt; HttpException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; HttpExceptionContent -&gt; HttpException
</span><span class="hs-identifier hs-var">HTTP.HttpExceptionRequest</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679225136"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="#local-6989586621679225131"><span class="hs-identifier hs-var">sce</span></a></span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span class="hs-comment">-- | A specific element (case-insensitive, ignoring namespace - sadly necessary), extracting only the textual contents.</span><span>
</span><span id="line-888"></span><span class="annot"><a href="Aws.Core.html#elContent"><span class="hs-identifier hs-type">elContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cursor</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-889"></span><span id="elContent"><span class="annot"><span class="annottext">elContent :: Text -&gt; Cursor -&gt; [Text]
</span><a href="Aws.Core.html#elContent"><span class="hs-identifier hs-var hs-var">elContent</span></a></span></span><span> </span><span id="local-6989586621679225127"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225127"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Axis
</span><span class="hs-identifier hs-var">laxElement</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225127"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Axis -&gt; (Cursor -&gt; [Text]) -&gt; Cursor -&gt; [Text]
forall node a.
Axis node -&gt; (Cursor node -&gt; [a]) -&gt; Cursor node -&gt; [a]
</span><span class="hs-operator hs-var">&amp;/</span></span><span> </span><span class="annot"><span class="annottext">Cursor -&gt; [Text]
</span><span class="hs-identifier hs-var">content</span></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span class="hs-comment">-- | Like 'elContent', but extracts 'String's instead of 'T.Text'.</span><span>
</span><span id="line-892"></span><span class="annot"><a href="Aws.Core.html#elCont"><span class="hs-identifier hs-type">elCont</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cursor</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-893"></span><span id="elCont"><span class="annot"><span class="annottext">elCont :: Text -&gt; Cursor -&gt; [String]
</span><a href="Aws.Core.html#elCont"><span class="hs-identifier hs-var hs-var">elCont</span></a></span></span><span> </span><span id="local-6989586621679225123"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225123"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Axis
</span><span class="hs-identifier hs-var">laxElement</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225123"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Axis -&gt; (Cursor -&gt; [String]) -&gt; Cursor -&gt; [String]
forall node a.
Axis node -&gt; (Cursor node -&gt; [a]) -&gt; Cursor node -&gt; [a]
</span><span class="hs-operator hs-var">&amp;/</span></span><span> </span><span class="annot"><span class="annottext">Cursor -&gt; [Text]
</span><span class="hs-identifier hs-var">content</span></span><span> </span><span class="annot"><span class="annottext">(Cursor -&gt; [Text]) -&gt; (Text -&gt; String) -&gt; Cursor -&gt; [String]
forall node a b.
(Cursor node -&gt; [a]) -&gt; (a -&gt; b) -&gt; Cursor node -&gt; [b]
</span><span class="hs-operator hs-var">&amp;|</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span class="hs-comment">-- | Extract the first element from a parser result list, and throw an 'XmlException' if the list is empty.</span><span>
</span><span id="line-896"></span><span id="local-6989586621679225119"><span id="local-6989586621679225120"><span class="annot"><a href="Aws.Core.html#force"><span class="hs-identifier hs-type">force</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225119"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225120"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225119"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-897"></span><span id="force"><span class="annot"><span class="annottext">force :: String -&gt; [a] -&gt; m a
</span><a href="Aws.Core.html#force"><span class="hs-identifier hs-var hs-var">force</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XmlException -&gt; [a] -&gt; m a
forall e (f :: * -&gt; *) a.
(Exception e, MonadThrow f) =&gt;
e -&gt; [a] -&gt; f a
</span><span class="hs-identifier hs-var">Cu.force</span></span><span> </span><span class="annot"><span class="annottext">(XmlException -&gt; [a] -&gt; m a)
-&gt; (String -&gt; XmlException) -&gt; String -&gt; [a] -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XmlException
</span><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | Extract the first element from a monadic parser result list, and throw an 'XmlException' if the list is empty.</span><span>
</span><span id="line-900"></span><span id="local-6989586621679225117"><span id="local-6989586621679225118"><span class="annot"><a href="Aws.Core.html#forceM"><span class="hs-identifier hs-type">forceM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679225118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225117"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225117"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-901"></span><span id="forceM"><span class="annot"><span class="annottext">forceM :: String -&gt; [m a] -&gt; m a
</span><a href="Aws.Core.html#forceM"><span class="hs-identifier hs-var hs-var">forceM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XmlException -&gt; [m a] -&gt; m a
forall e (f :: * -&gt; *) a.
(Exception e, MonadThrow f) =&gt;
e -&gt; [f a] -&gt; f a
</span><span class="hs-identifier hs-var">Cu.forceM</span></span><span> </span><span class="annot"><span class="annottext">(XmlException -&gt; [m a] -&gt; m a)
-&gt; (String -&gt; XmlException) -&gt; String -&gt; [m a] -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XmlException
</span><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span class="hs-comment">-- | Read a boolean from a 'T.Text', throwing an 'XmlException' on failure.</span><span>
</span><span id="line-904"></span><span id="local-6989586621679225116"><span class="annot"><a href="Aws.Core.html#textReadBool"><span class="hs-identifier hs-type">textReadBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225116"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225116"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-905"></span><span id="textReadBool"><span class="annot"><span class="annottext">textReadBool :: Text -&gt; m Bool
</span><a href="Aws.Core.html#textReadBool"><span class="hs-identifier hs-var hs-var">textReadBool</span></a></span></span><span> </span><span id="local-6989586621679225115"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225115"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225115"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-906"></span><span>                  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;true&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-907"></span><span>                  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-908"></span><span>                  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XmlException -&gt; m Bool
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(XmlException -&gt; m Bool) -&gt; XmlException -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XmlException
</span><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid Bool&quot;</span></span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span class="hs-comment">-- | Read an integer from a 'T.Text', throwing an 'XmlException' on failure.</span><span>
</span><span id="line-911"></span><span id="local-6989586621679225113"><span id="local-6989586621679225114"><span class="annot"><a href="Aws.Core.html#textReadInt"><span class="hs-identifier hs-type">textReadInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225114"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679225113"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225113"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-912"></span><span id="textReadInt"><span class="annot"><span class="annottext">textReadInt :: Text -&gt; m a
</span><a href="Aws.Core.html#textReadInt"><span class="hs-identifier hs-var hs-var">textReadInt</span></a></span></span><span> </span><span id="local-6989586621679225112"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225112"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Integer
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">ReadS Integer -&gt; ReadS Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679225112"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-913"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679225110"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679225110"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m a) -&gt; a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679225110"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-914"></span><span>                  </span><span class="annot"><span class="annottext">[(Integer, String)]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XmlException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(XmlException -&gt; m a) -&gt; XmlException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XmlException
</span><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid Integer&quot;</span></span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span class="hs-comment">-- | Read an integer from a 'String', throwing an 'XmlException' on failure.</span><span>
</span><span id="line-917"></span><span id="local-6989586621679225108"><span id="local-6989586621679225109"><span class="annot"><a href="Aws.Core.html#readInt"><span class="hs-identifier hs-type">readInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679225109"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679225108"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679225109"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225108"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-918"></span><span id="readInt"><span class="annot"><span class="annottext">readInt :: String -&gt; m a
</span><a href="Aws.Core.html#readInt"><span class="hs-identifier hs-var hs-var">readInt</span></a></span></span><span> </span><span id="local-6989586621679225107"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225107"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Integer
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679225107"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-919"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679225106"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679225106"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m a) -&gt; a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679225106"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-920"></span><span>              </span><span class="annot"><span class="annottext">[(Integer, String)]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XmlException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(XmlException -&gt; m a) -&gt; XmlException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XmlException
</span><a href="Aws.Core.html#XmlException"><span class="hs-identifier hs-var">XmlException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid Integer&quot;</span></span><span>
</span><span id="line-921"></span><span>
</span><span id="line-922"></span><span class="hs-comment">-- | Create a complete 'HTTPResponseConsumer' from a simple function that takes a 'Cu.Cursor' to XML in the response</span><span>
</span><span id="line-923"></span><span class="hs-comment">-- body.</span><span>
</span><span id="line-924"></span><span class="hs-comment">--</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- This function is highly recommended for any services that parse relatively short XML responses. (If status and response</span><span>
</span><span id="line-926"></span><span class="hs-comment">-- headers are required, simply take them as function parameters, and pass them through to this function.)</span><span>
</span><span id="line-927"></span><span id="local-6989586621679225104"><span id="local-6989586621679225105"><span class="annot"><a href="Aws.Core.html#xmlCursorConsumer"><span class="hs-identifier hs-type">xmlCursorConsumer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-928"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679225105"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cu.Cursor</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225105"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225104"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-930"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="annot"><a href="#local-6989586621679225105"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-931"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Aws.Core.html#HTTPResponseConsumer"><span class="hs-identifier hs-type">HTTPResponseConsumer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679225104"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-932"></span><span id="xmlCursorConsumer"><span class="annot"><span class="annottext">xmlCursorConsumer :: (Cursor -&gt; Response m a) -&gt; IORef m -&gt; HTTPResponseConsumer a
</span><a href="Aws.Core.html#xmlCursorConsumer"><span class="hs-identifier hs-var hs-var">xmlCursorConsumer</span></a></span></span><span> </span><span id="local-6989586621679225103"><span class="annot"><span class="annottext">Cursor -&gt; Response m a
</span><a href="#local-6989586621679225103"><span class="hs-identifier hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679225102"><span class="annot"><span class="annottext">IORef m
</span><a href="#local-6989586621679225102"><span class="hs-identifier hs-var">metadataRef</span></a></span></span><span> </span><span id="local-6989586621679225101"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679225101"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-933"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679225100"><span class="annot"><span class="annottext">Document
</span><a href="#local-6989586621679225100"><span class="hs-identifier hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConduitT () Void (ResourceT IO) Document -&gt; ResourceT IO Document
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">C.runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void (ResourceT IO) Document -&gt; ResourceT IO Document)
-&gt; ConduitT () Void (ResourceT IO) Document
-&gt; ResourceT IO Document
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; ConduitM () ByteString (ResourceT IO) ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTP.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679225101"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) Document
-&gt; ConduitT () Void (ResourceT IO) Document
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ParseSettings -&gt; ConduitM ByteString Void (ResourceT IO) Document
forall (m :: * -&gt; *) o.
MonadThrow m =&gt;
ParseSettings -&gt; ConduitT ByteString o m Document
</span><span class="hs-identifier hs-var">XML.sinkDoc</span></span><span> </span><span class="annot"><span class="annottext">ParseSettings
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">XML.def</span></span><span>
</span><span id="line-934"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679225097"><span class="annot"><span class="annottext">cursor :: Cursor
</span><a href="#local-6989586621679225097"><span class="hs-identifier hs-var hs-var">cursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Document -&gt; Cursor
</span><span class="hs-identifier hs-var">Cu.fromDocument</span></span><span> </span><span class="annot"><span class="annottext">Document
</span><a href="#local-6989586621679225100"><span class="hs-identifier hs-var">doc</span></a></span><span>
</span><span id="line-935"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Aws.Core.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span id="local-6989586621679225095"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225095"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span id="local-6989586621679225094"><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679225094"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cursor -&gt; Response m a
</span><a href="#local-6989586621679225103"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">Cursor
</span><a href="#local-6989586621679225097"><span class="hs-identifier hs-var">cursor</span></a></span><span>
</span><span id="line-936"></span><span>         </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef m -&gt; m -&gt; IO ()
forall m. Monoid m =&gt; IORef m -&gt; m -&gt; IO ()
</span><a href="Aws.Core.html#tellMetadataRef"><span class="hs-identifier hs-var">tellMetadataRef</span></a></span><span> </span><span class="annot"><span class="annottext">IORef m
</span><a href="#local-6989586621679225102"><span class="hs-identifier hs-var">metadataRef</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679225095"><span class="hs-identifier hs-var">metadata</span></a></span><span>
</span><span id="line-937"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either SomeException a
</span><a href="#local-6989586621679225094"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-938"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679225093"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679225093"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; ResourceT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; ResourceT IO a) -&gt; IO a -&gt; ResourceT IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679225093"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-939"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679225092"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225092"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ResourceT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679225092"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-940"></span></pre></body></html>