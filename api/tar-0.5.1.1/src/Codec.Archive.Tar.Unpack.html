<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  Codec.Archive.Tar</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) 2007 Bjorn Bringert,</span><span>
</span><span id="line-6"></span><span class="hs-comment">--                    2008 Andrea Vezzosi,</span><span>
</span><span id="line-7"></span><span class="hs-comment">--                    2008-2009, 2012, 2016 Duncan Coutts</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  duncan@community.haskell.org</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Archive.Tar.Unpack</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Codec.Archive.Tar.Unpack.html#unpack"><span class="hs-identifier">unpack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Archive.Tar.Types.html"><span class="hs-identifier">Codec.Archive.Tar.Types</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Archive.Tar.Check.html"><span class="hs-identifier">Codec.Archive.Tar.Check</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-23"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FilePath.Native</span></span><span>
</span><span id="line-25"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">takeDirectory</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>
</span><span id="line-27"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">copyFile</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-29"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwIO</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_directory(1,2,3)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>
</span><span id="line-32"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">setModificationTime</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock.POSIX</span></span><span>
</span><span id="line-34"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">posixSecondsToUTCTime</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span>
</span><span id="line-36"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span>
</span><span id="line-38"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">isPermissionError</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Create local files and directories based on the entries of a tar archive.</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- This is a portable implementation of unpacking suitable for portable</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- archives. It handles 'NormalFile' and 'Directory' entries and has simulated</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- support for 'SymbolicLink' and 'HardLink' entries. Links are implemented by</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- copying the target file. This therefore works on Windows as well as Unix.</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- All other entry types are ignored, that is they are not unpacked and no</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- exception is raised.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- If the 'Entries' ends in an error then it is raised an an exception. Any</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- files or directories that have been unpacked before the error was</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- encountered will not be deleted. For this reason you may want to unpack</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- into an empty directory so that you can easily clean up if unpacking fails</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- part-way.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- On its own, this function only checks for security (using 'checkSecurity').</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- You can do other checks by applying checking functions to the 'Entries' that</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- you pass to this function. For example:</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt; unpack dir (checkTarbomb expectedDir entries)</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- If you care about the priority of the reported errors then you may want to</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- use 'checkSecurity' before 'checkTarbomb' or other checks.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span id="local-6989586621679059717"><span class="annot"><a href="Codec.Archive.Tar.Unpack.html#unpack"><span class="hs-identifier hs-type">unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="#local-6989586621679059717"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Archive.Tar.Types.html#Entries"><span class="hs-identifier hs-type">Entries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059717"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-67"></span><span id="unpack"><span class="annot"><span class="annottext">unpack :: FilePath -&gt; Entries e -&gt; IO ()
</span><a href="Codec.Archive.Tar.Unpack.html#unpack"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span id="local-6989586621679059716"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">baseDir</span></a></span></span><span> </span><span id="local-6989586621679059715"><span class="annot"><span class="annottext">Entries e
</span><a href="#local-6989586621679059715"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e FileNameError) -&gt; IO [(FilePath, FilePath)]
forall e e.
(Exception e, Exception e) =&gt;
[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entries e -&gt; Entries (Either e FileNameError)
forall e. Entries e -&gt; Entries (Either e FileNameError)
</span><a href="Codec.Archive.Tar.Check.html#checkSecurity"><span class="hs-identifier hs-var">checkSecurity</span></a></span><span> </span><span class="annot"><span class="annottext">Entries e
</span><a href="#local-6989586621679059715"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                     </span><span class="annot"><span class="annottext">IO [(FilePath, FilePath)]
-&gt; ([(FilePath, FilePath)] -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)] -&gt; IO ()
</span><a href="#local-6989586621679059712"><span class="hs-identifier hs-var">emulateLinks</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- We're relying here on 'checkSecurity' to make sure we're not scribbling</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- files all over the place.</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679059714"><span class="annot"><span class="annottext">unpackEntries :: [(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var hs-var">unpackEntries</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Archive.Tar.Types.html#Fail"><span class="hs-identifier hs-type">Fail</span></a></span><span> </span><span id="local-6989586621679059710"><span class="annot"><span class="annottext">Either e e
</span><a href="#local-6989586621679059710"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; IO [(FilePath, FilePath)])
-&gt; (e -&gt; IO [(FilePath, FilePath)])
-&gt; Either e e
-&gt; IO [(FilePath, FilePath)]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; IO [(FilePath, FilePath)]
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; IO [(FilePath, FilePath)]
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">Either e e
</span><a href="#local-6989586621679059710"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span id="local-6989586621679059708"><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059708"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="Codec.Archive.Tar.Types.html#Done"><span class="hs-identifier hs-var">Done</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)] -&gt; IO [(FilePath, FilePath)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059708"><span class="hs-identifier hs-var">links</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span id="local-6989586621679059706"><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Archive.Tar.Types.html#Next"><span class="hs-identifier hs-type">Next</span></a></span><span> </span><span id="local-6989586621679059704"><span class="annot"><span class="annottext">Entry
</span><a href="#local-6989586621679059704"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679059703"><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry -&gt; EntryContent
</span><a href="Codec.Archive.Tar.Types.html#entryContent"><span class="hs-identifier hs-var hs-var">entryContent</span></a></span><span> </span><span class="annot"><span class="annottext">Entry
</span><a href="#local-6989586621679059704"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><a href="Codec.Archive.Tar.Types.html#NormalFile"><span class="hs-identifier hs-type">NormalFile</span></a></span><span> </span><span id="local-6989586621679059700"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059700"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; FileSize -&gt; IO ()
</span><a href="#local-6989586621679059699"><span class="hs-identifier hs-var">extractFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059700"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059697"><span class="hs-identifier hs-var">mtime</span></a></span><span>
</span><span id="line-78"></span><span>                        </span><span class="annot"><span class="annottext">IO () -&gt; IO [(FilePath, FilePath)] -&gt; IO [(FilePath, FilePath)]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">EntryContent
</span><a href="Codec.Archive.Tar.Types.html#Directory"><span class="hs-identifier hs-var">Directory</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FileSize -&gt; IO ()
</span><a href="#local-6989586621679059695"><span class="hs-identifier hs-var">extractDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059697"><span class="hs-identifier hs-var">mtime</span></a></span><span>
</span><span id="line-80"></span><span>                        </span><span class="annot"><span class="annottext">IO () -&gt; IO [(FilePath, FilePath)] -&gt; IO [(FilePath, FilePath)]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><a href="Codec.Archive.Tar.Types.html#HardLink"><span class="hs-identifier hs-type">HardLink</span></a></span><span>     </span><span id="local-6989586621679059693"><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059693"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="annot"><span class="annottext">([(FilePath, FilePath)]
 -&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)])
-&gt; [(FilePath, FilePath)]
-&gt; Entries (Either e e)
-&gt; IO [(FilePath, FilePath)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; LinkTarget -&gt; [(FilePath, FilePath)] -&gt; [(FilePath, FilePath)]
forall (t :: * -&gt; *) a.
Foldable t =&gt;
t a -&gt; LinkTarget -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
</span><a href="#local-6989586621679059691"><span class="hs-identifier hs-var">saveLink</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059693"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="annot"><a href="Codec.Archive.Tar.Types.html#SymbolicLink"><span class="hs-identifier hs-type">SymbolicLink</span></a></span><span> </span><span id="local-6989586621679059689"><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059689"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="annot"><span class="annottext">([(FilePath, FilePath)]
 -&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)])
-&gt; [(FilePath, FilePath)]
-&gt; Entries (Either e e)
-&gt; IO [(FilePath, FilePath)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; LinkTarget -&gt; [(FilePath, FilePath)] -&gt; [(FilePath, FilePath)]
forall (t :: * -&gt; *) a.
Foldable t =&gt;
t a -&gt; LinkTarget -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
</span><a href="#local-6989586621679059691"><span class="hs-identifier hs-var">saveLink</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059689"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><span class="annottext">EntryContent
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; Entries (Either e e) -&gt; IO [(FilePath, FilePath)]
</span><a href="#local-6989586621679059714"><span class="hs-identifier hs-var">unpackEntries</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679059706"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">Entries (Either e e)
</span><a href="#local-6989586621679059703"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-comment">--ignore other file types</span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>        </span><span id="local-6989586621679059698"><span class="annot"><span class="annottext">path :: FilePath
</span><a href="#local-6989586621679059698"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry -&gt; FilePath
</span><a href="Codec.Archive.Tar.Types.html#entryPath"><span class="hs-identifier hs-var">entryPath</span></a></span><span> </span><span class="annot"><span class="annottext">Entry
</span><a href="#local-6989586621679059704"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span id="local-6989586621679059697"><span class="annot"><span class="annottext">mtime :: FileSize
</span><a href="#local-6989586621679059697"><span class="hs-identifier hs-var hs-var">mtime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry -&gt; FileSize
</span><a href="Codec.Archive.Tar.Types.html#entryTime"><span class="hs-identifier hs-var hs-var">entryTime</span></a></span><span> </span><span class="annot"><span class="annottext">Entry
</span><a href="#local-6989586621679059704"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679059699"><span class="annot"><span class="annottext">extractFile :: FilePath -&gt; ByteString -&gt; FileSize -&gt; IO ()
</span><a href="#local-6989586621679059699"><span class="hs-identifier hs-var hs-var">extractFile</span></a></span></span><span> </span><span id="local-6989586621679059686"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059686"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059685"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059685"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span id="local-6989586621679059684"><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059684"><span class="hs-identifier hs-var">mtime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-comment">-- Note that tar archives do not make sure each directory is created</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- before files they contain, indeed we may have to create several</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-comment">-- levels of directory.</span><span>
</span><span id="line-92"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059683"><span class="hs-identifier hs-var">absDir</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; IO ()
</span><span class="hs-identifier hs-var">BS.writeFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059681"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679059685"><span class="hs-identifier hs-var">content</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; FileSize -&gt; IO ()
</span><a href="Codec.Archive.Tar.Unpack.html#setModTime"><span class="hs-identifier hs-var">setModTime</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059681"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059684"><span class="hs-identifier hs-var">mtime</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679059683"><span class="annot"><span class="annottext">absDir :: FilePath
</span><a href="#local-6989586621679059683"><span class="hs-identifier hs-var hs-var">absDir</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">FilePath.Native.takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059686"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621679059681"><span class="annot"><span class="annottext">absPath :: FilePath
</span><a href="#local-6989586621679059681"><span class="hs-identifier hs-var hs-var">absPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059686"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679059695"><span class="annot"><span class="annottext">extractDir :: FilePath -&gt; FileSize -&gt; IO ()
</span><a href="#local-6989586621679059695"><span class="hs-identifier hs-var hs-var">extractDir</span></a></span></span><span> </span><span id="local-6989586621679059679"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059679"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059678"><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059678"><span class="hs-identifier hs-var">mtime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059677"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; FileSize -&gt; IO ()
</span><a href="Codec.Archive.Tar.Unpack.html#setModTime"><span class="hs-identifier hs-var">setModTime</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059677"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059678"><span class="hs-identifier hs-var">mtime</span></a></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>        </span><span id="local-6989586621679059677"><span class="annot"><span class="annottext">absPath :: FilePath
</span><a href="#local-6989586621679059677"><span class="hs-identifier hs-var hs-var">absPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059679"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679059691"><span class="annot"><span class="annottext">saveLink :: t a -&gt; LinkTarget -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
</span><a href="#local-6989586621679059691"><span class="hs-identifier hs-var hs-var">saveLink</span></a></span></span><span> </span><span id="local-6989586621679059676"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679059676"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059675"><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059675"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span id="local-6989586621679059674"><span class="annot"><span class="annottext">[(t a, FilePath)]
</span><a href="#local-6989586621679059674"><span class="hs-identifier hs-var">links</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679059676"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                             </span><span class="annot"><span class="annottext">([(t a, FilePath)] -&gt; [(t a, FilePath)])
-&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059672"><span class="hs-identifier hs-var">link'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                             </span><span class="annot"><span class="annottext">([(t a, FilePath)] -&gt; [(t a, FilePath)])
-&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679059676"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059672"><span class="hs-identifier hs-var">link'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(t a, FilePath) -&gt; [(t a, FilePath)] -&gt; [(t a, FilePath)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(t a, FilePath)]
</span><a href="#local-6989586621679059674"><span class="hs-identifier hs-var">links</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679059672"><span class="annot"><span class="annottext">link' :: FilePath
</span><a href="#local-6989586621679059672"><span class="hs-identifier hs-var hs-var">link'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinkTarget -&gt; FilePath
</span><a href="Codec.Archive.Tar.Types.html#fromLinkTarget"><span class="hs-identifier hs-var">fromLinkTarget</span></a></span><span> </span><span class="annot"><span class="annottext">LinkTarget
</span><a href="#local-6989586621679059675"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679059712"><span class="annot"><span class="annottext">emulateLinks :: [(FilePath, FilePath)] -&gt; IO ()
</span><a href="#local-6989586621679059712"><span class="hs-identifier hs-var hs-var">emulateLinks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; IO ()) -&gt; [(FilePath, FilePath)] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(((FilePath, FilePath) -&gt; IO ())
 -&gt; [(FilePath, FilePath)] -&gt; IO ())
-&gt; ((FilePath, FilePath) -&gt; IO ())
-&gt; [(FilePath, FilePath)]
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679059669"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059669"><span class="hs-identifier hs-var">relPath</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059668"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059668"><span class="hs-identifier hs-var">relLinkTarget</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059667"><span class="annot"><span class="annottext">absPath :: FilePath
</span><a href="#local-6989586621679059667"><span class="hs-identifier hs-var hs-var">absPath</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059716"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059669"><span class="hs-identifier hs-var">relPath</span></a></span><span>
</span><span id="line-112"></span><span>          </span><span id="local-6989586621679059666"><span class="annot"><span class="annottext">absTarget :: FilePath
</span><a href="#local-6989586621679059666"><span class="hs-identifier hs-var hs-var">absTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">FilePath.Native.takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059667"><span class="hs-identifier hs-var">absPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059668"><span class="hs-identifier hs-var">relLinkTarget</span></a></span><span>
</span><span id="line-113"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">copyFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059666"><span class="hs-identifier hs-var">absTarget</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059667"><span class="hs-identifier hs-var">absPath</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Codec.Archive.Tar.Unpack.html#setModTime"><span class="hs-identifier hs-type">setModTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Archive.Tar.Types.html#EpochTime"><span class="hs-identifier hs-type">EpochTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_directory(1,2,3)
</span><span class="hs-comment">-- functionality only supported as of directory-1.2.3.x</span><span>
</span><span id="line-118"></span><span id="setModTime"><span class="annot"><span class="annottext">setModTime :: FilePath -&gt; FileSize -&gt; IO ()
</span><a href="Codec.Archive.Tar.Unpack.html#setModTime"><span class="hs-identifier hs-var hs-var">setModTime</span></a></span></span><span> </span><span id="local-6989586621679059664"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059664"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679059663"><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059663"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; UTCTime -&gt; IO ()
</span><span class="hs-identifier hs-var">setModificationTime</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679059664"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileSize -&gt; POSIXTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">FileSize
</span><a href="#local-6989586621679059663"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; (IOError -&gt; IO ()) -&gt; IO ()
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`Exception.catch`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059662"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679059662"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; Bool
</span><span class="hs-identifier hs-var">isPermissionError</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679059662"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621679059662"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">setModTime</span><span> </span><span class="hs-identifier">_path</span><span> </span><span class="hs-identifier">_t</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span></pre></body></html>