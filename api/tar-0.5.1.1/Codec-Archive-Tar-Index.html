<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Codec.Archive.Tar.Index</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">tar-0.5.1.1: Reading, writing and manipulating &quot;.tar&quot; archive files.</span><ul class="links" id="page-menu"><li><a href="src/Codec.Archive.Tar.Index.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2010-2015 Duncan Coutts</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>duncan@community.haskell.org</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Codec.Archive.Tar.Index</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Index type</a></li><li><a href="#g:2">Index lookup</a><ul><li><a href="#g:3">I/O operations</a></li></ul></li><li><a href="#g:4">Index construction</a><ul><li><a href="#g:5">Incremental construction</a></li></ul></li><li><a href="#g:6">Serialising indexes</a></li><li><a href="#g:7">Lower level operations with offsets and I/O on tar files</a></li><li><a href="#g:8">Deprecated aliases</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Random access to the content of a <code>.tar</code> archive.</p><p>This module uses common names and so is designed to be imported qualified:</p><pre>import qualified Codec.Archive.Tar.Index as TarIndex</pre></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:TarIndex">TarIndex</a></li><li class="src short"><a href="#v:lookup">lookup</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TarIndexEntry">TarIndexEntry</a><ul class="subs"><li>= <a href="#v:TarFileEntry">TarFileEntry</a> !<a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></li><li>| <a href="#v:TarDir">TarDir</a> [(<a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>, <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a>)]</li></ul></li><li class="src short"><a href="#v:toList">toList</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; [(<a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>, <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a>)]</li><li class="src short"><span class="keyword">type</span> <a href="#t:TarEntryOffset">TarEntryOffset</a> = <a href="../base-4.14.3.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a></li><li class="src short"><a href="#v:hReadEntry">hReadEntry</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></li><li class="src short"><a href="#v:hReadEntryHeader">hReadEntryHeader</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></li><li class="src short"><a href="#v:build">build</a> :: <a href="Codec-Archive-Tar.html#t:Entries" title="Codec.Archive.Tar">Entries</a> e -&gt; <a href="../base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> e <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:IndexBuilder">IndexBuilder</a></li><li class="src short"><a href="#v:empty">empty</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></li><li class="src short"><a href="#v:addNextEntry">addNextEntry</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></li><li class="src short"><a href="#v:skipNextEntry">skipNextEntry</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></li><li class="src short"><a href="#v:finalise">finalise</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></li><li class="src short"><a href="#v:unfinalise">unfinalise</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></li><li class="src short"><a href="#v:serialise">serialise</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:deserialise">deserialise</a> :: <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a>, <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</li><li class="src short"><a href="#v:hReadEntryHeaderOrEof">hReadEntryHeaderOrEof</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a>, <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a>))</li><li class="src short"><a href="#v:hSeekEntryOffset">hSeekEntryOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:hSeekEntryContentOffset">hSeekEntryContentOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:hSeekEndEntryOffset">hSeekEndEntryOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></li><li class="src short"><a href="#v:nextEntryOffset">nextEntryOffset</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></li><li class="src short"><a href="#v:indexEndEntryOffset">indexEndEntryOffset</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></li><li class="src short"><a href="#v:indexNextEntryOffset">indexNextEntryOffset</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></li><li class="src short"><a href="#v:emptyIndex">emptyIndex</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></li><li class="src short"><a href="#v:finaliseIndex">finaliseIndex</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>The <code>tar</code> format does not contain an index of files within the
 archive. Normally, <code>tar</code> file have to be processed linearly. It is
 sometimes useful however to be able to get random access to files
 within the archive.</p><p>This module provides an index of a <code>tar</code> file. A linear pass of the
 <code>tar</code> file is needed to <code><a href="Codec-Archive-Tar-Index.html#v:build" title="Codec.Archive.Tar.Index">build</a></code> the <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>, but thereafter you can
 <code><a href="Codec-Archive-Tar-Index.html#v:lookup" title="Codec.Archive.Tar.Index">lookup</a></code> paths in the <code>tar</code> file, and then use <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntry" title="Codec.Archive.Tar.Index">hReadEntry</a></code> to
 seek to the right part of the file and read the entry.</p><p>An index cannot be used to lookup <code><a href="Codec-Archive-Tar-Entry.html#v:Directory" title="Codec.Archive.Tar.Entry">Directory</a></code> entries in a tar file;
 instead, you will get <code><a href="Codec-Archive-Tar-Index.html#v:TarDir" title="Codec.Archive.Tar.Index">TarDir</a></code> entry listing all the entries in the
 directory.</p></div><a href="#g:1" id="g:1"><h1>Index type</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TarIndex" class="def">TarIndex</a> <a href="src/Codec.Archive.Tar.Index.html#TarIndex" class="link">Source</a> <a href="#t:TarIndex" class="selflink">#</a></p><div class="doc"><p>An index of the entries in a tar file.</p><p>This index type is designed to be quite compact and suitable to store either
 on disk or in memory.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TarIndex">Instances</h4><details id="i:TarIndex" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TarIndex:Eq:1"></span> <a href="../base-4.14.3.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-172" class="link">Source</a> <a href="#t:TarIndex" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TarIndex:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TarIndex:Show:2"></span> <a href="../base-4.14.3.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-172" class="link">Source</a> <a href="#t:TarIndex" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TarIndex:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a>] -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TarIndex:NFData:3"></span> <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-174" class="link">Source</a> <a href="#t:TarIndex" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TarIndex:NFData:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Index lookup</h1></a><div class="top"><p class="src"><a id="v:lookup" class="def">lookup</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a> <a href="src/Codec.Archive.Tar.Index.html#lookup" class="link">Source</a> <a href="#v:lookup" class="selflink">#</a></p><div class="doc"><p>Look up a given filepath in the <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>. It may return a <code><a href="Codec-Archive-Tar-Index.html#v:TarFileEntry" title="Codec.Archive.Tar.Index">TarFileEntry</a></code>
 containing the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> of the file within the tar file, or if
 the filepath identifies a directory then it returns a <code><a href="Codec-Archive-Tar-Index.html#v:TarDir" title="Codec.Archive.Tar.Index">TarDir</a></code> containing
 the list of files within that directory.</p><p>Given the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> you can then use one of the I/O operations:</p><ul><li><code><a href="Codec-Archive-Tar-Index.html#v:hReadEntry" title="Codec.Archive.Tar.Index">hReadEntry</a></code> to read the whole entry;</li><li><code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeader" title="Codec.Archive.Tar.Index">hReadEntryHeader</a></code> to read just the file metadata (e.g. its length);</li></ul></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TarIndexEntry" class="def">TarIndexEntry</a> <a href="src/Codec.Archive.Tar.Index.html#TarIndexEntry" class="link">Source</a> <a href="#t:TarIndexEntry" class="selflink">#</a></p><div class="doc"><p>The result of <code><a href="Codec-Archive-Tar-Index.html#v:lookup" title="Codec.Archive.Tar.Index">lookup</a></code> in a <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>. It can either be a file directly,
 or a directory entry containing further entries (and all subdirectories
 recursively). Note that the subtrees are constructed lazily, so it's
 cheaper if you don't look at them.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TarFileEntry" class="def">TarFileEntry</a> !<a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TarDir" class="def">TarDir</a> [(<a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>, <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a>)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TarIndexEntry">Instances</h4><details id="i:TarIndexEntry" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TarIndexEntry:Show:1"></span> <a href="../base-4.14.3.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-184" class="link">Source</a> <a href="#t:TarIndexEntry" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TarIndexEntry:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a> -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Codec-Archive-Tar-Index.html#t:TarIndexEntry" title="Codec.Archive.Tar.Index">TarIndexEntry</a>] -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:toList" class="def">toList</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; [(<a href="../base-4.14.3.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a>, <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a>)] <a href="src/Codec.Archive.Tar.Index.html#toList" class="link">Source</a> <a href="#v:toList" class="selflink">#</a></p><div class="doc"><p>All the files in the index with their corresponding <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>s.</p><p>Note that the files are in no special order. If you intend to read all or
 most files then is is recommended to sort by the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>.</p></div></div><a href="#g:3" id="g:3"><h2>I/O operations</h2></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TarEntryOffset" class="def">TarEntryOffset</a> = <a href="../base-4.14.3.0/Data-Word.html#t:Word32" title="Data.Word">Word32</a> <a href="src/Codec.Archive.Tar.Index.html#TarEntryOffset" class="link">Source</a> <a href="#t:TarEntryOffset" class="selflink">#</a></p><div class="doc"><p>An offset within a tar file. Use <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntry" title="Codec.Archive.Tar.Index">hReadEntry</a></code>, <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeader" title="Codec.Archive.Tar.Index">hReadEntryHeader</a></code> or
 <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryOffset" title="Codec.Archive.Tar.Index">hSeekEntryOffset</a></code>.</p><p>This is actually a tar &quot;record&quot; number, not a byte offset.</p></div></div><div class="top"><p class="src"><a id="v:hReadEntry" class="def">hReadEntry</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> <a href="src/Codec.Archive.Tar.Index.html#hReadEntry" class="link">Source</a> <a href="#v:hReadEntry" class="selflink">#</a></p><div class="doc"><p>Reads an entire <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code> at the given <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> in the tar file.
 The <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> must be open for reading and be seekable.</p><p>This reads the whole entry into memory strictly, not incrementally. For more
 control, use <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeader" title="Codec.Archive.Tar.Index">hReadEntryHeader</a></code> and then read the entry content manually.</p></div></div><div class="top"><p class="src"><a id="v:hReadEntryHeader" class="def">hReadEntryHeader</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> <a href="src/Codec.Archive.Tar.Index.html#hReadEntryHeader" class="link">Source</a> <a href="#v:hReadEntryHeader" class="selflink">#</a></p><div class="doc"><p>Read the header for a <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code> at the given <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> in the tar
 file. The <code><a href="Codec-Archive-Tar-Entry.html#v:entryContent" title="Codec.Archive.Tar.Entry">entryContent</a></code> will contain the correct metadata but an empty file
 content. The <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> must be open for reading and be seekable.</p><p>The <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> position is advanced to the beginning of the entry content (if
 any). You must check the <code><a href="Codec-Archive-Tar-Entry.html#v:entryContent" title="Codec.Archive.Tar.Entry">entryContent</a></code> to see if the entry is of type
 <code><a href="Codec-Archive-Tar-Entry.html#v:NormalFile" title="Codec.Archive.Tar.Entry">NormalFile</a></code>. If it is, the <code><a href="Codec-Archive-Tar-Entry.html#v:NormalFile" title="Codec.Archive.Tar.Entry">NormalFile</a></code> gives the content length and you
 are free to read this much data from the <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code>.</p><pre>entry &lt;- Tar.hReadEntryHeader hnd
case Tar.entryContent entry of
  Tar.NormalFile _ size -&gt; do content &lt;- BS.hGet hnd size
                              ...</pre><p>Of course you don't have to read it all in one go (as <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntry" title="Codec.Archive.Tar.Index">hReadEntry</a></code> does),
 you can use any appropriate method to read it incrementally.</p><p>In addition to I/O errors, this can throw a <code><a href="Codec-Archive-Tar.html#t:FormatError" title="Codec.Archive.Tar">FormatError</a></code> if the offset is
 wrong, or if the file is not valid tar format.</p><p>There is also the lower level operation <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryOffset" title="Codec.Archive.Tar.Index">hSeekEntryOffset</a></code>.</p></div></div><a href="#g:4" id="g:4"><h1>Index construction</h1></a><div class="top"><p class="src"><a id="v:build" class="def">build</a> :: <a href="Codec-Archive-Tar.html#t:Entries" title="Codec.Archive.Tar">Entries</a> e -&gt; <a href="../base-4.14.3.0/Data-Either.html#t:Either" title="Data.Either">Either</a> e <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> <a href="src/Codec.Archive.Tar.Index.html#build" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p><div class="doc"><p>Build a <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> from a sequence of tar <code><a href="Codec-Archive-Tar.html#t:Entries" title="Codec.Archive.Tar">Entries</a></code>. The <code><a href="Codec-Archive-Tar.html#t:Entries" title="Codec.Archive.Tar">Entries</a></code> are
 assumed to start at offset <code>0</code> within a file.</p></div></div><a href="#g:5" id="g:5"><h2>Incremental construction</h2></a><div class="doc"><p>If you need more control than <code><a href="Codec-Archive-Tar-Index.html#v:build" title="Codec.Archive.Tar.Index">build</a></code> then you can construct the index
 in an acumulator style using the <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code> and operations.</p><p>Start with <code><a href="Codec-Archive-Tar-Index.html#v:empty" title="Codec.Archive.Tar.Index">empty</a></code> and use <code><a href="Codec-Archive-Tar-Index.html#v:addNextEntry" title="Codec.Archive.Tar.Index">addNextEntry</a></code> (or <code><a href="Codec-Archive-Tar-Index.html#v:skipNextEntry" title="Codec.Archive.Tar.Index">skipNextEntry</a></code>) for
 each <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code> in the tar file in order. Every entry must added or skipped in
 order, otherwise the resulting <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> will report the wrong
 <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>s. At the end use <code><a href="Codec-Archive-Tar-Index.html#v:finalise" title="Codec.Archive.Tar.Index">finalise</a></code> to get the <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>.</p><p>For example, <code><a href="Codec-Archive-Tar-Index.html#v:build" title="Codec.Archive.Tar.Index">build</a></code> is simply:</p><pre>build = go empty
  where
    go !builder (Next e es) = go (addNextEntry e builder) es
    go !builder  Done       = Right $! finalise builder
    go !_       (Fail err)  = Left err</pre></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:IndexBuilder" class="def">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#IndexBuilder" class="link">Source</a> <a href="#t:IndexBuilder" class="selflink">#</a></p><div class="doc"><p>The intermediate type used for incremental construction of a <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:IndexBuilder">Instances</h4><details id="i:IndexBuilder" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IndexBuilder:Eq:1"></span> <a href="../base-4.14.3.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-283" class="link">Source</a> <a href="#t:IndexBuilder" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IndexBuilder:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IndexBuilder:Show:2"></span> <a href="../base-4.14.3.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-283" class="link">Source</a> <a href="#t:IndexBuilder" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IndexBuilder:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a>] -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IndexBuilder:NFData:3"></span> <a href="../deepseq-1.4.4.0/Control-DeepSeq.html#t:NFData" title="Control.DeepSeq">NFData</a> <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></span> <a href="src/Codec.Archive.Tar.Index.html#line-285" class="link">Source</a> <a href="#t:IndexBuilder" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IndexBuilder:NFData:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Codec-Archive-Tar-Index.html">Codec.Archive.Tar.Index</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; () <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:empty" class="def">empty</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#empty" class="link">Source</a> <a href="#v:empty" class="selflink">#</a></p><div class="doc"><p>The initial empty <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:addNextEntry" class="def">addNextEntry</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#addNextEntry" class="link">Source</a> <a href="#v:addNextEntry" class="selflink">#</a></p><div class="doc"><p>Add the next <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code> into the <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:skipNextEntry" class="def">skipNextEntry</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#skipNextEntry" class="link">Source</a> <a href="#v:skipNextEntry" class="selflink">#</a></p><div class="doc"><p>Use this function if you want to skip some entries and not add them to the
 final <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:finalise" class="def">finalise</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> <a href="src/Codec.Archive.Tar.Index.html#finalise" class="link">Source</a> <a href="#v:finalise" class="selflink">#</a></p><div class="doc"><p>Finish accumulating <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code> information and build the compact <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>
 lookup structure.</p></div></div><div class="top"><p class="src"><a id="v:unfinalise" class="def">unfinalise</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#unfinalise" class="link">Source</a> <a href="#v:unfinalise" class="selflink">#</a></p><div class="doc"><p>Resume building an existing index</p><p>A <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> is optimized for a highly compact and efficient in-memory
 representation. This, however, makes it read-only. If you have an existing
 <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> for a large file, and want to add to it, you can translate the
 <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> back to an <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code>. Be aware that this is a relatively
 costly operation (linear in the size of the <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>), though still
 faster than starting again from scratch.</p><p>This is the left inverse to <code><a href="Codec-Archive-Tar-Index.html#v:finalise" title="Codec.Archive.Tar.Index">finalise</a></code> (modulo ordering).</p></div></div><a href="#g:6" id="g:6"><h1>Serialising indexes</h1></a><div class="top"><p class="src"><a id="v:serialise" class="def">serialise</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Codec.Archive.Tar.Index.html#serialise" class="link">Source</a> <a href="#v:serialise" class="selflink">#</a></p><div class="doc"><p>The <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> is compact in memory, and it has a similarly compact
 external representation.</p></div></div><div class="top"><p class="src"><a id="v:deserialise" class="def">deserialise</a> :: <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a>, <a href="../bytestring-0.10.12.0/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>) <a href="src/Codec.Archive.Tar.Index.html#deserialise" class="link">Source</a> <a href="#v:deserialise" class="selflink">#</a></p><div class="doc"><p>Read the external representation back into a <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code>.</p></div></div><a href="#g:7" id="g:7"><h1>Lower level operations with offsets and I/O on tar files</h1></a><div class="top"><p class="src"><a id="v:hReadEntryHeaderOrEof" class="def">hReadEntryHeaderOrEof</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a>, <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a>)) <a href="src/Codec.Archive.Tar.Index.html#hReadEntryHeaderOrEof" class="link">Source</a> <a href="#v:hReadEntryHeaderOrEof" class="selflink">#</a></p><div class="doc"><p>This is a low level variant on <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeader" title="Codec.Archive.Tar.Index">hReadEntryHeader</a></code>, that can be used to
 iterate through a tar file, entry by entry.</p><p>It has a few differences compared to <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeader" title="Codec.Archive.Tar.Index">hReadEntryHeader</a></code>:</p><ul><li>It returns an indication when the end of the tar file is reached.</li><li>It <em>does not</em> move the <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> position to the beginning of the entry
   content.</li><li>It returns the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> of the next entry.</li></ul><p>After this action, the <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> position is not in any useful place. If
 you want to skip to the next entry, take the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> returned and
 use <code><a href="Codec-Archive-Tar-Index.html#v:hReadEntryHeaderOrEof" title="Codec.Archive.Tar.Index">hReadEntryHeaderOrEof</a></code> again. Or if having inspected the <code><a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a></code>
 header you want to read the entry content (if it has one) then use
 <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryContentOffset" title="Codec.Archive.Tar.Index">hSeekEntryContentOffset</a></code> on the original input <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:hSeekEntryOffset" class="def">hSeekEntryOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Codec.Archive.Tar.Index.html#hSeekEntryOffset" class="link">Source</a> <a href="#v:hSeekEntryOffset" class="selflink">#</a></p><div class="doc"><p>Set the <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> position to the position corresponding to the given
 <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>.</p><p>This position is where the entry metadata can be read. If you already know
 the entry has a body (and perhaps know it's length), you may wish to seek to
 the body content directly using <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryContentOffset" title="Codec.Archive.Tar.Index">hSeekEntryContentOffset</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:hSeekEntryContentOffset" class="def">hSeekEntryContentOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Codec.Archive.Tar.Index.html#hSeekEntryContentOffset" class="link">Source</a> <a href="#v:hSeekEntryContentOffset" class="selflink">#</a></p><div class="doc"><p>Set the <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> position to the entry content position corresponding to
 the given <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>.</p><p>This position is where the entry content can be read using ordinary I/O
 operations (though you have to know in advance how big the entry content
 is). This is <em>only valid</em> if you <em>already know</em> the entry has a body (i.e.
 is a normal file).</p></div></div><div class="top"><p class="src"><a id="v:hSeekEndEntryOffset" class="def">hSeekEndEntryOffset</a> :: <a href="../base-4.14.3.0/GHC-IO-Handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> <a href="src/Codec.Archive.Tar.Index.html#hSeekEndEntryOffset" class="link">Source</a> <a href="#v:hSeekEndEntryOffset" class="selflink">#</a></p><div class="doc"><p>Seek to the end of a tar file, to the position where new entries can
 be appended, and return that <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code>.</p><p>If you have a valid <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> for this tar file then you should supply it
 because it allows seeking directly to the correct location.</p><p>If you do not have an index, then this becomes an expensive linear
 operation because we have to read each tar entry header from the beginning
 to find the location immediately after the last entry (this is because tar
 files have a variable length trailer and we cannot reliably find that by
 starting at the end). In this mode, it will fail with an exception if the
 file is not in fact in the tar format.</p></div></div><div class="top"><p class="src"><a id="v:nextEntryOffset" class="def">nextEntryOffset</a> :: <a href="Codec-Archive-Tar-Entry.html#t:Entry" title="Codec.Archive.Tar.Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> <a href="src/Codec.Archive.Tar.Index.html#nextEntryOffset" class="link">Source</a> <a href="#v:nextEntryOffset" class="selflink">#</a></p><div class="doc"><p>Calculate the <code><a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a></code> of the next entry, given the size and
 offset of the current entry.</p><p>This is much like using <code><a href="Codec-Archive-Tar-Index.html#v:skipNextEntry" title="Codec.Archive.Tar.Index">skipNextEntry</a></code> and <code><a href="Codec-Archive-Tar-Index.html#v:indexNextEntryOffset" title="Codec.Archive.Tar.Index">indexNextEntryOffset</a></code>, but without
 using an <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:indexEndEntryOffset" class="def">indexEndEntryOffset</a> :: <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> <a href="src/Codec.Archive.Tar.Index.html#indexEndEntryOffset" class="link">Source</a> <a href="#v:indexEndEntryOffset" class="selflink">#</a></p><div class="doc"><p>This is the offset immediately following the last entry in the tar file.
 This can be useful to append further entries into the tar file.
 Use with <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryOffset" title="Codec.Archive.Tar.Index">hSeekEntryOffset</a></code>, or just use <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEndEntryOffset" title="Codec.Archive.Tar.Index">hSeekEndEntryOffset</a></code> directly.</p></div></div><div class="top"><p class="src"><a id="v:indexNextEntryOffset" class="def">indexNextEntryOffset</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarEntryOffset" title="Codec.Archive.Tar.Index">TarEntryOffset</a> <a href="src/Codec.Archive.Tar.Index.html#indexNextEntryOffset" class="link">Source</a> <a href="#v:indexNextEntryOffset" class="selflink">#</a></p><div class="doc"><p>This is the offset immediately following the entry most recently added
 to the <code><a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a></code>. You might use this if you need to know the offsets
 but don't want to use the <code><a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a></code> lookup structure.
 Use with <code><a href="Codec-Archive-Tar-Index.html#v:hSeekEntryOffset" title="Codec.Archive.Tar.Index">hSeekEntryOffset</a></code>. See also <code><a href="Codec-Archive-Tar-Index.html#v:nextEntryOffset" title="Codec.Archive.Tar.Index">nextEntryOffset</a></code>.</p></div></div><a href="#g:8" id="g:8"><h1>Deprecated aliases</h1></a><div class="top"><p class="src"><a id="v:emptyIndex" class="def">emptyIndex</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> <a href="src/Codec.Archive.Tar.Index.html#emptyIndex" class="link">Source</a> <a href="#v:emptyIndex" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: Use TarIndex.empty</p></div></div></div><div class="top"><p class="src"><a id="v:finaliseIndex" class="def">finaliseIndex</a> :: <a href="Codec-Archive-Tar-Index.html#t:IndexBuilder" title="Codec.Archive.Tar.Index">IndexBuilder</a> -&gt; <a href="Codec-Archive-Tar-Index.html#t:TarIndex" title="Codec.Archive.Tar.Index">TarIndex</a> <a href="src/Codec.Archive.Tar.Index.html#finaliseIndex" class="link">Source</a> <a href="#v:finaliseIndex" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: Use TarIndex.finalise</p></div></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>