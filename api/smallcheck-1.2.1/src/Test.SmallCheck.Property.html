<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_AEkOG16Gwn65Vog3VxL0R8"><span id="%24tag2con_AEkOG16Gwn65Vog3VxL0R8"><span id="%24con2tag_AEkOG16Gwn65Vog3VxL0R8"></span></span></span><span class="hs-comment">-- vim:fdm=marker:foldtext=foldtext()</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module    : Test.SmallCheck.Property</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright : (c) Colin Runciman et al.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer: Roman Cheplyaka &lt;roma@ro-che.info&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Properties and tools to construct them.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE CPP                   #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable    #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Are we using new, polykinded and derivable Typeable yet?</span><span class="hs-cpp">
#define NEWTYPEABLE MIN_VERSION_base(4,7,0)
</span><span class="hs-cpp">
#if NEWTYPEABLE
</span><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- Trustworthy is needed because of the hand-written Typeable instance</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 704
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-32"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.SmallCheck.Property</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Constructors</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Test.SmallCheck.Property.html#forAll"><span class="hs-identifier">forAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#exists"><span class="hs-identifier">exists</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#existsUnique"><span class="hs-identifier">existsUnique</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#over"><span class="hs-identifier">over</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#%3D%3D%3E"><span class="hs-operator">(==&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#monadic"><span class="hs-identifier">monadic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#changeDepth"><span class="hs-identifier">changeDepth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#changeDepth1"><span class="hs-identifier">changeDepth1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Property's entrails</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertySuccess"><span class="hs-identifier">PropertySuccess</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertyFailure"><span class="hs-identifier">PropertyFailure</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#runProperty"><span class="hs-identifier">runProperty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#TestQuality"><span class="hs-identifier">TestQuality</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Argument"><span class="hs-identifier">Argument</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Reason"><span class="hs-identifier">Reason</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier">Depth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier">Testable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.SmallCheck.Series.html"><span class="hs-identifier">Test.SmallCheck.Series</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html"><span class="hs-identifier">Test.SmallCheck.SeriesMonad</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html"><span class="hs-identifier">Test.SmallCheck.Property.Result</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mzero</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Logic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadLogic</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runLogicT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ifte</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">once</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">msplit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lnot</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reader</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReader</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">local</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reader</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">pure</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;$)</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">

#if !NEWTYPEABLE
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Typeable1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mkTyConApp</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">typeOf</span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_base(4,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkTyCon3</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkTyCon</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-61"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Property-related types</span><span>
</span><span id="line-63"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-64"></span><span class="hs-comment">--{{{</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | The type of properties over the monad @m@.</span><span>
</span><span id="line-67"></span><span class="hs-keyword">newtype</span><span> </span><span id="Property"><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span> </span><span id="local-6989586621679059374"><span class="annot"><a href="#local-6989586621679059374"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Property"><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unProperty"><span class="annot"><span class="annottext">Property m -&gt; Reader (Env m) (PropertySeries m)
</span><a href="Test.SmallCheck.Property.html#unProperty"><span class="hs-identifier hs-var hs-var">unProperty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059374"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-type">PropertySeries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059374"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-cpp">
#if NEWTYPEABLE
</span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-72"></span><span class="hs-keyword">data</span><span> </span><span id="PropertySeries"><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span></span><span> </span><span id="local-6989586621679059379"><span class="annot"><a href="#local-6989586621679059379"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-73"></span><span>  </span><span id="PropertySeries"><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="searchExamples"><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059379"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertySuccess"><span class="hs-identifier hs-type">PropertySuccess</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="searchCounterExamples"><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059379"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertyFailure"><span class="hs-identifier hs-type">PropertyFailure</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="searchClosest"><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m (Property m, [Argument])
</span><a href="Test.SmallCheck.Property.html#searchClosest"><span class="hs-identifier hs-var hs-var">searchClosest</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059379"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059379"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="Env"><span class="annot"><a href="Test.SmallCheck.Property.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span id="local-6989586621679059375"><span class="annot"><a href="#local-6989586621679059375"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span id="Env"><span class="annot"><a href="Test.SmallCheck.Property.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="quantification"><span class="annot"><span class="annottext">Env m -&gt; Quantification
</span><a href="Test.SmallCheck.Property.html#quantification"><span class="hs-identifier hs-var hs-var">quantification</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Quantification"><span class="hs-identifier hs-type">Quantification</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="testHook"><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#TestQuality"><span class="hs-identifier hs-type">TestQuality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059375"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">data</span><span> </span><span id="Quantification"><span class="annot"><a href="Test.SmallCheck.Property.html#Quantification"><span class="hs-identifier hs-var">Quantification</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Forall"><span class="annot"><a href="Test.SmallCheck.Property.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Exists"><span class="annot"><a href="Test.SmallCheck.Property.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExistsUnique"><span class="annot"><a href="Test.SmallCheck.Property.html#ExistsUnique"><span class="hs-identifier hs-var">ExistsUnique</span></a></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">data</span><span> </span><span id="TestQuality"><span class="annot"><a href="Test.SmallCheck.Property.html#TestQuality"><span class="hs-identifier hs-var">TestQuality</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GoodTest"><span class="annot"><a href="Test.SmallCheck.Property.html#GoodTest"><span class="hs-identifier hs-var">GoodTest</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BadTest"><span class="annot"><a href="Test.SmallCheck.Property.html#BadTest"><span class="hs-identifier hs-var">BadTest</span></a></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059217"><span id="local-6989586621679059219"><span class="annot"><span class="annottext">TestQuality -&gt; TestQuality -&gt; Bool
(TestQuality -&gt; TestQuality -&gt; Bool)
-&gt; (TestQuality -&gt; TestQuality -&gt; Bool) -&gt; Eq TestQuality
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TestQuality -&gt; TestQuality -&gt; Bool
$c/= :: TestQuality -&gt; TestQuality -&gt; Bool
== :: TestQuality -&gt; TestQuality -&gt; Bool
$c== :: TestQuality -&gt; TestQuality -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059201"><span id="local-6989586621679059203"><span id="local-6989586621679059205"><span id="local-6989586621679059207"><span id="local-6989586621679059209"><span id="local-6989586621679059211"><span id="local-6989586621679059213"><span class="annot"><span class="annottext">Eq TestQuality
Eq TestQuality
-&gt; (TestQuality -&gt; TestQuality -&gt; Ordering)
-&gt; (TestQuality -&gt; TestQuality -&gt; Bool)
-&gt; (TestQuality -&gt; TestQuality -&gt; Bool)
-&gt; (TestQuality -&gt; TestQuality -&gt; Bool)
-&gt; (TestQuality -&gt; TestQuality -&gt; Bool)
-&gt; (TestQuality -&gt; TestQuality -&gt; TestQuality)
-&gt; (TestQuality -&gt; TestQuality -&gt; TestQuality)
-&gt; Ord TestQuality
TestQuality -&gt; TestQuality -&gt; Bool
TestQuality -&gt; TestQuality -&gt; Ordering
TestQuality -&gt; TestQuality -&gt; TestQuality
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TestQuality -&gt; TestQuality -&gt; TestQuality
$cmin :: TestQuality -&gt; TestQuality -&gt; TestQuality
max :: TestQuality -&gt; TestQuality -&gt; TestQuality
$cmax :: TestQuality -&gt; TestQuality -&gt; TestQuality
&gt;= :: TestQuality -&gt; TestQuality -&gt; Bool
$c&gt;= :: TestQuality -&gt; TestQuality -&gt; Bool
&gt; :: TestQuality -&gt; TestQuality -&gt; Bool
$c&gt; :: TestQuality -&gt; TestQuality -&gt; Bool
&lt;= :: TestQuality -&gt; TestQuality -&gt; Bool
$c&lt;= :: TestQuality -&gt; TestQuality -&gt; Bool
&lt; :: TestQuality -&gt; TestQuality -&gt; Bool
$c&lt; :: TestQuality -&gt; TestQuality -&gt; Bool
compare :: TestQuality -&gt; TestQuality -&gt; Ordering
$ccompare :: TestQuality -&gt; TestQuality -&gt; Ordering
$cp1Ord :: Eq TestQuality
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059184"><span id="local-6989586621679059186"><span id="local-6989586621679059188"><span id="local-6989586621679059190"><span id="local-6989586621679059192"><span id="local-6989586621679059194"><span id="local-6989586621679059196"><span id="local-6989586621679059198"><span class="annot"><span class="annottext">Int -&gt; TestQuality
TestQuality -&gt; Int
TestQuality -&gt; [TestQuality]
TestQuality -&gt; TestQuality
TestQuality -&gt; TestQuality -&gt; [TestQuality]
TestQuality -&gt; TestQuality -&gt; TestQuality -&gt; [TestQuality]
(TestQuality -&gt; TestQuality)
-&gt; (TestQuality -&gt; TestQuality)
-&gt; (Int -&gt; TestQuality)
-&gt; (TestQuality -&gt; Int)
-&gt; (TestQuality -&gt; [TestQuality])
-&gt; (TestQuality -&gt; TestQuality -&gt; [TestQuality])
-&gt; (TestQuality -&gt; TestQuality -&gt; [TestQuality])
-&gt; (TestQuality -&gt; TestQuality -&gt; TestQuality -&gt; [TestQuality])
-&gt; Enum TestQuality
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: TestQuality -&gt; TestQuality -&gt; TestQuality -&gt; [TestQuality]
$cenumFromThenTo :: TestQuality -&gt; TestQuality -&gt; TestQuality -&gt; [TestQuality]
enumFromTo :: TestQuality -&gt; TestQuality -&gt; [TestQuality]
$cenumFromTo :: TestQuality -&gt; TestQuality -&gt; [TestQuality]
enumFromThen :: TestQuality -&gt; TestQuality -&gt; [TestQuality]
$cenumFromThen :: TestQuality -&gt; TestQuality -&gt; [TestQuality]
enumFrom :: TestQuality -&gt; [TestQuality]
$cenumFrom :: TestQuality -&gt; [TestQuality]
fromEnum :: TestQuality -&gt; Int
$cfromEnum :: TestQuality -&gt; Int
toEnum :: Int -&gt; TestQuality
$ctoEnum :: Int -&gt; TestQuality
pred :: TestQuality -&gt; TestQuality
$cpred :: TestQuality -&gt; TestQuality
succ :: TestQuality -&gt; TestQuality
$csucc :: TestQuality -&gt; TestQuality
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059177"><span id="local-6989586621679059179"><span id="local-6989586621679059181"><span class="annot"><span class="annottext">Int -&gt; TestQuality -&gt; ShowS
[TestQuality] -&gt; ShowS
TestQuality -&gt; Argument
(Int -&gt; TestQuality -&gt; ShowS)
-&gt; (TestQuality -&gt; Argument)
-&gt; ([TestQuality] -&gt; ShowS)
-&gt; Show TestQuality
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; Argument) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TestQuality] -&gt; ShowS
$cshowList :: [TestQuality] -&gt; ShowS
show :: TestQuality -&gt; Argument
$cshow :: TestQuality -&gt; Argument
showsPrec :: Int -&gt; TestQuality -&gt; ShowS
$cshowsPrec :: Int -&gt; TestQuality -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span class="hs-cpp">

#if !NEWTYPEABLE
</span><span class="hs-comment">-- Typeable here is not polykinded yet, and also GHC doesn't know how to</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- derive this.</span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable1</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Property</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-identifier">typeOf</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-identifier">mkTyConApp</span><span class="hs-cpp">
#if MIN_VERSION_base(4,4,0)
</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">mkTyCon3</span><span> </span><span class="hs-string">&quot;smallcheck&quot;</span><span> </span><span class="hs-string">&quot;Test.SmallCheck.Property&quot;</span><span> </span><span class="hs-string">&quot;Property&quot;</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">mkTyCon</span><span> </span><span class="hs-string">&quot;smallcheck Test.SmallCheck.Property Property&quot;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>        </span><span class="hs-special">[</span><span class="hs-identifier">typeOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Property runners and constructors</span><span>
</span><span id="line-114"></span><span class="hs-comment">------------------------------------</span><span>
</span><span id="line-115"></span><span class="hs-comment">--{{{</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679059352"><span class="annot"><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-type">unProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059352"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059352"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-type">PropertySeries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059352"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-118"></span><span id="unProp"><span class="annot"><span class="annottext">unProp :: Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var hs-var">unProp</span></a></span></span><span> </span><span id="local-6989586621679059174"><span class="annot"><span class="annottext">Env t
</span><a href="#local-6989586621679059174"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679059173"><span class="annot"><span class="annottext">Reader (Env t) (PropertySeries t)
</span><a href="#local-6989586621679059173"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env t) (PropertySeries t) -&gt; Env t -&gt; PropertySeries t
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="annot"><span class="annottext">Reader (Env t) (PropertySeries t)
</span><a href="#local-6989586621679059173"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Env t
</span><a href="#local-6989586621679059174"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679059172"><span class="annot"><a href="Test.SmallCheck.Property.html#runProperty"><span class="hs-identifier hs-type">runProperty</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059172"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#TestQuality"><span class="hs-identifier hs-type">TestQuality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059172"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059172"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059172"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertyFailure"><span class="hs-identifier hs-type">PropertyFailure</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-126"></span><span id="runProperty"><span class="annot"><span class="annottext">runProperty :: Int
-&gt; (TestQuality -&gt; m ()) -&gt; Property m -&gt; m (Maybe PropertyFailure)
</span><a href="Test.SmallCheck.Property.html#runProperty"><span class="hs-identifier hs-var hs-var">runProperty</span></a></span></span><span> </span><span id="local-6989586621679059171"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059171"><span class="hs-identifier hs-var">depth</span></a></span></span><span> </span><span id="local-6989586621679059170"><span class="annot"><span class="annottext">TestQuality -&gt; m ()
</span><a href="#local-6989586621679059170"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span id="local-6989586621679059169"><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059169"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059168"><span class="annot"><span class="annottext">LogicT m PropertyFailure
</span><a href="#local-6989586621679059168"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LogicT m PropertyFailure
-&gt; (PropertyFailure
    -&gt; m (Maybe PropertyFailure) -&gt; m (Maybe PropertyFailure))
-&gt; m (Maybe PropertyFailure)
-&gt; m (Maybe PropertyFailure)
forall (m :: * -&gt; *) a r.
LogicT m a -&gt; (a -&gt; m r -&gt; m r) -&gt; m r -&gt; m r
</span><span class="hs-identifier hs-var">runLogicT</span></span><span> </span><span class="annot"><span class="annottext">LogicT m PropertyFailure
</span><a href="#local-6989586621679059168"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059167"><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059167"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">m (Maybe PropertyFailure)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PropertyFailure -&gt; m (Maybe PropertyFailure)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PropertyFailure -&gt; m (Maybe PropertyFailure))
-&gt; Maybe PropertyFailure -&gt; m (Maybe PropertyFailure)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Maybe PropertyFailure
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059167"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PropertyFailure -&gt; m (Maybe PropertyFailure)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe PropertyFailure
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogicT m PropertyFailure -&gt; m (Maybe PropertyFailure))
-&gt; LogicT m PropertyFailure -&gt; m (Maybe PropertyFailure)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Series m PropertyFailure -&gt; LogicT m PropertyFailure
forall (m :: * -&gt; *) a. Int -&gt; Series m a -&gt; LogicT m a
</span><a href="Test.SmallCheck.SeriesMonad.html#runSeries"><span class="hs-identifier hs-var">runSeries</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059171"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">(Series m PropertyFailure -&gt; LogicT m PropertyFailure)
-&gt; Series m PropertyFailure -&gt; LogicT m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertyFailure)
-&gt; PropertySeries m -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Env m -&gt; PropertySeries m)
-&gt; Env m -&gt; Reader (Env m) (PropertySeries m) -&gt; PropertySeries m
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Env m -&gt; PropertySeries m
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantification -&gt; (TestQuality -&gt; m ()) -&gt; Env m
forall (m :: * -&gt; *).
Quantification -&gt; (TestQuality -&gt; m ()) -&gt; Env m
</span><a href="Test.SmallCheck.Property.html#Env"><span class="hs-identifier hs-var">Env</span></a></span><span> </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality -&gt; m ()
</span><a href="#local-6989586621679059170"><span class="hs-identifier hs-var">hook</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">Property m -&gt; Reader (Env m) (PropertySeries m)
forall (m :: * -&gt; *).
Property m -&gt; Reader (Env m) (PropertySeries m)
</span><a href="Test.SmallCheck.Property.html#unProperty"><span class="hs-identifier hs-var hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059169"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679059366"><span class="annot"><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-type">atomicProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059366"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertySuccess"><span class="hs-identifier hs-type">PropertySuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059366"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#PropertyFailure"><span class="hs-identifier hs-type">PropertyFailure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-type">PropertySeries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059366"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-134"></span><span id="atomicProperty"><span class="annot"><span class="annottext">atomicProperty :: Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var hs-var">atomicProperty</span></a></span></span><span> </span><span id="local-6989586621679059163"><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059163"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679059162"><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059161"><span class="annot"><span class="annottext">prop :: PropertySeries m
</span><a href="#local-6989586621679059161"><span class="hs-identifier hs-var hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059163"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059162"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Property m, [Argument]) -&gt; Series m (Property m, [Argument])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Reader (Env m) (PropertySeries m)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059161"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059161"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679059294"><span class="annot"><a href="Test.SmallCheck.Property.html#makeAtomic"><span class="hs-identifier hs-type">makeAtomic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059294"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059294"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-139"></span><span id="makeAtomic"><span class="annot"><span class="annottext">makeAtomic :: Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#makeAtomic"><span class="hs-identifier hs-var hs-var">makeAtomic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679059159"><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m)
</span><a href="#local-6989586621679059159"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((PropertySeries m -&gt; PropertySeries m)
 -&gt; Reader (Env m) (PropertySeries m)
 -&gt; Reader (Env m) (PropertySeries m))
-&gt; Reader (Env m) (PropertySeries m)
-&gt; (PropertySeries m -&gt; PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m)
</span><a href="#local-6989586621679059159"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">((PropertySeries m -&gt; PropertySeries m)
 -&gt; Reader (Env m) (PropertySeries m))
-&gt; (PropertySeries m -&gt; PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059158"><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059158"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var">atomicProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059158"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059158"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | @'over' s $ \\x -&gt; p x@ makes @x@ range over the 'Series' @s@ (by</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- default, all variables range over the 'series' for their types).</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Note that, unlike the quantification operators, this affects only the</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- variable following the operator and not subsequent variables.</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- 'over' does not affect the quantification context.</span><span>
</span><span id="line-150"></span><span id="local-6989586621679059155"><span id="local-6989586621679059156"><span id="local-6989586621679059157"><span class="annot"><a href="Test.SmallCheck.Property.html#over"><span class="hs-identifier hs-type">over</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059157"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059156"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059155"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059156"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059157"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059157"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059155"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059156"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-153"></span><span id="over"><span class="annot"><span class="annottext">over :: Series m a -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#over"><span class="hs-identifier hs-var hs-var">over</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series m a -&gt; (a -&gt; b) -&gt; Property m
forall a (m :: * -&gt; *) b.
(Show a, Testable m b) =&gt;
Series m a -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#testFunction"><span class="hs-identifier hs-var">testFunction</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Execute a monadic test.</span><span>
</span><span id="line-156"></span><span id="local-6989586621679059152"><span id="local-6989586621679059153"><span class="annot"><a href="Test.SmallCheck.Property.html#monadic"><span class="hs-identifier hs-type">monadic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059153"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059153"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059153"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-157"></span><span id="monadic"><span class="annot"><span class="annottext">monadic :: m a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#monadic"><span class="hs-identifier hs-var hs-var">monadic</span></a></span></span><span> </span><span id="local-6989586621679059151"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059151"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">reader</span></span><span> </span><span class="annot"><span class="annottext">((Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m))
-&gt; (Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059150"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059150"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059149"><span class="annot"><span class="annottext">pair :: Series m (PropertySeries m)
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var hs-var">pair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059150"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m)
-&gt; (a -&gt; Property m) -&gt; a -&gt; PropertySeries m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#freshContext"><span class="hs-identifier hs-var">freshContext</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PropertySeries m)
-&gt; Series m a -&gt; Series m (PropertySeries m)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; Series m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059151"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var">atomicProperty</span></a></span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertySuccess)
-&gt; Series m (PropertySeries m) -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Series m (PropertySeries m)
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertyFailure)
-&gt; Series m (PropertySeries m) -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Series m (PropertySeries m)
</span><a href="#local-6989586621679059149"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-------------------------------</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Testable class and instances</span><span>
</span><span id="line-170"></span><span class="hs-comment">-------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Class of tests that can be run in a monad. For pure tests, it is</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- recommended to keep their types polymorphic in @m@ rather than</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- specialising it to 'Data.Functor.Identity'.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059335"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Testable"><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-var">Testable</span></a></span></span><span> </span><span id="local-6989586621679059335"><span class="annot"><a href="#local-6989586621679059335"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679059334"><span class="annot"><a href="#local-6989586621679059334"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="test"><span class="annot"><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-type">test</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679059334"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059335"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679059144"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679059140"><span class="annot"><span class="annottext">test :: Bool -&gt; Property m
</span><a href="#local-6989586621679059140"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679059139"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059139"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">reader</span></span><span> </span><span class="annot"><span class="annottext">((Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m))
-&gt; (Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059138"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059138"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-182"></span><span>      </span><span id="local-6989586621679059137"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059137"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">m () -&gt; Series m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; Series m ()) -&gt; m () -&gt; Series m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
forall (m :: * -&gt; *). Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059138"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality
</span><a href="Test.SmallCheck.Property.html#GoodTest"><span class="hs-identifier hs-var">GoodTest</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679059139"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertySuccess -&gt; Series m PropertySuccess)
-&gt; PropertySuccess -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Argument -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#PropertyTrue"><span class="hs-identifier hs-var">PropertyTrue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Argument
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679059135"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059135"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Argument -&gt; PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#PropertyFalse"><span class="hs-identifier hs-var">PropertyFalse</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Argument
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m () -&gt; Series m PropertyFailure
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess -&gt; Series m ()
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">lnot</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059137"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var">atomicProperty</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059137"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059135"><span class="hs-identifier hs-var">failure</span></a></span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Works like the 'Bool' instance, but includes an explanation of the result.</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- 'Left' and 'Right' correspond to test failure and success</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- respectively.</span><span>
</span><span id="line-192"></span><span id="local-6989586621679059133"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059133"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059133"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Reason"><span class="hs-identifier hs-type">Reason</span></a></span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Reason"><span class="hs-identifier hs-type">Reason</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679059130"><span class="annot"><span class="annottext">test :: Either Argument Argument -&gt; Property m
</span><a href="#local-6989586621679059130"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679059129"><span class="annot"><span class="annottext">Either Argument Argument
</span><a href="#local-6989586621679059129"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">reader</span></span><span> </span><span class="annot"><span class="annottext">((Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m))
-&gt; (Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059128"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059128"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621679059127"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059127"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">m () -&gt; Series m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; Series m ()) -&gt; m () -&gt; Series m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
forall (m :: * -&gt; *). Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059128"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality
</span><a href="Test.SmallCheck.Property.html#GoodTest"><span class="hs-identifier hs-var">GoodTest</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">(Argument -&gt; Series m PropertySuccess)
-&gt; (Argument -&gt; Series m PropertySuccess)
-&gt; Either Argument Argument
-&gt; Series m PropertySuccess
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Series m PropertySuccess -&gt; Argument -&gt; Series m PropertySuccess
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m PropertySuccess
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PropertySuccess -&gt; Series m PropertySuccess)
-&gt; (Argument -&gt; PropertySuccess)
-&gt; Argument
-&gt; Series m PropertySuccess
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe Argument -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#PropertyTrue"><span class="hs-identifier hs-var">PropertyTrue</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Argument -&gt; PropertySuccess)
-&gt; (Argument -&gt; Maybe Argument) -&gt; Argument -&gt; PropertySuccess
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Argument -&gt; Maybe Argument
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either Argument Argument
</span><a href="#local-6989586621679059129"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span id="local-6989586621679059124"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">m () -&gt; Series m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; Series m ()) -&gt; m () -&gt; Series m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
forall (m :: * -&gt; *). Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059128"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality
</span><a href="Test.SmallCheck.Property.html#GoodTest"><span class="hs-identifier hs-var">GoodTest</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">(Argument -&gt; Series m PropertyFailure)
-&gt; (Argument -&gt; Series m PropertyFailure)
-&gt; Either Argument Argument
-&gt; Series m PropertyFailure
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m PropertyFailure
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PropertyFailure -&gt; Series m PropertyFailure)
-&gt; (Argument -&gt; PropertyFailure)
-&gt; Argument
-&gt; Series m PropertyFailure
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe Argument -&gt; PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#PropertyFalse"><span class="hs-identifier hs-var">PropertyFalse</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Argument -&gt; PropertyFailure)
-&gt; (Argument -&gt; Maybe Argument) -&gt; Argument -&gt; PropertyFailure
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Argument -&gt; Maybe Argument
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Series m PropertyFailure -&gt; Argument -&gt; Series m PropertyFailure
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either Argument Argument
</span><a href="#local-6989586621679059129"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var">atomicProperty</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059127"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059124"><span class="hs-identifier hs-var">failure</span></a></span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679059121"><span id="local-6989586621679059122"><span id="local-6989586621679059123"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059122"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059122"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059121"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059123"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059122"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679059121"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679059118"><span class="annot"><span class="annottext">test :: (a -&gt; b) -&gt; Property m
</span><a href="#local-6989586621679059118"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series m a -&gt; (a -&gt; b) -&gt; Property m
forall a (m :: * -&gt; *) b.
(Show a, Testable m b) =&gt;
Series m a -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#testFunction"><span class="hs-identifier hs-var">testFunction</span></a></span><span> </span><span class="annot"><span class="annottext">Series m a
forall (m :: * -&gt; *) a. Serial m a =&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a></span></span></span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span id="local-6989586621679059115"><span id="local-6989586621679059116"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679059116"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059116"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679059115"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059115"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059116"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679059112"><span class="annot"><span class="annottext">test :: Property m -&gt; Property n
</span><a href="#local-6989586621679059112"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Property m -&gt; Property n
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span></span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679059360"><span id="local-6989586621679059361"><span id="local-6989586621679059362"><span class="annot"><a href="Test.SmallCheck.Property.html#testFunction"><span class="hs-identifier hs-type">testFunction</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059362"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059361"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059360"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Series"><span class="hs-identifier hs-type">Series</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059361"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059362"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059362"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059360"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059361"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-212"></span><span id="testFunction"><span class="annot"><span class="annottext">testFunction :: Series m a -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#testFunction"><span class="hs-identifier hs-var hs-var">testFunction</span></a></span></span><span> </span><span id="local-6989586621679059110"><span class="annot"><span class="annottext">Series m a
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679059109"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">reader</span></span><span> </span><span class="annot"><span class="annottext">((Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m))
-&gt; (Env m -&gt; PropertySeries m) -&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679059108"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679059107"><span class="annot"><span class="annottext">closest :: Series m (Property m, [Argument])
</span><a href="#local-6989586621679059107"><span class="hs-identifier hs-var hs-var">closest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621679059106"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Series m a
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679059105"><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059105"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059104"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059104"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m (Property m, [Argument])
forall (m :: * -&gt; *).
PropertySeries m -&gt; Series m (Property m, [Argument])
</span><a href="Test.SmallCheck.Property.html#searchClosest"><span class="hs-identifier hs-var hs-var">searchClosest</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m (Property m, [Argument]))
-&gt; PropertySeries m -&gt; Series m (Property m, [Argument])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Property m) -&gt; b -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">(Property m, [Argument]) -&gt; Series m (Property m, [Argument])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059105"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Argument
forall a. Show a =&gt; a -&gt; Argument
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059106"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Argument -&gt; [Argument] -&gt; [Argument]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059104"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Quantification
forall (m :: * -&gt; *). Env m -&gt; Quantification
</span><a href="Test.SmallCheck.Property.html#quantification"><span class="hs-identifier hs-var hs-var">quantification</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059102"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059101"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059107"><span class="hs-identifier hs-var">closest</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621679059101"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059101"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>          </span><span id="local-6989586621679059100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059100"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Series m a
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-226"></span><span>          </span><span id="local-6989586621679059099"><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059099"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertyFailure)
-&gt; PropertySeries m -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Property m) -&gt; b -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059100"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059098"><span class="annot"><span class="annottext">arg :: Argument
</span><a href="#local-6989586621679059098"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Argument
forall a. Show a =&gt; a -&gt; Argument
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059100"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-228"></span><span>          </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertyFailure -&gt; Series m PropertyFailure)
-&gt; PropertyFailure -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059099"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#CounterExample"><span class="hs-identifier hs-type">CounterExample</span></a></span><span> </span><span id="local-6989586621679059096"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059096"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679059095"><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059095"><span class="hs-identifier hs-var">etc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; PropertyFailure -&gt; PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#CounterExample"><span class="hs-identifier hs-var">CounterExample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679059098"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Argument -&gt; [Argument] -&gt; [Argument]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059096"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059095"><span class="hs-identifier hs-var">etc</span></a></span><span>
</span><span id="line-231"></span><span>              </span><span class="annot"><span class="annottext">PropertyFailure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; PropertyFailure -&gt; PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#CounterExample"><span class="hs-identifier hs-var">CounterExample</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679059098"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059099"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>        </span><span id="local-6989586621679059102"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059102"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Argument -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#PropertyTrue"><span class="hs-identifier hs-var">PropertyTrue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Argument
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m () -&gt; Series m PropertySuccess
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure -&gt; Series m ()
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">lnot</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059101"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059094"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059093"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059107"><span class="hs-identifier hs-var">closest</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621679059094"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059094"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>          </span><span id="local-6989586621679059092"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059092"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Series m a
</span><a href="#local-6989586621679059110"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-241"></span><span>          </span><span id="local-6989586621679059091"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059091"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertySuccess)
-&gt; PropertySeries m -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Property m) -&gt; b -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679059109"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059092"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-242"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679059090"><span class="annot"><span class="annottext">arg :: Argument
</span><a href="#local-6989586621679059090"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Argument
forall a. Show a =&gt; a -&gt; Argument
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059092"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>          </span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertySuccess -&gt; Series m PropertySuccess)
-&gt; PropertySuccess -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059091"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>              </span><span class="annot"><a href="Test.SmallCheck.Property.Result.html#Exist"><span class="hs-identifier hs-type">Exist</span></a></span><span> </span><span id="local-6989586621679059088"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059088"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679059087"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059087"><span class="hs-identifier hs-var">etc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; PropertySuccess -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#Exist"><span class="hs-identifier hs-var">Exist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679059090"><span class="hs-identifier hs-var">arg</span></a></span><span class="annot"><span class="annottext">Argument -&gt; [Argument] -&gt; [Argument]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059088"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059087"><span class="hs-identifier hs-var">etc</span></a></span><span>
</span><span id="line-247"></span><span>              </span><span class="annot"><span class="annottext">PropertySuccess
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; PropertySuccess -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#Exist"><span class="hs-identifier hs-var">Exist</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679059090"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059091"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>        </span><span id="local-6989586621679059093"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059093"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#NotExist"><span class="hs-identifier hs-var">NotExist</span></a></span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m () -&gt; Series m PropertyFailure
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess -&gt; Series m ()
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">lnot</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059094"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#ExistsUnique"><span class="hs-identifier hs-var">ExistsUnique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059085"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059084"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059107"><span class="hs-identifier hs-var">closest</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>        </span><span id="local-6989586621679059083"><span class="annot"><span class="annottext">search :: Series m [([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059083"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Series m ([Argument], PropertySuccess)
-&gt; Series m [([Argument], PropertySuccess)]
forall (m :: * -&gt; *) a. MonadLogic m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="Test.SmallCheck.Property.html#atMost"><span class="hs-identifier hs-var">atMost</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Series m ([Argument], PropertySuccess)
 -&gt; Series m [([Argument], PropertySuccess)])
-&gt; Series m ([Argument], PropertySuccess)
-&gt; Series m [([Argument], PropertySuccess)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679059081"><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059081"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679059080"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059080"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059107"><span class="hs-identifier hs-var">closest</span></a></span><span>
</span><span id="line-257"></span><span>          </span><span id="local-6989586621679059079"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059079"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">once</span></span><span> </span><span class="annot"><span class="annottext">(Series m PropertySuccess -&gt; Series m PropertySuccess)
-&gt; Series m PropertySuccess -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertySuccess)
-&gt; PropertySeries m -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059108"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Property m -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">Property m
</span><a href="#local-6989586621679059081"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-258"></span><span>          </span><span class="annot"><span class="annottext">([Argument], PropertySuccess)
-&gt; Series m ([Argument], PropertySuccess)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059080"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059079"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679059085"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059085"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>          </span><span class="annot"><span class="annottext">Series m [([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059083"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Series m [([Argument], PropertySuccess)]
-&gt; ([([Argument], PropertySuccess)] -&gt; Series m PropertySuccess)
-&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-glyph">\</span><span id="local-6989586621679059078"><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059078"><span class="hs-identifier hs-var">examples</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059078"><span class="hs-identifier hs-var">examples</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-264"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679059077"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059077"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059076"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059076"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertySuccess -&gt; Series m PropertySuccess)
-&gt; PropertySuccess -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; PropertySuccess -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#ExistUnique"><span class="hs-identifier hs-var">ExistUnique</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059077"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059076"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>        </span><span id="local-6989586621679059084"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059084"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">Series m [([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059083"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Series m [([Argument], PropertySuccess)]
-&gt; ([([Argument], PropertySuccess)] -&gt; Series m PropertyFailure)
-&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span>
</span><span id="line-269"></span><span>            </span><span class="hs-glyph">\</span><span id="local-6989586621679059074"><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059074"><span class="hs-identifier hs-var">examples</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><a href="#local-6989586621679059074"><span class="hs-identifier hs-var">examples</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-271"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#NotExist"><span class="hs-identifier hs-var">NotExist</span></a></span><span>
</span><span id="line-272"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679059073"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059073"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059072"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059072"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679059071"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059070"><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059070"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertyFailure -&gt; Series m PropertyFailure)
-&gt; PropertyFailure -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Argument]
-&gt; PropertySuccess
-&gt; [Argument]
-&gt; PropertySuccess
-&gt; PropertyFailure
</span><a href="Test.SmallCheck.Property.Result.html#AtLeastTwo"><span class="hs-identifier hs-var">AtLeastTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059073"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059072"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679059071"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySuccess
</span><a href="#local-6989586621679059070"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-273"></span><span>                </span><span class="annot"><span class="annottext">[([Argument], PropertySuccess)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621679059306"><span id="local-6989586621679059307"><span class="annot"><a href="Test.SmallCheck.Property.html#atMost"><span class="hs-identifier hs-type">atMost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadLogic</span></span><span> </span><span class="annot"><a href="#local-6989586621679059307"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059307"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059306"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059307"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059306"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-277"></span><span id="atMost"><span class="annot"><span class="annottext">atMost :: Int -&gt; m a -&gt; m [a]
</span><a href="Test.SmallCheck.Property.html#atMost"><span class="hs-identifier hs-var hs-var">atMost</span></a></span></span><span> </span><span id="local-6989586621679059068"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059068"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679059067"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059067"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059068"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>      </span><span id="local-6989586621679059065"><span class="annot"><span class="annottext">Maybe (a, m a)
</span><a href="#local-6989586621679059065"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a -&gt; m (Maybe (a, m a))
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m (Maybe (a, m a))
</span><span class="hs-identifier hs-var">msplit</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059067"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, m a)
</span><a href="#local-6989586621679059065"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Maybe (a, m a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059064"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059063"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059063"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059064"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a] -&gt; m [a]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m a -&gt; m [a]
forall (m :: * -&gt; *) a. MonadLogic m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="Test.SmallCheck.Property.html#atMost"><span class="hs-identifier hs-var">atMost</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679059068"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679059063"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- Test constructors</span><span>
</span><span id="line-290"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621679059288"><span class="annot"><a href="Test.SmallCheck.Property.html#quantify"><span class="hs-identifier hs-type">quantify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Quantification"><span class="hs-identifier hs-type">Quantification</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059288"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059288"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-294"></span><span id="quantify"><span class="annot"><span class="annottext">quantify :: Quantification -&gt; Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#quantify"><span class="hs-identifier hs-var hs-var">quantify</span></a></span></span><span> </span><span id="local-6989586621679059061"><span class="annot"><span class="annottext">Quantification
</span><a href="#local-6989586621679059061"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span id="local-6989586621679059060"><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m)
</span><a href="#local-6989586621679059060"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><span class="annottext">Property m -&gt; Property m
forall (m :: * -&gt; *). Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#makeAtomic"><span class="hs-identifier hs-var">makeAtomic</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; Property m) -&gt; Property m -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Env m -&gt; Env m)
-&gt; Reader (Env m) (PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059059"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059059"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059059"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quantification :: Quantification
</span><a href="Test.SmallCheck.Property.html#quantification"><span class="hs-identifier hs-var">quantification</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantification
</span><a href="#local-6989586621679059061"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m)
</span><a href="#local-6989586621679059060"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span id="local-6989586621679059347"><span id="local-6989586621679059348"><span class="annot"><a href="Test.SmallCheck.Property.html#freshContext"><span class="hs-identifier hs-type">freshContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059348"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059348"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-298"></span><span id="freshContext"><span class="annot"><span class="annottext">freshContext :: a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#freshContext"><span class="hs-identifier hs-var hs-var">freshContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#forAll"><span class="hs-identifier hs-var">forAll</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Set the universal quantification context.</span><span>
</span><span id="line-301"></span><span id="local-6989586621679059057"><span id="local-6989586621679059058"><span class="annot"><a href="Test.SmallCheck.Property.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059058"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059058"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-302"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantification -&gt; Property m -&gt; Property m
forall (m :: * -&gt; *). Quantification -&gt; Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#quantify"><span class="hs-identifier hs-var">quantify</span></a></span><span> </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#Forall"><span class="hs-identifier hs-var">Forall</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; Property m) -&gt; (a -&gt; Property m) -&gt; a -&gt; Property m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Set the existential quantification context.</span><span>
</span><span id="line-305"></span><span id="local-6989586621679059055"><span id="local-6989586621679059056"><span class="annot"><a href="Test.SmallCheck.Property.html#exists"><span class="hs-identifier hs-type">exists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059056"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059056"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-306"></span><span id="exists"><span class="annot"><span class="annottext">exists :: a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#exists"><span class="hs-identifier hs-var hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantification -&gt; Property m -&gt; Property m
forall (m :: * -&gt; *). Quantification -&gt; Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#quantify"><span class="hs-identifier hs-var">quantify</span></a></span><span> </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#Exists"><span class="hs-identifier hs-var">Exists</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; Property m) -&gt; (a -&gt; Property m) -&gt; a -&gt; Property m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Set the uniqueness quantification context.</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- Bear in mind that \( \exists! x, y\colon p\, x \, y \)</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- is not the same as \( \exists! x \colon \exists! y \colon p \, x \, y \).</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- For example, \( \exists! x \colon \exists! y \colon |x| = |y| \)</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- is true (it holds only when \(x=y=0\)),</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- but \( \exists! x, y \colon |x| = |y| \) is false</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- (there are many such pairs).</span><span>
</span><span id="line-317"></span><span class="hs-comment">--</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- As is customary in mathematics,</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- @'existsUnique' $ \\x y -&gt; p x y@ is equivalent to</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- @'existsUnique' $ \\(x, y) -&gt; p x y@ and not to</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- @'existsUnique' $ \\x -&gt; 'existsUnique' $ \\y -&gt; p x y@</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- (the latter, of course, may be explicitly written when desired).</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- That is, all the variables affected by the same uniqueness context are</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- quantified simultaneously as a tuple.</span><span>
</span><span id="line-326"></span><span id="local-6989586621679059053"><span id="local-6989586621679059054"><span class="annot"><a href="Test.SmallCheck.Property.html#existsUnique"><span class="hs-identifier hs-type">existsUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059054"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059053"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059054"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-327"></span><span id="existsUnique"><span class="annot"><span class="annottext">existsUnique :: a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#existsUnique"><span class="hs-identifier hs-var hs-var">existsUnique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantification -&gt; Property m -&gt; Property m
forall (m :: * -&gt; *). Quantification -&gt; Property m -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#quantify"><span class="hs-identifier hs-var">quantify</span></a></span><span> </span><span class="annot"><span class="annottext">Quantification
</span><a href="Test.SmallCheck.Property.html#ExistsUnique"><span class="hs-identifier hs-var">ExistsUnique</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; Property m) -&gt; (a -&gt; Property m) -&gt; a -&gt; Property m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | The '==&gt;' operator can be used to express a restricting condition</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- under which a property should hold. It corresponds to implication in the</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- classical logic.</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- Note that '==&gt;' resets the quantification context for its operands to</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- the default (universal).</span><span>
</span><span id="line-335"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-type">==&gt;</span></a></span><span>
</span><span id="line-336"></span><span id="local-6989586621679059050"><span id="local-6989586621679059051"><span id="local-6989586621679059052"><span class="annot"><a href="Test.SmallCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-type">(==&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059051"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059050"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059051"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059052"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-337"></span><span id="local-6989586621679059049"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679059049"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="%3D%3D%3E"><span class="annot"><span class="annottext">==&gt; :: c -&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-var hs-var">==&gt;</span></a></span></span><span> </span><span id="local-6989586621679059048"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059048"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader (Env m) (PropertySeries m) -&gt; Property m)
-&gt; Reader (Env m) (PropertySeries m) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679059047"><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (Env m) Identity (Env m)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679059046"><span class="annot"><span class="annottext">counterExample :: Series m PropertyFailure
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var hs-var">counterExample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a. MonadLogic m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">once</span></span><span> </span><span class="annot"><span class="annottext">(Series m PropertyFailure -&gt; Series m PropertyFailure)
-&gt; Series m PropertyFailure -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Series m PropertyFailure)
-&gt; PropertySeries m -&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059045"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#freshContext"><span class="hs-identifier hs-var">freshContext</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679059049"><span class="hs-identifier hs-var">cond</span></a></span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-comment">-- NB: we do not invoke the test hook in the antecedent</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679059045"><span class="annot"><span class="annottext">env' :: Env m
</span><a href="#local-6989586621679059045"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testHook :: TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var">testHook</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; TestQuality -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; TestQuality -&gt; m ()) -&gt; m () -&gt; TestQuality -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679059044"><span class="annot"><span class="annottext">consequent :: PropertySeries m
</span><a href="#local-6989586621679059044"><span class="hs-identifier hs-var hs-var">consequent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env m -&gt; Property m -&gt; PropertySeries m
forall (t :: * -&gt; *). Env t -&gt; Property t -&gt; PropertySeries t
</span><a href="Test.SmallCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Property m -&gt; PropertySeries m) -&gt; Property m -&gt; PropertySeries m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#freshContext"><span class="hs-identifier hs-var">freshContext</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059048"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621679059043"><span class="annot"><span class="annottext">badTestHook :: Series m ()
</span><a href="#local-6989586621679059043"><span class="hs-identifier hs-var hs-var">badTestHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; Series m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; Series m ()) -&gt; m () -&gt; Series m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
forall (m :: * -&gt; *). Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality
</span><a href="Test.SmallCheck.Property.html#BadTest"><span class="hs-identifier hs-var">BadTest</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679059042"><span class="annot"><span class="annottext">success :: Series m PropertySuccess
</span><a href="#local-6989586621679059042"><span class="hs-identifier hs-var hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>      </span><span class="annot"><span class="annottext">Series m PropertyFailure
-&gt; (PropertyFailure -&gt; Series m PropertySuccess)
-&gt; Series m PropertySuccess
-&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a b.
MonadLogic m =&gt;
m a -&gt; (a -&gt; m b) -&gt; m b -&gt; m b
</span><span class="hs-identifier hs-var">ifte</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var">counterExample</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-comment">-- then</span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679059041"><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059041"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-353"></span><span>          </span><span class="annot"><span class="annottext">Series m ()
</span><a href="#local-6989586621679059043"><span class="hs-identifier hs-var">badTestHook</span></a></span><span>
</span><span id="line-354"></span><span>          </span><span class="annot"><span class="annottext">PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertySuccess -&gt; Series m PropertySuccess)
-&gt; PropertySuccess -&gt; Series m PropertySuccess
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropertyFailure -&gt; PropertySuccess
</span><a href="Test.SmallCheck.Property.Result.html#Vacuously"><span class="hs-identifier hs-var">Vacuously</span></a></span><span> </span><span class="annot"><span class="annottext">PropertyFailure
</span><a href="#local-6989586621679059041"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-comment">-- else</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertySuccess
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertySuccess
</span><a href="Test.SmallCheck.Property.html#searchExamples"><span class="hs-identifier hs-var hs-var">searchExamples</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059044"><span class="hs-identifier hs-var">consequent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679059039"><span class="annot"><span class="annottext">failure :: Series m PropertyFailure
</span><a href="#local-6989586621679059039"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><span class="annottext">Series m PropertyFailure
-&gt; (PropertyFailure -&gt; Series m PropertyFailure)
-&gt; Series m PropertyFailure
-&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a b.
MonadLogic m =&gt;
m a -&gt; (a -&gt; m b) -&gt; m b -&gt; m b
</span><span class="hs-identifier hs-var">ifte</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059046"><span class="hs-identifier hs-var">counterExample</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-comment">-- then</span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Series m PropertyFailure
-&gt; PropertyFailure -&gt; Series m PropertyFailure
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Series m PropertyFailure
 -&gt; PropertyFailure -&gt; Series m PropertyFailure)
-&gt; Series m PropertyFailure
-&gt; PropertyFailure
-&gt; Series m PropertyFailure
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-363"></span><span>          </span><span class="annot"><span class="annottext">m () -&gt; Series m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; Series m ()) -&gt; m () -&gt; Series m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Env m -&gt; TestQuality -&gt; m ()
forall (m :: * -&gt; *). Env m -&gt; TestQuality -&gt; m ()
</span><a href="Test.SmallCheck.Property.html#testHook"><span class="hs-identifier hs-var hs-var">testHook</span></a></span><span> </span><span class="annot"><span class="annottext">Env m
</span><a href="#local-6989586621679059047"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">TestQuality
</span><a href="Test.SmallCheck.Property.html#BadTest"><span class="hs-identifier hs-var">BadTest</span></a></span><span>
</span><span id="line-364"></span><span>          </span><span class="annot"><span class="annottext">Series m PropertyFailure
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-comment">-- else</span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; Series m PropertyFailure
forall (m :: * -&gt; *). PropertySeries m -&gt; Series m PropertyFailure
</span><a href="Test.SmallCheck.Property.html#searchCounterExamples"><span class="hs-identifier hs-var hs-var">searchCounterExamples</span></a></span><span> </span><span class="annot"><span class="annottext">PropertySeries m
</span><a href="#local-6989586621679059044"><span class="hs-identifier hs-var">consequent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><span class="annottext">PropertySeries m -&gt; Reader (Env m) (PropertySeries m)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; Reader (Env m) (PropertySeries m))
-&gt; PropertySeries m -&gt; Reader (Env m) (PropertySeries m)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure -&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#atomicProperty"><span class="hs-identifier hs-var">atomicProperty</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059042"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059039"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Run property with a modified depth. Affects all quantified variables</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- in the property.</span><span>
</span><span id="line-373"></span><span id="local-6989586621679059266"><span id="local-6989586621679059267"><span class="annot"><a href="Test.SmallCheck.Property.html#changeDepth"><span class="hs-identifier hs-type">changeDepth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059267"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059267"><span class="hs-identifier hs-type">m</span></a></span></span></span><span>
</span><span id="line-374"></span><span id="changeDepth"><span class="annot"><span class="annottext">changeDepth :: (Int -&gt; Int) -&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#changeDepth"><span class="hs-identifier hs-var hs-var">changeDepth</span></a></span></span><span> </span><span id="local-6989586621679059038"><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059038"><span class="hs-identifier hs-var">modifyDepth</span></a></span></span><span> </span><span id="local-6989586621679059037"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059037"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader (Env m) (PropertySeries m) -&gt; Property m
forall (m :: * -&gt; *).
Reader (Env m) (PropertySeries m) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertySeries m -&gt; PropertySeries m
</span><a href="#local-6989586621679059036"><span class="hs-identifier hs-var">changeDepthPS</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertySeries m -&gt; PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
-&gt; Reader (Env m) (PropertySeries m)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Property m -&gt; Reader (Env m) (PropertySeries m)
forall (m :: * -&gt; *).
Property m -&gt; Reader (Env m) (PropertySeries m)
</span><a href="Test.SmallCheck.Property.html#unProperty"><span class="hs-identifier hs-var hs-var">unProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Property m
forall (m :: * -&gt; *) a. Testable m a =&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679059037"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679059036"><span class="annot"><span class="annottext">changeDepthPS :: PropertySeries m -&gt; PropertySeries m
</span><a href="#local-6989586621679059036"><span class="hs-identifier hs-var hs-var">changeDepthPS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-type">PropertySeries</span></a></span><span> </span><span id="local-6989586621679059035"><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059035"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679059034"><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059034"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span id="local-6989586621679059033"><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059033"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
forall (m :: * -&gt; *).
Series m PropertySuccess
-&gt; Series m PropertyFailure
-&gt; Series m (Property m, [Argument])
-&gt; PropertySeries m
</span><a href="Test.SmallCheck.Property.html#PropertySeries"><span class="hs-identifier hs-var">PropertySeries</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int)
-&gt; Series m PropertySuccess -&gt; Series m PropertySuccess
forall (m :: * -&gt; *) a. (Int -&gt; Int) -&gt; Series m a -&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059038"><span class="hs-identifier hs-var">modifyDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertySuccess
</span><a href="#local-6989586621679059035"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int)
-&gt; Series m PropertyFailure -&gt; Series m PropertyFailure
forall (m :: * -&gt; *) a. (Int -&gt; Int) -&gt; Series m a -&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059038"><span class="hs-identifier hs-var">modifyDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Series m PropertyFailure
</span><a href="#local-6989586621679059034"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Property m -&gt; Property m)
-&gt; (Property m, [Argument]) -&gt; (Property m, [Argument])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Property m -&gt; Property m
forall (m :: * -&gt; *) a.
Testable m a =&gt;
(Int -&gt; Int) -&gt; a -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#changeDepth"><span class="hs-identifier hs-var">changeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059038"><span class="hs-identifier hs-var">modifyDepth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Property m, [Argument]) -&gt; (Property m, [Argument]))
-&gt; Series m (Property m, [Argument])
-&gt; Series m (Property m, [Argument])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><span class="annottext">(Int -&gt; Int)
-&gt; Series m (Property m, [Argument])
-&gt; Series m (Property m, [Argument])
forall (m :: * -&gt; *) a. (Int -&gt; Int) -&gt; Series m a -&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059038"><span class="hs-identifier hs-var">modifyDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Series m (Property m, [Argument])
</span><a href="#local-6989586621679059033"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Quantify the function's argument over its 'series', but adjust the</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- depth. This doesn't affect any subsequent variables.</span><span>
</span><span id="line-385"></span><span id="local-6989586621679059029"><span id="local-6989586621679059030"><span id="local-6989586621679059031"><span class="annot"><a href="Test.SmallCheck.Property.html#changeDepth1"><span class="hs-identifier hs-type">changeDepth1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Series.html#Serial"><span class="hs-identifier hs-type">Serial</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.SeriesMonad.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059031"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059029"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.SmallCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059030"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-386"></span><span id="changeDepth1"><span class="annot"><span class="annottext">changeDepth1 :: (Int -&gt; Int) -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#changeDepth1"><span class="hs-identifier hs-var hs-var">changeDepth1</span></a></span></span><span> </span><span id="local-6989586621679059028"><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var">modifyDepth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Series m a -&gt; (a -&gt; b) -&gt; Property m
forall a (m :: * -&gt; *) b.
(Show a, Testable m b) =&gt;
Series m a -&gt; (a -&gt; b) -&gt; Property m
</span><a href="Test.SmallCheck.Property.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(Series m a -&gt; (a -&gt; b) -&gt; Property m)
-&gt; Series m a -&gt; (a -&gt; b) -&gt; Property m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Series m a -&gt; Series m a
forall (m :: * -&gt; *) a. (Int -&gt; Int) -&gt; Series m a -&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#localDepth"><span class="hs-identifier hs-var">localDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679059028"><span class="hs-identifier hs-var">modifyDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Series m a
forall (m :: * -&gt; *) a. Serial m a =&gt; Series m a
</span><a href="Test.SmallCheck.Series.html#series"><span class="hs-identifier hs-var">series</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-389"></span></pre></body></html>