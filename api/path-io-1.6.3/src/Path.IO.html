<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Module      :  Path.IO</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Copyright   :  &#169; 2016&#8211;present Mark Karpov</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- License     :  BSD 3 clause</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Maintainer  :  Mark Karpov &lt;markkarpov92@gmail.com&gt;</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- This module provides an interface to &quot;System.Directory&quot; for users of the</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- &quot;Path&quot; module. It also implements some extra functionality like recursive</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- scanning and copying of directories, working with temporary</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- files\/directories, etc.</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Path.IO</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Actions on directories</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Path.IO.html#createDir"><span class="hs-identifier">createDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Path.IO.html#createDirIfMissing"><span class="hs-identifier">createDirIfMissing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Path.IO.html#ensureDir"><span class="hs-identifier">ensureDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Path.IO.html#removeDir"><span class="hs-identifier">removeDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Path.IO.html#removeDirRecur"><span class="hs-identifier">removeDirRecur</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Path.IO.html#renameDir"><span class="hs-identifier">renameDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Path.IO.html#listDir"><span class="hs-identifier">listDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Path.IO.html#listDirRel"><span class="hs-identifier">listDirRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Path.IO.html#listDirRecur"><span class="hs-identifier">listDirRecur</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Path.IO.html#listDirRecurRel"><span class="hs-identifier">listDirRecurRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Path.IO.html#copyDirRecur"><span class="hs-identifier">copyDirRecur</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Path.IO.html#copyDirRecur%27"><span class="hs-identifier">copyDirRecur'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Walking directory trees</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier">WalkAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Path.IO.html#walkDir"><span class="hs-identifier">walkDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Path.IO.html#walkDirRel"><span class="hs-identifier">walkDirRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Path.IO.html#walkDirAccum"><span class="hs-identifier">walkDirAccum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Path.IO.html#walkDirAccumRel"><span class="hs-identifier">walkDirAccumRel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Current working directory</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier">getCurrentDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Path.IO.html#setCurrentDir"><span class="hs-identifier">setCurrentDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Path.IO.html#withCurrentDir"><span class="hs-identifier">withCurrentDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Pre-defined directories</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Path.IO.html#getHomeDir"><span class="hs-identifier">getHomeDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Path.IO.html#getAppUserDataDir"><span class="hs-identifier">getAppUserDataDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Path.IO.html#getUserDocsDir"><span class="hs-identifier">getUserDocsDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Path.IO.html#getTempDir"><span class="hs-identifier">getTempDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-identifier">D.XdgDirectory</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Path.IO.html#getXdgDir"><span class="hs-identifier">getXdgDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier">D.XdgDirectoryList</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Path.IO.html#getXdgDirList"><span class="hs-identifier">getXdgDirList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Path transformation</span></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Path.IO.html#AnyPath"><span class="hs-identifier">AnyPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Path.IO.html#resolveFile"><span class="hs-identifier">resolveFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Path.IO.html#resolveFile%27"><span class="hs-identifier">resolveFile'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Path.IO.html#resolveDir"><span class="hs-identifier">resolveDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Path.IO.html#resolveDir%27"><span class="hs-identifier">resolveDir'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Actions on files</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Path.IO.html#removeFile"><span class="hs-identifier">removeFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Path.IO.html#renameFile"><span class="hs-identifier">renameFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Path.IO.html#copyFile"><span class="hs-identifier">copyFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Path.IO.html#findExecutable"><span class="hs-identifier">findExecutable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Path.IO.html#findFile"><span class="hs-identifier">findFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="Path.IO.html#findFiles"><span class="hs-identifier">findFiles</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Path.IO.html#findFilesWith"><span class="hs-identifier">findFilesWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Symbolic links</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Path.IO.html#createFileLink"><span class="hs-identifier">createFileLink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Path.IO.html#createDirLink"><span class="hs-identifier">createDirLink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Path.IO.html#removeDirLink"><span class="hs-identifier">removeDirLink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Path.IO.html#getSymlinkTarget"><span class="hs-identifier">getSymlinkTarget</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Path.IO.html#isSymlink"><span class="hs-identifier">isSymlink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Temporary files and directories</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Path.IO.html#withTempFile"><span class="hs-identifier">withTempFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Path.IO.html#withTempDir"><span class="hs-identifier">withTempDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Path.IO.html#withSystemTempFile"><span class="hs-identifier">withSystemTempFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Path.IO.html#withSystemTempDir"><span class="hs-identifier">withSystemTempDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="Path.IO.html#openTempFile"><span class="hs-identifier">openTempFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Path.IO.html#openBinaryTempFile"><span class="hs-identifier">openBinaryTempFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Path.IO.html#createTempDir"><span class="hs-identifier">createTempDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Existence tests</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Path.IO.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Path.IO.html#doesDirExist"><span class="hs-identifier">doesDirExist</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Path.IO.html#isLocationOccupied"><span class="hs-identifier">isLocationOccupied</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Path.IO.html#forgivingAbsence"><span class="hs-identifier">forgivingAbsence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="Path.IO.html#ignoringAbsence"><span class="hs-identifier">ignoringAbsence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Permissions</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-identifier">D.Permissions</span></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="hs-identifier">D.emptyPermissions</span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="hs-identifier">D.readable</span></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="hs-identifier">D.writable</span></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier">D.executable</span></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="hs-identifier">D.searchable</span></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="hs-identifier">D.setOwnerReadable</span></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="hs-identifier">D.setOwnerWritable</span></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="hs-identifier">D.setOwnerExecutable</span></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-identifier">D.setOwnerSearchable</span></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Path.IO.html#getPermissions"><span class="hs-identifier">getPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Path.IO.html#setPermissions"><span class="hs-identifier">setPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Path.IO.html#copyPermissions"><span class="hs-identifier">copyPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Timestamps</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Path.IO.html#getAccessTime"><span class="hs-identifier">getAccessTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Path.IO.html#setAccessTime"><span class="hs-identifier">setAccessTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Path.IO.html#setModificationTime"><span class="hs-identifier">setModificationTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Path.IO.html#getModificationTime"><span class="hs-identifier">getModificationTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runMaybeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">execWriterT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DList</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rights</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(\\)</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Path</span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Handle</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isDoesNotExistError</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Temp</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.PosixCompat.Files</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- Actions on directories</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | @'createDir' dir@ creates a new directory @dir@ which is initially</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- empty, or as near to empty as the operating system allows.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- @[EROFS, EACCES]@</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- * 'isAlreadyExistsError' \/ 'AlreadyExists'</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- The operand refers to a directory that already exists.</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- @ [EEXIST]@</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- The operand is not a valid directory name.</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- * 'NoSuchThing'</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- There is no path to the directory.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- * 'ResourceExhausted' Insufficient resources (virtual memory, process</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- file descriptors, physical disk space, etc.) are available to perform the</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- operation. @[EDQUOT, ENOSPC, ENOMEM, EMLINK]@</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- The path refers to an existing non-directory object.</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- @[EEXIST]@</span><span>
</span><span id="line-174"></span><span id="local-6989586621679082341"><span id="local-6989586621679082342"><span class="annot"><a href="Path.IO.html#createDir"><span class="hs-identifier hs-type">createDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082342"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082341"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082342"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-175"></span><span id="createDir"><span class="annot"><span class="annottext">createDir :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#createDir"><span class="hs-identifier hs-var hs-var">createDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createDirectory</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | @'createDirIfMissing' parents dir@ creates a new directory @dir@ if it</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- doesn't exist. If the first argument is 'True' the function will also</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- create all parent directories if they are missing.</span><span>
</span><span id="line-180"></span><span id="local-6989586621679082810"><span id="local-6989586621679082811"><span class="annot"><a href="Path.IO.html#createDirIfMissing"><span class="hs-identifier hs-type">createDirIfMissing</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082811"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- | Create its parents too?</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- | The path to the directory you want to make</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082810"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="#local-6989586621679082811"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-187"></span><span id="createDirIfMissing"><span class="annot"><span class="annottext">createDirIfMissing :: Bool -&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#createDirIfMissing"><span class="hs-identifier hs-var hs-var">createDirIfMissing</span></a></span></span><span> </span><span id="local-6989586621679082338"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082338"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082338"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Ensure that a directory exists creating it and its parent directories</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- if necessary. This is just a handy shortcut:</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- &gt; ensureDir = createDirIfMissing True</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- @since 0.3.1</span><span>
</span><span id="line-195"></span><span id="local-6989586621679082694"><span id="local-6989586621679082695"><span class="annot"><a href="Path.IO.html#ensureDir"><span class="hs-identifier hs-type">ensureDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082694"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082695"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-196"></span><span id="ensureDir"><span class="annot"><span class="annottext">ensureDir :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#ensureDir"><span class="hs-identifier hs-var hs-var">ensureDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) b. MonadIO m =&gt; Bool -&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#createDirIfMissing"><span class="hs-identifier hs-var">createDirIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | @'removeDir' dir@ removes an existing directory @dir@. The</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- implementation may specify additional constraints which must be satisfied</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- before a directory can be removed (e.g. the directory has to be empty, or</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- may not be in use by other processes). It is not legal for an</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- implementation to partially remove a directory unless the entire</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- directory is removed. A conformant implementation need not support</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- directory removal in all situations (e.g. removal of the root directory).</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- The operand is not a valid directory name.</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- The directory does not exist.</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- @[EROFS, EACCES, EPERM]@</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- * 'UnsatisfiedConstraints'</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Implementation-dependent constraints are not satisfied.</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- @[EBUSY, ENOTEMPTY, EEXIST]@</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- The implementation does not support removal in this situation.</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- @[EINVAL]@</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- The operand refers to an existing non-directory object.</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- @[ENOTDIR]@</span><span>
</span><span id="line-235"></span><span id="local-6989586621679082335"><span id="local-6989586621679082336"><span class="annot"><a href="Path.IO.html#removeDir"><span class="hs-identifier hs-type">removeDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082336"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082335"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082336"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-236"></span><span id="removeDir"><span class="annot"><span class="annottext">removeDir :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#removeDir"><span class="hs-identifier hs-var hs-var">removeDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.removeDirectory</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | @'removeDirRecur' dir@ removes an existing directory @dir@ together</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- with its contents and sub-directories. Within this directory, symbolic</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- links are removed without affecting their targets.</span><span>
</span><span id="line-241"></span><span id="local-6989586621679082332"><span id="local-6989586621679082333"><span class="annot"><a href="Path.IO.html#removeDirRecur"><span class="hs-identifier hs-type">removeDirRecur</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082333"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082332"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082333"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-242"></span><span id="removeDirRecur"><span class="annot"><span class="annottext">removeDirRecur :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#removeDirRecur"><span class="hs-identifier hs-var hs-var">removeDirRecur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.removeDirectoryRecursive</span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | @'renameDir' old new@ changes the name of an existing directory from</span><span>
</span><span id="line-245"></span><span class="hs-comment">--  @old@ to @new@. If the @new@ directory already exists, it is atomically</span><span>
</span><span id="line-246"></span><span class="hs-comment">--  replaced by the @old@ directory. If the @new@ directory is neither the</span><span>
</span><span id="line-247"></span><span class="hs-comment">--  @old@ directory nor an alias of the @old@ directory, it is removed as if</span><span>
</span><span id="line-248"></span><span class="hs-comment">--  by 'removeDir'. A conformant implementation need not support renaming</span><span>
</span><span id="line-249"></span><span class="hs-comment">--  directories in all situations (e.g. renaming to an existing directory, or</span><span>
</span><span id="line-250"></span><span class="hs-comment">--  across different physical devices), but the constraints must be</span><span>
</span><span id="line-251"></span><span class="hs-comment">--  documented.</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-comment">--  On Win32 platforms, @renameDir@ fails if the @new@ directory already</span><span>
</span><span id="line-254"></span><span class="hs-comment">--  exists.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span class="hs-comment">--  The operation may fail with:</span><span>
</span><span id="line-257"></span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span class="hs-comment">--  * 'HardwareFault'</span><span>
</span><span id="line-259"></span><span class="hs-comment">--  A physical I\/O error has occurred.</span><span>
</span><span id="line-260"></span><span class="hs-comment">--  @[EIO]@</span><span>
</span><span id="line-261"></span><span class="hs-comment">--</span><span>
</span><span id="line-262"></span><span class="hs-comment">--  * 'InvalidArgument'</span><span>
</span><span id="line-263"></span><span class="hs-comment">--  Either operand is not a valid directory name.</span><span>
</span><span id="line-264"></span><span class="hs-comment">--  @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">--  * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><span id="line-267"></span><span class="hs-comment">--  The original directory does not exist, or there is no path to the target.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--  @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-269"></span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span class="hs-comment">--  * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-271"></span><span class="hs-comment">--  The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--  @[EROFS, EACCES, EPERM]@</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">--  * 'ResourceExhausted'</span><span>
</span><span id="line-275"></span><span class="hs-comment">--  Insufficient resources are available to perform the operation.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--  @[EDQUOT, ENOSPC, ENOMEM, EMLINK]@</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">--  * 'UnsatisfiedConstraints'</span><span>
</span><span id="line-279"></span><span class="hs-comment">--  Implementation-dependent constraints are not satisfied.</span><span>
</span><span id="line-280"></span><span class="hs-comment">--  @[EBUSY, ENOTEMPTY, EEXIST]@</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">--  * 'UnsupportedOperation'</span><span>
</span><span id="line-283"></span><span class="hs-comment">--  The implementation does not support renaming in this situation.</span><span>
</span><span id="line-284"></span><span class="hs-comment">--  @[EINVAL, EXDEV]@</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="hs-comment">--  * 'InappropriateType'</span><span>
</span><span id="line-287"></span><span class="hs-comment">--  Either path refers to an existing non-directory object.</span><span>
</span><span id="line-288"></span><span class="hs-comment">--  @[ENOTDIR, EISDIR]@</span><span>
</span><span id="line-289"></span><span id="local-6989586621679082328"><span id="local-6989586621679082329"><span id="local-6989586621679082330"><span class="annot"><a href="Path.IO.html#renameDir"><span class="hs-identifier hs-type">renameDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082330"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">-- | Old name</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082329"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-comment">-- | New name</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082328"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="#local-6989586621679082330"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-296"></span><span id="renameDir"><span class="annot"><span class="annottext">renameDir :: Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#renameDir"><span class="hs-identifier hs-var hs-var">renameDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO ())
-&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
forall (m :: * -&gt; *) a b0 t0 b1 t1.
MonadIO m =&gt;
(FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var">liftD2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.renameDirectory</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | @'listDir' dir@ returns a list of /all/ entries in @dir@ without the</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- special entries (@.@ and @..@). Entries are not sorted.</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-304"></span><span class="hs-comment">--   A physical I\/O error has occurred.</span><span>
</span><span id="line-305"></span><span class="hs-comment">--   @[EIO]@</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-308"></span><span class="hs-comment">--   The operand is not a valid directory name.</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   The directory does not exist.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-316"></span><span class="hs-comment">--   The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-317"></span><span class="hs-comment">--   @[EACCES]@</span><span>
</span><span id="line-318"></span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><span id="line-320"></span><span class="hs-comment">--   Insufficient resources are available to perform the operation.</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   @[EMFILE, ENFILE]@</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-324"></span><span class="hs-comment">--   The path refers to an existing non-directory object.</span><span>
</span><span id="line-325"></span><span class="hs-comment">--   @[ENOTDIR]@</span><span>
</span><span id="line-326"></span><span id="local-6989586621679082324"><span id="local-6989586621679082325"><span class="annot"><a href="Path.IO.html#listDir"><span class="hs-identifier hs-type">listDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-comment">-- | Directory to list</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082324"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- | Sub-directories and files</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="#local-6989586621679082325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-332"></span><span id="listDir"><span class="annot"><span class="annottext">listDir :: Path b Dir -&gt; m ([Path Abs Dir], [Path Abs File])
</span><a href="Path.IO.html#listDir"><span class="hs-identifier hs-var hs-var">listDir</span></a></span></span><span> </span><span id="local-6989586621679082323"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082323"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679082322"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082322"><span class="hs-identifier hs-var">bpath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082323"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679082320"><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082320"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082319"><span class="annot"><span class="annottext">[Path Rel File]
</span><a href="#local-6989586621679082319"><span class="hs-identifier hs-var">files</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m ([Path Rel Dir], [Path Rel File])
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
Path b Dir -&gt; m ([Path Rel Dir], [Path Rel File])
</span><a href="Path.IO.html#listDirRel"><span class="hs-identifier hs-var">listDirRel</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082322"><span class="hs-identifier hs-var">bpath</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><span class="annottext">([Path Abs Dir], [Path Abs File])
-&gt; m ([Path Abs Dir], [Path Abs File])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082322"><span class="hs-identifier hs-var">bpath</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel Dir -&gt; Path Abs Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; Path Abs Dir) -&gt; [Path Rel Dir] -&gt; [Path Abs Dir]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082320"><span class="hs-identifier hs-var">subdirs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082322"><span class="hs-identifier hs-var">bpath</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel File -&gt; Path Abs File
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel File -&gt; Path Abs File)
-&gt; [Path Rel File] -&gt; [Path Abs File]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel File]
</span><a href="#local-6989586621679082319"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | The same as 'listDir' but returns relative paths.</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- @since 1.4.0</span><span>
</span><span id="line-343"></span><span id="local-6989586621679082786"><span id="local-6989586621679082787"><span class="annot"><a href="Path.IO.html#listDirRel"><span class="hs-identifier hs-type">listDirRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082787"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-comment">-- | Directory to list</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082786"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-comment">-- | Sub-directories and files</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><a href="#local-6989586621679082787"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-349"></span><span id="listDirRel"><span class="annot"><span class="annottext">listDirRel :: Path b Dir -&gt; m ([Path Rel Dir], [Path Rel File])
</span><a href="Path.IO.html#listDirRel"><span class="hs-identifier hs-var hs-var">listDirRel</span></a></span></span><span> </span><span id="local-6989586621679082316"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082316"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ([Path Rel Dir], [Path Rel File])
-&gt; m ([Path Rel Dir], [Path Rel File])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ([Path Rel Dir], [Path Rel File])
 -&gt; m ([Path Rel Dir], [Path Rel File]))
-&gt; IO ([Path Rel Dir], [Path Rel File])
-&gt; m ([Path Rel Dir], [Path Rel File])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679082314"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679082314"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO [FilePath]) -&gt; Path b Dir -&gt; IO [FilePath]
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [FilePath]
</span><span class="hs-identifier hs-var">D.getDirectoryContents</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082316"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679082312"><span class="annot"><span class="annottext">[Either (Path Rel Dir) (Path Rel File)]
</span><a href="#local-6989586621679082312"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FilePath]
-&gt; (FilePath -&gt; IO (Either (Path Rel Dir) (Path Rel File)))
-&gt; IO [Either (Path Rel Dir) (Path Rel File)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679082314"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;..&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO (Either (Path Rel Dir) (Path Rel File)))
 -&gt; IO [Either (Path Rel Dir) (Path Rel File)])
-&gt; (FilePath -&gt; IO (Either (Path Rel Dir) (Path Rel File)))
-&gt; IO [Either (Path Rel Dir) (Path Rel File)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082310"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082310"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679082309"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082309"><span class="hs-identifier hs-var">isDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; FilePath -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082316"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">F.&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082310"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082309"><span class="hs-identifier hs-var">isDir</span></a></span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Path Rel Dir -&gt; Either (Path Rel Dir) (Path Rel File)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; Either (Path Rel Dir) (Path Rel File))
-&gt; IO (Path Rel Dir) -&gt; IO (Either (Path Rel Dir) (Path Rel File))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Rel Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Rel Dir)
</span><span class="hs-identifier hs-var">parseRelDir</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082310"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Path Rel File -&gt; Either (Path Rel Dir) (Path Rel File)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Path Rel File -&gt; Either (Path Rel Dir) (Path Rel File))
-&gt; IO (Path Rel File) -&gt; IO (Either (Path Rel Dir) (Path Rel File))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Rel File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Rel File)
</span><span class="hs-identifier hs-var">parseRelFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082310"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">([Path Rel Dir], [Path Rel File])
-&gt; IO ([Path Rel Dir], [Path Rel File])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either (Path Rel Dir) (Path Rel File)] -&gt; [Path Rel Dir]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either (Path Rel Dir) (Path Rel File)]
</span><a href="#local-6989586621679082312"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Either (Path Rel Dir) (Path Rel File)] -&gt; [Path Rel File]
forall a b. [Either a b] -&gt; [b]
</span><span class="hs-identifier hs-var">rights</span></span><span> </span><span class="annot"><span class="annottext">[Either (Path Rel Dir) (Path Rel File)]
</span><a href="#local-6989586621679082312"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | Similar to 'listDir', but recursively traverses every sub-directory</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- /excluding symbolic links/, and returns all files and directories found.</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- This can fail with the same exceptions as 'listDir'.</span><span>
</span><span id="line-361"></span><span class="hs-comment">--</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- __Note__: before version /1.3.0/, this function followed symlinks.</span><span>
</span><span id="line-363"></span><span id="local-6989586621679082700"><span id="local-6989586621679082701"><span class="annot"><a href="Path.IO.html#listDirRecur"><span class="hs-identifier hs-type">listDirRecur</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-comment">-- | Directory to list</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082700"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-comment">-- | Sub-directories and files</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="#local-6989586621679082701"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-369"></span><span id="listDirRecur"><span class="annot"><span class="annottext">listDirRecur :: Path b Dir -&gt; m ([Path Abs Dir], [Path Abs File])
</span><a href="Path.IO.html#listDirRecur"><span class="hs-identifier hs-var hs-var">listDirRecur</span></a></span></span><span> </span><span id="local-6989586621679082303"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082303"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList (Path Abs Dir) -&gt; [Path Abs Dir]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DList.toList</span></span><span> </span><span class="annot"><span class="annottext">(DList (Path Abs Dir) -&gt; [Path Abs Dir])
-&gt; (DList (Path Abs File) -&gt; [Path Abs File])
-&gt; (DList (Path Abs Dir), DList (Path Abs File))
-&gt; ([Path Abs Dir], [Path Abs File])
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">DList (Path Abs File) -&gt; [Path Abs File]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DList.toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">((DList (Path Abs Dir), DList (Path Abs File))
 -&gt; ([Path Abs Dir], [Path Abs File]))
-&gt; m (DList (Path Abs Dir), DList (Path Abs File))
-&gt; m ([Path Abs Dir], [Path Abs File])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (Path Abs Dir
   -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; (Path Abs Dir
    -&gt; [Path Abs Dir]
    -&gt; [Path Abs File]
    -&gt; m (DList (Path Abs Dir), DList (Path Abs File)))
-&gt; Path b Dir
-&gt; m (DList (Path Abs Dir), DList (Path Abs File))
forall (m :: * -&gt; *) o b.
(MonadIO m, Monoid o) =&gt;
Maybe
  (Path Abs Dir
   -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; (Path Abs Dir -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccum"><span class="hs-identifier hs-var">walkDirAccum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Path Abs Dir
 -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; Maybe
     (Path Abs Dir
      -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
-&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs)
forall (f :: * -&gt; *) p b p.
MonadIO f =&gt;
p -&gt; [Path b Dir] -&gt; p -&gt; f (WalkAction b)
</span><a href="#local-6989586621679082301"><span class="hs-identifier hs-var">excludeSymlinks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
-&gt; [Path Abs Dir]
-&gt; [Path Abs File]
-&gt; m (DList (Path Abs Dir), DList (Path Abs File))
forall (m :: * -&gt; *) p a a.
Monad m =&gt;
p -&gt; [a] -&gt; [a] -&gt; m (DList a, DList a)
</span><a href="#local-6989586621679082300"><span class="hs-identifier hs-var">writer</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082303"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679082301"><span class="annot"><span class="annottext">excludeSymlinks :: p -&gt; [Path b Dir] -&gt; p -&gt; f (WalkAction b)
</span><a href="#local-6989586621679082301"><span class="hs-identifier hs-var hs-var">excludeSymlinks</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679082299"><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082299"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><span class="annottext">[Path b Dir] -&gt; WalkAction b
forall b. [Path b Dir] -&gt; WalkAction b
</span><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-var">WalkExclude</span></a></span><span> </span><span class="annot"><span class="annottext">([Path b Dir] -&gt; WalkAction b)
-&gt; f [Path b Dir] -&gt; f (WalkAction b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Path b Dir -&gt; f Bool) -&gt; [Path b Dir] -&gt; f [Path b Dir]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; f Bool
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m Bool
</span><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-var">isSymlink</span></a></span><span> </span><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082299"><span class="hs-identifier hs-var">subdirs</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span id="local-6989586621679082300"><span class="annot"><span class="annottext">writer :: p -&gt; [a] -&gt; [a] -&gt; m (DList a, DList a)
</span><a href="#local-6989586621679082300"><span class="hs-identifier hs-var hs-var">writer</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679082296"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679082296"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679082295"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679082295"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><span class="annottext">(DList a, DList a) -&gt; m (DList a, DList a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; DList a
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DList.fromList</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679082296"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>          </span><span class="annot"><span class="annottext">[a] -&gt; DList a
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DList.fromList</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679082295"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | The same as 'listDirRecur' but returns paths that are relative to the</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- given directory.</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- @since 1.4.2</span><span>
</span><span id="line-385"></span><span id="local-6989586621679082292"><span id="local-6989586621679082293"><span class="annot"><a href="Path.IO.html#listDirRecurRel"><span class="hs-identifier hs-type">listDirRecurRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-comment">-- | Directory to list</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082292"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-comment">-- | Sub-directories and files</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><a href="#local-6989586621679082293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-391"></span><span id="listDirRecurRel"><span class="annot"><span class="annottext">listDirRecurRel :: Path b Dir -&gt; m ([Path Rel Dir], [Path Rel File])
</span><a href="Path.IO.html#listDirRecurRel"><span class="hs-identifier hs-var hs-var">listDirRecurRel</span></a></span></span><span> </span><span id="local-6989586621679082291"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082291"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DList (Path Rel Dir) -&gt; [Path Rel Dir]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DList.toList</span></span><span> </span><span class="annot"><span class="annottext">(DList (Path Rel Dir) -&gt; [Path Rel Dir])
-&gt; (DList (Path Rel File) -&gt; [Path Rel File])
-&gt; (DList (Path Rel Dir), DList (Path Rel File))
-&gt; ([Path Rel Dir], [Path Rel File])
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">DList (Path Rel File) -&gt; [Path Rel File]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DList.toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">((DList (Path Rel Dir), DList (Path Rel File))
 -&gt; ([Path Rel Dir], [Path Rel File]))
-&gt; m (DList (Path Rel Dir), DList (Path Rel File))
-&gt; m ([Path Rel Dir], [Path Rel File])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (Path Rel Dir
   -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; (Path Rel Dir
    -&gt; [Path Rel Dir]
    -&gt; [Path Rel File]
    -&gt; m (DList (Path Rel Dir), DList (Path Rel File)))
-&gt; Path b Dir
-&gt; m (DList (Path Rel Dir), DList (Path Rel File))
forall (m :: * -&gt; *) o b.
(MonadIO m, Monoid o) =&gt;
Maybe
  (Path Rel Dir
   -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; (Path Rel Dir -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccumRel"><span class="hs-identifier hs-var">walkDirAccumRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Path Rel Dir
 -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; Maybe
     (Path Rel Dir
      -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
-&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel)
</span><a href="#local-6989586621679082290"><span class="hs-identifier hs-var">excludeSymlinks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
-&gt; [Path Rel Dir]
-&gt; [Path Rel File]
-&gt; m (DList (Path Rel Dir), DList (Path Rel File))
forall (m :: * -&gt; *) b t t.
Monad m =&gt;
Path b Dir
-&gt; [Path Rel t]
-&gt; [Path Rel t]
-&gt; m (DList (Path b t), DList (Path b t))
</span><a href="#local-6989586621679082289"><span class="hs-identifier hs-var">writer</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082291"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679082290"><span class="annot"><span class="annottext">excludeSymlinks :: Path Rel Dir
-&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel)
</span><a href="#local-6989586621679082290"><span class="hs-identifier hs-var hs-var">excludeSymlinks</span></a></span></span><span> </span><span id="local-6989586621679082288"><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082288"><span class="hs-identifier hs-var">tdir</span></a></span></span><span> </span><span id="local-6989586621679082287"><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082287"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Path Rel File]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><span class="annottext">[Path Rel Dir] -&gt; WalkAction Rel
forall b. [Path b Dir] -&gt; WalkAction b
</span><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-var">WalkExclude</span></a></span><span> </span><span class="annot"><span class="annottext">([Path Rel Dir] -&gt; WalkAction Rel)
-&gt; m [Path Rel Dir] -&gt; m (WalkAction Rel)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; m Bool) -&gt; [Path Rel Dir] -&gt; m [Path Rel Dir]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir -&gt; m Bool
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m Bool
</span><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-var">isSymlink</span></a></span><span> </span><span class="annot"><span class="annottext">(Path b Dir -&gt; m Bool)
-&gt; (Path Rel Dir -&gt; Path b Dir) -&gt; Path Rel Dir -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082291"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; Path Rel Dir -&gt; Path b Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; Path b Dir)
-&gt; (Path Rel Dir -&gt; Path Rel Dir) -&gt; Path Rel Dir -&gt; Path b Dir
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082288"><span class="hs-identifier hs-var">tdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir -&gt; Path Rel Dir -&gt; Path Rel Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082287"><span class="hs-identifier hs-var">subdirs</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679082289"><span class="annot"><span class="annottext">writer :: Path b Dir
-&gt; [Path Rel t]
-&gt; [Path Rel t]
-&gt; m (DList (Path b t), DList (Path b t))
</span><a href="#local-6989586621679082289"><span class="hs-identifier hs-var hs-var">writer</span></a></span></span><span> </span><span id="local-6989586621679082285"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082285"><span class="hs-identifier hs-var">tdir</span></a></span></span><span> </span><span id="local-6989586621679082284"><span class="annot"><span class="annottext">[Path Rel t]
</span><a href="#local-6989586621679082284"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679082283"><span class="annot"><span class="annottext">[Path Rel t]
</span><a href="#local-6989586621679082283"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">(DList (Path b t), DList (Path b t))
-&gt; m (DList (Path b t), DList (Path b t))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Path b t] -&gt; DList (Path b t)
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DList.fromList</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082285"><span class="hs-identifier hs-var">tdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; Path Rel t -&gt; Path b t
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel t -&gt; Path b t) -&gt; [Path Rel t] -&gt; [Path b t]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel t]
</span><a href="#local-6989586621679082284"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>          </span><span class="annot"><span class="annottext">[Path b t] -&gt; DList (Path b t)
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DList.fromList</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082285"><span class="hs-identifier hs-var">tdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; Path Rel t -&gt; Path b t
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel t -&gt; Path b t) -&gt; [Path Rel t] -&gt; [Path b t]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel t]
</span><a href="#local-6989586621679082283"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Copies a directory recursively. It /does not/ follow symbolic links and</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- preserves permissions when possible. If the destination directory already</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- exists, new files and sub-directories complement its structure, possibly</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- overwriting old files if they happen to have the same name as the new</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- ones.</span><span>
</span><span id="line-408"></span><span class="hs-comment">--</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- __Note__: before version /1.3.0/, this function followed symlinks.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- __Note__: before version /1.6.0/, the function created empty directories</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- in the destination directory when the source directory contained</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- directory symlinks. The symlinked directories were not recursively</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- traversed. It also copied symlinked files creating normal regular files</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- in the target directory as the result. This was fixed in the version</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- /1.6.0/ so that the function now behaves much like the @cp@ utility, not</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- traversing symlinked directories, but recreating symlinks in the target</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- directory according to their targets in the source directory.</span><span>
</span><span id="line-419"></span><span id="local-6989586621679082280"><span id="local-6989586621679082281"><span id="local-6989586621679082282"><span class="annot"><a href="Path.IO.html#copyDirRecur"><span class="hs-identifier hs-type">copyDirRecur</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082282"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadCatch</span></span><span> </span><span class="annot"><a href="#local-6989586621679082282"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-comment">-- | Source</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082281"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-comment">-- | Destination</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082280"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><a href="#local-6989586621679082282"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-426"></span><span id="copyDirRecur"><span class="annot"><span class="annottext">copyDirRecur :: Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#copyDirRecur"><span class="hs-identifier hs-var hs-var">copyDirRecur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
forall (m :: * -&gt; *) b0 b1.
MonadIO m =&gt;
Bool -&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#copyDirRecurGen"><span class="hs-identifier hs-var">copyDirRecurGen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | The same as 'copyDirRecur', but it /does not/ preserve directory</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- permissions. This may be useful, for example, if the directory you want</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- to copy is &#8220;read-only&#8221;, but you want your copy to be editable.</span><span>
</span><span id="line-431"></span><span class="hs-comment">--</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- @since 1.1.0</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- __Note__: before version /1.3.0/, this function followed symlinks.</span><span>
</span><span id="line-435"></span><span class="hs-comment">--</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- __Note__: before version /1.6.0/, the function created empty directories</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- in the destination directory when the source directory contained</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- directory symlinks. The symlinked directories were not recursively</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- traversed. It also copied symlinked files creating normal regular files</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- in the target directory as the result. This was fixed in the version</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- /1.6.0/ so that the function now behaves much like the @cp@ utility, not</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- traversing symlinked directories, but recreating symlinks in the target</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- directory according to their targets in the source directory.</span><span>
</span><span id="line-444"></span><span id="local-6989586621679082276"><span id="local-6989586621679082277"><span id="local-6989586621679082278"><span class="annot"><a href="Path.IO.html#copyDirRecur%27"><span class="hs-identifier hs-type">copyDirRecur'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082278"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadCatch</span></span><span> </span><span class="annot"><a href="#local-6989586621679082278"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-comment">-- | Source</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082277"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-comment">-- | Destination</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082276"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="#local-6989586621679082278"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-451"></span><span id="copyDirRecur%27"><span class="annot"><span class="annottext">copyDirRecur' :: Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#copyDirRecur%27"><span class="hs-identifier hs-var hs-var">copyDirRecur'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
forall (m :: * -&gt; *) b0 b1.
MonadIO m =&gt;
Bool -&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#copyDirRecurGen"><span class="hs-identifier hs-var">copyDirRecurGen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Generic version of 'copyDirRecur'. The first argument controls whether</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- to preserve directory permissions or not. /Does not/ follow symbolic</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- links. Internal function.</span><span>
</span><span id="line-456"></span><span id="local-6989586621679082708"><span id="local-6989586621679082709"><span id="local-6989586621679082710"><span class="annot"><a href="Path.IO.html#copyDirRecurGen"><span class="hs-identifier hs-type">copyDirRecurGen</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-comment">-- | Should we preserve directory permissions?</span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-comment">-- | Source</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082709"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-comment">-- | Destination</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082708"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="#local-6989586621679082710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-465"></span><span id="copyDirRecurGen"><span class="annot"><span class="annottext">copyDirRecurGen :: Bool -&gt; Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#copyDirRecurGen"><span class="hs-identifier hs-var hs-var">copyDirRecurGen</span></a></span></span><span> </span><span id="local-6989586621679082275"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082275"><span class="hs-identifier hs-var">preserveDirPermissions</span></a></span></span><span> </span><span id="local-6989586621679082274"><span class="annot"><span class="annottext">Path b0 Dir
</span><a href="#local-6989586621679082274"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679082273"><span class="annot"><span class="annottext">Path b1 Dir
</span><a href="#local-6989586621679082273"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621679082272"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082272"><span class="hs-identifier hs-var">bsrc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b0 Dir -&gt; IO (AbsPath (Path b0 Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b0 Dir
</span><a href="#local-6989586621679082274"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621679082271"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082271"><span class="hs-identifier hs-var">bdest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b1 Dir -&gt; IO (AbsPath (Path b1 Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b1 Dir
</span><a href="#local-6989586621679082273"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679082270"><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082270"><span class="hs-identifier hs-var">dirs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082269"><span class="annot"><span class="annottext">[Path Abs File]
</span><a href="#local-6989586621679082269"><span class="hs-identifier hs-var">files</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; IO ([Path Abs Dir], [Path Abs File])
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
Path b Dir -&gt; m ([Path Abs Dir], [Path Abs File])
</span><a href="Path.IO.html#listDirRecur"><span class="hs-identifier hs-var">listDirRecur</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082272"><span class="hs-identifier hs-var">bsrc</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082689"><span class="annot"><a href="#local-6989586621679082268"><span class="hs-identifier hs-type">swapParent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-470"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-472"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><a href="#local-6989586621679082689"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><a href="#local-6989586621679082689"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-474"></span><span>      </span><span id="local-6989586621679082268"><span class="annot"><span class="annottext">swapParent :: Path Abs Dir -&gt; Path Abs Dir -&gt; Path Abs t -&gt; IO (Path Abs t)
</span><a href="#local-6989586621679082268"><span class="hs-identifier hs-var hs-var">swapParent</span></a></span></span><span> </span><span id="local-6989586621679082267"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082267"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679082266"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082266"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span id="local-6989586621679082265"><span class="annot"><span class="annottext">Path Abs t
</span><a href="#local-6989586621679082265"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-475"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082266"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel t -&gt; Path Abs t
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>          </span><span class="annot"><span class="annottext">(Path Rel t -&gt; Path Abs t) -&gt; IO (Path Rel t) -&gt; IO (Path Abs t)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Abs t -&gt; IO (Path Rel t)
forall (m :: * -&gt; *) b t.
MonadThrow m =&gt;
Path b Dir -&gt; Path b t -&gt; m (Path Rel t)
</span><span class="hs-identifier hs-var">stripProperPrefix</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082267"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs t
</span><a href="#local-6989586621679082265"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; IO ()
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#ensureDir"><span class="hs-identifier hs-var">ensureDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082271"><span class="hs-identifier hs-var">bdest</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="annottext">[Path Abs Dir] -&gt; (Path Abs Dir -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082270"><span class="hs-identifier hs-var">dirs</span></a></span><span> </span><span class="annot"><span class="annottext">((Path Abs Dir -&gt; IO ()) -&gt; IO ())
-&gt; (Path Abs Dir -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082262"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082262"><span class="hs-identifier hs-var">srcDir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679082261"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082261"><span class="hs-identifier hs-var">destDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Abs Dir -&gt; Path Abs Dir -&gt; IO (Path Abs Dir)
forall t.
Path Abs Dir -&gt; Path Abs Dir -&gt; Path Abs t -&gt; IO (Path Abs t)
</span><a href="#local-6989586621679082268"><span class="hs-identifier hs-var">swapParent</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082272"><span class="hs-identifier hs-var">bsrc</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082271"><span class="hs-identifier hs-var">bdest</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082262"><span class="hs-identifier hs-var">srcDir</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679082260"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082260"><span class="hs-identifier hs-var">dirIsSymlink</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; IO Bool
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m Bool
</span><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-var">isSymlink</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082262"><span class="hs-identifier hs-var">srcDir</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082260"><span class="hs-identifier hs-var">dirIsSymlink</span></a></span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-483"></span><span>        </span><span id="local-6989586621679082259"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082259"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; IO FilePath
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m FilePath
</span><a href="Path.IO.html#getSymlinkTarget"><span class="hs-identifier hs-var">getSymlinkTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082262"><span class="hs-identifier hs-var">srcDir</span></a></span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createDirectoryLink</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082259"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-485"></span><span>          </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082261"><span class="hs-identifier hs-var">destDir</span></a></span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; IO ()
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#ensureDir"><span class="hs-identifier hs-var">ensureDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082261"><span class="hs-identifier hs-var">destDir</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082275"><span class="hs-identifier hs-var">preserveDirPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
</span><a href="Path.IO.html#ignoringIOErrors"><span class="hs-identifier hs-var">ignoringIOErrors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Abs Dir -&gt; IO ()
forall (m :: * -&gt; *) b0 t0 b1 t1.
MonadIO m =&gt;
Path b0 t0 -&gt; Path b1 t1 -&gt; m ()
</span><a href="Path.IO.html#copyPermissions"><span class="hs-identifier hs-var">copyPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082262"><span class="hs-identifier hs-var">srcDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082261"><span class="hs-identifier hs-var">destDir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="annottext">[Path Abs File] -&gt; (Path Abs File -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Path Abs File]
</span><a href="#local-6989586621679082269"><span class="hs-identifier hs-var">files</span></a></span><span> </span><span class="annot"><span class="annottext">((Path Abs File -&gt; IO ()) -&gt; IO ())
-&gt; (Path Abs File -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082254"><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082254"><span class="hs-identifier hs-var">srcFile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679082253"><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082253"><span class="hs-identifier hs-var">destFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Abs Dir -&gt; Path Abs File -&gt; IO (Path Abs File)
forall t.
Path Abs Dir -&gt; Path Abs Dir -&gt; Path Abs t -&gt; IO (Path Abs t)
</span><a href="#local-6989586621679082268"><span class="hs-identifier hs-var">swapParent</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082272"><span class="hs-identifier hs-var">bsrc</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082271"><span class="hs-identifier hs-var">bdest</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082254"><span class="hs-identifier hs-var">srcFile</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679082252"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082252"><span class="hs-identifier hs-var">fileIsSymlink</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; IO Bool
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m Bool
</span><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-var">isSymlink</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082254"><span class="hs-identifier hs-var">srcFile</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082252"><span class="hs-identifier hs-var">fileIsSymlink</span></a></span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-494"></span><span>        </span><span id="local-6989586621679082251"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082251"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; IO FilePath
forall (m :: * -&gt; *) b t. MonadIO m =&gt; Path b t -&gt; m FilePath
</span><a href="Path.IO.html#getSymlinkTarget"><span class="hs-identifier hs-var">getSymlinkTarget</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082254"><span class="hs-identifier hs-var">srcFile</span></a></span><span>
</span><span id="line-495"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createFileLink</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082251"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs File -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082253"><span class="hs-identifier hs-var">destFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; Path Abs File -&gt; IO ()
forall (m :: * -&gt; *) b0 b1.
MonadIO m =&gt;
Path b0 File -&gt; Path b1 File -&gt; m ()
</span><a href="Path.IO.html#copyFile"><span class="hs-identifier hs-var">copyFile</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082254"><span class="hs-identifier hs-var">srcFile</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082253"><span class="hs-identifier hs-var">destFile</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082275"><span class="hs-identifier hs-var">preserveDirPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
</span><a href="Path.IO.html#ignoringIOErrors"><span class="hs-identifier hs-var">ignoringIOErrors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Abs Dir -&gt; IO ()
forall (m :: * -&gt; *) b0 t0 b1 t1.
MonadIO m =&gt;
Path b0 t0 -&gt; Path b1 t1 -&gt; m ()
</span><a href="Path.IO.html#copyPermissions"><span class="hs-identifier hs-var">copyPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082272"><span class="hs-identifier hs-var">bsrc</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082271"><span class="hs-identifier hs-var">bdest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- Walking directory trees</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- Recursive directory walk functionality, with a flexible API and avoidance</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- of loops. Following are some notes on the design.</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- Callback handler API:</span><span>
</span><span id="line-507"></span><span class="hs-comment">--</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- The callback handler interface is designed to be highly flexible. There are</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- two possible alternative ways to control the traversal:</span><span>
</span><span id="line-510"></span><span class="hs-comment">--</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- - In the context of the parent dir, decide which subdirs to descend into.</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- - In the context of the subdir, decide whether to traverse the subdir or not.</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- We choose the first approach here since it is more flexible and can</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- achieve everything that the second one can. The additional benefit with</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- this is that we can use the parent dir context efficiently instead of</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- each child looking at the parent context independently.</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- To control which subdirs to descend we use a 'WalkExclude' API instead of</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- a &#8220;WalkInclude&#8221; type of API so that the handlers cannot accidentally ask</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- us to descend a dir which is not a subdir of the directory being walked.</span><span>
</span><span id="line-522"></span><span class="hs-comment">--</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- Avoiding Traversal Loops:</span><span>
</span><span id="line-524"></span><span class="hs-comment">--</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- There can be loops in the path being traversed due to subdirectory</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- symlinks or filesystem corruptions can cause loops by creating directory</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- hardlinks. Also, if the filesystem is changing while we are traversing</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- then we might be going in loops due to the changes.</span><span>
</span><span id="line-529"></span><span class="hs-comment">--</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- We record the path we are coming from to detect the loops. If we end up</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- traversing the same directory again we are in a loop.</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="hs-comment">-- | Action returned by the traversal handler function. The action controls</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- how the traversal will proceed.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- __Note__: in version /1.4.0/ the type was adjusted to have the @b@ type</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- parameter.</span><span>
</span><span id="line-538"></span><span class="hs-comment">--</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- @since 1.2.0</span><span>
</span><span id="line-540"></span><span class="hs-keyword">data</span><span> </span><span id="WalkAction"><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-var">WalkAction</span></a></span></span><span> </span><span id="local-6989586621679082732"><span class="annot"><a href="#local-6989586621679082732"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Finish the entire walk altogether</span><span>
</span><span id="line-542"></span><span>    </span><span id="WalkFinish"><span class="annot"><a href="Path.IO.html#WalkFinish"><span class="hs-identifier hs-var">WalkFinish</span></a></span></span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | List of sub-directories to exclude from</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-comment">-- descending</span><span>
</span><span id="line-545"></span><span>    </span><span id="WalkExclude"><span class="annot"><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-var">WalkExclude</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082732"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679082245"><span id="local-6989586621679082247"><span class="annot"><span class="annottext">WalkAction b -&gt; WalkAction b -&gt; Bool
(WalkAction b -&gt; WalkAction b -&gt; Bool)
-&gt; (WalkAction b -&gt; WalkAction b -&gt; Bool) -&gt; Eq (WalkAction b)
forall b. WalkAction b -&gt; WalkAction b -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WalkAction b -&gt; WalkAction b -&gt; Bool
$c/= :: forall b. WalkAction b -&gt; WalkAction b -&gt; Bool
== :: WalkAction b -&gt; WalkAction b -&gt; Bool
$c== :: forall b. WalkAction b -&gt; WalkAction b -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082238"><span id="local-6989586621679082240"><span id="local-6989586621679082242"><span class="annot"><span class="annottext">Int -&gt; WalkAction b -&gt; FilePath -&gt; FilePath
[WalkAction b] -&gt; FilePath -&gt; FilePath
WalkAction b -&gt; FilePath
(Int -&gt; WalkAction b -&gt; FilePath -&gt; FilePath)
-&gt; (WalkAction b -&gt; FilePath)
-&gt; ([WalkAction b] -&gt; FilePath -&gt; FilePath)
-&gt; Show (WalkAction b)
forall b. Int -&gt; WalkAction b -&gt; FilePath -&gt; FilePath
forall b. [WalkAction b] -&gt; FilePath -&gt; FilePath
forall b. WalkAction b -&gt; FilePath
forall a.
(Int -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
showList :: [WalkAction b] -&gt; FilePath -&gt; FilePath
$cshowList :: forall b. [WalkAction b] -&gt; FilePath -&gt; FilePath
show :: WalkAction b -&gt; FilePath
$cshow :: forall b. WalkAction b -&gt; FilePath
showsPrec :: Int -&gt; WalkAction b -&gt; FilePath -&gt; FilePath
$cshowsPrec :: forall b. Int -&gt; WalkAction b -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | Traverse a directory tree using depth first pre-order traversal,</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- calling a handler function at each directory node traversed. The absolute</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- paths of the parent directory, sub-directories and the files in the</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- directory are provided as arguments to the handler.</span><span>
</span><span id="line-552"></span><span class="hs-comment">--</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- The function is capable of detecting and avoiding traversal loops in the</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- directory tree. Note that the traversal follows symlinks by default, an</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- appropriate traversal handler can be used to avoid that when necessary.</span><span>
</span><span id="line-556"></span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- @since 1.2.0</span><span>
</span><span id="line-558"></span><span id="local-6989586621679082635"><span id="local-6989586621679082636"><span class="annot"><a href="Path.IO.html#walkDir"><span class="hs-identifier hs-type">walkDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-559"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082636"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-comment">-- | Handler (@dir -&gt; subdirs -&gt; files -&gt; 'WalkAction'@)</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082636"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-comment">-- | Directory where traversal begins</span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082635"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><a href="#local-6989586621679082636"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-565"></span><span id="walkDir"><span class="annot"><span class="annottext">walkDir :: (Path Abs Dir
 -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#walkDir"><span class="hs-identifier hs-var hs-var">walkDir</span></a></span></span><span> </span><span id="local-6989586621679082236"><span class="annot"><span class="annottext">Path Abs Dir
-&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs)
</span><a href="#local-6989586621679082236"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span id="local-6989586621679082235"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082235"><span class="hs-identifier hs-var">topdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe ()) -&gt; m ()) -&gt; m (Maybe ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082235"><span class="hs-identifier hs-var">topdir</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir) -&gt; (Path Abs Dir -&gt; m (Maybe ())) -&gt; m (Maybe ())
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Abs Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082233"><span class="hs-identifier hs-var">walkAvoidLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-569"></span><span>    </span><span id="local-6989586621679082233"><span class="annot"><span class="annottext">walkAvoidLoop :: Set (DeviceID, FileID) -&gt; Path Abs Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082233"><span class="hs-identifier hs-var hs-var">walkAvoidLoop</span></a></span></span><span> </span><span id="local-6989586621679082231"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082231"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082230"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082230"><span class="hs-identifier hs-var">curdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-570"></span><span>      </span><span id="local-6989586621679082229"><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><a href="#local-6989586621679082229"><span class="hs-identifier hs-var">mRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
forall (m :: * -&gt; *).
MonadIO m =&gt;
Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
</span><a href="#local-6989586621679082228"><span class="hs-identifier hs-var">checkLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082231"><span class="hs-identifier hs-var">traversed</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082230"><span class="hs-identifier hs-var">curdir</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><a href="#local-6989586621679082229"><span class="hs-identifier hs-var">mRes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-572"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; m (Maybe ())) -&gt; Maybe () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679082227"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082227"><span class="hs-identifier hs-var">traversed'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Abs Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082226"><span class="hs-identifier hs-var">walktree</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082227"><span class="hs-identifier hs-var">traversed'</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082230"><span class="hs-identifier hs-var">curdir</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621679082226"><span class="annot"><span class="annottext">walktree :: Set (DeviceID, FileID) -&gt; Path Abs Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082226"><span class="hs-identifier hs-var hs-var">walktree</span></a></span></span><span> </span><span id="local-6989586621679082225"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082225"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082224"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082224"><span class="hs-identifier hs-var">curdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679082223"><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082223"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082222"><span class="annot"><span class="annottext">[Path Abs File]
</span><a href="#local-6989586621679082222"><span class="hs-identifier hs-var">files</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m ([Path Abs Dir], [Path Abs File])
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
Path b Dir -&gt; m ([Path Abs Dir], [Path Abs File])
</span><a href="Path.IO.html#listDir"><span class="hs-identifier hs-var">listDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082224"><span class="hs-identifier hs-var">curdir</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span id="local-6989586621679082221"><span class="annot"><span class="annottext">WalkAction Abs
</span><a href="#local-6989586621679082221"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
-&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs)
</span><a href="#local-6989586621679082236"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082224"><span class="hs-identifier hs-var">curdir</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082223"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Abs File]
</span><a href="#local-6989586621679082222"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WalkAction Abs
</span><a href="#local-6989586621679082221"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-578"></span><span>        </span><span class="annot"><span class="annottext">WalkAction Abs
</span><a href="Path.IO.html#WalkFinish"><span class="hs-identifier hs-var">WalkFinish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-579"></span><span>        </span><span class="annot"><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-type">WalkExclude</span></a></span><span> </span><span id="local-6989586621679082220"><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082220"><span class="hs-identifier hs-var">xdirs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-580"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082223"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Abs Dir] -&gt; [Path Abs Dir] -&gt; [Path Abs Dir]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082220"><span class="hs-identifier hs-var">xdirs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-581"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; m (Maybe ())) -&gt; Maybe () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>            </span><span id="local-6989586621679082219"><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082219"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>              </span><span class="annot"><span class="annottext">MaybeT m () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT m () -&gt; m (Maybe ())) -&gt; MaybeT m () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-584"></span><span>                </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; MaybeT m ()) -&gt; [Path Abs Dir] -&gt; MaybeT m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span>
</span><span id="line-585"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; MaybeT m ()
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe ()) -&gt; MaybeT m ())
-&gt; (Path Abs Dir -&gt; m (Maybe ())) -&gt; Path Abs Dir -&gt; MaybeT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Abs Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082233"><span class="hs-identifier hs-var">walkAvoidLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082225"><span class="hs-identifier hs-var">traversed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>                  </span><span class="annot"><span class="annottext">[Path Abs Dir]
</span><a href="#local-6989586621679082219"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621679082228"><span class="annot"><span class="annottext">checkLoop :: Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
</span><a href="#local-6989586621679082228"><span class="hs-identifier hs-var hs-var">checkLoop</span></a></span></span><span> </span><span id="local-6989586621679082216"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082216"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082215"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082215"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-588"></span><span>      </span><span id="local-6989586621679082214"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082214"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileStatus -&gt; m FileStatus
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO FileStatus -&gt; m FileStatus) -&gt; IO FileStatus -&gt; m FileStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileStatus
</span><span class="hs-identifier hs-var">P.getFileStatus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
</span><span class="hs-identifier hs-var">fromAbsDir</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082215"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082211"><span class="annot"><span class="annottext">ufid :: (DeviceID, FileID)
</span><a href="#local-6989586621679082211"><span class="hs-identifier hs-var hs-var">ufid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileStatus -&gt; DeviceID
</span><span class="hs-identifier hs-var">P.deviceID</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082214"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; FileID
</span><span class="hs-identifier hs-var">P.fileID</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082214"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
-&gt; m (Maybe (Set (DeviceID, FileID)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Set (DeviceID, FileID))
 -&gt; m (Maybe (Set (DeviceID, FileID))))
-&gt; Maybe (Set (DeviceID, FileID))
-&gt; m (Maybe (Set (DeviceID, FileID)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-591"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID) -&gt; Set (DeviceID, FileID) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID)
</span><a href="#local-6989586621679082211"><span class="hs-identifier hs-var">ufid</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082216"><span class="hs-identifier hs-var">traversed</span></a></span><span>
</span><span id="line-592"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-593"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Maybe (Set (DeviceID, FileID))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DeviceID, FileID)
-&gt; Set (DeviceID, FileID) -&gt; Set (DeviceID, FileID)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.insert</span></span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID)
</span><a href="#local-6989586621679082211"><span class="hs-identifier hs-var">ufid</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082216"><span class="hs-identifier hs-var">traversed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">-- | The same as 'walkDir' but uses relative paths. The handler is given</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- @dir@, directory relative to the directory where traversal begins.</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- Sub-directories and files are relative to @dir@.</span><span>
</span><span id="line-598"></span><span class="hs-comment">--</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- @since 1.4.2</span><span>
</span><span id="line-600"></span><span id="local-6989586621679082630"><span id="local-6989586621679082631"><span class="annot"><a href="Path.IO.html#walkDirRel"><span class="hs-identifier hs-type">walkDirRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-comment">-- | Handler (@dir -&gt; subdirs -&gt; files -&gt; 'WalkAction'@)</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><a href="#local-6989586621679082631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-comment">-- | Directory where traversal begins</span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082630"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-610"></span><span>  </span><span class="annot"><a href="#local-6989586621679082631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-611"></span><span id="walkDirRel"><span class="annot"><span class="annottext">walkDirRel :: (Path Rel Dir
 -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#walkDirRel"><span class="hs-identifier hs-var hs-var">walkDirRel</span></a></span></span><span> </span><span id="local-6989586621679082206"><span class="annot"><span class="annottext">Path Rel Dir
-&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel)
</span><a href="#local-6989586621679082206"><span class="hs-identifier hs-var">handler</span></a></span></span><span> </span><span id="local-6989586621679082205"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082205"><span class="hs-identifier hs-var">topdir'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>  </span><span id="local-6989586621679082204"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082204"><span class="hs-identifier hs-var">topdir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082205"><span class="hs-identifier hs-var">topdir'</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082203"><span class="annot"><span class="annottext">walkAvoidLoop :: Set (DeviceID, FileID) -&gt; Path Rel Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var hs-var">walkAvoidLoop</span></a></span></span><span> </span><span id="local-6989586621679082202"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082202"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082201"><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">curdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-614"></span><span>        </span><span id="local-6989586621679082200"><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var">mRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
forall (m :: * -&gt; *).
MonadIO m =&gt;
Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
</span><a href="#local-6989586621679082199"><span class="hs-identifier hs-var">checkLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082202"><span class="hs-identifier hs-var">traversed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082204"><span class="hs-identifier hs-var">topdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel Dir -&gt; Path Abs Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">curdir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><a href="#local-6989586621679082200"><span class="hs-identifier hs-var">mRes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-616"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; m (Maybe ())) -&gt; Maybe () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679082198"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082198"><span class="hs-identifier hs-var">traversed'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Rel Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var">walktree</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082198"><span class="hs-identifier hs-var">traversed'</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082201"><span class="hs-identifier hs-var">curdir</span></a></span><span>
</span><span id="line-618"></span><span>      </span><span id="local-6989586621679082197"><span class="annot"><span class="annottext">walktree :: Set (DeviceID, FileID) -&gt; Path Rel Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082197"><span class="hs-identifier hs-var hs-var">walktree</span></a></span></span><span> </span><span id="local-6989586621679082196"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082196"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082195"><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082195"><span class="hs-identifier hs-var">curdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679082194"><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082194"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082193"><span class="annot"><span class="annottext">[Path Rel File]
</span><a href="#local-6989586621679082193"><span class="hs-identifier hs-var">files</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m ([Path Rel Dir], [Path Rel File])
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
Path b Dir -&gt; m ([Path Rel Dir], [Path Rel File])
</span><a href="Path.IO.html#listDirRel"><span class="hs-identifier hs-var">listDirRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082204"><span class="hs-identifier hs-var">topdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel Dir -&gt; Path Abs Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082195"><span class="hs-identifier hs-var">curdir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>        </span><span id="local-6989586621679082192"><span class="annot"><span class="annottext">WalkAction Rel
</span><a href="#local-6989586621679082192"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
-&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel)
</span><a href="#local-6989586621679082206"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082195"><span class="hs-identifier hs-var">curdir</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082194"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Rel File]
</span><a href="#local-6989586621679082193"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WalkAction Rel
</span><a href="#local-6989586621679082192"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>          </span><span class="annot"><span class="annottext">WalkAction Rel
</span><a href="Path.IO.html#WalkFinish"><span class="hs-identifier hs-var">WalkFinish</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-623"></span><span>          </span><span class="annot"><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-type">WalkExclude</span></a></span><span> </span><span id="local-6989586621679082191"><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082191"><span class="hs-identifier hs-var">xdirs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-624"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082194"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir] -&gt; [Path Rel Dir] -&gt; [Path Rel Dir]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082191"><span class="hs-identifier hs-var">xdirs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-625"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe () -&gt; m (Maybe ())) -&gt; Maybe () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>              </span><span id="local-6989586621679082190"><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082190"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-627"></span><span>                </span><span class="annot"><span class="annottext">MaybeT m () -&gt; m (Maybe ())
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT m () -&gt; m (Maybe ())) -&gt; MaybeT m () -&gt; m (Maybe ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-628"></span><span>                  </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; MaybeT m ()) -&gt; [Path Rel Dir] -&gt; MaybeT m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span>
</span><span id="line-629"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; MaybeT m ()
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe ()) -&gt; MaybeT m ())
-&gt; (Path Rel Dir -&gt; m (Maybe ())) -&gt; Path Rel Dir -&gt; MaybeT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Rel Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var">walkAvoidLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082196"><span class="hs-identifier hs-var">traversed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Rel Dir
</span><a href="#local-6989586621679082195"><span class="hs-identifier hs-var">curdir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir -&gt; Path Rel Dir -&gt; Path Rel Dir
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir -&gt; Path Rel Dir) -&gt; [Path Rel Dir] -&gt; [Path Rel Dir]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Path Rel Dir]
</span><a href="#local-6989586621679082190"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>      </span><span id="local-6989586621679082199"><span class="annot"><span class="annottext">checkLoop :: Set (DeviceID, FileID)
-&gt; Path Abs Dir -&gt; m (Maybe (Set (DeviceID, FileID)))
</span><a href="#local-6989586621679082199"><span class="hs-identifier hs-var hs-var">checkLoop</span></a></span></span><span> </span><span id="local-6989586621679082189"><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082189"><span class="hs-identifier hs-var">traversed</span></a></span></span><span> </span><span id="local-6989586621679082188"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082188"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-632"></span><span>        </span><span id="local-6989586621679082187"><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082187"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FileStatus -&gt; m FileStatus
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO FileStatus -&gt; m FileStatus) -&gt; IO FileStatus -&gt; m FileStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FileStatus
</span><span class="hs-identifier hs-var">P.getFileStatus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
</span><span class="hs-identifier hs-var">fromAbsDir</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082188"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082186"><span class="annot"><span class="annottext">ufid :: (DeviceID, FileID)
</span><a href="#local-6989586621679082186"><span class="hs-identifier hs-var hs-var">ufid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FileStatus -&gt; DeviceID
</span><span class="hs-identifier hs-var">P.deviceID</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082187"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FileStatus -&gt; FileID
</span><span class="hs-identifier hs-var">P.fileID</span></span><span> </span><span class="annot"><span class="annottext">FileStatus
</span><a href="#local-6989586621679082187"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
-&gt; m (Maybe (Set (DeviceID, FileID)))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Set (DeviceID, FileID))
 -&gt; m (Maybe (Set (DeviceID, FileID))))
-&gt; Maybe (Set (DeviceID, FileID))
-&gt; m (Maybe (Set (DeviceID, FileID)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-635"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID) -&gt; Set (DeviceID, FileID) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID)
</span><a href="#local-6989586621679082186"><span class="hs-identifier hs-var">ufid</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082189"><span class="hs-identifier hs-var">traversed</span></a></span><span>
</span><span id="line-636"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Set (DeviceID, FileID))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-637"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Maybe (Set (DeviceID, FileID))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DeviceID, FileID)
-&gt; Set (DeviceID, FileID) -&gt; Set (DeviceID, FileID)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.insert</span></span><span> </span><span class="annot"><span class="annottext">(DeviceID, FileID)
</span><a href="#local-6989586621679082186"><span class="hs-identifier hs-var">ufid</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
</span><a href="#local-6989586621679082189"><span class="hs-identifier hs-var">traversed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="annottext">m (Maybe ()) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (DeviceID, FileID) -&gt; Path Rel Dir -&gt; m (Maybe ())
</span><a href="#local-6989586621679082203"><span class="hs-identifier hs-var">walkAvoidLoop</span></a></span><span> </span><span class="annot"><span class="annottext">Set (DeviceID, FileID)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="hs-special">$(</span><span class="hs-identifier">mkRelDir</span><span> </span><span class="hs-string">&quot;.&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | Similar to 'walkDir' but accepts a 'Monoid'-returning output writer as</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- well. Values returned by the output writer invocations are accumulated</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- and returned.</span><span>
</span><span id="line-643"></span><span class="hs-comment">--</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- Both, the descend handler as well as the output writer can be used for</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- side effects but keep in mind that the output writer runs before the</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- descend handler.</span><span>
</span><span id="line-647"></span><span class="hs-comment">--</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- @since 1.2.0</span><span>
</span><span id="line-649"></span><span id="local-6989586621679082742"><span id="local-6989586621679082743"><span id="local-6989586621679082744"><span class="annot"><a href="Path.IO.html#walkDirAccum"><span class="hs-identifier hs-type">walkDirAccum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082744"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679082743"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-comment">-- | Descend handler (@dir -&gt; subdirs -&gt; files -&gt; 'WalkAction'@),</span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-comment">-- descend the whole tree if omitted</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-comment">-- | Output writer (@dir -&gt; subdirs -&gt; files -&gt; o@)</span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082743"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-comment">-- | Directory where traversal begins</span><span>
</span><span id="line-658"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082742"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-comment">-- | Accumulation of outputs generated by the output writer invocations</span><span>
</span><span id="line-660"></span><span>  </span><span class="annot"><a href="#local-6989586621679082744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082743"><span class="hs-identifier hs-type">o</span></a></span></span></span></span><span>
</span><span id="line-661"></span><span id="walkDirAccum"><span class="annot"><span class="annottext">walkDirAccum :: Maybe
  (Path Abs Dir
   -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; (Path Abs Dir -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccum"><span class="hs-identifier hs-var hs-var">walkDirAccum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Path Abs Dir
  -&gt; [Path Abs Dir]
  -&gt; [Path Abs File]
  -&gt; WriterT o m (WalkAction Abs))
 -&gt; Path b Dir -&gt; WriterT o m ())
-&gt; Maybe
     (Path Abs Dir
      -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; (Path Abs Dir -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
forall (m :: * -&gt; *) o a b.
(MonadIO m, Monoid o) =&gt;
((Path a Dir
  -&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a))
 -&gt; Path b Dir -&gt; WriterT o m ())
-&gt; Maybe
     (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
-&gt; (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccumWith"><span class="hs-identifier hs-var">walkDirAccumWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir
 -&gt; [Path Abs Dir]
 -&gt; [Path Abs File]
 -&gt; WriterT o m (WalkAction Abs))
-&gt; Path b Dir -&gt; WriterT o m ()
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
(Path Abs Dir
 -&gt; [Path Abs Dir] -&gt; [Path Abs File] -&gt; m (WalkAction Abs))
-&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#walkDir"><span class="hs-identifier hs-var">walkDir</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | The same as 'walkDirAccum' but uses relative paths. The handler and</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- writer are given @dir@, directory relative to the directory where</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- traversal begins. Sub-directories and files are relative to @dir@.</span><span>
</span><span id="line-666"></span><span class="hs-comment">--</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- @since 1.4.2</span><span>
</span><span id="line-668"></span><span id="local-6989586621679082721"><span id="local-6989586621679082722"><span id="local-6989586621679082723"><span class="annot"><a href="Path.IO.html#walkDirAccumRel"><span class="hs-identifier hs-type">walkDirAccumRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679082722"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-670"></span><span>  </span><span class="hs-comment">-- | Descend handler (@dir -&gt; subdirs -&gt; files -&gt; 'WalkAction'@),</span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-comment">-- descend the whole tree if omitted</span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-comment">-- | Output writer (@dir -&gt; subdirs -&gt; files -&gt; o@)</span><span>
</span><span id="line-675"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082722"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-comment">-- | Directory where traversal begins</span><span>
</span><span id="line-677"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082721"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-678"></span><span>  </span><span class="hs-comment">-- | Accumulation of outputs generated by the output writer invocations</span><span>
</span><span id="line-679"></span><span>  </span><span class="annot"><a href="#local-6989586621679082723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082722"><span class="hs-identifier hs-type">o</span></a></span></span></span></span><span>
</span><span id="line-680"></span><span id="walkDirAccumRel"><span class="annot"><span class="annottext">walkDirAccumRel :: Maybe
  (Path Rel Dir
   -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; (Path Rel Dir -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccumRel"><span class="hs-identifier hs-var hs-var">walkDirAccumRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Path Rel Dir
  -&gt; [Path Rel Dir]
  -&gt; [Path Rel File]
  -&gt; WriterT o m (WalkAction Rel))
 -&gt; Path b Dir -&gt; WriterT o m ())
-&gt; Maybe
     (Path Rel Dir
      -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; (Path Rel Dir -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
forall (m :: * -&gt; *) o a b.
(MonadIO m, Monoid o) =&gt;
((Path a Dir
  -&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a))
 -&gt; Path b Dir -&gt; WriterT o m ())
-&gt; Maybe
     (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
-&gt; (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccumWith"><span class="hs-identifier hs-var">walkDirAccumWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Path Rel Dir
 -&gt; [Path Rel Dir]
 -&gt; [Path Rel File]
 -&gt; WriterT o m (WalkAction Rel))
-&gt; Path b Dir -&gt; WriterT o m ()
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
(Path Rel Dir
 -&gt; [Path Rel Dir] -&gt; [Path Rel File] -&gt; m (WalkAction Rel))
-&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#walkDirRel"><span class="hs-identifier hs-var">walkDirRel</span></a></span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span class="hs-comment">-- | Non-public helper function for defining accumulating walking actions.</span><span>
</span><span id="line-683"></span><span id="local-6989586621679082637"><span id="local-6989586621679082638"><span id="local-6989586621679082639"><span id="local-6989586621679082640"><span class="annot"><a href="Path.IO.html#walkDirAccumWith"><span class="hs-identifier hs-type">walkDirAccumWith</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-684"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679082639"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-comment">-- | The walk function we use</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679082639"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-691"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082637"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679082639"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-comment">-- | Descend handler (@dir -&gt; subdirs -&gt; files -&gt; 'WalkAction'@),</span><span>
</span><span id="line-695"></span><span>  </span><span class="hs-comment">-- descend the whole tree if omitted</span><span>
</span><span id="line-696"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#WalkAction"><span class="hs-identifier hs-type">WalkAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-comment">-- | Output writer (@dir -&gt; subdirs -&gt; files -&gt; o@)</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082639"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-comment">-- | Directory where traversal begins</span><span>
</span><span id="line-700"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082637"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-comment">-- | Accumulation of outputs generated by the output writer invocations</span><span>
</span><span id="line-702"></span><span>  </span><span class="annot"><a href="#local-6989586621679082640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082639"><span class="hs-identifier hs-type">o</span></a></span></span></span></span></span><span>
</span><span id="line-703"></span><span id="walkDirAccumWith"><span class="annot"><span class="annottext">walkDirAccumWith :: ((Path a Dir
  -&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a))
 -&gt; Path b Dir -&gt; WriterT o m ())
-&gt; Maybe
     (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
-&gt; (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m o)
-&gt; Path b Dir
-&gt; m o
</span><a href="Path.IO.html#walkDirAccumWith"><span class="hs-identifier hs-var hs-var">walkDirAccumWith</span></a></span></span><span> </span><span id="local-6989586621679082183"><span class="annot"><span class="annottext">(Path a Dir
 -&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a))
-&gt; Path b Dir -&gt; WriterT o m ()
</span><a href="#local-6989586621679082183"><span class="hs-identifier hs-var">walkF</span></a></span></span><span> </span><span id="local-6989586621679082182"><span class="annot"><span class="annottext">Maybe
  (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
</span><a href="#local-6989586621679082182"><span class="hs-identifier hs-var">dHandler</span></a></span></span><span> </span><span id="local-6989586621679082181"><span class="annot"><span class="annottext">Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m o
</span><a href="#local-6989586621679082181"><span class="hs-identifier hs-var">writer</span></a></span></span><span> </span><span id="local-6989586621679082180"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082180"><span class="hs-identifier hs-var">topdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>  </span><span class="annot"><span class="annottext">WriterT o m () -&gt; m o
forall (m :: * -&gt; *) w a. Monad m =&gt; WriterT w m a -&gt; m w
</span><span class="hs-identifier hs-var">execWriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Path a Dir
 -&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a))
-&gt; Path b Dir -&gt; WriterT o m ()
</span><a href="#local-6989586621679082183"><span class="hs-identifier hs-var">walkF</span></a></span><span> </span><span class="annot"><span class="annottext">Path a Dir
-&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a)
</span><a href="#local-6989586621679082179"><span class="hs-identifier hs-var">handler</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082180"><span class="hs-identifier hs-var">topdir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679082179"><span class="annot"><span class="annottext">handler :: Path a Dir
-&gt; [Path a Dir] -&gt; [Path a File] -&gt; WriterT o m (WalkAction a)
</span><a href="#local-6989586621679082179"><span class="hs-identifier hs-var hs-var">handler</span></a></span></span><span> </span><span id="local-6989586621679082178"><span class="annot"><span class="annottext">Path a Dir
</span><a href="#local-6989586621679082178"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679082177"><span class="annot"><span class="annottext">[Path a Dir]
</span><a href="#local-6989586621679082177"><span class="hs-identifier hs-var">subdirs</span></a></span></span><span> </span><span id="local-6989586621679082176"><span class="annot"><span class="annottext">[Path a File]
</span><a href="#local-6989586621679082176"><span class="hs-identifier hs-var">files</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-707"></span><span>      </span><span id="local-6989586621679082175"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679082175"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m o -&gt; WriterT o m o
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m o -&gt; WriterT o m o) -&gt; m o -&gt; WriterT o m o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m o
</span><a href="#local-6989586621679082181"><span class="hs-identifier hs-var">writer</span></a></span><span> </span><span class="annot"><span class="annottext">Path a Dir
</span><a href="#local-6989586621679082178"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">[Path a Dir]
</span><a href="#local-6989586621679082177"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path a File]
</span><a href="#local-6989586621679082176"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-708"></span><span>      </span><span class="annot"><span class="annottext">o -&gt; WriterT o m ()
forall (m :: * -&gt; *) w. Monad m =&gt; w -&gt; WriterT w m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679082175"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe
  (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
</span><a href="#local-6989586621679082182"><span class="hs-identifier hs-var">dHandler</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-710"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679082174"><span class="annot"><span class="annottext">Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a)
</span><a href="#local-6989586621679082174"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (WalkAction a) -&gt; WriterT o m (WalkAction a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (WalkAction a) -&gt; WriterT o m (WalkAction a))
-&gt; m (WalkAction a) -&gt; WriterT o m (WalkAction a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a)
</span><a href="#local-6989586621679082174"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Path a Dir
</span><a href="#local-6989586621679082178"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">[Path a Dir]
</span><a href="#local-6989586621679082177"><span class="hs-identifier hs-var">subdirs</span></a></span><span> </span><span class="annot"><span class="annottext">[Path a File]
</span><a href="#local-6989586621679082176"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-711"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (Path a Dir -&gt; [Path a Dir] -&gt; [Path a File] -&gt; m (WalkAction a))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WalkAction a -&gt; WriterT o m (WalkAction a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Path a Dir] -&gt; WalkAction a
forall b. [Path b Dir] -&gt; WalkAction b
</span><a href="Path.IO.html#WalkExclude"><span class="hs-identifier hs-var">WalkExclude</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- Current working directory</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">-- | Obtain the current working directory as an absolute path.</span><span>
</span><span id="line-717"></span><span class="hs-comment">--</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- In a multithreaded program, the current working directory is a global</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- state shared among all threads of the process. Therefore, when performing</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- filesystem operations from multiple threads, it is highly recommended to</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- use absolute rather than relative paths (see: 'makeAbsolute').</span><span>
</span><span id="line-722"></span><span class="hs-comment">--</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-724"></span><span class="hs-comment">--</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-728"></span><span class="hs-comment">--</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- * 'isDoesNotExistError' or 'NoSuchThing'</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- There is no path referring to the working directory.</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- @[EPERM, ENOENT, ESTALE...]@</span><span>
</span><span id="line-732"></span><span class="hs-comment">--</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- * 'isPermissionError' or 'PermissionDenied'</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- @[EACCES]@</span><span>
</span><span id="line-736"></span><span class="hs-comment">--</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- Insufficient resources are available to perform the operation.</span><span>
</span><span id="line-739"></span><span class="hs-comment">--</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- The operating system has no notion of current working directory.</span><span>
</span><span id="line-742"></span><span id="local-6989586621679082604"><span class="annot"><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-type">getCurrentDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082604"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-743"></span><span id="getCurrentDir"><span class="annot"><span class="annottext">getCurrentDir :: m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var hs-var">getCurrentDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">D.getCurrentDirectory</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- | Change the working directory to the given path.</span><span>
</span><span id="line-746"></span><span class="hs-comment">--</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- In a multithreaded program, the current working directory is a global</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- state shared among all threads of the process. Therefore, when performing</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- filesystem operations from multiple threads, it is highly recommended to</span><span>
</span><span id="line-750"></span><span class="hs-comment">-- use absolute rather than relative paths (see: 'makeAbsolute').</span><span>
</span><span id="line-751"></span><span class="hs-comment">--</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-753"></span><span class="hs-comment">--</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-757"></span><span class="hs-comment">--</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- The operand is not a valid directory name.</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-761"></span><span class="hs-comment">--</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- * 'isDoesNotExistError' or 'NoSuchThing'</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- The directory does not exist.</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-765"></span><span class="hs-comment">--</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- * 'isPermissionError' or 'PermissionDenied'</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- @[EACCES]@</span><span>
</span><span id="line-769"></span><span class="hs-comment">--</span><span>
</span><span id="line-770"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- The operating system has no notion of current working directory, or the</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- working directory cannot be dynamically changed.</span><span>
</span><span id="line-773"></span><span class="hs-comment">--</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- The path refers to an existing non-directory object.</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- @[ENOTDIR]@</span><span>
</span><span id="line-777"></span><span id="local-6989586621679082170"><span id="local-6989586621679082171"><span class="annot"><a href="Path.IO.html#setCurrentDir"><span class="hs-identifier hs-type">setCurrentDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082171"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082170"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082171"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-778"></span><span id="setCurrentDir"><span class="annot"><span class="annottext">setCurrentDir :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#setCurrentDir"><span class="hs-identifier hs-var hs-var">setCurrentDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.setCurrentDirectory</span></span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-comment">-- | Run an 'IO' action with the given working directory and restore the</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- original working directory afterwards, even if the given action fails due</span><span>
</span><span id="line-782"></span><span class="hs-comment">-- to an exception.</span><span>
</span><span id="line-783"></span><span class="hs-comment">--</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- The operation may fail with the same exceptions as 'getCurrentDir' and</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- 'setCurrentDir'.</span><span>
</span><span id="line-786"></span><span id="local-6989586621679082166"><span id="local-6989586621679082167"><span id="local-6989586621679082168"><span class="annot"><a href="Path.IO.html#withCurrentDir"><span class="hs-identifier hs-type">withCurrentDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082168"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679082168"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-788"></span><span>  </span><span class="hs-comment">-- | Directory to execute in</span><span>
</span><span id="line-789"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082167"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-comment">-- | Action to be executed</span><span>
</span><span id="line-791"></span><span>  </span><span class="annot"><a href="#local-6989586621679082168"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082166"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-792"></span><span>  </span><span class="annot"><a href="#local-6989586621679082168"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082166"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-793"></span><span id="withCurrentDir"><span class="annot"><span class="annottext">withCurrentDir :: Path b Dir -&gt; m a -&gt; m a
</span><a href="Path.IO.html#withCurrentDir"><span class="hs-identifier hs-var hs-var">withCurrentDir</span></a></span></span><span> </span><span id="local-6989586621679082165"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082165"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679082164"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679082164"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-794"></span><span>  </span><span class="annot"><span class="annottext">m (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; m ()) -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a c b.
MonadMask m =&gt;
m a -&gt; (a -&gt; m c) -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var">getCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m ()
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#setCurrentDir"><span class="hs-identifier hs-var">setCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">((Path Abs Dir -&gt; m a) -&gt; m a) -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; Path Abs Dir -&gt; m a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir -&gt; m ()
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b Dir -&gt; m ()
</span><a href="Path.IO.html#setCurrentDir"><span class="hs-identifier hs-var">setCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082165"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679082164"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- Pre-defined directories</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">-- | Return the current user's home directory.</span><span>
</span><span id="line-800"></span><span class="hs-comment">--</span><span>
</span><span id="line-801"></span><span class="hs-comment">-- The directory returned is expected to be writable by the current user,</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- but note that it isn't generally considered good practice to store</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- application-specific data here; use 'getAppUserDataDir' instead.</span><span>
</span><span id="line-804"></span><span class="hs-comment">--</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- On Unix, 'getHomeDir' returns the value of the @HOME@ environment</span><span>
</span><span id="line-806"></span><span class="hs-comment">-- variable. On Windows, the system is queried for a suitable path; a</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- typical path might be @C:\/Users\//\&lt;user\&gt;/@.</span><span>
</span><span id="line-808"></span><span class="hs-comment">--</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-810"></span><span class="hs-comment">--</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- The operating system has no notion of home directory.</span><span>
</span><span id="line-813"></span><span class="hs-comment">--</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- * 'isDoesNotExistError'</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- The home directory for the current user does not exist, or</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- cannot be found.</span><span>
</span><span id="line-817"></span><span id="local-6989586621679082161"><span class="annot"><a href="Path.IO.html#getHomeDir"><span class="hs-identifier hs-type">getHomeDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082161"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082161"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-818"></span><span id="getHomeDir"><span class="annot"><span class="annottext">getHomeDir :: m (Path Abs Dir)
</span><a href="Path.IO.html#getHomeDir"><span class="hs-identifier hs-var hs-var">getHomeDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">D.getHomeDirectory</span></span><span> </span><span class="annot"><span class="annottext">m FilePath -&gt; (FilePath -&gt; m (Path Abs Dir)) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#resolveDir%27"><span class="hs-identifier hs-var">resolveDir'</span></a></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="hs-comment">-- | Obtain the path to a special directory for storing user-specific</span><span>
</span><span id="line-821"></span><span class="hs-comment">-- application data (traditional Unix location).</span><span>
</span><span id="line-822"></span><span class="hs-comment">--</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- The argument is usually the name of the application. Since it will be</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- integrated into the path, it must consist of valid path characters.</span><span>
</span><span id="line-825"></span><span class="hs-comment">--</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- * On Unix-like systems, the path is @~\/./\&lt;app\&gt;/@.</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- * On Windows, the path is @%APPDATA%\//\&lt;app\&gt;/@</span><span>
</span><span id="line-828"></span><span class="hs-comment">--   (e.g. @C:\/Users\//\&lt;user\&gt;/\/AppData\/Roaming\//\&lt;app\&gt;/@)</span><span>
</span><span id="line-829"></span><span class="hs-comment">--</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- Note: the directory may not actually exist, in which case you would need</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- to create it. It is expected that the parent directory exists and is</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- writable.</span><span>
</span><span id="line-833"></span><span class="hs-comment">--</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-835"></span><span class="hs-comment">--</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-837"></span><span class="hs-comment">--   The operating system has no notion of application-specific data</span><span>
</span><span id="line-838"></span><span class="hs-comment">--   directory.</span><span>
</span><span id="line-839"></span><span class="hs-comment">--</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- * 'isDoesNotExistError'</span><span>
</span><span id="line-841"></span><span class="hs-comment">--   The home directory for the current user does not exist, or cannot be</span><span>
</span><span id="line-842"></span><span class="hs-comment">--   found.</span><span>
</span><span id="line-843"></span><span id="local-6989586621679082159"><span class="annot"><a href="Path.IO.html#getAppUserDataDir"><span class="hs-identifier hs-type">getAppUserDataDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-844"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082159"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-comment">-- | Name of application (used in path construction)</span><span>
</span><span id="line-846"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-847"></span><span>  </span><span class="annot"><a href="#local-6989586621679082159"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-848"></span><span id="getAppUserDataDir"><span class="annot"><span class="annottext">getAppUserDataDir :: FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getAppUserDataDir"><span class="hs-identifier hs-var hs-var">getAppUserDataDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; FilePath -&gt; m (Path Abs Dir)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO FilePath -&gt; IO (Path Abs Dir))
-&gt; (FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO (Path Abs Dir)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.getAppUserDataDirectory</span></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-comment">-- | Return the current user's document directory.</span><span>
</span><span id="line-851"></span><span class="hs-comment">--</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- The directory returned is expected to be writable by the current user,</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- but note that it isn't generally considered good practice to store</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- application-specific data here; use 'getAppUserDataDir' instead.</span><span>
</span><span id="line-855"></span><span class="hs-comment">--</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- On Unix, 'getUserDocsDir' returns the value of the @HOME@ environment</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- variable. On Windows, the system is queried for a suitable path; a</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- typical path might be @C:\/Users\//\&lt;user\&gt;/\/Documents@.</span><span>
</span><span id="line-859"></span><span class="hs-comment">--</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-861"></span><span class="hs-comment">--</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-863"></span><span class="hs-comment">-- The operating system has no notion of document directory.</span><span>
</span><span id="line-864"></span><span class="hs-comment">--</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- * 'isDoesNotExistError'</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- The document directory for the current user does not exist, or</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- cannot be found.</span><span>
</span><span id="line-868"></span><span id="local-6989586621679082156"><span class="annot"><a href="Path.IO.html#getUserDocsDir"><span class="hs-identifier hs-type">getUserDocsDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082156"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082156"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-869"></span><span id="getUserDocsDir"><span class="annot"><span class="annottext">getUserDocsDir :: m (Path Abs Dir)
</span><a href="Path.IO.html#getUserDocsDir"><span class="hs-identifier hs-var hs-var">getUserDocsDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">D.getUserDocumentsDirectory</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-870"></span><span>
</span><span id="line-871"></span><span class="hs-comment">-- | Return the current directory for temporary files.</span><span>
</span><span id="line-872"></span><span class="hs-comment">--</span><span>
</span><span id="line-873"></span><span class="hs-comment">-- On Unix, 'getTempDir' returns the value of the @TMPDIR@ environment</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- variable or \&quot;\/tmp\&quot; if the variable isn\'t defined. On Windows, the</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- function checks for the existence of environment variables in the</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- following order and uses the first path found:</span><span>
</span><span id="line-877"></span><span class="hs-comment">--</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- *</span><span>
</span><span id="line-879"></span><span class="hs-comment">-- TMP environment variable.</span><span>
</span><span id="line-880"></span><span class="hs-comment">--</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- *</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- TEMP environment variable.</span><span>
</span><span id="line-883"></span><span class="hs-comment">--</span><span>
</span><span id="line-884"></span><span class="hs-comment">-- *</span><span>
</span><span id="line-885"></span><span class="hs-comment">-- USERPROFILE environment variable.</span><span>
</span><span id="line-886"></span><span class="hs-comment">--</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- *</span><span>
</span><span id="line-888"></span><span class="hs-comment">-- The Windows directory</span><span>
</span><span id="line-889"></span><span class="hs-comment">--</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-891"></span><span class="hs-comment">--</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- The operating system has no notion of temporary directory.</span><span>
</span><span id="line-894"></span><span class="hs-comment">--</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- The function doesn't verify whether the path exists.</span><span>
</span><span id="line-896"></span><span id="local-6989586621679082154"><span class="annot"><a href="Path.IO.html#getTempDir"><span class="hs-identifier hs-type">getTempDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082154"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082154"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-897"></span><span id="getTempDir"><span class="annot"><span class="annottext">getTempDir :: m (Path Abs Dir)
</span><a href="Path.IO.html#getTempDir"><span class="hs-identifier hs-var hs-var">getTempDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><span class="hs-identifier hs-var">D.getTemporaryDirectory</span></span><span> </span><span class="annot"><span class="annottext">m FilePath -&gt; (FilePath -&gt; m (Path Abs Dir)) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#resolveDir%27"><span class="hs-identifier hs-var">resolveDir'</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="hs-comment">-- | Obtain the paths to special directories for storing user-specific</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- application data, configuration, and cache files, conforming to the</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- &lt;http://standards.freedesktop.org/basedir-spec/basedir-spec-latest.html XDG Base Directory Specification&gt;.</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- Compared with 'getAppUserDataDir', this function provides a more</span><span>
</span><span id="line-903"></span><span class="hs-comment">-- fine-grained hierarchy as well as greater flexibility for the user.</span><span>
</span><span id="line-904"></span><span class="hs-comment">--</span><span>
</span><span id="line-905"></span><span class="hs-comment">-- It also works on Windows, although in that case 'D.XdgData' and</span><span>
</span><span id="line-906"></span><span class="hs-comment">-- 'D.XdgConfig' will map to the same directory.</span><span>
</span><span id="line-907"></span><span class="hs-comment">--</span><span>
</span><span id="line-908"></span><span class="hs-comment">-- Note: The directory may not actually exist, in which case you would need</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- to create it with file mode @700@ (i.e. only accessible by the owner).</span><span>
</span><span id="line-910"></span><span class="hs-comment">--</span><span>
</span><span id="line-911"></span><span class="hs-comment">-- Note also: this is a piece of conditional API, only available if</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- @directory-1.2.3.0@ or later is used.</span><span>
</span><span id="line-913"></span><span class="hs-comment">--</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- @since 1.2.1</span><span>
</span><span id="line-915"></span><span id="local-6989586621679082152"><span class="annot"><a href="Path.IO.html#getXdgDir"><span class="hs-identifier hs-type">getXdgDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-917"></span><span>  </span><span class="hs-comment">-- | Which special directory</span><span>
</span><span id="line-918"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">D.XdgDirectory</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-comment">-- | A relative path that is appended to the path; if 'Nothing', the</span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-comment">-- base path is returned</span><span>
</span><span id="line-921"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><a href="#local-6989586621679082152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-923"></span><span id="getXdgDir"><span class="annot"><span class="annottext">getXdgDir :: XdgDirectory -&gt; Maybe (Path Rel Dir) -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getXdgDir"><span class="hs-identifier hs-var hs-var">getXdgDir</span></a></span></span><span> </span><span id="local-6989586621679082151"><span class="annot"><span class="annottext">XdgDirectory
</span><a href="#local-6989586621679082151"><span class="hs-identifier hs-var">xdgDir</span></a></span></span><span> </span><span id="local-6989586621679082150"><span class="annot"><span class="annottext">Maybe (Path Rel Dir)
</span><a href="#local-6989586621679082150"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XdgDirectory -&gt; FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.getXdgDirectory</span></span><span> </span><span class="annot"><span class="annottext">XdgDirectory
</span><a href="#local-6989586621679082151"><span class="hs-identifier hs-var">xdgDir</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; (Path Rel Dir -&gt; FilePath) -&gt; Maybe (Path Rel Dir) -&gt; FilePath
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Path Rel Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Path Rel Dir)
</span><a href="#local-6989586621679082150"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-925"></span><span>
</span><span id="line-926"></span><span class="hs-comment">-- | Similar to 'getXdgDir' but retrieves the entire list of XDG</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- directories.</span><span>
</span><span id="line-928"></span><span class="hs-comment">--</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- On Windows, 'D.XdgDataDirs' and 'D.XdgConfigDirs' usually map to the same</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- list of directories unless overridden.</span><span>
</span><span id="line-931"></span><span class="hs-comment">--</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- Refer to the docs of 'D.XdgDirectoryList' for more details.</span><span>
</span><span id="line-933"></span><span class="hs-comment">--</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-935"></span><span id="local-6989586621679082147"><span class="annot"><a href="Path.IO.html#getXdgDirList"><span class="hs-identifier hs-type">getXdgDirList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-936"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-comment">-- | Which special directory list</span><span>
</span><span id="line-938"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">D.XdgDirectoryList</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-939"></span><span>  </span><span class="annot"><a href="#local-6989586621679082147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-940"></span><span id="getXdgDirList"><span class="annot"><span class="annottext">getXdgDirList :: XdgDirectoryList -&gt; m [Path Abs Dir]
</span><a href="Path.IO.html#getXdgDirList"><span class="hs-identifier hs-var hs-var">getXdgDirList</span></a></span></span><span> </span><span id="local-6989586621679082146"><span class="annot"><span class="annottext">XdgDirectoryList
</span><a href="#local-6989586621679082146"><span class="hs-identifier hs-var">xdgDirList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-941"></span><span>  </span><span class="annot"><span class="annottext">IO [Path Abs Dir] -&gt; m [Path Abs Dir]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XdgDirectoryList -&gt; IO [FilePath]
</span><span class="hs-identifier hs-var">D.getXdgDirectoryList</span></span><span> </span><span class="annot"><span class="annottext">XdgDirectoryList
</span><a href="#local-6989586621679082146"><span class="hs-identifier hs-var">xdgDirList</span></a></span><span> </span><span class="annot"><span class="annottext">IO [FilePath]
-&gt; ([FilePath] -&gt; IO [Path Abs Dir]) -&gt; IO [Path Abs Dir]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Path Abs Dir)) -&gt; [FilePath] -&gt; IO [Path Abs Dir]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-944"></span><span class="hs-comment">-- Path transformation</span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="hs-comment">-- | Class of things ('Path's) that can be canonicalized, made absolute, and</span><span>
</span><span id="line-947"></span><span class="hs-comment">-- made relative to a some base directory.</span><span>
</span><span id="line-948"></span><span class="hs-keyword">class</span><span> </span><span id="AnyPath"><span class="annot"><a href="Path.IO.html#AnyPath"><span class="hs-identifier hs-var">AnyPath</span></a></span></span><span> </span><span id="local-6989586621679082791"><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-949"></span><span>  </span><span class="hs-comment">-- | Type of absolute version of the given @path@.</span><span>
</span><span id="line-950"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AbsPath"><span class="annot"><a href="Path.IO.html#AbsPath"><span class="hs-identifier hs-var">AbsPath</span></a></span></span><span> </span><span id="local-6989586621679082791"><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span>  </span><span class="hs-comment">-- | Type of relative version of the given @path@.</span><span>
</span><span id="line-953"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="RelPath"><span class="annot"><a href="Path.IO.html#RelPath"><span class="hs-identifier hs-var">RelPath</span></a></span></span><span> </span><span id="local-6989586621679082791"><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-comment">-- | Make a path absolute and remove as many indirections from it as</span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-comment">-- possible. Indirections include the two special directories @.@ and</span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-comment">-- @..@, as well as any symbolic links. The input path need not point to</span><span>
</span><span id="line-958"></span><span>  </span><span class="hs-comment">-- an existing file or directory.</span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-comment">-- __Note__: if you require only an absolute path, use 'makeAbsolute'</span><span>
</span><span id="line-961"></span><span>  </span><span class="hs-comment">-- instead. Most programs need not care about whether a path contains</span><span>
</span><span id="line-962"></span><span>  </span><span class="hs-comment">-- symbolic links.</span><span>
</span><span id="line-963"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-comment">-- Due to the fact that symbolic links are dependent on the state of the</span><span>
</span><span id="line-965"></span><span>  </span><span class="hs-comment">-- existing filesystem, the function can only make a conservative,</span><span>
</span><span id="line-966"></span><span>  </span><span class="hs-comment">-- best-effort attempt. Nevertheless, if the input path points to an</span><span>
</span><span id="line-967"></span><span>  </span><span class="hs-comment">-- existing file or directory, then the output path shall also point to</span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-comment">-- the same file or directory.</span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-970"></span><span>  </span><span class="hs-comment">-- Formally, symbolic links are removed from the longest prefix of the</span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-comment">-- path that still points to an existing file. The function is not atomic,</span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-comment">-- therefore concurrent changes in the filesystem may lead to incorrect</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-comment">-- results.</span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-comment">-- (Despite the name, the function does not guarantee canonicity of the</span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-comment">-- returned path due to the presence of hard links, mount points, etc.)</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-comment">-- /Known bug(s)/: on Windows, the function does not resolve symbolic</span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-comment">-- links.</span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-comment">-- Please note that before version 1.2.3.0 of the @directory@ package,</span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-comment">-- this function had unpredictable behavior on non-existent paths.</span><span>
</span><span id="line-983"></span><span>  </span><span id="local-6989586621679082584"><span id="canonicalizePath"><span class="annot"><a href="Path.IO.html#canonicalizePath"><span class="hs-identifier hs-type">canonicalizePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-984"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082584"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-985"></span><span>    </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-986"></span><span>    </span><span class="annot"><a href="#local-6989586621679082584"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#AbsPath"><span class="hs-identifier hs-type">AbsPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-comment">-- | Make a path absolute by prepending the current directory (if it isn't</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-comment">-- already absolute) and applying 'F.normalise' to the result.</span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-991"></span><span>  </span><span class="hs-comment">-- If the path is already absolute, the operation never fails. Otherwise,</span><span>
</span><span id="line-992"></span><span>  </span><span class="hs-comment">-- the operation may fail with the same exceptions as 'getCurrentDir'.</span><span>
</span><span id="line-993"></span><span>  </span><span id="local-6989586621679082789"><span id="makeAbsolute"><span class="annot"><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-type">makeAbsolute</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-994"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082789"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-995"></span><span>    </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-996"></span><span>    </span><span class="annot"><a href="#local-6989586621679082789"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#AbsPath"><span class="hs-identifier hs-type">AbsPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span>  </span><span class="hs-comment">-- | Make a path relative to a given directory.</span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1000"></span><span>  </span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1001"></span><span>  </span><span id="local-6989586621679082582"><span id="makeRelative"><span class="annot"><a href="Path.IO.html#makeRelative"><span class="hs-identifier hs-type">makeRelative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1002"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679082582"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1003"></span><span>    </span><span class="hs-comment">-- | Base directory</span><span>
</span><span id="line-1004"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1005"></span><span>    </span><span class="hs-comment">-- | Path that will be made relative to base directory</span><span>
</span><span id="line-1006"></span><span>    </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1007"></span><span>    </span><span class="annot"><a href="#local-6989586621679082582"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#RelPath"><span class="hs-identifier hs-type">RelPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-comment">-- | Make a path relative to current working directory.</span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1012"></span><span>  </span><span id="local-6989586621679082580"><span id="makeRelativeToCurrentDir"><span class="annot"><a href="Path.IO.html#makeRelativeToCurrentDir"><span class="hs-identifier hs-type">makeRelativeToCurrentDir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1013"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1014"></span><span>    </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1015"></span><span>    </span><span class="annot"><a href="#local-6989586621679082580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Path.IO.html#RelPath"><span class="hs-identifier hs-type">RelPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082791"><span class="hs-identifier hs-type">path</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span id="local-6989586621679082140"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Path.IO.html#AnyPath"><span class="hs-identifier hs-type">AnyPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082140"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AbsPath"><span class="annot"><a href="Path.IO.html#AbsPath"><span class="hs-identifier hs-var">AbsPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082140"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="RelPath"><span class="annot"><a href="Path.IO.html#RelPath"><span class="hs-identifier hs-var">RelPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082140"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span>
</span><span id="line-1020"></span><span>
</span><span id="line-1021"></span><span>  </span><span id="local-6989586621679082134"><span class="annot"><span class="annottext">canonicalizePath :: Path b File -&gt; m (AbsPath (Path b File))
</span><a href="#local-6989586621679082134"><span class="hs-identifier hs-var hs-var hs-var hs-var">canonicalizePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Path Abs File))
-&gt; Path b File -&gt; m (Path Abs File)
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO (Path Abs File))
 -&gt; Path b File -&gt; m (Path Abs File))
-&gt; (FilePath -&gt; IO (Path Abs File))
-&gt; Path b File
-&gt; m (Path Abs File)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.canonicalizePath</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath)
-&gt; (FilePath -&gt; IO (Path Abs File))
-&gt; FilePath
-&gt; IO (Path Abs File)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span>
</span><span id="line-1022"></span><span>  </span><span id="local-6989586621679082130"><span class="annot"><span class="annottext">makeAbsolute :: Path b File -&gt; m (AbsPath (Path b File))
</span><a href="#local-6989586621679082130"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeAbsolute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Path Abs File))
-&gt; Path b File -&gt; m (Path Abs File)
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; IO (Path Abs File))
 -&gt; Path b File -&gt; m (Path Abs File))
-&gt; (FilePath -&gt; IO (Path Abs File))
-&gt; Path b File
-&gt; m (Path Abs File)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath)
-&gt; (FilePath -&gt; IO (Path Abs File))
-&gt; FilePath
-&gt; IO (Path Abs File)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span>
</span><span id="line-1023"></span><span>  </span><span id="local-6989586621679082128"><span class="annot"><span class="annottext">makeRelative :: Path Abs Dir -&gt; Path b File -&gt; m (RelPath (Path b File))
</span><a href="#local-6989586621679082128"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRelative</span></a></span></span><span> </span><span id="local-6989586621679082127"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082127"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679082126"><span class="annot"><span class="annottext">Path b File
</span><a href="#local-6989586621679082126"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Rel File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Rel File)
</span><span class="hs-identifier hs-var">parseRelFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">F.makeRelative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082127"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b File -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path b File
</span><a href="#local-6989586621679082126"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>  </span><span id="local-6989586621679082124"><span class="annot"><span class="annottext">makeRelativeToCurrentDir :: Path b File -&gt; m (RelPath (Path b File))
</span><a href="#local-6989586621679082124"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRelativeToCurrentDir</span></a></span></span><span> </span><span id="local-6989586621679082123"><span class="annot"><span class="annottext">Path b File
</span><a href="#local-6989586621679082123"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Rel File) -&gt; m (Path Rel File)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Rel File) -&gt; m (Path Rel File))
-&gt; IO (Path Rel File) -&gt; m (Path Rel File)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var">getCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; IO (Path Rel File)) -&gt; IO (Path Rel File)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; Path b File -&gt; IO (Path Rel File))
-&gt; Path b File -&gt; Path Abs Dir -&gt; IO (Path Rel File)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path b File -&gt; IO (Path Rel File)
forall path (m :: * -&gt; *).
(AnyPath path, MonadThrow m) =&gt;
Path Abs Dir -&gt; path -&gt; m (RelPath path)
</span><a href="Path.IO.html#makeRelative"><span class="hs-identifier hs-var">makeRelative</span></a></span><span> </span><span class="annot"><span class="annottext">Path b File
</span><a href="#local-6989586621679082123"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span id="local-6989586621679082121"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Path.IO.html#AnyPath"><span class="hs-identifier hs-type">AnyPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082121"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="AbsPath"><span class="annot"><a href="Path.IO.html#AbsPath"><span class="hs-identifier hs-var">AbsPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082121"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="RelPath"><span class="annot"><a href="Path.IO.html#RelPath"><span class="hs-identifier hs-var">RelPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082121"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span>  </span><span id="local-6989586621679082116"><span class="annot"><span class="annottext">canonicalizePath :: Path b Dir -&gt; m (AbsPath (Path b Dir))
</span><a href="#local-6989586621679082116"><span class="hs-identifier hs-var hs-var hs-var hs-var">canonicalizePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; Path b Dir -&gt; m FilePath
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.canonicalizePath</span></span><span> </span><span class="annot"><span class="annottext">(Path b Dir -&gt; m FilePath)
-&gt; (FilePath -&gt; m (Path Abs Dir)) -&gt; Path b Dir -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; FilePath -&gt; m (Path Abs Dir)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-1031"></span><span>  </span><span id="local-6989586621679082115"><span class="annot"><span class="annottext">makeAbsolute :: Path b Dir -&gt; m (AbsPath (Path b Dir))
</span><a href="#local-6989586621679082115"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeAbsolute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; Path b Dir -&gt; m FilePath
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.makeAbsolute</span></span><span> </span><span class="annot"><span class="annottext">(Path b Dir -&gt; m FilePath)
-&gt; (FilePath -&gt; m (Path Abs Dir)) -&gt; Path b Dir -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; FilePath -&gt; m (Path Abs Dir)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-1032"></span><span>  </span><span id="local-6989586621679082114"><span class="annot"><span class="annottext">makeRelative :: Path Abs Dir -&gt; Path b Dir -&gt; m (RelPath (Path b Dir))
</span><a href="#local-6989586621679082114"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRelative</span></a></span></span><span> </span><span id="local-6989586621679082113"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082113"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679082112"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082112"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Rel Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Rel Dir)
</span><span class="hs-identifier hs-var">parseRelDir</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">F.makeRelative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082113"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082112"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>  </span><span id="local-6989586621679082111"><span class="annot"><span class="annottext">makeRelativeToCurrentDir :: Path b Dir -&gt; m (RelPath (Path b Dir))
</span><a href="#local-6989586621679082111"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRelativeToCurrentDir</span></a></span></span><span> </span><span id="local-6989586621679082110"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082110"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Rel Dir) -&gt; m (Path Rel Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Rel Dir) -&gt; m (Path Rel Dir))
-&gt; IO (Path Rel Dir) -&gt; m (Path Rel Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var">getCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; IO (Path Rel Dir)) -&gt; IO (Path Rel Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; Path b Dir -&gt; IO (Path Rel Dir))
-&gt; Path b Dir -&gt; Path Abs Dir -&gt; IO (Path Rel Dir)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path b Dir -&gt; IO (Path Rel Dir)
forall path (m :: * -&gt; *).
(AnyPath path, MonadThrow m) =&gt;
Path Abs Dir -&gt; path -&gt; m (RelPath path)
</span><a href="Path.IO.html#makeRelative"><span class="hs-identifier hs-var">makeRelative</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082110"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="hs-comment">-- | Append stringly-typed path to an absolute path and then canonicalize</span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- it.</span><span>
</span><span id="line-1037"></span><span class="hs-comment">--</span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1039"></span><span id="local-6989586621679082560"><span class="annot"><a href="Path.IO.html#resolveFile"><span class="hs-identifier hs-type">resolveFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1040"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1041"></span><span>  </span><span class="hs-comment">-- | Base directory</span><span>
</span><span id="line-1042"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1043"></span><span>  </span><span class="hs-comment">-- | Path to resolve</span><span>
</span><span id="line-1044"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1045"></span><span>  </span><span class="annot"><a href="#local-6989586621679082560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1046"></span><span id="resolveFile"><span class="annot"><span class="annottext">resolveFile :: Path Abs Dir -&gt; FilePath -&gt; m (Path Abs File)
</span><a href="Path.IO.html#resolveFile"><span class="hs-identifier hs-var hs-var">resolveFile</span></a></span></span><span> </span><span id="local-6989586621679082109"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082109"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679082108"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082108"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs File) -&gt; m (Path Abs File)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs File) -&gt; m (Path Abs File))
-&gt; IO (Path Abs File) -&gt; m (Path Abs File)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.canonicalizePath</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082109"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">F.&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082108"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO FilePath
-&gt; (FilePath -&gt; IO (Path Abs File)) -&gt; IO (Path Abs File)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="hs-comment">-- | The same as 'resolveFile', but uses current working directory.</span><span>
</span><span id="line-1049"></span><span class="hs-comment">--</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1051"></span><span id="local-6989586621679082107"><span class="annot"><a href="Path.IO.html#resolveFile%27"><span class="hs-identifier hs-type">resolveFile'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1052"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082107"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1053"></span><span>  </span><span class="hs-comment">-- | Path to resolve</span><span>
</span><span id="line-1054"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1055"></span><span>  </span><span class="annot"><a href="#local-6989586621679082107"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1056"></span><span id="resolveFile%27"><span class="annot"><span class="annottext">resolveFile' :: FilePath -&gt; m (Path Abs File)
</span><a href="Path.IO.html#resolveFile%27"><span class="hs-identifier hs-var hs-var">resolveFile'</span></a></span></span><span> </span><span id="local-6989586621679082106"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082106"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var">getCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; m (Path Abs File)) -&gt; m (Path Abs File)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; FilePath -&gt; m (Path Abs File))
-&gt; FilePath -&gt; Path Abs Dir -&gt; m (Path Abs File)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath -&gt; m (Path Abs File)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Path Abs Dir -&gt; FilePath -&gt; m (Path Abs File)
</span><a href="Path.IO.html#resolveFile"><span class="hs-identifier hs-var">resolveFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082106"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- | The same as 'resolveFile', but for directories.</span><span>
</span><span id="line-1059"></span><span class="hs-comment">--</span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1061"></span><span id="local-6989586621679082557"><span class="annot"><a href="Path.IO.html#resolveDir"><span class="hs-identifier hs-type">resolveDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1062"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1063"></span><span>  </span><span class="hs-comment">-- | Base directory</span><span>
</span><span id="line-1064"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1065"></span><span>  </span><span class="hs-comment">-- | Path to resolve</span><span>
</span><span id="line-1066"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1067"></span><span>  </span><span class="annot"><a href="#local-6989586621679082557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1068"></span><span id="resolveDir"><span class="annot"><span class="annottext">resolveDir :: Path Abs Dir -&gt; FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#resolveDir"><span class="hs-identifier hs-var hs-var">resolveDir</span></a></span></span><span> </span><span id="local-6989586621679082105"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082105"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679082104"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082104"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.canonicalizePath</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082105"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">F.&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082104"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-1069"></span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- | The same as 'resolveDir', but uses current working directory.</span><span>
</span><span id="line-1071"></span><span class="hs-comment">--</span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1073"></span><span id="local-6989586621679082598"><span class="annot"><a href="Path.IO.html#resolveDir%27"><span class="hs-identifier hs-type">resolveDir'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1074"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082598"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1075"></span><span>  </span><span class="hs-comment">-- | Path to resolve</span><span>
</span><span id="line-1076"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1077"></span><span>  </span><span class="annot"><a href="#local-6989586621679082598"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1078"></span><span id="resolveDir%27"><span class="annot"><span class="annottext">resolveDir' :: FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#resolveDir%27"><span class="hs-identifier hs-var hs-var">resolveDir'</span></a></span></span><span> </span><span id="local-6989586621679082103"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082103"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getCurrentDir"><span class="hs-identifier hs-var">getCurrentDir</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; m (Path Abs Dir)) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; FilePath -&gt; m (Path Abs Dir))
-&gt; FilePath -&gt; Path Abs Dir -&gt; m (Path Abs Dir)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *).
MonadIO m =&gt;
Path Abs Dir -&gt; FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#resolveDir"><span class="hs-identifier hs-var">resolveDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082103"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1079"></span><span>
</span><span id="line-1080"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- Actions on files</span><span>
</span><span id="line-1082"></span><span>
</span><span id="line-1083"></span><span class="hs-comment">-- | @'removeFile' file@ removes the directory entry for an existing file</span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- @file@, where @file@ is not itself a directory. The implementation may</span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- specify additional constraints which must be satisfied before a file can</span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- be removed (e.g. the file may not be in use by other processes).</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--</span><span>
</span><span id="line-1088"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1089"></span><span class="hs-comment">--</span><span>
</span><span id="line-1090"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-1092"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-1093"></span><span class="hs-comment">--</span><span>
</span><span id="line-1094"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-1095"></span><span class="hs-comment">-- The operand is not a valid file name.</span><span>
</span><span id="line-1096"></span><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-1097"></span><span class="hs-comment">--</span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><span id="line-1099"></span><span class="hs-comment">-- The file does not exist.</span><span>
</span><span id="line-1100"></span><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-1101"></span><span class="hs-comment">--</span><span>
</span><span id="line-1102"></span><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-1103"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-1104"></span><span class="hs-comment">-- @[EROFS, EACCES, EPERM]@</span><span>
</span><span id="line-1105"></span><span class="hs-comment">--</span><span>
</span><span id="line-1106"></span><span class="hs-comment">-- * 'UnsatisfiedConstraints'</span><span>
</span><span id="line-1107"></span><span class="hs-comment">-- Implementation-dependent constraints are not satisfied.</span><span>
</span><span id="line-1108"></span><span class="hs-comment">-- @[EBUSY]@</span><span>
</span><span id="line-1109"></span><span class="hs-comment">--</span><span>
</span><span id="line-1110"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-1111"></span><span class="hs-comment">-- The operand refers to an existing directory.</span><span>
</span><span id="line-1112"></span><span class="hs-comment">-- @[EPERM, EINVAL]@</span><span>
</span><span id="line-1113"></span><span id="local-6989586621679082101"><span id="local-6989586621679082102"><span class="annot"><a href="Path.IO.html#removeFile"><span class="hs-identifier hs-type">removeFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082101"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1114"></span><span id="removeFile"><span class="annot"><span class="annottext">removeFile :: Path b File -&gt; m ()
</span><a href="Path.IO.html#removeFile"><span class="hs-identifier hs-var hs-var">removeFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b File -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.removeFile</span></span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- | @'renameFile' old new@ changes the name of an existing file system</span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- object from /old/ to /new/. If the /new/ object already exists, it is</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- atomically replaced by the /old/ object. Neither path may refer to an</span><span>
</span><span id="line-1119"></span><span class="hs-comment">-- existing directory. A conformant implementation need not support renaming</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- files in all situations (e.g. renaming across different physical</span><span>
</span><span id="line-1121"></span><span class="hs-comment">-- devices), but the constraints must be documented.</span><span>
</span><span id="line-1122"></span><span class="hs-comment">--</span><span>
</span><span id="line-1123"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1124"></span><span class="hs-comment">--</span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- * 'HardwareFault'</span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- A physical I\/O error has occurred.</span><span>
</span><span id="line-1127"></span><span class="hs-comment">-- @[EIO]@</span><span>
</span><span id="line-1128"></span><span class="hs-comment">--</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- * 'InvalidArgument'</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- Either operand is not a valid file name.</span><span>
</span><span id="line-1131"></span><span class="hs-comment">-- @[ENAMETOOLONG, ELOOP]@</span><span>
</span><span id="line-1132"></span><span class="hs-comment">--</span><span>
</span><span id="line-1133"></span><span class="hs-comment">-- * 'isDoesNotExistError' \/ 'NoSuchThing'</span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- The original file does not exist, or there is no path to the target.</span><span>
</span><span id="line-1135"></span><span class="hs-comment">-- @[ENOENT, ENOTDIR]@</span><span>
</span><span id="line-1136"></span><span class="hs-comment">--</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- * 'isPermissionError' \/ 'PermissionDenied'</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- The process has insufficient privileges to perform the operation.</span><span>
</span><span id="line-1139"></span><span class="hs-comment">-- @[EROFS, EACCES, EPERM]@</span><span>
</span><span id="line-1140"></span><span class="hs-comment">--</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- * 'ResourceExhausted'</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- Insufficient resources are available to perform the operation.</span><span>
</span><span id="line-1143"></span><span class="hs-comment">-- @[EDQUOT, ENOSPC, ENOMEM, EMLINK]@</span><span>
</span><span id="line-1144"></span><span class="hs-comment">--</span><span>
</span><span id="line-1145"></span><span class="hs-comment">-- * 'UnsatisfiedConstraints'</span><span>
</span><span id="line-1146"></span><span class="hs-comment">-- Implementation-dependent constraints are not satisfied.</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- @[EBUSY]@</span><span>
</span><span id="line-1148"></span><span class="hs-comment">--</span><span>
</span><span id="line-1149"></span><span class="hs-comment">-- * 'UnsupportedOperation'</span><span>
</span><span id="line-1150"></span><span class="hs-comment">-- The implementation does not support renaming in this situation.</span><span>
</span><span id="line-1151"></span><span class="hs-comment">-- @[EXDEV]@</span><span>
</span><span id="line-1152"></span><span class="hs-comment">--</span><span>
</span><span id="line-1153"></span><span class="hs-comment">-- * 'InappropriateType'</span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- Either path refers to an existing directory.</span><span>
</span><span id="line-1155"></span><span class="hs-comment">-- @[ENOTDIR, EISDIR, EINVAL, EEXIST, ENOTEMPTY]@</span><span>
</span><span id="line-1156"></span><span id="local-6989586621679082097"><span id="local-6989586621679082098"><span id="local-6989586621679082099"><span class="annot"><a href="Path.IO.html#renameFile"><span class="hs-identifier hs-type">renameFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1157"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1158"></span><span>  </span><span class="hs-comment">-- | Original location</span><span>
</span><span id="line-1159"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082098"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1160"></span><span>  </span><span class="hs-comment">-- | New location</span><span>
</span><span id="line-1161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082097"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1162"></span><span>  </span><span class="annot"><a href="#local-6989586621679082099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1163"></span><span id="renameFile"><span class="annot"><span class="annottext">renameFile :: Path b0 File -&gt; Path b1 File -&gt; m ()
</span><a href="Path.IO.html#renameFile"><span class="hs-identifier hs-var hs-var">renameFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO ())
-&gt; Path b0 File -&gt; Path b1 File -&gt; m ()
forall (m :: * -&gt; *) a b0 t0 b1 t1.
MonadIO m =&gt;
(FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var">liftD2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.renameFile</span></span><span>
</span><span id="line-1164"></span><span>
</span><span id="line-1165"></span><span class="hs-comment">-- | @'copyFile' old new@ copies the existing file from @old@ to @new@. If</span><span>
</span><span id="line-1166"></span><span class="hs-comment">-- the @new@ file already exists, it is atomically replaced by the @old@</span><span>
</span><span id="line-1167"></span><span class="hs-comment">-- file. Neither path may refer to an existing directory. The permissions of</span><span>
</span><span id="line-1168"></span><span class="hs-comment">-- @old@ are copied to @new@, if possible.</span><span>
</span><span id="line-1169"></span><span id="local-6989586621679082677"><span id="local-6989586621679082678"><span id="local-6989586621679082679"><span class="annot"><a href="Path.IO.html#copyFile"><span class="hs-identifier hs-type">copyFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1170"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082679"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1171"></span><span>  </span><span class="hs-comment">-- | Original location</span><span>
</span><span id="line-1172"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082678"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-comment">-- | Where to put copy</span><span>
</span><span id="line-1174"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082677"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1175"></span><span>  </span><span class="annot"><a href="#local-6989586621679082679"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1176"></span><span id="copyFile"><span class="annot"><span class="annottext">copyFile :: Path b0 File -&gt; Path b1 File -&gt; m ()
</span><a href="Path.IO.html#copyFile"><span class="hs-identifier hs-var hs-var">copyFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO ())
-&gt; Path b0 File -&gt; Path b1 File -&gt; m ()
forall (m :: * -&gt; *) a b0 t0 b1 t1.
MonadIO m =&gt;
(FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var">liftD2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.copyFile</span></span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span class="hs-comment">-- | Given an executable file name, search for such file in the directories</span><span>
</span><span id="line-1179"></span><span class="hs-comment">-- listed in system @PATH@. The returned value is the path to the found</span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- executable or 'Nothing' if an executable with the given name was not</span><span>
</span><span id="line-1181"></span><span class="hs-comment">-- found. For example ('findExecutable' \&quot;ghc\&quot;) gives you the path to GHC.</span><span>
</span><span id="line-1182"></span><span class="hs-comment">--</span><span>
</span><span id="line-1183"></span><span class="hs-comment">-- The path returned by 'findExecutable' corresponds to the program that</span><span>
</span><span id="line-1184"></span><span class="hs-comment">-- would be executed by 'System.Process.createProcess' when passed the same</span><span>
</span><span id="line-1185"></span><span class="hs-comment">-- string (as a RawCommand, not a ShellCommand).</span><span>
</span><span id="line-1186"></span><span class="hs-comment">--</span><span>
</span><span id="line-1187"></span><span class="hs-comment">-- On Windows, 'findExecutable' calls the Win32 function 'SearchPath', which</span><span>
</span><span id="line-1188"></span><span class="hs-comment">-- may search other places before checking the directories in @PATH@. Where</span><span>
</span><span id="line-1189"></span><span class="hs-comment">-- it actually searches depends on registry settings, but notably includes</span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- the directory containing the current executable. See</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- &lt;http://msdn.microsoft.com/en-us/library/aa365527.aspx&gt; for more details.</span><span>
</span><span id="line-1192"></span><span id="local-6989586621679082094"><span class="annot"><a href="Path.IO.html#findExecutable"><span class="hs-identifier hs-type">findExecutable</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1193"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-comment">-- | Executable file name</span><span>
</span><span id="line-1195"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1196"></span><span>  </span><span class="hs-comment">-- | Path to found executable</span><span>
</span><span id="line-1197"></span><span>  </span><span class="annot"><a href="#local-6989586621679082094"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-1198"></span><span id="findExecutable"><span class="annot"><span class="annottext">findExecutable :: Path Rel File -&gt; m (Maybe (Path Abs File))
</span><a href="Path.IO.html#findExecutable"><span class="hs-identifier hs-var hs-var">findExecutable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; Maybe (Path Abs File))
-&gt; m (Maybe FilePath) -&gt; m (Maybe (Path Abs File))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
-&gt; (FilePath -&gt; Maybe (Path Abs File)) -&gt; Maybe (Path Abs File)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Maybe FilePath) -&gt; m (Maybe (Path Abs File)))
-&gt; (Path Rel File -&gt; m (Maybe FilePath))
-&gt; Path Rel File
-&gt; m (Maybe (Path Abs File))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO (Maybe FilePath))
-&gt; Path Rel File -&gt; m (Maybe FilePath)
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Maybe FilePath)
</span><span class="hs-identifier hs-var">D.findExecutable</span></span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- | Search through the given set of directories for the given file.</span><span>
</span><span id="line-1201"></span><span id="local-6989586621679082539"><span id="local-6989586621679082540"><span class="annot"><a href="Path.IO.html#findFile"><span class="hs-identifier hs-type">findFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1202"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082540"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1203"></span><span>  </span><span class="hs-comment">-- | Set of directories to search in</span><span>
</span><span id="line-1204"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082539"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1205"></span><span>  </span><span class="hs-comment">-- | Filename of interest</span><span>
</span><span id="line-1206"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1207"></span><span>  </span><span class="hs-comment">-- | Absolute path to file (if found)</span><span>
</span><span id="line-1208"></span><span>  </span><span class="annot"><a href="#local-6989586621679082540"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1209"></span><span id="findFile"><span class="annot"><span class="annottext">findFile :: [Path b Dir] -&gt; Path Rel File -&gt; m (Maybe (Path Abs File))
</span><a href="Path.IO.html#findFile"><span class="hs-identifier hs-var hs-var">findFile</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Path Abs File) -&gt; m (Maybe (Path Abs File))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Path Abs File)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1210"></span><span class="annot"><a href="Path.IO.html#findFile"><span class="hs-identifier hs-var">findFile</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679082092"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082092"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679082091"><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082091"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679082090"><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082090"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1211"></span><span>  </span><span id="local-6989586621679082089"><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082089"><span class="hs-identifier hs-var">bfile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel File -&gt; Path Abs File
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082090"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; Path Abs File)
-&gt; m (Path Abs Dir) -&gt; m (Path Abs File)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082092"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1212"></span><span>  </span><span id="local-6989586621679082088"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082088"><span class="hs-identifier hs-var">exist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b File -&gt; m Bool
</span><a href="Path.IO.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082089"><span class="hs-identifier hs-var">bfile</span></a></span><span>
</span><span id="line-1213"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082088"><span class="hs-identifier hs-var">exist</span></a></span><span>
</span><span id="line-1214"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Path Abs File) -&gt; m (Maybe (Path Abs File))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs File -&gt; Maybe (Path Abs File)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082089"><span class="hs-identifier hs-var">bfile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Path b Dir] -&gt; Path Rel File -&gt; m (Maybe (Path Abs File))
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
[Path b Dir] -&gt; Path Rel File -&gt; m (Maybe (Path Abs File))
</span><a href="Path.IO.html#findFile"><span class="hs-identifier hs-var">findFile</span></a></span><span> </span><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082091"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082090"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="hs-comment">-- | Search through the given set of directories for the given file and</span><span>
</span><span id="line-1218"></span><span class="hs-comment">-- return a list of paths where the given file exists.</span><span>
</span><span id="line-1219"></span><span id="local-6989586621679082086"><span id="local-6989586621679082087"><span class="annot"><a href="Path.IO.html#findFiles"><span class="hs-identifier hs-type">findFiles</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1220"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1221"></span><span>  </span><span class="hs-comment">-- | Set of directories to search in</span><span>
</span><span id="line-1222"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082086"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1223"></span><span>  </span><span class="hs-comment">-- | Filename of interest</span><span>
</span><span id="line-1224"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1225"></span><span>  </span><span class="hs-comment">-- | Absolute paths to all found files</span><span>
</span><span id="line-1226"></span><span>  </span><span class="annot"><a href="#local-6989586621679082087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1227"></span><span id="findFiles"><span class="annot"><span class="annottext">findFiles :: [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
</span><a href="Path.IO.html#findFiles"><span class="hs-identifier hs-var hs-var">findFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
</span><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m Bool -&gt; Path Abs File -&gt; m Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>
</span><span id="line-1229"></span><span class="hs-comment">-- | Search through the given set of directories for the given file and with</span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- the given property (usually permissions) and return a list of paths where</span><span>
</span><span id="line-1231"></span><span class="hs-comment">-- the given file exists and has the property.</span><span>
</span><span id="line-1232"></span><span id="local-6989586621679082535"><span id="local-6989586621679082536"><span class="annot"><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-type">findFilesWith</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1234"></span><span>  </span><span class="hs-comment">-- | How to test the files</span><span>
</span><span id="line-1235"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1236"></span><span>  </span><span class="hs-comment">-- | Set of directories to search in</span><span>
</span><span id="line-1237"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082535"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1238"></span><span>  </span><span class="hs-comment">-- | Filename of interest</span><span>
</span><span id="line-1239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rel</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-comment">-- | Absolute paths to all found files</span><span>
</span><span id="line-1241"></span><span>  </span><span class="annot"><a href="#local-6989586621679082536"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-1242"></span><span id="findFilesWith"><span class="annot"><span class="annottext">findFilesWith :: (Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
</span><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-var hs-var">findFilesWith</span></a></span></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Path Abs File] -&gt; m [Path Abs File]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1243"></span><span class="annot"><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a></span><span> </span><span id="local-6989586621679082085"><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
</span><a href="#local-6989586621679082085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679082084"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082084"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679082083"><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082083"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679082082"><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082082"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1244"></span><span>  </span><span id="local-6989586621679082081"><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082081"><span class="hs-identifier hs-var">bfile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; Path Rel File -&gt; Path Abs File
forall b t. Path b Dir -&gt; Path Rel t -&gt; Path b t
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082082"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Abs Dir -&gt; Path Abs File)
-&gt; m (Path Abs Dir) -&gt; m (Path Abs File)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082084"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1245"></span><span>  </span><span id="local-6989586621679082080"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082080"><span class="hs-identifier hs-var">exist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
forall (m :: * -&gt; *) b. MonadIO m =&gt; Path b File -&gt; m Bool
</span><a href="Path.IO.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082081"><span class="hs-identifier hs-var">bfile</span></a></span><span>
</span><span id="line-1246"></span><span>  </span><span id="local-6989586621679082079"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082079"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082080"><span class="hs-identifier hs-var">exist</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
</span><a href="#local-6989586621679082085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082081"><span class="hs-identifier hs-var">bfile</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1247"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082079"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1248"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs File
</span><a href="#local-6989586621679082081"><span class="hs-identifier hs-var">bfile</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; [Path Abs File] -&gt; [Path Abs File]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Path Abs File] -&gt; [Path Abs File])
-&gt; m [Path Abs File] -&gt; m [Path Abs File]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
</span><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
</span><a href="#local-6989586621679082085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082083"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082082"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-1249"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
forall (m :: * -&gt; *) b.
MonadIO m =&gt;
(Path Abs File -&gt; m Bool)
-&gt; [Path b Dir] -&gt; Path Rel File -&gt; m [Path Abs File]
</span><a href="Path.IO.html#findFilesWith"><span class="hs-identifier hs-var">findFilesWith</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; m Bool
</span><a href="#local-6989586621679082085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Path b Dir]
</span><a href="#local-6989586621679082083"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Path Rel File
</span><a href="#local-6989586621679082082"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-1250"></span><span>
</span><span id="line-1251"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1252"></span><span class="hs-comment">-- Symbolic links</span><span>
</span><span id="line-1253"></span><span>
</span><span id="line-1254"></span><span class="hs-comment">-- | Create a /file/ symbolic link. The target path can be either absolute</span><span>
</span><span id="line-1255"></span><span class="hs-comment">-- or relative and need not refer to an existing file. The order of</span><span>
</span><span id="line-1256"></span><span class="hs-comment">-- arguments follows the POSIX convention.</span><span>
</span><span id="line-1257"></span><span class="hs-comment">--</span><span>
</span><span id="line-1258"></span><span class="hs-comment">-- To remove an existing file symbolic link, use 'removeFile'.</span><span>
</span><span id="line-1259"></span><span class="hs-comment">--</span><span>
</span><span id="line-1260"></span><span class="hs-comment">-- Although the distinction between /file/ symbolic links and /directory/</span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- symbolic links does not exist on POSIX systems, on Windows this is an</span><span>
</span><span id="line-1262"></span><span class="hs-comment">-- intrinsic property of every symbolic link and cannot be changed without</span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- recreating the link. A file symbolic link that actually points to a</span><span>
</span><span id="line-1264"></span><span class="hs-comment">-- directory will fail to dereference and vice versa. Moreover, creating</span><span>
</span><span id="line-1265"></span><span class="hs-comment">-- symbolic links on Windows may require privileges unavailable to users</span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- outside the Administrators group. Portable programs that use symbolic</span><span>
</span><span id="line-1267"></span><span class="hs-comment">-- links should take both into consideration.</span><span>
</span><span id="line-1268"></span><span class="hs-comment">--</span><span>
</span><span id="line-1269"></span><span class="hs-comment">-- On Windows, the function is implemented using @CreateSymbolicLink@. Since</span><span>
</span><span id="line-1270"></span><span class="hs-comment">-- 1.3.3.0, the @SYMBOLIC_LINK_FLAG_ALLOW_UNPRIVILEGED_CREATE@ flag is</span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- included if supported by the operating system. On POSIX, the function</span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- uses @symlink@ and is therefore atomic.</span><span>
</span><span id="line-1273"></span><span class="hs-comment">--</span><span>
</span><span id="line-1274"></span><span class="hs-comment">-- Windows-specific errors: This operation may fail with</span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- 'System.IO.Error.permissionErrorType' if the user lacks the privileges to</span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- create symbolic links. It may also fail with</span><span>
</span><span id="line-1277"></span><span class="hs-comment">-- 'System.IO.Error.illegalOperationErrorType' if the file system does not</span><span>
</span><span id="line-1278"></span><span class="hs-comment">-- support symbolic links.</span><span>
</span><span id="line-1279"></span><span class="hs-comment">--</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-1281"></span><span id="local-6989586621679082076"><span id="local-6989586621679082077"><span id="local-6989586621679082078"><span class="annot"><a href="Path.IO.html#createFileLink"><span class="hs-identifier hs-type">createFileLink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1282"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1283"></span><span>  </span><span class="hs-comment">-- | Path to the target file</span><span>
</span><span id="line-1284"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082077"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1285"></span><span>  </span><span class="hs-comment">-- | Path to the link to be created</span><span>
</span><span id="line-1286"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082076"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1287"></span><span>  </span><span class="annot"><a href="#local-6989586621679082078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1288"></span><span id="createFileLink"><span class="annot"><span class="annottext">createFileLink :: Path b0 File -&gt; Path b1 File -&gt; m ()
</span><a href="Path.IO.html#createFileLink"><span class="hs-identifier hs-var hs-var">createFileLink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO ())
-&gt; Path b0 File -&gt; Path b1 File -&gt; m ()
forall (m :: * -&gt; *) a b0 t0 b1 t1.
MonadIO m =&gt;
(FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var">liftD2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createFileLink</span></span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span class="hs-comment">-- | Create a /directory/ symbolic link. The target path can be either</span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- absolute or relative and need not refer to an existing directory. The</span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- order of arguments follows the POSIX convention.</span><span>
</span><span id="line-1293"></span><span class="hs-comment">--</span><span>
</span><span id="line-1294"></span><span class="hs-comment">-- To remove an existing directory symbolic link, use 'removeDirLink'.</span><span>
</span><span id="line-1295"></span><span class="hs-comment">--</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- Although the distinction between /file/ symbolic links and /directory/</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- symbolic links does not exist on POSIX systems, on Windows this is an</span><span>
</span><span id="line-1298"></span><span class="hs-comment">-- intrinsic property of every symbolic link and cannot be changed without</span><span>
</span><span id="line-1299"></span><span class="hs-comment">-- recreating the link. A file symbolic link that actually points to a</span><span>
</span><span id="line-1300"></span><span class="hs-comment">-- directory will fail to dereference and vice versa. Moreover, creating</span><span>
</span><span id="line-1301"></span><span class="hs-comment">-- symbolic links on Windows may require privileges unavailable to users</span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- outside the Administrators group. Portable programs that use symbolic</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- links should take both into consideration.</span><span>
</span><span id="line-1304"></span><span class="hs-comment">--</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- On Windows, the function is implemented using @CreateSymbolicLink@ with</span><span>
</span><span id="line-1306"></span><span class="hs-comment">-- @SYMBOLIC_LINK_FLAG_DIRECTORY@. Since 1.3.3.0, the</span><span>
</span><span id="line-1307"></span><span class="hs-comment">-- @SYMBOLIC_LINK_FLAG_ALLOW_UNPRIVILEGED_CREATE@ flag is also included if</span><span>
</span><span id="line-1308"></span><span class="hs-comment">-- supported by the operating system. On POSIX, this is an alias for</span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- 'createFileLink' and is therefore atomic.</span><span>
</span><span id="line-1310"></span><span class="hs-comment">--</span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- Windows-specific errors: This operation may fail with</span><span>
</span><span id="line-1312"></span><span class="hs-comment">-- 'System.IO.Error.permissionErrorType' if the user lacks the privileges to</span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- create symbolic links. It may also fail with</span><span>
</span><span id="line-1314"></span><span class="hs-comment">-- 'System.IO.Error.illegalOperationErrorType' if the file system does not</span><span>
</span><span id="line-1315"></span><span class="hs-comment">-- support symbolic links.</span><span>
</span><span id="line-1316"></span><span class="hs-comment">--</span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-1318"></span><span id="local-6989586621679082073"><span id="local-6989586621679082074"><span id="local-6989586621679082075"><span class="annot"><a href="Path.IO.html#createDirLink"><span class="hs-identifier hs-type">createDirLink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1319"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082075"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1320"></span><span>  </span><span class="hs-comment">-- | Path to the target directory</span><span>
</span><span id="line-1321"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082074"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1322"></span><span>  </span><span class="hs-comment">-- | Path to the link to be created</span><span>
</span><span id="line-1323"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082073"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1324"></span><span>  </span><span class="annot"><a href="#local-6989586621679082075"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1325"></span><span id="createDirLink"><span class="annot"><span class="annottext">createDirLink :: Path b0 Dir -&gt; Path b1 Dir -&gt; m ()
</span><a href="Path.IO.html#createDirLink"><span class="hs-identifier hs-var hs-var">createDirLink</span></a></span></span><span> </span><span id="local-6989586621679082072"><span class="annot"><span class="annottext">Path b0 Dir
</span><a href="#local-6989586621679082072"><span class="hs-identifier hs-var">target'</span></a></span></span><span> </span><span id="local-6989586621679082071"><span class="annot"><span class="annottext">Path b1 Dir
</span><a href="#local-6989586621679082071"><span class="hs-identifier hs-var">dest'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1326"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082070"><span class="annot"><span class="annottext">target :: FilePath
</span><a href="#local-6989586621679082070"><span class="hs-identifier hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path b0 Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path b0 Dir
</span><a href="#local-6989586621679082072"><span class="hs-identifier hs-var">target'</span></a></span><span>
</span><span id="line-1327"></span><span>      </span><span id="local-6989586621679082069"><span class="annot"><span class="annottext">dest :: FilePath
</span><a href="#local-6989586621679082069"><span class="hs-identifier hs-var hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path b1 Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path b1 Dir
</span><a href="#local-6989586621679082071"><span class="hs-identifier hs-var">dest'</span></a></span><span>
</span><span id="line-1328"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.createDirectoryLink</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082070"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082069"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1329"></span><span>
</span><span id="line-1330"></span><span class="hs-comment">-- | Remove an existing /directory/ symbolic link.</span><span>
</span><span id="line-1331"></span><span class="hs-comment">--</span><span>
</span><span id="line-1332"></span><span class="hs-comment">-- On Windows, this is an alias for 'removeDir'. On POSIX systems, this is</span><span>
</span><span id="line-1333"></span><span class="hs-comment">-- an alias for 'removeFile'.</span><span>
</span><span id="line-1334"></span><span class="hs-comment">--</span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- See also: 'removeFile', which can remove an existing /file/ symbolic link.</span><span>
</span><span id="line-1336"></span><span class="hs-comment">--</span><span>
</span><span id="line-1337"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-1338"></span><span id="local-6989586621679082067"><span id="local-6989586621679082068"><span class="annot"><a href="Path.IO.html#removeDirLink"><span class="hs-identifier hs-type">removeDirLink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1339"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1340"></span><span>  </span><span class="hs-comment">-- | Path to the link to be removed</span><span>
</span><span id="line-1341"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082067"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1342"></span><span>  </span><span class="annot"><a href="#local-6989586621679082068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1343"></span><span id="removeDirLink"><span class="annot"><span class="annottext">removeDirLink :: Path b Dir -&gt; m ()
</span><a href="Path.IO.html#removeDirLink"><span class="hs-identifier hs-var hs-var">removeDirLink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; Path b Dir -&gt; m ()
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.removeDirectoryLink</span></span><span>
</span><span id="line-1344"></span><span>
</span><span id="line-1345"></span><span class="hs-comment">-- | Retrieve the target path of either a file or directory symbolic link.</span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- The returned path may not exist, and may not even be a valid path.</span><span>
</span><span id="line-1347"></span><span class="hs-comment">--</span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- On Windows systems, this calls @DeviceIoControl@ with</span><span>
</span><span id="line-1349"></span><span class="hs-comment">-- @FSCTL_GET_REPARSE_POINT@. In addition to symbolic links, the function</span><span>
</span><span id="line-1350"></span><span class="hs-comment">-- also works on junction points. On POSIX systems, this calls @readlink@.</span><span>
</span><span id="line-1351"></span><span class="hs-comment">--</span><span>
</span><span id="line-1352"></span><span class="hs-comment">-- Windows-specific errors: This operation may fail with</span><span>
</span><span id="line-1353"></span><span class="hs-comment">-- 'System.IO.Error.illegalOperationErrorType' if the file system does not</span><span>
</span><span id="line-1354"></span><span class="hs-comment">-- support symbolic links.</span><span>
</span><span id="line-1355"></span><span class="hs-comment">--</span><span>
</span><span id="line-1356"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-1357"></span><span id="local-6989586621679082686"><span id="local-6989586621679082687"><span id="local-6989586621679082688"><span class="annot"><a href="Path.IO.html#getSymlinkTarget"><span class="hs-identifier hs-type">getSymlinkTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1358"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082688"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1359"></span><span>  </span><span class="hs-comment">-- | Symlink path</span><span>
</span><span id="line-1360"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082687"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082686"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1361"></span><span>  </span><span class="annot"><a href="#local-6989586621679082688"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span></span></span><span>
</span><span id="line-1362"></span><span id="getSymlinkTarget"><span class="annot"><span class="annottext">getSymlinkTarget :: Path b t -&gt; m FilePath
</span><a href="Path.IO.html#getSymlinkTarget"><span class="hs-identifier hs-var hs-var">getSymlinkTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; Path b t -&gt; m FilePath
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">D.getSymbolicLinkTarget</span></span><span>
</span><span id="line-1363"></span><span>
</span><span id="line-1364"></span><span class="hs-comment">-- | Check whether the path refers to a symbolic link.  An exception is thrown</span><span>
</span><span id="line-1365"></span><span class="hs-comment">-- if the path does not exist or is inaccessible.</span><span>
</span><span id="line-1366"></span><span class="hs-comment">--</span><span>
</span><span id="line-1367"></span><span class="hs-comment">-- On Windows, this checks for @FILE_ATTRIBUTE_REPARSE_POINT@.  In addition to</span><span>
</span><span id="line-1368"></span><span class="hs-comment">-- symbolic links, the function also returns true on junction points.  On</span><span>
</span><span id="line-1369"></span><span class="hs-comment">-- POSIX systems, this checks for @S_IFLNK@.</span><span>
</span><span id="line-1370"></span><span class="hs-comment">--</span><span>
</span><span id="line-1371"></span><span class="hs-comment">-- @since 1.5.0</span><span>
</span><span id="line-1372"></span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- | Check if the given path is a symbolic link.</span><span>
</span><span id="line-1374"></span><span class="hs-comment">--</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- @since 1.3.0</span><span>
</span><span id="line-1376"></span><span id="local-6989586621679082727"><span id="local-6989586621679082728"><span id="local-6989586621679082729"><span class="annot"><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-type">isSymlink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082729"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082728"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082727"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082729"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-1377"></span><span id="isSymlink"><span class="annot"><span class="annottext">isSymlink :: Path b t -&gt; m Bool
</span><a href="Path.IO.html#isSymlink"><span class="hs-identifier hs-var hs-var">isSymlink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; Path b t -&gt; m Bool
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.pathIsSymbolicLink</span></span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- Temporary files and directories</span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span class="hs-comment">-- | Use a temporary file that doesn't already exist.</span><span>
</span><span id="line-1383"></span><span class="hs-comment">--</span><span>
</span><span id="line-1384"></span><span class="hs-comment">-- Creates a new temporary file inside the given directory, making use of</span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- the template. The temporary file is deleted after use.</span><span>
</span><span id="line-1386"></span><span class="hs-comment">--</span><span>
</span><span id="line-1387"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1388"></span><span id="local-6989586621679082503"><span id="local-6989586621679082504"><span id="local-6989586621679082505"><span class="annot"><a href="Path.IO.html#withTempFile"><span class="hs-identifier hs-type">withTempFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1389"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082505"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679082505"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1390"></span><span>  </span><span class="hs-comment">-- | Directory to create the file in</span><span>
</span><span id="line-1391"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082504"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1392"></span><span>  </span><span class="hs-comment">-- | File name template, see 'openTempFile'</span><span>
</span><span id="line-1393"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1394"></span><span>  </span><span class="hs-comment">-- | Callback that can use the file</span><span>
</span><span id="line-1395"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082505"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082503"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1396"></span><span>  </span><span class="annot"><a href="#local-6989586621679082505"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082503"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-1397"></span><span id="withTempFile"><span class="annot"><span class="annottext">withTempFile :: Path b Dir -&gt; FilePath -&gt; (Path Abs File -&gt; Handle -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withTempFile"><span class="hs-identifier hs-var hs-var">withTempFile</span></a></span></span><span> </span><span id="local-6989586621679082063"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082063"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679082062"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082062"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679082061"><span class="annot"><span class="annottext">Path Abs File -&gt; Handle -&gt; m a
</span><a href="#local-6989586621679082061"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1398"></span><span>  </span><span id="local-6989586621679082060"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082060"><span class="hs-identifier hs-var">apath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082063"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1399"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; (FilePath -&gt; Handle -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m) =&gt;
FilePath -&gt; FilePath -&gt; (FilePath -&gt; Handle -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">T.withTempFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082060"><span class="hs-identifier hs-var">apath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082062"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((FilePath -&gt; Handle -&gt; m a) -&gt; m a)
-&gt; (FilePath -&gt; Handle -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082058"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082058"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679082057"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082057"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1400"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082058"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs File) -&gt; (Path Abs File -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; Handle -&gt; m a) -&gt; Handle -&gt; Path Abs File -&gt; m a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; Handle -&gt; m a
</span><a href="#local-6989586621679082061"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082057"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1401"></span><span>
</span><span id="line-1402"></span><span class="hs-comment">-- | Create and use a temporary directory.</span><span>
</span><span id="line-1403"></span><span class="hs-comment">--</span><span>
</span><span id="line-1404"></span><span class="hs-comment">-- Creates a new temporary directory inside the given directory, making use</span><span>
</span><span id="line-1405"></span><span class="hs-comment">-- of the template. The temporary directory is deleted after use.</span><span>
</span><span id="line-1406"></span><span class="hs-comment">--</span><span>
</span><span id="line-1407"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1408"></span><span id="local-6989586621679082498"><span id="local-6989586621679082499"><span id="local-6989586621679082500"><span class="annot"><a href="Path.IO.html#withTempDir"><span class="hs-identifier hs-type">withTempDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1409"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082500"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679082500"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1410"></span><span>  </span><span class="hs-comment">-- | Directory to create the file in</span><span>
</span><span id="line-1411"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082499"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1412"></span><span>  </span><span class="hs-comment">-- | Directory name template, see 'openTempFile'</span><span>
</span><span id="line-1413"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-comment">-- | Callback that can use the directory</span><span>
</span><span id="line-1415"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082500"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082498"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1416"></span><span>  </span><span class="annot"><a href="#local-6989586621679082500"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082498"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-1417"></span><span id="withTempDir"><span class="annot"><span class="annottext">withTempDir :: Path b Dir -&gt; FilePath -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withTempDir"><span class="hs-identifier hs-var hs-var">withTempDir</span></a></span></span><span> </span><span id="local-6989586621679082056"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082056"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679082055"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082055"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679082054"><span class="annot"><span class="annottext">Path Abs Dir -&gt; m a
</span><a href="#local-6989586621679082054"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1418"></span><span>  </span><span id="local-6989586621679082053"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082053"><span class="hs-identifier hs-var">apath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; m (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082056"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1419"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; (FilePath -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a.
(MonadMask m, MonadIO m) =&gt;
FilePath -&gt; FilePath -&gt; (FilePath -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">T.withTempDirectory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082053"><span class="hs-identifier hs-var">apath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082055"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; m (Path Abs Dir))
-&gt; (Path Abs Dir -&gt; m a) -&gt; FilePath -&gt; m a
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m a
</span><a href="#local-6989586621679082054"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1420"></span><span>
</span><span id="line-1421"></span><span class="hs-comment">-- | Create and use a temporary file in the system standard temporary</span><span>
</span><span id="line-1422"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-1423"></span><span class="hs-comment">--</span><span>
</span><span id="line-1424"></span><span class="hs-comment">-- Behaves exactly the same as 'withTempFile', except that the parent</span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- temporary directory will be that returned by 'getTempDir'.</span><span>
</span><span id="line-1426"></span><span class="hs-comment">--</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1428"></span><span id="local-6989586621679082050"><span id="local-6989586621679082051"><span class="annot"><a href="Path.IO.html#withSystemTempFile"><span class="hs-identifier hs-type">withSystemTempFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1429"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082051"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679082051"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-comment">-- | File name template, see 'openTempFile'</span><span>
</span><span id="line-1431"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1432"></span><span>  </span><span class="hs-comment">-- | Callback that can use the file</span><span>
</span><span id="line-1433"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082050"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1434"></span><span>  </span><span class="annot"><a href="#local-6989586621679082051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082050"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1435"></span><span id="withSystemTempFile"><span class="annot"><span class="annottext">withSystemTempFile :: FilePath -&gt; (Path Abs File -&gt; Handle -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withSystemTempFile"><span class="hs-identifier hs-var hs-var">withSystemTempFile</span></a></span></span><span> </span><span id="local-6989586621679082049"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082049"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679082048"><span class="annot"><span class="annottext">Path Abs File -&gt; Handle -&gt; m a
</span><a href="#local-6989586621679082048"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1436"></span><span>  </span><span class="annot"><span class="annottext">m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getTempDir"><span class="hs-identifier hs-var">getTempDir</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir) -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082047"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082047"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1437"></span><span>    </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath -&gt; (Path Abs File -&gt; Handle -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) b a.
(MonadIO m, MonadMask m) =&gt;
Path b Dir -&gt; FilePath -&gt; (Path Abs File -&gt; Handle -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withTempFile"><span class="hs-identifier hs-var">withTempFile</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082047"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082049"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs File -&gt; Handle -&gt; m a
</span><a href="#local-6989586621679082048"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span class="hs-comment">-- | Create and use a temporary directory in the system standard temporary</span><span>
</span><span id="line-1440"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-1441"></span><span class="hs-comment">--</span><span>
</span><span id="line-1442"></span><span class="hs-comment">-- Behaves exactly the same as 'withTempDir', except that the parent</span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- temporary directory will be that returned by 'getTempDir'.</span><span>
</span><span id="line-1444"></span><span class="hs-comment">--</span><span>
</span><span id="line-1445"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1446"></span><span id="local-6989586621679082045"><span id="local-6989586621679082046"><span class="annot"><a href="Path.IO.html#withSystemTempDir"><span class="hs-identifier hs-type">withSystemTempDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1447"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082046"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679082046"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1448"></span><span>  </span><span class="hs-comment">-- | Directory name template, see 'openTempFile'</span><span>
</span><span id="line-1449"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1450"></span><span>  </span><span class="hs-comment">-- | Callback that can use the directory</span><span>
</span><span id="line-1451"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1452"></span><span>  </span><span class="annot"><a href="#local-6989586621679082046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082045"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-1453"></span><span id="withSystemTempDir"><span class="annot"><span class="annottext">withSystemTempDir :: FilePath -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withSystemTempDir"><span class="hs-identifier hs-var hs-var">withSystemTempDir</span></a></span></span><span> </span><span id="local-6989586621679082044"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082044"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679082043"><span class="annot"><span class="annottext">Path Abs Dir -&gt; m a
</span><a href="#local-6989586621679082043"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1454"></span><span>  </span><span class="annot"><span class="annottext">m (Path Abs Dir)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#getTempDir"><span class="hs-identifier hs-var">getTempDir</span></a></span><span> </span><span class="annot"><span class="annottext">m (Path Abs Dir) -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082042"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082042"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1455"></span><span>    </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; FilePath -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) b a.
(MonadIO m, MonadMask m) =&gt;
Path b Dir -&gt; FilePath -&gt; (Path Abs Dir -&gt; m a) -&gt; m a
</span><a href="Path.IO.html#withTempDir"><span class="hs-identifier hs-var">withTempDir</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082042"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082044"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir -&gt; m a
</span><a href="#local-6989586621679082043"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-1456"></span><span>
</span><span id="line-1457"></span><span class="hs-comment">-- | The function creates a temporary file in @rw@ mode. The created file</span><span>
</span><span id="line-1458"></span><span class="hs-comment">-- isn't deleted automatically, so you need to delete it manually.</span><span>
</span><span id="line-1459"></span><span class="hs-comment">--</span><span>
</span><span id="line-1460"></span><span class="hs-comment">-- The file is created with permissions such that only the current user can</span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- read\/write it.</span><span>
</span><span id="line-1462"></span><span class="hs-comment">--</span><span>
</span><span id="line-1463"></span><span class="hs-comment">-- With some exceptions (see below), the file will be created securely in</span><span>
</span><span id="line-1464"></span><span class="hs-comment">-- the sense that an attacker should not be able to cause openTempFile to</span><span>
</span><span id="line-1465"></span><span class="hs-comment">-- overwrite another file on the filesystem using your credentials, by</span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- putting symbolic links (on Unix) in the place where the temporary file is</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- to be created. On Unix the @O_CREAT@ and @O_EXCL@ flags are used to</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- prevent this attack, but note that @O_EXCL@ is sometimes not supported on</span><span>
</span><span id="line-1469"></span><span class="hs-comment">-- NFS filesystems, so if you rely on this behaviour it is best to use local</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- filesystems only.</span><span>
</span><span id="line-1471"></span><span class="hs-comment">--</span><span>
</span><span id="line-1472"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1473"></span><span id="local-6989586621679082040"><span id="local-6989586621679082041"><span class="annot"><a href="Path.IO.html#openTempFile"><span class="hs-identifier hs-type">openTempFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1475"></span><span>  </span><span class="hs-comment">-- | Directory to create file in</span><span>
</span><span id="line-1476"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082040"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1477"></span><span>  </span><span class="hs-comment">-- | File name template; if the template is &quot;foo.ext&quot; then the created</span><span>
</span><span id="line-1478"></span><span>  </span><span class="hs-comment">-- file will be @\&quot;fooXXX.ext\&quot;@ where @XXX@ is some random number</span><span>
</span><span id="line-1479"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1480"></span><span>  </span><span class="hs-comment">-- | Name of created file and its 'Handle'</span><span>
</span><span id="line-1481"></span><span>  </span><span class="annot"><a href="#local-6989586621679082041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1482"></span><span id="openTempFile"><span class="annot"><span class="annottext">openTempFile :: Path b Dir -&gt; FilePath -&gt; m (Path Abs File, Handle)
</span><a href="Path.IO.html#openTempFile"><span class="hs-identifier hs-var hs-var">openTempFile</span></a></span></span><span> </span><span id="local-6989586621679082039"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082039"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679082038"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082038"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle))
-&gt; IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1483"></span><span>  </span><span id="local-6989586621679082037"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082037"><span class="hs-identifier hs-var">apath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; IO (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082039"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1484"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679082036"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082036"><span class="hs-identifier hs-var">tfile</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082035"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082035"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO (FilePath, Handle))
-&gt; Path Abs Dir -&gt; FilePath -&gt; IO (FilePath, Handle)
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO (FilePath, Handle)
</span><span class="hs-identifier hs-var">T.openTempFile</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082037"><span class="hs-identifier hs-var">apath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082038"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1485"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082035"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; (Path Abs File, Handle))
-&gt; IO (Path Abs File) -&gt; IO (Path Abs File, Handle)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082036"><span class="hs-identifier hs-var">tfile</span></a></span><span>
</span><span id="line-1486"></span><span>
</span><span id="line-1487"></span><span class="hs-comment">-- | Like 'openTempFile', but opens the file in binary mode. On Windows,</span><span>
</span><span id="line-1488"></span><span class="hs-comment">-- reading a file in text mode (which is the default) will translate @CRLF@</span><span>
</span><span id="line-1489"></span><span class="hs-comment">-- to @LF@, and writing will translate @LF@ to @CRLF@. This is usually what</span><span>
</span><span id="line-1490"></span><span class="hs-comment">-- you want with text files. With binary files this is undesirable; also, as</span><span>
</span><span id="line-1491"></span><span class="hs-comment">-- usual under Microsoft operating systems, text mode treats control-Z as</span><span>
</span><span id="line-1492"></span><span class="hs-comment">-- EOF. Binary mode turns off all special treatment of end-of-line and</span><span>
</span><span id="line-1493"></span><span class="hs-comment">-- end-of-file characters.</span><span>
</span><span id="line-1494"></span><span class="hs-comment">--</span><span>
</span><span id="line-1495"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1496"></span><span id="local-6989586621679082031"><span id="local-6989586621679082032"><span class="annot"><a href="Path.IO.html#openBinaryTempFile"><span class="hs-identifier hs-type">openBinaryTempFile</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1497"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1498"></span><span>  </span><span class="hs-comment">-- | Directory to create file in</span><span>
</span><span id="line-1499"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082031"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1500"></span><span>  </span><span class="hs-comment">-- | File name template, see 'openTempFile'</span><span>
</span><span id="line-1501"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1502"></span><span>  </span><span class="hs-comment">-- | Name of created file and its 'Handle'</span><span>
</span><span id="line-1503"></span><span>  </span><span class="annot"><a href="#local-6989586621679082032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1504"></span><span id="openBinaryTempFile"><span class="annot"><span class="annottext">openBinaryTempFile :: Path b Dir -&gt; FilePath -&gt; m (Path Abs File, Handle)
</span><a href="Path.IO.html#openBinaryTempFile"><span class="hs-identifier hs-var hs-var">openBinaryTempFile</span></a></span></span><span> </span><span id="local-6989586621679082030"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082030"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679082029"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082029"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle))
-&gt; IO (Path Abs File, Handle) -&gt; m (Path Abs File, Handle)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1505"></span><span>  </span><span id="local-6989586621679082028"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082028"><span class="hs-identifier hs-var">apath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path b Dir -&gt; IO (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082030"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1506"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679082027"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082027"><span class="hs-identifier hs-var">tfile</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679082026"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082026"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO (FilePath, Handle))
-&gt; Path Abs Dir -&gt; FilePath -&gt; IO (FilePath, Handle)
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO (FilePath, Handle)
</span><span class="hs-identifier hs-var">T.openBinaryTempFile</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082028"><span class="hs-identifier hs-var">apath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082029"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1507"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679082026"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path Abs File -&gt; (Path Abs File, Handle))
-&gt; IO (Path Abs File) -&gt; IO (Path Abs File, Handle)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs File)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs File)
</span><span class="hs-identifier hs-var">parseAbsFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082027"><span class="hs-identifier hs-var">tfile</span></a></span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span class="hs-comment">-- | Create a temporary directory. The created directory isn't deleted</span><span>
</span><span id="line-1510"></span><span class="hs-comment">-- automatically, so you need to delete it manually.</span><span>
</span><span id="line-1511"></span><span class="hs-comment">--</span><span>
</span><span id="line-1512"></span><span class="hs-comment">-- The directory is created with permissions such that only the current user</span><span>
</span><span id="line-1513"></span><span class="hs-comment">-- can read\/write it.</span><span>
</span><span id="line-1514"></span><span class="hs-comment">--</span><span>
</span><span id="line-1515"></span><span class="hs-comment">-- @since 0.2.0</span><span>
</span><span id="line-1516"></span><span id="local-6989586621679082023"><span id="local-6989586621679082024"><span class="annot"><a href="Path.IO.html#createTempDir"><span class="hs-identifier hs-type">createTempDir</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1517"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-comment">-- | Directory to create file in</span><span>
</span><span id="line-1519"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082023"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1520"></span><span>  </span><span class="hs-comment">-- | Directory name template, see 'openTempFile'</span><span>
</span><span id="line-1521"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1522"></span><span>  </span><span class="hs-comment">-- | Name of created temporary directory</span><span>
</span><span id="line-1523"></span><span>  </span><span class="annot"><a href="#local-6989586621679082024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Abs</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1524"></span><span id="createTempDir"><span class="annot"><span class="annottext">createTempDir :: Path b Dir -&gt; FilePath -&gt; m (Path Abs Dir)
</span><a href="Path.IO.html#createTempDir"><span class="hs-identifier hs-var hs-var">createTempDir</span></a></span></span><span> </span><span id="local-6989586621679082022"><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082022"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679082021"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082021"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1525"></span><span>  </span><span class="annot"><span class="annottext">IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Path Abs Dir) -&gt; m (Path Abs Dir))
-&gt; IO (Path Abs Dir) -&gt; m (Path Abs Dir)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1526"></span><span>    </span><span class="annot"><span class="annottext">Path b Dir -&gt; IO (AbsPath (Path b Dir))
forall path (m :: * -&gt; *).
(AnyPath path, MonadIO m) =&gt;
path -&gt; m (AbsPath path)
</span><a href="Path.IO.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">Path b Dir
</span><a href="#local-6989586621679082022"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Path Abs Dir)
-&gt; (Path Abs Dir -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679082020"><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082020"><span class="hs-identifier hs-var">apath</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1527"></span><span>      </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO FilePath)
-&gt; Path Abs Dir -&gt; FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">T.createTempDirectory</span></span><span> </span><span class="annot"><span class="annottext">Path Abs Dir
</span><a href="#local-6989586621679082020"><span class="hs-identifier hs-var">apath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082021"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO (Path Abs Dir)) -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO (Path Abs Dir)
forall (m :: * -&gt; *). MonadThrow m =&gt; FilePath -&gt; m (Path Abs Dir)
</span><span class="hs-identifier hs-var">parseAbsDir</span></span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1530"></span><span class="hs-comment">-- Existence tests</span><span>
</span><span id="line-1531"></span><span>
</span><span id="line-1532"></span><span class="hs-comment">-- | The operation 'doesFileExist' returns 'True' if the argument file</span><span>
</span><span id="line-1533"></span><span class="hs-comment">-- exists and is not a directory, and 'False' otherwise.</span><span>
</span><span id="line-1534"></span><span id="local-6989586621679082541"><span id="local-6989586621679082542"><span class="annot"><a href="Path.IO.html#doesFileExist"><span class="hs-identifier hs-type">doesFileExist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082542"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082541"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">File</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082542"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-1535"></span><span id="doesFileExist"><span class="annot"><span class="annottext">doesFileExist :: Path b File -&gt; m Bool
</span><a href="Path.IO.html#doesFileExist"><span class="hs-identifier hs-var hs-var">doesFileExist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; Path b File -&gt; m Bool
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.doesFileExist</span></span><span>
</span><span id="line-1536"></span><span>
</span><span id="line-1537"></span><span class="hs-comment">-- | The operation 'doesDirExist' returns 'True' if the argument file exists</span><span>
</span><span id="line-1538"></span><span class="hs-comment">-- and is either a directory or a symbolic link to a directory, and 'False'</span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- otherwise.</span><span>
</span><span id="line-1540"></span><span id="local-6989586621679082016"><span id="local-6989586621679082017"><span class="annot"><a href="Path.IO.html#doesDirExist"><span class="hs-identifier hs-type">doesDirExist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082017"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082016"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082017"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-1541"></span><span id="doesDirExist"><span class="annot"><span class="annottext">doesDirExist :: Path b Dir -&gt; m Bool
</span><a href="Path.IO.html#doesDirExist"><span class="hs-identifier hs-var hs-var">doesDirExist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool) -&gt; Path b Dir -&gt; m Bool
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.doesDirectoryExist</span></span><span>
</span><span id="line-1542"></span><span>
</span><span id="line-1543"></span><span class="hs-comment">-- | Check if there is a file or directory on specified path.</span><span>
</span><span id="line-1544"></span><span id="local-6989586621679082013"><span id="local-6989586621679082014"><span id="local-6989586621679082015"><span class="annot"><a href="Path.IO.html#isLocationOccupied"><span class="hs-identifier hs-type">isLocationOccupied</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082015"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082014"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082013"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082015"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-1545"></span><span id="isLocationOccupied"><span class="annot"><span class="annottext">isLocationOccupied :: Path b t -&gt; m Bool
</span><a href="Path.IO.html#isLocationOccupied"><span class="hs-identifier hs-var hs-var">isLocationOccupied</span></a></span></span><span> </span><span id="local-6989586621679082012"><span class="annot"><span class="annottext">Path b t
</span><a href="#local-6989586621679082012"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1546"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679082011"><span class="annot"><span class="annottext">fp :: FilePath
</span><a href="#local-6989586621679082011"><span class="hs-identifier hs-var hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path b t -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span> </span><span class="annot"><span class="annottext">Path b t
</span><a href="#local-6989586621679082012"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-1547"></span><span>  </span><span id="local-6989586621679082010"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082010"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; m Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082011"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1548"></span><span>  </span><span id="local-6989586621679082009"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082009"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; m Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><span class="hs-identifier hs-var">D.doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679082011"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082010"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679082009"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1550"></span><span>
</span><span id="line-1551"></span><span class="hs-comment">-- | If argument of the function throws a</span><span>
</span><span id="line-1552"></span><span class="hs-comment">-- 'System.IO.Error.doesNotExistErrorType', 'Nothing' is returned (other</span><span>
</span><span id="line-1553"></span><span class="hs-comment">-- exceptions propagate). Otherwise the result is returned inside a 'Just'.</span><span>
</span><span id="line-1554"></span><span class="hs-comment">--</span><span>
</span><span id="line-1555"></span><span class="hs-comment">-- @since 0.3.0</span><span>
</span><span id="line-1556"></span><span id="local-6989586621679082468"><span id="local-6989586621679082469"><span class="annot"><a href="Path.IO.html#forgivingAbsence"><span class="hs-identifier hs-type">forgivingAbsence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082469"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadCatch</span></span><span> </span><span class="annot"><a href="#local-6989586621679082469"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679082468"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1557"></span><span id="forgivingAbsence"><span class="annot"><span class="annottext">forgivingAbsence :: m a -&gt; m (Maybe a)
</span><a href="Path.IO.html#forgivingAbsence"><span class="hs-identifier hs-var hs-var">forgivingAbsence</span></a></span></span><span> </span><span id="local-6989586621679082007"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679082007"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1558"></span><span>  </span><span class="annot"><span class="annottext">(IOError -&gt; Bool)
-&gt; m (Maybe a) -&gt; (IOError -&gt; m (Maybe a)) -&gt; m (Maybe a)
forall (m :: * -&gt; *) e a.
(MonadCatch m, Exception e) =&gt;
(e -&gt; Bool) -&gt; m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">catchIf</span></span><span>
</span><span id="line-1559"></span><span>    </span><span class="annot"><span class="annottext">IOError -&gt; Bool
</span><span class="hs-identifier hs-var">isDoesNotExistError</span></span><span>
</span><span id="line-1560"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; m a -&gt; m (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679082007"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1561"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m (Maybe a) -&gt; IOError -&gt; m (Maybe a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe a) -&gt; IOError -&gt; m (Maybe a))
-&gt; m (Maybe a) -&gt; IOError -&gt; m (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span class="hs-comment">-- | The same as 'forgivingAbsence', but ignores result.</span><span>
</span><span id="line-1564"></span><span class="hs-comment">--</span><span>
</span><span id="line-1565"></span><span class="hs-comment">-- @since 0.3.1</span><span>
</span><span id="line-1566"></span><span id="local-6989586621679082004"><span id="local-6989586621679082005"><span class="annot"><a href="Path.IO.html#ignoringAbsence"><span class="hs-identifier hs-type">ignoringAbsence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082005"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadCatch</span></span><span> </span><span class="annot"><a href="#local-6989586621679082005"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1567"></span><span id="ignoringAbsence"><span class="annot"><span class="annottext">ignoringAbsence :: m a -&gt; m ()
</span><a href="Path.IO.html#ignoringAbsence"><span class="hs-identifier hs-var hs-var">ignoringAbsence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe a) -&gt; m ()) -&gt; (m a -&gt; m (Maybe a)) -&gt; m a -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a.
(MonadIO m, MonadCatch m) =&gt;
m a -&gt; m (Maybe a)
</span><a href="Path.IO.html#forgivingAbsence"><span class="hs-identifier hs-var">forgivingAbsence</span></a></span><span>
</span><span id="line-1568"></span><span>
</span><span id="line-1569"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1570"></span><span class="hs-comment">-- Permissions</span><span>
</span><span id="line-1571"></span><span>
</span><span id="line-1572"></span><span class="hs-comment">-- | The 'getPermissions' operation returns the permissions for the file or</span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-1574"></span><span class="hs-comment">--</span><span>
</span><span id="line-1575"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1576"></span><span class="hs-comment">--</span><span>
</span><span id="line-1577"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to access</span><span>
</span><span id="line-1578"></span><span class="hs-comment">--   the permissions; or</span><span>
</span><span id="line-1579"></span><span class="hs-comment">--</span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1581"></span><span id="local-6989586621679082001"><span id="local-6989586621679082002"><span id="local-6989586621679082003"><span class="annot"><a href="Path.IO.html#getPermissions"><span class="hs-identifier hs-type">getPermissions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082001"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">D.Permissions</span></span></span></span></span><span>
</span><span id="line-1582"></span><span id="getPermissions"><span class="annot"><span class="annottext">getPermissions :: Path b t -&gt; m Permissions
</span><a href="Path.IO.html#getPermissions"><span class="hs-identifier hs-var hs-var">getPermissions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Permissions) -&gt; Path b t -&gt; m Permissions
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Permissions
</span><span class="hs-identifier hs-var">D.getPermissions</span></span><span>
</span><span id="line-1583"></span><span>
</span><span id="line-1584"></span><span class="hs-comment">-- | The 'setPermissions' operation sets the permissions for the file or</span><span>
</span><span id="line-1585"></span><span class="hs-comment">-- directory.</span><span>
</span><span id="line-1586"></span><span class="hs-comment">--</span><span>
</span><span id="line-1587"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1588"></span><span class="hs-comment">--</span><span>
</span><span id="line-1589"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to set</span><span>
</span><span id="line-1590"></span><span class="hs-comment">--   the permissions; or</span><span>
</span><span id="line-1591"></span><span class="hs-comment">--</span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1593"></span><span id="local-6989586621679081997"><span id="local-6989586621679081998"><span id="local-6989586621679081999"><span class="annot"><a href="Path.IO.html#setPermissions"><span class="hs-identifier hs-type">setPermissions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679081999"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081998"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081997"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">D.Permissions</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081999"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1594"></span><span id="setPermissions"><span class="annot"><span class="annottext">setPermissions :: Path b t -&gt; Permissions -&gt; m ()
</span><a href="Path.IO.html#setPermissions"><span class="hs-identifier hs-var hs-var">setPermissions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Permissions -&gt; IO ())
-&gt; Path b t -&gt; Permissions -&gt; m ()
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Permissions -&gt; IO ()
</span><span class="hs-identifier hs-var">D.setPermissions</span></span><span>
</span><span id="line-1595"></span><span>
</span><span id="line-1596"></span><span class="hs-comment">-- | Set permissions for the object found on second given path so they match</span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- permissions of the object on the first path.</span><span>
</span><span id="line-1598"></span><span id="local-6989586621679082680"><span id="local-6989586621679082681"><span id="local-6989586621679082682"><span id="local-6989586621679082683"><span id="local-6989586621679082684"><span class="annot"><a href="Path.IO.html#copyPermissions"><span class="hs-identifier hs-type">copyPermissions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1599"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1600"></span><span>  </span><span class="hs-comment">-- | From where to copy</span><span>
</span><span id="line-1601"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082683"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082682"><span class="hs-identifier hs-type">t0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-comment">-- | What to modify</span><span>
</span><span id="line-1603"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082681"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082680"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1604"></span><span>  </span><span class="annot"><a href="#local-6989586621679082684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-1605"></span><span id="copyPermissions"><span class="annot"><span class="annottext">copyPermissions :: Path b0 t0 -&gt; Path b1 t1 -&gt; m ()
</span><a href="Path.IO.html#copyPermissions"><span class="hs-identifier hs-var hs-var">copyPermissions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO ()) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m ()
forall (m :: * -&gt; *) a b0 t0 b1 t1.
MonadIO m =&gt;
(FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var">liftD2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">D.copyPermissions</span></span><span>
</span><span id="line-1606"></span><span>
</span><span id="line-1607"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1608"></span><span class="hs-comment">-- Timestamps</span><span>
</span><span id="line-1609"></span><span>
</span><span id="line-1610"></span><span class="hs-comment">-- | Obtain the time at which the file or directory was last accessed.</span><span>
</span><span id="line-1611"></span><span class="hs-comment">--</span><span>
</span><span id="line-1612"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1613"></span><span class="hs-comment">--</span><span>
</span><span id="line-1614"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to read</span><span>
</span><span id="line-1615"></span><span class="hs-comment">--   the access time; or</span><span>
</span><span id="line-1616"></span><span class="hs-comment">--</span><span>
</span><span id="line-1617"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1618"></span><span class="hs-comment">--</span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- Caveat for POSIX systems: This function returns a timestamp with</span><span>
</span><span id="line-1620"></span><span class="hs-comment">-- sub-second resolution only if this package is compiled against</span><span>
</span><span id="line-1621"></span><span class="hs-comment">-- @unix-2.6.0.0@ or later and the underlying filesystem supports them.</span><span>
</span><span id="line-1622"></span><span class="hs-comment">--</span><span>
</span><span id="line-1623"></span><span class="hs-comment">-- Note: this is a piece of conditional API, only available if</span><span>
</span><span id="line-1624"></span><span class="hs-comment">-- @directory-1.2.3.0@ or later is used.</span><span>
</span><span id="line-1625"></span><span id="local-6989586621679081992"><span id="local-6989586621679081993"><span id="local-6989586621679081994"><span class="annot"><a href="Path.IO.html#getAccessTime"><span class="hs-identifier hs-type">getAccessTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679081994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081993"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081992"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span></span></span></span><span>
</span><span id="line-1626"></span><span id="getAccessTime"><span class="annot"><span class="annottext">getAccessTime :: Path b t -&gt; m UTCTime
</span><a href="Path.IO.html#getAccessTime"><span class="hs-identifier hs-var hs-var">getAccessTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO UTCTime) -&gt; Path b t -&gt; m UTCTime
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO UTCTime
</span><span class="hs-identifier hs-var">D.getAccessTime</span></span><span>
</span><span id="line-1627"></span><span>
</span><span id="line-1628"></span><span class="hs-comment">-- | Change the time at which the file or directory was last accessed.</span><span>
</span><span id="line-1629"></span><span class="hs-comment">--</span><span>
</span><span id="line-1630"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1631"></span><span class="hs-comment">--</span><span>
</span><span id="line-1632"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to alter the</span><span>
</span><span id="line-1633"></span><span class="hs-comment">--   access time; or</span><span>
</span><span id="line-1634"></span><span class="hs-comment">--</span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1636"></span><span class="hs-comment">--</span><span>
</span><span id="line-1637"></span><span class="hs-comment">-- Some caveats for POSIX systems:</span><span>
</span><span id="line-1638"></span><span class="hs-comment">--</span><span>
</span><span id="line-1639"></span><span class="hs-comment">-- * Not all systems support @utimensat@, in which case the function can</span><span>
</span><span id="line-1640"></span><span class="hs-comment">--   only emulate the behavior by reading the modification time and then</span><span>
</span><span id="line-1641"></span><span class="hs-comment">--   setting both the access and modification times together. On systems</span><span>
</span><span id="line-1642"></span><span class="hs-comment">--   where @utimensat@ is supported, the access time is set atomically with</span><span>
</span><span id="line-1643"></span><span class="hs-comment">--   nanosecond precision.</span><span>
</span><span id="line-1644"></span><span class="hs-comment">--</span><span>
</span><span id="line-1645"></span><span class="hs-comment">-- * If compiled against a version of @unix@ prior to @2.7.0.0@, the</span><span>
</span><span id="line-1646"></span><span class="hs-comment">--   function would not be able to set timestamps with sub-second</span><span>
</span><span id="line-1647"></span><span class="hs-comment">--   resolution. In this case, there would also be loss of precision in the</span><span>
</span><span id="line-1648"></span><span class="hs-comment">--   modification time.</span><span>
</span><span id="line-1649"></span><span class="hs-comment">--</span><span>
</span><span id="line-1650"></span><span class="hs-comment">-- Note: this is a piece of conditional API, only available if</span><span>
</span><span id="line-1651"></span><span class="hs-comment">-- @directory-1.2.3.0@ or later is used.</span><span>
</span><span id="line-1652"></span><span id="local-6989586621679081988"><span id="local-6989586621679081989"><span id="local-6989586621679081990"><span class="annot"><a href="Path.IO.html#setAccessTime"><span class="hs-identifier hs-type">setAccessTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679081990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081989"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081988"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081990"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1653"></span><span id="setAccessTime"><span class="annot"><span class="annottext">setAccessTime :: Path b t -&gt; UTCTime -&gt; m ()
</span><a href="Path.IO.html#setAccessTime"><span class="hs-identifier hs-var hs-var">setAccessTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; UTCTime -&gt; IO ()) -&gt; Path b t -&gt; UTCTime -&gt; m ()
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; UTCTime -&gt; IO ()
</span><span class="hs-identifier hs-var">D.setAccessTime</span></span><span>
</span><span id="line-1654"></span><span>
</span><span id="line-1655"></span><span class="hs-comment">-- | Change the time at which the file or directory was last modified.</span><span>
</span><span id="line-1656"></span><span class="hs-comment">--</span><span>
</span><span id="line-1657"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1658"></span><span class="hs-comment">--</span><span>
</span><span id="line-1659"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to alter the</span><span>
</span><span id="line-1660"></span><span class="hs-comment">--   modification time; or</span><span>
</span><span id="line-1661"></span><span class="hs-comment">--</span><span>
</span><span id="line-1662"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1663"></span><span class="hs-comment">--</span><span>
</span><span id="line-1664"></span><span class="hs-comment">-- Some caveats for POSIX systems:</span><span>
</span><span id="line-1665"></span><span class="hs-comment">--</span><span>
</span><span id="line-1666"></span><span class="hs-comment">-- * Not all systems support @utimensat@, in which case the function can</span><span>
</span><span id="line-1667"></span><span class="hs-comment">--   only emulate the behavior by reading the access time and then setting</span><span>
</span><span id="line-1668"></span><span class="hs-comment">--   both the access and modification times together. On systems where</span><span>
</span><span id="line-1669"></span><span class="hs-comment">--   @utimensat@ is supported, the modification time is set atomically with</span><span>
</span><span id="line-1670"></span><span class="hs-comment">--   nanosecond precision.</span><span>
</span><span id="line-1671"></span><span class="hs-comment">--</span><span>
</span><span id="line-1672"></span><span class="hs-comment">-- * If compiled against a version of @unix@ prior to @2.7.0.0@, the</span><span>
</span><span id="line-1673"></span><span class="hs-comment">--   function would not be able to set timestamps with sub-second</span><span>
</span><span id="line-1674"></span><span class="hs-comment">--   resolution. In this case, there would also be loss of precision in the</span><span>
</span><span id="line-1675"></span><span class="hs-comment">--   access time.</span><span>
</span><span id="line-1676"></span><span class="hs-comment">--</span><span>
</span><span id="line-1677"></span><span class="hs-comment">-- Note: this is a piece of conditional API, only available if</span><span>
</span><span id="line-1678"></span><span class="hs-comment">-- @directory-1.2.3.0@ or later is used.</span><span>
</span><span id="line-1679"></span><span id="local-6989586621679081984"><span id="local-6989586621679081985"><span id="local-6989586621679081986"><span class="annot"><a href="Path.IO.html#setModificationTime"><span class="hs-identifier hs-type">setModificationTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679081986"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081985"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081984"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081986"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1680"></span><span id="setModificationTime"><span class="annot"><span class="annottext">setModificationTime :: Path b t -&gt; UTCTime -&gt; m ()
</span><a href="Path.IO.html#setModificationTime"><span class="hs-identifier hs-var hs-var">setModificationTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; UTCTime -&gt; IO ()) -&gt; Path b t -&gt; UTCTime -&gt; m ()
forall (m :: * -&gt; *) v a b t.
MonadIO m =&gt;
(FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var">liftD2'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; UTCTime -&gt; IO ()
</span><span class="hs-identifier hs-var">D.setModificationTime</span></span><span>
</span><span id="line-1681"></span><span>
</span><span id="line-1682"></span><span class="hs-comment">-- | Obtain the time at which the file or directory was last modified.</span><span>
</span><span id="line-1683"></span><span class="hs-comment">--</span><span>
</span><span id="line-1684"></span><span class="hs-comment">-- The operation may fail with:</span><span>
</span><span id="line-1685"></span><span class="hs-comment">--</span><span>
</span><span id="line-1686"></span><span class="hs-comment">-- * 'isPermissionError' if the user is not permitted to read</span><span>
</span><span id="line-1687"></span><span class="hs-comment">--   the modification time; or</span><span>
</span><span id="line-1688"></span><span class="hs-comment">--</span><span>
</span><span id="line-1689"></span><span class="hs-comment">-- * 'isDoesNotExistError' if the file or directory does not exist.</span><span>
</span><span id="line-1690"></span><span class="hs-comment">--</span><span>
</span><span id="line-1691"></span><span class="hs-comment">-- Caveat for POSIX systems: This function returns a timestamp with</span><span>
</span><span id="line-1692"></span><span class="hs-comment">-- sub-second resolution only if this package is compiled against</span><span>
</span><span id="line-1693"></span><span class="hs-comment">-- @unix-2.6.0.0@ or later and the underlying filesystem supports them.</span><span>
</span><span id="line-1694"></span><span id="local-6989586621679081980"><span id="local-6989586621679081981"><span id="local-6989586621679081982"><span class="annot"><a href="Path.IO.html#getModificationTime"><span class="hs-identifier hs-type">getModificationTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679081982"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081981"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081980"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081982"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span></span></span></span><span>
</span><span id="line-1695"></span><span id="getModificationTime"><span class="annot"><span class="annottext">getModificationTime :: Path b t -&gt; m UTCTime
</span><a href="Path.IO.html#getModificationTime"><span class="hs-identifier hs-var hs-var">getModificationTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO UTCTime) -&gt; Path b t -&gt; m UTCTime
forall (m :: * -&gt; *) a b t.
MonadIO m =&gt;
(FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var">liftD</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO UTCTime
</span><span class="hs-identifier hs-var">D.getModificationTime</span></span><span>
</span><span id="line-1696"></span><span>
</span><span id="line-1697"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-1698"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-1699"></span><span>
</span><span id="line-1700"></span><span class="hs-comment">-- | Lift an action in 'IO' that takes 'FilePath' into an action in slightly</span><span>
</span><span id="line-1701"></span><span class="hs-comment">-- more abstract monad that takes 'Path'.</span><span>
</span><span id="line-1702"></span><span id="local-6989586621679082816"><span id="local-6989586621679082817"><span id="local-6989586621679082818"><span id="local-6989586621679082820"><span class="annot"><a href="Path.IO.html#liftD"><span class="hs-identifier hs-type">liftD</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1703"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082820"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1704"></span><span>  </span><span class="hs-comment">-- | Original action</span><span>
</span><span id="line-1705"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1706"></span><span>  </span><span class="hs-comment">-- | 'Path' argument</span><span>
</span><span id="line-1707"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082817"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082816"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1708"></span><span>  </span><span class="hs-comment">-- | Lifted action</span><span>
</span><span id="line-1709"></span><span>  </span><span class="annot"><a href="#local-6989586621679082820"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082818"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-1710"></span><span id="liftD"><span class="annot"><span class="annottext">liftD :: (FilePath -&gt; IO a) -&gt; Path b t -&gt; m a
</span><a href="Path.IO.html#liftD"><span class="hs-identifier hs-var hs-var">liftD</span></a></span></span><span> </span><span id="local-6989586621679081978"><span class="annot"><span class="annottext">FilePath -&gt; IO a
</span><a href="#local-6989586621679081978"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; m a) -&gt; (Path b t -&gt; IO a) -&gt; Path b t -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO a
</span><a href="#local-6989586621679081978"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO a) -&gt; (Path b t -&gt; FilePath) -&gt; Path b t -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Path b t -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span>
</span><span id="line-1711"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Path.IO.html#liftD"><span class="hs-pragma hs-type">liftD</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1712"></span><span>
</span><span id="line-1713"></span><span class="hs-comment">-- | Similar to 'liftD' but for functions with arity 2.</span><span>
</span><span id="line-1714"></span><span id="local-6989586621679082797"><span id="local-6989586621679082798"><span id="local-6989586621679082799"><span id="local-6989586621679082800"><span id="local-6989586621679082801"><span id="local-6989586621679082802"><span class="annot"><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-type">liftD2</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1715"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1716"></span><span>  </span><span class="hs-comment">-- | Original action</span><span>
</span><span id="line-1717"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082801"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1718"></span><span>  </span><span class="hs-comment">-- | First 'Path' argument</span><span>
</span><span id="line-1719"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082800"><span class="hs-identifier hs-type">b0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082799"><span class="hs-identifier hs-type">t0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1720"></span><span>  </span><span class="hs-comment">-- | Second 'Path' argument</span><span>
</span><span id="line-1721"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082798"><span class="hs-identifier hs-type">b1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082797"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1722"></span><span>  </span><span class="annot"><a href="#local-6989586621679082802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082801"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-1723"></span><span id="liftD2"><span class="annot"><span class="annottext">liftD2 :: (FilePath -&gt; FilePath -&gt; IO a) -&gt; Path b0 t0 -&gt; Path b1 t1 -&gt; m a
</span><a href="Path.IO.html#liftD2"><span class="hs-identifier hs-var hs-var">liftD2</span></a></span></span><span> </span><span id="local-6989586621679081977"><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679081977"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679081976"><span class="annot"><span class="annottext">Path b0 t0
</span><a href="#local-6989586621679081976"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081975"><span class="annot"><span class="annottext">Path b1 t1
</span><a href="#local-6989586621679081975"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; m a) -&gt; IO a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO a
</span><a href="#local-6989586621679081977"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b0 t0 -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path b0 t0
</span><a href="#local-6989586621679081976"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b1 t1 -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path b1 t1
</span><a href="#local-6989586621679081975"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1724"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Path.IO.html#liftD2"><span class="hs-pragma hs-type">liftD2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1725"></span><span>
</span><span id="line-1726"></span><span class="hs-comment">-- | Similar to 'liftD2', but allows us to pass second argument of arbitrary</span><span>
</span><span id="line-1727"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-1728"></span><span id="local-6989586621679082491"><span id="local-6989586621679082492"><span id="local-6989586621679082493"><span id="local-6989586621679082494"><span id="local-6989586621679082495"><span class="annot"><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-type">liftD2'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1729"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1730"></span><span>  </span><span class="hs-comment">-- | Original action</span><span>
</span><span id="line-1731"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082494"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679082493"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1732"></span><span>  </span><span class="hs-comment">-- | First 'Path' argument</span><span>
</span><span id="line-1733"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679082492"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082491"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1734"></span><span>  </span><span class="hs-comment">-- | Second argument</span><span>
</span><span id="line-1735"></span><span>  </span><span class="annot"><a href="#local-6989586621679082494"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1736"></span><span>  </span><span class="annot"><a href="#local-6989586621679082495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082493"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-1737"></span><span id="liftD2%27"><span class="annot"><span class="annottext">liftD2' :: (FilePath -&gt; v -&gt; IO a) -&gt; Path b t -&gt; v -&gt; m a
</span><a href="Path.IO.html#liftD2%27"><span class="hs-identifier hs-var hs-var">liftD2'</span></a></span></span><span> </span><span id="local-6989586621679081974"><span class="annot"><span class="annottext">FilePath -&gt; v -&gt; IO a
</span><a href="#local-6989586621679081974"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679081973"><span class="annot"><span class="annottext">Path b t
</span><a href="#local-6989586621679081973"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679081972"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679081972"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; m a) -&gt; IO a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; v -&gt; IO a
</span><a href="#local-6989586621679081974"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path b t -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var">toFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path b t
</span><a href="#local-6989586621679081973"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679081972"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1738"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Path.IO.html#liftD2%27"><span class="hs-pragma hs-type">liftD2'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1739"></span><span>
</span><span id="line-1740"></span><span class="hs-comment">-- | Like 'toFilePath', but also drops the trailing path separator.</span><span>
</span><span id="line-1741"></span><span id="local-6989586621679081970"><span id="local-6989586621679081971"><span class="annot"><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-type">toFilePath'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path</span></span><span> </span><span class="annot"><a href="#local-6989586621679081971"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081970"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span></span><span>
</span><span id="line-1742"></span><span id="toFilePath%27"><span class="annot"><span class="annottext">toFilePath' :: Path b t -&gt; FilePath
</span><a href="Path.IO.html#toFilePath%27"><span class="hs-identifier hs-var hs-var">toFilePath'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">F.dropTrailingPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (Path b t -&gt; FilePath) -&gt; Path b t -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Path b t -&gt; FilePath
forall b t. Path b t -&gt; FilePath
</span><span class="hs-identifier hs-var">toFilePath</span></span><span>
</span><span id="line-1743"></span><span>
</span><span id="line-1744"></span><span class="hs-comment">-- | Perform an action ignoring IO exceptions it may throw.</span><span>
</span><span id="line-1745"></span><span class="annot"><a href="Path.IO.html#ignoringIOErrors"><span class="hs-identifier hs-type">ignoringIOErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span id="ignoringIOErrors"><span class="annot"><span class="annottext">ignoringIOErrors :: IO () -&gt; IO ()
</span><a href="Path.IO.html#ignoringIOErrors"><span class="hs-identifier hs-var hs-var">ignoringIOErrors</span></a></span></span><span> </span><span id="local-6989586621679081968"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679081968"><span class="hs-identifier hs-var">ioe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679081968"><span class="hs-identifier hs-var">ioe</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; (IOError -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) e a.
(MonadCatch m, Exception e) =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall (m :: * -&gt; *). Monad m =&gt; IOError -&gt; m ()
</span><a href="#local-6989586621679081966"><span class="hs-identifier hs-var">handler</span></a></span><span>
</span><span id="line-1747"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1748"></span><span>    </span><span id="local-6989586621679082422"><span class="annot"><a href="#local-6989586621679081966"><span class="hs-identifier hs-type">handler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679082422"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679082422"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1749"></span><span>    </span><span id="local-6989586621679081966"><span class="annot"><span class="annottext">handler :: IOError -&gt; m ()
</span><a href="#local-6989586621679081966"><span class="hs-identifier hs-var hs-var">handler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; IOError -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1750"></span></pre></body></html>