<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module:      Math.NumberTheory.Logarithms</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Copyright:   (c) 2011 Daniel Fischer</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Licence:     MIT</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer:  Daniel Fischer &lt;daniel.is.fischer@googlemail.com&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability:   Provisional</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability: Non-portable (GHC extensions)</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Integer Logarithms. For efficiency, the internal representation of 'Integer's</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- from integer-gmp is used.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Math.NumberTheory.Logarithms</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Integer logarithms with input checks</span></span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLogBase"><span class="hs-identifier">integerLogBase</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog2"><span class="hs-identifier">integerLog2</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog10"><span class="hs-identifier">integerLog10</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLogBase"><span class="hs-identifier">naturalLogBase</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog2"><span class="hs-identifier">naturalLog2</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog10"><span class="hs-identifier">naturalLog10</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#intLog2"><span class="hs-identifier">intLog2</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#wordLog2"><span class="hs-identifier">wordLog2</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Integer logarithms without input checks</span></span><span>
</span><span id="line-31"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- | These functions are total, however, don't rely on the values with out-of-domain arguments.</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier">integerLogBase'</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier">integerLog2'</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog10%27"><span class="hs-identifier">integerLog10'</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#intLog2%27"><span class="hs-identifier">intLog2'</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#wordLog2%27"><span class="hs-identifier">wordLog2'</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.Unboxed</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Natural</span></span><span class="hs-cpp">

#ifdef MIN_VERSION_ghc_bignum
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">GHC.Num.Natural</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BN</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Integer.Logarithms.Compat.html"><span class="hs-identifier">GHC.Integer.Logarithms.Compat</span></a></span><span class="hs-cpp">
#if MIN_VERSION_base(4,8,0) &amp;&amp; defined(MIN_VERSION_integer_gmp)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Integer.GMP.Internals</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Integer</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Natural</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if CheckBounds
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Array.IArray</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IArray</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.Base</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeAt</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Calculate the integer logarithm for an arbitrary base.</span><span>
</span><span id="line-64"></span><span class="hs-comment">--   The base must be greater than 1, the second argument, the number</span><span>
</span><span id="line-65"></span><span class="hs-comment">--   whose logarithm is sought, must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--   If @base == 2@, the specialised version is called, which is more</span><span>
</span><span id="line-67"></span><span class="hs-comment">--   efficient than the general algorithm.</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">--   Satisfies:</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt; base ^ integerLogBase base m &lt;= m &lt; base ^ (integerLogBase base m + 1)</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- for @base &gt; 1@ and @m &gt; 0@.</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLogBase"><span class="hs-identifier hs-type">integerLogBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-75"></span><span id="integerLogBase"><span class="annot"><span class="annottext">integerLogBase :: Integer -&gt; Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLogBase"><span class="hs-identifier hs-var hs-var">integerLogBase</span></a></span></span><span> </span><span id="local-6989586621679025500"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025500"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679025499"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025499"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025499"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.integerLogBase: argument must be positive.&quot;</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025499"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025500"><span class="hs-identifier hs-var">b</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025500"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier hs-var">integerLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025499"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025500"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.integerLogBase: base must be greater than one.&quot;</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier hs-var">integerLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025500"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025499"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Calculate the integer logarithm of an 'Integer' to base 2.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--   The argument must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog2"><span class="hs-identifier hs-type">integerLog2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-85"></span><span id="integerLog2"><span class="annot"><span class="annottext">integerLog2 :: Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog2"><span class="hs-identifier hs-var hs-var">integerLog2</span></a></span></span><span> </span><span id="local-6989586621679025496"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025496"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025496"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.integerLog2: argument must be positive&quot;</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLog2#</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025496"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Cacluate the integer logarithm for an arbitrary base.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--   The base must be greater than 1, the second argument, the number</span><span>
</span><span id="line-91"></span><span class="hs-comment">--   whose logarithm is sought, must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--   If @base == 2@, the specialised version is called, which is more</span><span>
</span><span id="line-93"></span><span class="hs-comment">--   efficient than the general algorithm.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">--   Satisfies:</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt; base ^ integerLogBase base m &lt;= m &lt; base ^ (integerLogBase base m + 1)</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- for @base &gt; 1@ and @m &gt; 0@.</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLogBase"><span class="hs-identifier hs-type">naturalLogBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-101"></span><span id="naturalLogBase"><span class="annot"><span class="annottext">naturalLogBase :: Natural -&gt; Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLogBase"><span class="hs-identifier hs-var hs-var">naturalLogBase</span></a></span></span><span> </span><span id="local-6989586621679025494"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025494"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679025493"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025493"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025493"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.naturalLogBase: argument must be positive.&quot;</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025493"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025494"><span class="hs-identifier hs-var">b</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025494"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%27"><span class="hs-identifier hs-var">naturalLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025493"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025494"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">2</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.naturalLogBase: base must be greater than one.&quot;</span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLogBase%27"><span class="hs-identifier hs-var">naturalLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025494"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025493"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Calculate the natural logarithm of an 'Natural' to base 2.</span><span>
</span><span id="line-109"></span><span class="hs-comment">--   The argument must be non-zero, otherwise an error is thrown.</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog2"><span class="hs-identifier hs-type">naturalLog2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-111"></span><span id="naturalLog2"><span class="annot"><span class="annottext">naturalLog2 :: Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2"><span class="hs-identifier hs-var hs-var">naturalLog2</span></a></span></span><span> </span><span id="local-6989586621679025490"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025490"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025490"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.naturalLog2: argument must be non-zero&quot;</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int#
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-var">naturalLog2#</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025490"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Calculate the integer logarithm of an 'Int' to base 2.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--   The argument must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-117"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#intLog2"><span class="hs-identifier hs-type">intLog2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-118"></span><span id="intLog2"><span class="annot"><span class="annottext">intLog2 :: Int -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#intLog2"><span class="hs-identifier hs-var hs-var">intLog2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679025488"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679025488"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679025488"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.intLog2: argument must be positive&quot;</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">wordLog2#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679025488"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Calculate the integer logarithm of a 'Word' to base 2.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--   The argument must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#wordLog2"><span class="hs-identifier hs-type">wordLog2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-125"></span><span id="wordLog2"><span class="annot"><span class="annottext">wordLog2 :: Word -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#wordLog2"><span class="hs-identifier hs-var hs-var">wordLog2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621679025485"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025485"><span class="hs-identifier hs-var">w#</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><span class="hs-identifier hs-var">isTrue#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025485"><span class="hs-identifier hs-var">w#</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`eqWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.wordLog2: argument must not be 0.&quot;</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">wordLog2#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025485"><span class="hs-identifier hs-var">w#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Same as 'integerLog2', but without checks, saves a little time when</span><span>
</span><span id="line-130"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-131"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier hs-type">integerLog2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-132"></span><span id="integerLog2%27"><span class="annot"><span class="annottext">integerLog2' :: Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier hs-var hs-var">integerLog2'</span></a></span></span><span> </span><span id="local-6989586621679025484"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025484"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLog2#</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025484"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Same as 'naturalLog2', but without checks, saves a little time when</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog2%27"><span class="hs-identifier hs-type">naturalLog2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-137"></span><span id="naturalLog2%27"><span class="annot"><span class="annottext">naturalLog2' :: Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%27"><span class="hs-identifier hs-var hs-var">naturalLog2'</span></a></span></span><span> </span><span id="local-6989586621679025483"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025483"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int#
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-var">naturalLog2#</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025483"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Same as 'intLog2', but without checks, saves a little time when</span><span>
</span><span id="line-140"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-141"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#intLog2%27"><span class="hs-identifier hs-type">intLog2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-142"></span><span id="intLog2%27"><span class="annot"><span class="annottext">intLog2' :: Int -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#intLog2%27"><span class="hs-identifier hs-var hs-var">intLog2'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679025482"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679025482"><span class="hs-identifier hs-var">i#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">wordLog2#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><span class="hs-identifier hs-var">int2Word#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679025482"><span class="hs-identifier hs-var">i#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Same as 'wordLog2', but without checks, saves a little time when</span><span>
</span><span id="line-145"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-146"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#wordLog2%27"><span class="hs-identifier hs-type">wordLog2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-147"></span><span id="wordLog2%27"><span class="annot"><span class="annottext">wordLog2' :: Word -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#wordLog2%27"><span class="hs-identifier hs-var hs-var">wordLog2'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W#</span></span><span> </span><span id="local-6989586621679025481"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025481"><span class="hs-identifier hs-var">w#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">wordLog2#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025481"><span class="hs-identifier hs-var">w#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Calculate the integer logarithm of an 'Integer' to base 10.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--   The argument must be positive, otherwise an error is thrown.</span><span>
</span><span id="line-151"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog10"><span class="hs-identifier hs-type">integerLog10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-152"></span><span id="integerLog10"><span class="annot"><span class="annottext">integerLog10 :: Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog10"><span class="hs-identifier hs-var hs-var">integerLog10</span></a></span></span><span> </span><span id="local-6989586621679025480"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025480"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025480"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.integerLog10: argument must be positive&quot;</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog10%27"><span class="hs-identifier hs-var">integerLog10'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025480"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Calculate the integer logarithm of an 'Integer' to base 10.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--   The argument must be not zero, otherwise an error is thrown.</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog10"><span class="hs-identifier hs-type">naturalLog10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-159"></span><span id="naturalLog10"><span class="annot"><span class="annottext">naturalLog10 :: Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog10"><span class="hs-identifier hs-var hs-var">naturalLog10</span></a></span></span><span> </span><span id="local-6989586621679025479"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025479"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025479"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Math.NumberTheory.Logarithms.naturalaLog10: argument must be non-zero&quot;</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog10%27"><span class="hs-identifier hs-var">naturalLog10'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025479"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Same as 'integerLog10', but without a check for a positive</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   argument. Saves a little time when called often for known good</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   input.</span><span>
</span><span id="line-166"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLog10%27"><span class="hs-identifier hs-type">integerLog10'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-167"></span><span id="integerLog10%27"><span class="annot"><span class="annottext">integerLog10' :: Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog10%27"><span class="hs-identifier hs-var hs-var">integerLog10'</span></a></span></span><span> </span><span id="local-6989586621679025477"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025477"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025477"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025477"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025476"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog10%27"><span class="hs-identifier hs-var">integerLog10'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025477"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025476"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>      </span><span id="local-6989586621679025472"><span class="annot"><span class="annottext">ln :: Int
</span><a href="#local-6989586621679025472"><span class="hs-identifier hs-var hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLog2#</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025477"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-comment">-- u/v is a good approximation of log 2/log 10</span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679025471"><span class="annot"><span class="annottext">u :: Integer
</span><a href="#local-6989586621679025471"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1936274</span></span><span>
</span><span id="line-175"></span><span>      </span><span id="local-6989586621679025470"><span class="annot"><span class="annottext">v :: Integer
</span><a href="#local-6989586621679025470"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6432163</span></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-comment">-- so ex is a good approximation to integerLogBase 10 n</span><span>
</span><span id="line-177"></span><span>      </span><span id="local-6989586621679025476"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025476"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025471"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025472"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025470"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Same as 'naturalLog10', but without a check for a positive</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   argument. Saves a little time when called often for known good</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   input.</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog10%27"><span class="hs-identifier hs-type">naturalLog10'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-183"></span><span id="naturalLog10%27"><span class="annot"><span class="annottext">naturalLog10' :: Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog10%27"><span class="hs-identifier hs-var hs-var">naturalLog10'</span></a></span></span><span> </span><span id="local-6989586621679025468"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025468"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">10</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">100</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025467"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog10%27"><span class="hs-identifier hs-var">naturalLog10'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int -&gt; Natural
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025467"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>      </span><span id="local-6989586621679025466"><span class="annot"><span class="annottext">ln :: Int
</span><a href="#local-6989586621679025466"><span class="hs-identifier hs-var hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Int#
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-var">naturalLog2#</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025468"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-comment">-- u/v is a good approximation of log 2/log 10</span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679025465"><span class="annot"><span class="annottext">u :: Integer
</span><a href="#local-6989586621679025465"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1936274</span></span><span>
</span><span id="line-191"></span><span>      </span><span id="local-6989586621679025464"><span class="annot"><span class="annottext">v :: Integer
</span><a href="#local-6989586621679025464"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6432163</span></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-comment">-- so ex is a good approximation to naturalLogBase 10 n</span><span>
</span><span id="line-193"></span><span>      </span><span id="local-6989586621679025467"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025467"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025465"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025466"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025464"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Same as 'integerLogBase', but without checks, saves a little time when</span><span>
</span><span id="line-196"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier hs-type">integerLogBase'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-198"></span><span id="integerLogBase%27"><span class="annot"><span class="annottext">integerLogBase' :: Integer -&gt; Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier hs-var hs-var">integerLogBase'</span></a></span></span><span> </span><span id="local-6989586621679025463"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679025462"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025462"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025462"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025461"><span class="hs-identifier hs-var">ln</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025460"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025460"><span class="hs-identifier hs-var">lb</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-comment">-- overflow safe version of ln &lt; 2*lb, implies n &lt; b*b</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">33</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679025459"><span class="annot"><span class="annottext">bi :: Int
</span><a href="#local-6989586621679025459"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-202"></span><span>                      </span><span id="local-6989586621679025458"><span class="annot"><span class="annottext">ix :: Int
</span><a href="#local-6989586621679025458"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025459"><span class="hs-identifier hs-var">bi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-203"></span><span>                      </span><span class="hs-comment">-- u/v is a good approximation of log 2/log b</span><span>
</span><span id="line-204"></span><span>                      </span><span id="local-6989586621679025457"><span class="annot"><span class="annottext">u :: Int
</span><a href="#local-6989586621679025457"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025458"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-205"></span><span>                      </span><span id="local-6989586621679025455"><span class="annot"><span class="annottext">v :: Int
</span><a href="#local-6989586621679025455"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025458"><span class="hs-identifier hs-var">ix</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                      </span><span class="hs-comment">-- hence ex is a rather good approximation of integerLogBase b n</span><span>
</span><span id="line-207"></span><span>                      </span><span class="hs-comment">-- most of the time, it will already be exact</span><span>
</span><span id="line-208"></span><span>                      </span><span id="local-6989586621679025454"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025454"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025457"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025461"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025455"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025457"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>                      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025461"><span class="hs-identifier hs-var">ln</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025455"><span class="hs-identifier hs-var">v</span></a></span><span>      </span><span class="hs-comment">-- a power of 2, easy</span><span>
</span><span id="line-211"></span><span>                      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025454"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier hs-var">integerLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025462"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025454"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- shift b so that 16 &lt;= bi &lt; 32</span><span>
</span><span id="line-213"></span><span>                      </span><span id="local-6989586621679025453"><span class="annot"><span class="annottext">bi :: Int
</span><a href="#local-6989586621679025453"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025460"><span class="hs-identifier hs-var">lb</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>                      </span><span class="hs-comment">-- we choose an approximation of log 2 / log (bi+1) to</span><span>
</span><span id="line-215"></span><span>                      </span><span class="hs-comment">-- be sure we underestimate</span><span>
</span><span id="line-216"></span><span>                      </span><span id="local-6989586621679025451"><span class="annot"><span class="annottext">ix :: Int
</span><a href="#local-6989586621679025451"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025453"><span class="hs-identifier hs-var">bi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-217"></span><span>                      </span><span class="hs-comment">-- u/w is a reasonably good approximation to log 2/log b</span><span>
</span><span id="line-218"></span><span>                      </span><span class="hs-comment">-- it is too small, but not by much, so the recursive call</span><span>
</span><span id="line-219"></span><span>                      </span><span class="hs-comment">-- should most of the time be caught by one of the first</span><span>
</span><span id="line-220"></span><span>                      </span><span class="hs-comment">-- two guards unless n is huge, but then it'd still be</span><span>
</span><span id="line-221"></span><span>                      </span><span class="hs-comment">-- a call with a much smaller second argument.</span><span>
</span><span id="line-222"></span><span>                      </span><span id="local-6989586621679025450"><span class="annot"><span class="annottext">u :: Integer
</span><a href="#local-6989586621679025450"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025451"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-223"></span><span>                      </span><span id="local-6989586621679025449"><span class="annot"><span class="annottext">v :: Integer
</span><a href="#local-6989586621679025449"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Int -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025451"><span class="hs-identifier hs-var">ix</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                      </span><span id="local-6989586621679025448"><span class="annot"><span class="annottext">w :: Integer
</span><a href="#local-6989586621679025448"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025449"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025450"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025460"><span class="hs-identifier hs-var">lb</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                      </span><span id="local-6989586621679025447"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025447"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025450"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025461"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025448"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025447"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLogBase%27"><span class="hs-identifier hs-var">integerLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025462"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025447"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>      </span><span id="local-6989586621679025460"><span class="annot"><span class="annottext">lb :: Int
</span><a href="#local-6989586621679025460"><span class="hs-identifier hs-var hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier hs-var">integerLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025463"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span id="local-6989586621679025461"><span class="annot"><span class="annottext">ln :: Int
</span><a href="#local-6989586621679025461"><span class="hs-identifier hs-var hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#integerLog2%27"><span class="hs-identifier hs-var">integerLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679025462"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Same as 'naturalLogBase', but without checks, saves a little time when</span><span>
</span><span id="line-232"></span><span class="hs-comment">--   called often for known good input.</span><span>
</span><span id="line-233"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLogBase%27"><span class="hs-identifier hs-type">naturalLogBase'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-234"></span><span id="naturalLogBase%27"><span class="annot"><span class="annottext">naturalLogBase' :: Natural -&gt; Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLogBase%27"><span class="hs-identifier hs-var hs-var">naturalLogBase'</span></a></span></span><span> </span><span id="local-6989586621679025446"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679025445"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025445"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025445"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025444"><span class="hs-identifier hs-var">ln</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025443"><span class="hs-identifier hs-var">lb</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025443"><span class="hs-identifier hs-var">lb</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-comment">-- overflow safe version of ln &lt; 2*lb, implies n &lt; b*b</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">33</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679025442"><span class="annot"><span class="annottext">bi :: Int
</span><a href="#local-6989586621679025442"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-238"></span><span>                      </span><span id="local-6989586621679025441"><span class="annot"><span class="annottext">ix :: Int
</span><a href="#local-6989586621679025441"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025442"><span class="hs-identifier hs-var">bi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-239"></span><span>                      </span><span class="hs-comment">-- u/v is a good approximation of log 2/log b</span><span>
</span><span id="line-240"></span><span>                      </span><span id="local-6989586621679025440"><span class="annot"><span class="annottext">u :: Int
</span><a href="#local-6989586621679025440"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025441"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-241"></span><span>                      </span><span id="local-6989586621679025439"><span class="annot"><span class="annottext">v :: Int
</span><a href="#local-6989586621679025439"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025441"><span class="hs-identifier hs-var">ix</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                      </span><span class="hs-comment">-- hence ex is a rather good approximation of integerLogBase b n</span><span>
</span><span id="line-243"></span><span>                      </span><span class="hs-comment">-- most of the time, it will already be exact</span><span>
</span><span id="line-244"></span><span>                      </span><span id="local-6989586621679025438"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025438"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a. Num a =&gt; Natural -&gt; a
</span><a href="Math.NumberTheory.Logarithms.html#fromNatural"><span class="hs-identifier hs-var">fromNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025440"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025444"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025439"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025440"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>                      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025444"><span class="hs-identifier hs-var">ln</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025439"><span class="hs-identifier hs-var">v</span></a></span><span>      </span><span class="hs-comment">-- a power of 2, easy</span><span>
</span><span id="line-247"></span><span>                      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025438"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLogBase%27"><span class="hs-identifier hs-var">naturalLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025445"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int -&gt; Natural
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025438"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- shift b so that 16 &lt;= bi &lt; 32</span><span>
</span><span id="line-249"></span><span>                      </span><span id="local-6989586621679025436"><span class="annot"><span class="annottext">bi :: Int
</span><a href="#local-6989586621679025436"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a. Num a =&gt; Natural -&gt; a
</span><a href="Math.NumberTheory.Logarithms.html#fromNatural"><span class="hs-identifier hs-var">fromNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int -&gt; Natural
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025443"><span class="hs-identifier hs-var">lb</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>                      </span><span class="hs-comment">-- we choose an approximation of log 2 / log (bi+1) to</span><span>
</span><span id="line-251"></span><span>                      </span><span class="hs-comment">-- be sure we underestimate</span><span>
</span><span id="line-252"></span><span>                      </span><span id="local-6989586621679025435"><span class="annot"><span class="annottext">ix :: Int
</span><a href="#local-6989586621679025435"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025436"><span class="hs-identifier hs-var">bi</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-253"></span><span>                      </span><span class="hs-comment">-- u/w is a reasonably good approximation to log 2/log b</span><span>
</span><span id="line-254"></span><span>                      </span><span class="hs-comment">-- it is too small, but not by much, so the recursive call</span><span>
</span><span id="line-255"></span><span>                      </span><span class="hs-comment">-- should most of the time be caught by one of the first</span><span>
</span><span id="line-256"></span><span>                      </span><span class="hs-comment">-- two guards unless n is huge, but then it'd still be</span><span>
</span><span id="line-257"></span><span>                      </span><span class="hs-comment">-- a call with a much smaller second argument.</span><span>
</span><span id="line-258"></span><span>                      </span><span id="local-6989586621679025434"><span class="annot"><span class="annottext">u :: Natural
</span><a href="#local-6989586621679025434"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025435"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-259"></span><span>                      </span><span id="local-6989586621679025433"><span class="annot"><span class="annottext">v :: Natural
</span><a href="#local-6989586621679025433"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Natural) -&gt; Int -&gt; Natural
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var">logArr</span></a></span><span> </span><span class="annot"><span class="annottext">UArray Int Int -&gt; Int -&gt; Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-operator hs-var">`unsafeAt`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025435"><span class="hs-identifier hs-var">ix</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>                      </span><span id="local-6989586621679025432"><span class="annot"><span class="annottext">w :: Natural
</span><a href="#local-6989586621679025432"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025433"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025434"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025443"><span class="hs-identifier hs-var">lb</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>                      </span><span id="local-6989586621679025431"><span class="annot"><span class="annottext">ex :: Int
</span><a href="#local-6989586621679025431"><span class="hs-identifier hs-var hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a. Num a =&gt; Natural -&gt; a
</span><a href="Math.NumberTheory.Logarithms.html#fromNatural"><span class="hs-identifier hs-var">fromNatural</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025434"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Natural
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025444"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025432"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025431"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLogBase%27"><span class="hs-identifier hs-var">naturalLogBase'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025445"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`quot`</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int -&gt; Natural
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679025431"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679025443"><span class="annot"><span class="annottext">lb :: Int
</span><a href="#local-6989586621679025443"><span class="hs-identifier hs-var hs-var">lb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%27"><span class="hs-identifier hs-var">naturalLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025446"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621679025444"><span class="annot"><span class="annottext">ln :: Int
</span><a href="#local-6989586621679025444"><span class="hs-identifier hs-var hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%27"><span class="hs-identifier hs-var">naturalLog2'</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621679025445"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- Lookup table for logarithms of 2 &lt;= k &lt;= 32</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- In each row &quot;x , y&quot;, x/y is a good rational approximation of log 2  / log k.</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- For the powers of 2, it is exact, otherwise x/y &lt; log 2/log k, since we don't</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- want to overestimate integerLogBase b n = floor $ (log 2/log b)*logBase 2 n.</span><span>
</span><span id="line-271"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-type">logArr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-272"></span><span id="logArr"><span class="annot"><span class="annottext">logArr :: UArray Int Int
</span><a href="Math.NumberTheory.Logarithms.html#logArr"><span class="hs-identifier hs-var hs-var">logArr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Int] -&gt; UArray Int Int
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">61</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">301994</span></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1936274</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4495889</span></span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">492531</span></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">91313</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256348</span></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">603988</span></span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1936274</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6432163</span></span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1686227</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5833387</span></span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">683068</span></span><span class="hs-special">,</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5458</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20197</span></span><span class="hs-special">,</span><span>
</span><span id="line-285"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">91313</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">347661</span></span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">416263</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1626294</span></span><span class="hs-special">,</span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32631</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">133378</span></span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">794525</span></span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">163451</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">694328</span></span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1936274</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8368437</span></span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1454590</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6389021</span></span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1686227</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7519614</span></span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">785355</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3552602</span></span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">873605</span></span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">968137</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4495889</span></span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5458</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">25655</span></span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">190537</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">905982</span></span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">91313</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">438974</span></span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">390321</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1896172</span></span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">416263</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2042557</span></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">709397</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3514492</span></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- Unsafe</span><span>
</span><span id="line-308"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span class="hs-cpp">

#if CheckBounds
</span><span class="hs-identifier">unsafeAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">IArray</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Ix</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span>
</span><span id="line-312"></span><span class="hs-identifier">unsafeAt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-315"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- Natural helpers</span><span>
</span><span id="line-317"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621679025520"><span class="annot"><a href="Math.NumberTheory.Logarithms.html#fromNatural"><span class="hs-identifier hs-type">fromNatural</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679025520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679025520"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-320"></span><span id="fromNatural"><span class="annot"><span class="annottext">fromNatural :: Natural -&gt; a
</span><a href="Math.NumberTheory.Logarithms.html#fromNatural"><span class="hs-identifier hs-var hs-var">fromNatural</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-type">naturalLog2#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span class="hs-cpp">
#ifdef MIN_VERSION_ghc_bignum
</span><span class="hs-identifier">naturalLog2#</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word2Int#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">BN.naturalLog2#</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#if MIN_VERSION_base(4,8,0) &amp;&amp; defined(MIN_VERSION_integer_gmp)
</span><span id="naturalLog2%23"><span class="annot"><span class="annottext">naturalLog2# :: Natural -&gt; Int#
</span><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-var hs-var">naturalLog2#</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NatS#</span></span><span> </span><span id="local-6989586621679025429"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025429"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><span class="hs-identifier hs-var">wordLog2#</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679025429"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Math.NumberTheory.Logarithms.html#naturalLog2%23"><span class="hs-identifier hs-var">naturalLog2#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NatJ#</span></span><span> </span><span id="local-6989586621679025427"><span class="annot"><span class="annottext">BigNat
</span><a href="#local-6989586621679025427"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int#
</span><span class="hs-identifier hs-var">integerLog2#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BigNat -&gt; Integer
</span><span class="hs-identifier hs-var">Jp#</span></span><span> </span><span class="annot"><span class="annottext">BigNat
</span><a href="#local-6989586621679025427"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">naturalLog2#</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">integerLog2#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toInteger</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 707
</span><span class="hs-comment">-- The times they are a-changing. The types of primops too :(</span><span>
</span><span id="line-336"></span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-337"></span><span class="hs-identifier">isTrue#</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">id</span><span class="hs-cpp">
#endif
</span></pre></body></html>