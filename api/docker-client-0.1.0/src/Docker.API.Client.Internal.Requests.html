<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedLists #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Functions for sending HTTP requests to the Docker Engine API</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Docker.API.Client.Internal.Requests</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Conduit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filterC</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapC</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Resource</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runResourceT</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">eitherDecode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBS</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runConduit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.|)</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.Combinators</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sinkFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sinkNull</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stdout</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.Tar</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tar</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Conduit.Zlib</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ungzip</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html"><span class="hs-identifier">Docker.API.Client.Internal.Schemas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier">ContainerId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#CreateContainer"><span class="hs-identifier">CreateContainer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#CreateContainerResponse"><span class="hs-identifier">CreateContainerResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#WaitContainerResponse"><span class="hs-identifier">WaitContainerResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html"><span class="hs-identifier">Docker.API.Client.Internal.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier">ClientErrorMonad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ContainerLogType"><span class="hs-identifier">ContainerLogType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ContainerSpec"><span class="hs-identifier">ContainerSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#image"><span class="hs-identifier">image</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#DockerClientError"><span class="hs-identifier">DockerClientError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Util.html"><span class="hs-identifier">Docker.API.Client.Internal.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Docker.API.Client.Internal.Util.html#chownTarballContent"><span class="hs-identifier">chownTarballContent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Util.html#containerSpecToCreateContainer"><span class="hs-identifier">containerSpecToCreateContainer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Util.html#createLogTypeFilter"><span class="hs-identifier">createLogTypeFilter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Util.html#parseMultiplexedDockerStream"><span class="hs-identifier">parseMultiplexedDockerStream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTPC</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types.Header</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hContentType</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types.Status</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Status</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status200</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status201</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status204</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">statusCode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">statusMessage</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">GroupID</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UserID</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Docker Engine API version. This value will prefix all docker api url paths.</span><span>
</span><span id="line-28"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-type">dockerAPIVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-29"></span><span id="dockerAPIVersion"><span class="annot"><span class="annottext">dockerAPIVersion :: String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var hs-var">dockerAPIVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;v1.40&quot;</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Helper function which formats the response of a failed HTTP request</span><span>
</span><span id="line-32"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-type">formatRequestError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-33"></span><span id="formatRequestError"><span class="annot"><span class="annottext">formatRequestError :: Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var hs-var">formatRequestError</span></a></span></span><span> </span><span id="local-6989586621679107795"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107795"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span id="local-6989586621679107794"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107794"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Request failed with status &quot;</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var hs-var">statusCode</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107795"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">statusMessage</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107795"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107794"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Similar to the `docker run` command. Runs a container in the background using the input HTTP connection manager, returning immediately.</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- To wait for the container to exit use `awaitContainer`.</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- Note that this currently always tries to pull the container's image.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#runContainer"><span class="hs-identifier hs-type">runContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon. You can `Docker.API.Client.newDefaultDockerManager` to get a default</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-comment">-- connection manager based on your operating system.</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ContainerSpec"><span class="hs-identifier hs-type">ContainerSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span>
</span><span id="line-50"></span><span id="runContainer"><span class="annot"><span class="annottext">runContainer :: Manager -&gt; ContainerSpec -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#runContainer"><span class="hs-identifier hs-var hs-var">runContainer</span></a></span></span><span> </span><span id="local-6989586621679107791"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107790"><span class="annot"><span class="annottext">ContainerSpec
</span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107789"><span class="annot"><span class="annottext">payload :: CreateContainer
</span><a href="#local-6989586621679107789"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContainerSpec -&gt; CreateContainer
</span><a href="Docker.API.Client.Internal.Util.html#containerSpecToCreateContainer"><span class="hs-identifier hs-var">containerSpecToCreateContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ContainerSpec
</span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-52"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; Text -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#pullImage"><span class="hs-identifier hs-var">pullImage</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContainerSpec -&gt; Text
</span><a href="Docker.API.Client.Internal.Types.html#image"><span class="hs-identifier hs-var hs-var">image</span></a></span><span> </span><span class="annot"><span class="annottext">ContainerSpec
</span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ClientErrorMonad ()
-&gt; ExceptT DockerClientError IO ByteString
-&gt; ExceptT DockerClientError IO ByteString
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Manager
-&gt; CreateContainer -&gt; ExceptT DockerClientError IO ByteString
</span><a href="Docker.API.Client.Internal.Requests.html#submitCreateContainer"><span class="hs-identifier hs-var">submitCreateContainer</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">CreateContainer
</span><a href="#local-6989586621679107789"><span class="hs-identifier hs-var">payload</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT DockerClientError IO ByteString
-&gt; (ByteString -&gt; ClientErrorMonad String)
-&gt; ClientErrorMonad String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#parseCreateContainerResult"><span class="hs-identifier hs-var">parseCreateContainerResult</span></a></span><span> </span><span class="annot"><span class="annottext">ClientErrorMonad String
-&gt; (String -&gt; ClientErrorMonad String) -&gt; ClientErrorMonad String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; String -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#startContainer"><span class="hs-identifier hs-var">startContainer</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Waits on a started container (e.g. via `runContainer`) until it exits, validating its exit code and returning an `DockerClientError` if</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- the container exited with an error. This will work for both actively running containers and those which have already exited.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#awaitContainer"><span class="hs-identifier hs-type">awaitContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon. You can `Docker.API.Client.newDefaultDockerManager` to get a default</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- connection manager based on your operating system.</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">-- | The container id to await</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span id="awaitContainer"><span class="annot"><span class="annottext">awaitContainer :: Manager -&gt; String -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#awaitContainer"><span class="hs-identifier hs-var hs-var">awaitContainer</span></a></span></span><span> </span><span id="local-6989586621679107783"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107783"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107782"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107782"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Manager -&gt; String -&gt; ExceptT DockerClientError IO ByteString
</span><a href="Docker.API.Client.Internal.Requests.html#submitWaitContainer"><span class="hs-identifier hs-var">submitWaitContainer</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107783"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107782"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT DockerClientError IO ByteString
-&gt; (ByteString
    -&gt; ExceptT DockerClientError IO WaitContainerResponse)
-&gt; ExceptT DockerClientError IO WaitContainerResponse
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT DockerClientError IO WaitContainerResponse
</span><a href="Docker.API.Client.Internal.Requests.html#parseWaitContainerResult"><span class="hs-identifier hs-var">parseWaitContainerResult</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT DockerClientError IO WaitContainerResponse
-&gt; (WaitContainerResponse -&gt; ClientErrorMonad ())
-&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#checkExitStatusCode"><span class="hs-identifier hs-var">checkExitStatusCode</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Analagous to the `docker cp` command. Recursively copies contents at the specified path in the container to</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- the provided output path on the host, setting file permissions to the specified user and group id.  Note that the</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- container must have been started for this to succeed (i.e. it must have a running or finished state).  This method</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- uses conduit to optimize memory usage.</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#saveContainerArchive"><span class="hs-identifier hs-type">saveContainerArchive</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">-- | The user id to use for output files and directories</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UserID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- | The group id to use for output files and directories</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">GroupID</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- | The path in the container to copy</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- | The output path at which to write outputs</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span id="saveContainerArchive"><span class="annot"><span class="annottext">saveContainerArchive :: Manager
-&gt; UserID
-&gt; GroupID
-&gt; String
-&gt; String
-&gt; String
-&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#saveContainerArchive"><span class="hs-identifier hs-var hs-var">saveContainerArchive</span></a></span></span><span> </span><span id="local-6989586621679107776"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107776"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107775"><span class="annot"><span class="annottext">UserID
</span><a href="#local-6989586621679107775"><span class="hs-identifier hs-var">uid</span></a></span></span><span> </span><span id="local-6989586621679107774"><span class="annot"><span class="annottext">GroupID
</span><a href="#local-6989586621679107774"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span id="local-6989586621679107773"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107773"><span class="hs-identifier hs-var">itemPath</span></a></span></span><span> </span><span id="local-6989586621679107772"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107772"><span class="hs-identifier hs-var">outPath</span></a></span></span><span> </span><span id="local-6989586621679107771"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107771"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107770"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107770"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">setQueryString</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;path&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107773"><span class="hs-identifier hs-var">itemPath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-85"></span><span>          </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-86"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>              </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107771"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/archive&quot;</span></span><span>
</span><span id="line-88"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679107764"><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107764"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe DockerClientError)
 -&gt; ExceptT DockerClientError IO (Maybe DockerClientError))
-&gt; IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (Maybe DockerClientError)
 -&gt; IO (Maybe DockerClientError))
-&gt; ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>      </span><span id="local-6989586621679107762"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request
-&gt; Manager
-&gt; ResourceT
     IO (Response (ConduitM () ByteString (ResourceT IO) ()))
forall (m :: * -&gt; *) i.
MonadResource m =&gt;
Request -&gt; Manager -&gt; m (Response (ConduitM i ByteString m ()))
</span><span class="hs-identifier hs-var">HTTPC.http</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107770"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107776"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107760"><span class="annot"><span class="annottext">body :: ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107760"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; ConduitM () ByteString (ResourceT IO) ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107758"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ()) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-comment">-- Note: we're using a different approach than in the other http requests since the response</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-comment">-- is wrapped in a ResourceT when using http-conduit, and we would have to implement</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-comment">-- the conduit pipeline using ExceptT to make it compatible with that approach.</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>          </span><span class="hs-comment">-- This operation may throw an unexpected exception. If we want to catch stuff like</span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-comment">-- tar decoding errors we can switch to Tar.restoreFileIntoLenient</span><span>
</span><span id="line-101"></span><span>          </span><span class="annot"><span class="annottext">ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ())
-&gt; ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107760"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitT () Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitT ByteString ByteString (ResourceT IO) ()
forall (m :: * -&gt; *).
(PrimMonad m, MonadThrow m) =&gt;
ConduitT ByteString ByteString m ()
</span><span class="hs-identifier hs-var">ungzip</span></span><span> </span><span class="annot"><span class="annottext">ConduitT ByteString ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; ConduitM ByteString (IO ()) (ResourceT IO) ())
-&gt; ConduitM ByteString (IO ()) (ResourceT IO) ()
forall (m :: * -&gt; *) o.
MonadThrow m =&gt;
(FileInfo -&gt; ConduitM ByteString o m ())
-&gt; ConduitM ByteString o m ()
</span><span class="hs-identifier hs-var">Tar.untar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FileInfo -&gt; ConduitM ByteString (IO ()) (ResourceT IO) ()
forall (m :: * -&gt; *).
MonadResource m =&gt;
String -&gt; FileInfo -&gt; ConduitM ByteString (IO ()) m ()
</span><span class="hs-identifier hs-var">Tar.restoreFileInto</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107772"><span class="hs-identifier hs-var">outPath</span></a></span><span> </span><span class="annot"><span class="annottext">(FileInfo -&gt; ConduitM ByteString (IO ()) (ResourceT IO) ())
-&gt; (FileInfo -&gt; FileInfo)
-&gt; FileInfo
-&gt; ConduitM ByteString (IO ()) (ResourceT IO) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserID -&gt; GroupID -&gt; FileInfo -&gt; FileInfo
</span><a href="Docker.API.Client.Internal.Util.html#chownTarballContent"><span class="hs-identifier hs-var">chownTarballContent</span></a></span><span> </span><span class="annot"><span class="annottext">UserID
</span><a href="#local-6989586621679107775"><span class="hs-identifier hs-var">uid</span></a></span><span> </span><span class="annot"><span class="annottext">GroupID
</span><a href="#local-6989586621679107774"><span class="hs-identifier hs-var">gid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConduitM ByteString (IO ()) (ResourceT IO) ()
-&gt; ConduitM (IO ()) Void (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitM (IO ()) Void (ResourceT IO) ()
forall (m :: * -&gt; *) a o. Monad m =&gt; ConduitT a o m ()
</span><span class="hs-identifier hs-var">sinkNull</span></span><span>
</span><span id="line-102"></span><span>          </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError))
-&gt; Maybe DockerClientError
-&gt; ResourceT IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; Maybe DockerClientError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; Maybe DockerClientError)
-&gt; DockerClientError -&gt; Maybe DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#GetContainerArchiveError"><span class="hs-identifier hs-var">GetContainerArchiveError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107764"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107752"><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107752"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107752"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Pulls an image from a remote registry (similar to a `docker pull` command). This currently</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- only supports public registries (e.g. DockerHub).</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#pullImage"><span class="hs-identifier hs-type">pullImage</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- | The image of interest. May include an optional tag or digest field. Note that</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">-- in line with the Docker Engine API, this will pull **ALL** images in a repo if no tag</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- or digest is specified.</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span id="pullImage"><span class="annot"><span class="annottext">pullImage :: Manager -&gt; Text -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#pullImage"><span class="hs-identifier hs-var hs-var">pullImage</span></a></span></span><span> </span><span id="local-6989586621679107750"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107750"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107749"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679107749"><span class="hs-identifier hs-var">image</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107748"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107748"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">setQueryString</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;fromImage&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679107749"><span class="hs-identifier hs-var">image</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-121"></span><span>          </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>              </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/images/create&quot;</span></span><span>
</span><span id="line-124"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679107746"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107746"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; ExceptT DockerClientError IO (Response ByteString))
-&gt; IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107748"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107750"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107744"><span class="annot"><span class="annottext">result :: ClientErrorMonad ()
</span><a href="#local-6989586621679107744"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107743"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad ())
-&gt; DockerClientError -&gt; ClientErrorMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#ImagePullError"><span class="hs-identifier hs-var">ImagePullError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107743"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107741"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>          </span><span id="local-6989586621679107741"><span class="annot"><span class="annottext">body :: ByteString
</span><a href="#local-6989586621679107741"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107746"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-131"></span><span>          </span><span id="local-6989586621679107743"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107743"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107746"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">ClientErrorMonad ()
</span><a href="#local-6989586621679107744"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Streams the logs from a docker container into the specified output file path. Logs can include</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- stdout, stderr, or both. Note that if you include both streams, the sorting of the timestamps in the output</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- file may not be perfectly sorted since the stream returned by the docker api is only sorted within each</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- stream type (i.e. stdout and stderr are sorted separately).</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#saveContainerLogs"><span class="hs-identifier hs-type">saveContainerLogs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-comment">-- | Which logs to fetch from the container</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ContainerLogType"><span class="hs-identifier hs-type">ContainerLogType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-comment">-- | Output file at which to write logs</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span id="saveContainerLogs"><span class="annot"><span class="annottext">saveContainerLogs :: Manager
-&gt; ContainerLogType -&gt; String -&gt; String -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#saveContainerLogs"><span class="hs-identifier hs-var hs-var">saveContainerLogs</span></a></span></span><span> </span><span id="local-6989586621679107739"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107738"><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">logType</span></a></span></span><span> </span><span id="local-6989586621679107737"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107737"><span class="hs-identifier hs-var">outPath</span></a></span></span><span> </span><span id="local-6989586621679107736"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107735"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107735"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">setQueryString</span></span><span>
</span><span id="line-150"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;follow&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;stdout&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107734"><span class="hs-identifier hs-var">stdout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;stderr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var">stderr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;timestamps&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>          </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>              </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/logs&quot;</span></span><span>
</span><span id="line-158"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>          </span><span id="local-6989586621679107733"><span class="annot"><span class="annottext">stderr :: ByteString
</span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var hs-var">stderr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">logType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="Docker.API.Client.Internal.Types.html#Stdout"><span class="hs-identifier hs-var">Stdout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-163"></span><span>          </span><span id="local-6989586621679107734"><span class="annot"><span class="annottext">stdout :: ByteString
</span><a href="#local-6989586621679107734"><span class="hs-identifier hs-var hs-var">stdout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">logType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="Docker.API.Client.Internal.Types.html#StdErr"><span class="hs-identifier hs-var">StdErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679107730"><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107730"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe DockerClientError)
 -&gt; ExceptT DockerClientError IO (Maybe DockerClientError))
-&gt; IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (Maybe DockerClientError)
 -&gt; IO (Maybe DockerClientError))
-&gt; ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679107729"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107729"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request
-&gt; Manager
-&gt; ResourceT
     IO (Response (ConduitM () ByteString (ResourceT IO) ()))
forall (m :: * -&gt; *) i.
MonadResource m =&gt;
Request -&gt; Manager -&gt; m (Response (ConduitM i ByteString m ()))
</span><span class="hs-identifier hs-var">HTTPC.http</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107735"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107728"><span class="annot"><span class="annottext">body :: ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107728"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; ConduitM () ByteString (ResourceT IO) ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107729"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107727"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107727"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ()) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107729"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-comment">-- Note: we're using a different approach than in the other http requests since the response</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-comment">-- is wrapped in a ResourceT when using http-conduit, and we would have to implement</span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-comment">-- the conduit pipeline using ExceptT to make it compatible with that approach.</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107727"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107726"><span class="annot"><span class="annottext">isLogType :: (DockerStreamType, a) -&gt; Bool
</span><a href="#local-6989586621679107726"><span class="hs-identifier hs-var hs-var">isLogType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContainerLogType -&gt; (DockerStreamType, a) -&gt; Bool
forall a. ContainerLogType -&gt; (DockerStreamType, a) -&gt; Bool
</span><a href="Docker.API.Client.Internal.Util.html#createLogTypeFilter"><span class="hs-identifier hs-var">createLogTypeFilter</span></a></span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">logType</span></a></span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><span class="annottext">ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ())
-&gt; ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107728"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitT () Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ByteString (DockerStreamType, ByteString) (ResourceT IO) ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
ConduitT ByteString (DockerStreamType, ByteString) m ()
</span><a href="Docker.API.Client.Internal.Util.html#parseMultiplexedDockerStream"><span class="hs-identifier hs-var">parseMultiplexedDockerStream</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ByteString (DockerStreamType, ByteString) (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">((DockerStreamType, ByteString) -&gt; Bool)
-&gt; ConduitT
     (DockerStreamType, ByteString)
     (DockerStreamType, ByteString)
     (ResourceT IO)
     ()
forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; Bool) -&gt; ConduitT a a m ()
</span><span class="hs-identifier hs-var">filterC</span></span><span> </span><span class="annot"><span class="annottext">(DockerStreamType, ByteString) -&gt; Bool
forall a. (DockerStreamType, a) -&gt; Bool
</span><a href="#local-6989586621679107726"><span class="hs-identifier hs-var">isLogType</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  (DockerStreamType, ByteString)
  (DockerStreamType, ByteString)
  (ResourceT IO)
  ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">((DockerStreamType, ByteString) -&gt; ByteString)
-&gt; ConduitT
     (DockerStreamType, ByteString) ByteString (ResourceT IO) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">mapC</span></span><span> </span><span class="annot"><span class="annottext">(DockerStreamType, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">ConduitT
  (DockerStreamType, ByteString) ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) o.
MonadResource m =&gt;
String -&gt; ConduitT ByteString o m ()
</span><span class="hs-identifier hs-var">sinkFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107737"><span class="hs-identifier hs-var">outPath</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError))
-&gt; Maybe DockerClientError
-&gt; ResourceT IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; Maybe DockerClientError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; Maybe DockerClientError)
-&gt; DockerClientError -&gt; Maybe DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#GetContainerLogsError"><span class="hs-identifier hs-var">GetContainerLogsError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107727"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107730"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107724"><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107724"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107724"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Streams the logs from a docker container, printing them to stdout. Logs can include</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- stdout, stderr, or both.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#printContainerLogs"><span class="hs-identifier hs-type">printContainerLogs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- | Which logs to fetch from the container</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ContainerLogType"><span class="hs-identifier hs-type">ContainerLogType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span id="printContainerLogs"><span class="annot"><span class="annottext">printContainerLogs :: Manager -&gt; ContainerLogType -&gt; String -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#printContainerLogs"><span class="hs-identifier hs-var hs-var">printContainerLogs</span></a></span></span><span> </span><span id="local-6989586621679107722"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107722"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107721"><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">logType</span></a></span></span><span> </span><span id="local-6989586621679107720"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107720"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107719"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107719"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">setQueryString</span></span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;follow&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;stdout&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107718"><span class="hs-identifier hs-var">stdout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;stderr&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">stderr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;timestamps&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>          </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;GET&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-203"></span><span>              </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107720"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/logs&quot;</span></span><span>
</span><span id="line-204"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>          </span><span id="local-6989586621679107717"><span class="annot"><span class="annottext">stderr :: ByteString
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var hs-var">stderr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">logType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="Docker.API.Client.Internal.Types.html#Stdout"><span class="hs-identifier hs-var">Stdout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-209"></span><span>          </span><span id="local-6989586621679107718"><span class="annot"><span class="annottext">stdout :: ByteString
</span><a href="#local-6989586621679107718"><span class="hs-identifier hs-var hs-var">stdout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">logType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="Docker.API.Client.Internal.Types.html#StdErr"><span class="hs-identifier hs-var">StdErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">ContainerLogType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679107716"><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe DockerClientError)
 -&gt; ExceptT DockerClientError IO (Maybe DockerClientError))
-&gt; IO (Maybe DockerClientError)
-&gt; ExceptT DockerClientError IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><span class="hs-identifier hs-var">runResourceT</span></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO (Maybe DockerClientError)
 -&gt; IO (Maybe DockerClientError))
-&gt; ResourceT IO (Maybe DockerClientError)
-&gt; IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679107715"><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107715"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Request
-&gt; Manager
-&gt; ResourceT
     IO (Response (ConduitM () ByteString (ResourceT IO) ()))
forall (m :: * -&gt; *) i.
MonadResource m =&gt;
Request -&gt; Manager -&gt; m (Response (ConduitM i ByteString m ()))
</span><span class="hs-identifier hs-var">HTTPC.http</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107719"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107722"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107714"><span class="annot"><span class="annottext">body :: ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107714"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
-&gt; ConduitM () ByteString (ResourceT IO) ()
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107715"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107713"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107713"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ()) -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">HTTPC.responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response (ConduitM () ByteString (ResourceT IO) ())
</span><a href="#local-6989586621679107715"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-comment">-- Note: we're using a different approach than in the other http requests since the response</span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-comment">-- is wrapped in a ResourceT when using http-conduit, and we would have to implement</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-comment">-- the conduit pipeline using ExceptT to make it compatible with that approach.</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107713"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107712"><span class="annot"><span class="annottext">isLogType :: (DockerStreamType, a) -&gt; Bool
</span><a href="#local-6989586621679107712"><span class="hs-identifier hs-var hs-var">isLogType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContainerLogType -&gt; (DockerStreamType, a) -&gt; Bool
forall a. ContainerLogType -&gt; (DockerStreamType, a) -&gt; Bool
</span><a href="Docker.API.Client.Internal.Util.html#createLogTypeFilter"><span class="hs-identifier hs-var">createLogTypeFilter</span></a></span><span> </span><span class="annot"><span class="annottext">ContainerLogType
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">logType</span></a></span><span>
</span><span id="line-223"></span><span>          </span><span class="annot"><span class="annottext">ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) r. Monad m =&gt; ConduitT () Void m r -&gt; m r
</span><span class="hs-identifier hs-var">runConduit</span></span><span> </span><span class="annot"><span class="annottext">(ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ())
-&gt; ConduitT () Void (ResourceT IO) () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
</span><a href="#local-6989586621679107714"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitM () ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitT () Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ByteString (DockerStreamType, ByteString) (ResourceT IO) ()
forall (m :: * -&gt; *).
MonadIO m =&gt;
ConduitT ByteString (DockerStreamType, ByteString) m ()
</span><a href="Docker.API.Client.Internal.Util.html#parseMultiplexedDockerStream"><span class="hs-identifier hs-var">parseMultiplexedDockerStream</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  ByteString (DockerStreamType, ByteString) (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">((DockerStreamType, ByteString) -&gt; Bool)
-&gt; ConduitT
     (DockerStreamType, ByteString)
     (DockerStreamType, ByteString)
     (ResourceT IO)
     ()
forall (m :: * -&gt; *) a. Monad m =&gt; (a -&gt; Bool) -&gt; ConduitT a a m ()
</span><span class="hs-identifier hs-var">filterC</span></span><span> </span><span class="annot"><span class="annottext">(DockerStreamType, ByteString) -&gt; Bool
forall a. (DockerStreamType, a) -&gt; Bool
</span><a href="#local-6989586621679107712"><span class="hs-identifier hs-var">isLogType</span></a></span><span> </span><span class="annot"><span class="annottext">ConduitT
  (DockerStreamType, ByteString)
  (DockerStreamType, ByteString)
  (ResourceT IO)
  ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">((DockerStreamType, ByteString) -&gt; ByteString)
-&gt; ConduitT
     (DockerStreamType, ByteString) ByteString (ResourceT IO) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; b) -&gt; ConduitT a b m ()
</span><span class="hs-identifier hs-var">mapC</span></span><span> </span><span class="annot"><span class="annottext">(DockerStreamType, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">ConduitT
  (DockerStreamType, ByteString) ByteString (ResourceT IO) ()
-&gt; ConduitM ByteString Void (ResourceT IO) ()
-&gt; ConduitM (DockerStreamType, ByteString) Void (ResourceT IO) ()
forall (m :: * -&gt; *) a b c r.
Monad m =&gt;
ConduitM a b m () -&gt; ConduitM b c m r -&gt; ConduitM a c m r
</span><span class="hs-operator hs-var">.|</span></span><span> </span><span class="annot"><span class="annottext">ConduitM ByteString Void (ResourceT IO) ()
forall (m :: * -&gt; *) o. MonadIO m =&gt; ConduitT ByteString o m ()
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-224"></span><span>          </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DockerClientError -&gt; ResourceT IO (Maybe DockerClientError))
-&gt; Maybe DockerClientError
-&gt; ResourceT IO (Maybe DockerClientError)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; Maybe DockerClientError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; Maybe DockerClientError)
-&gt; DockerClientError -&gt; Maybe DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#GetContainerLogsError"><span class="hs-identifier hs-var">GetContainerLogsError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107713"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107711"><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107711"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">DockerClientError
</span><a href="#local-6989586621679107711"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">Maybe DockerClientError
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Attempts to create a docker container, returning the new container's id</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#submitCreateContainer"><span class="hs-identifier hs-type">submitCreateContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#CreateContainer"><span class="hs-identifier hs-type">CreateContainer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span>
</span><span id="line-232"></span><span id="submitCreateContainer"><span class="annot"><span class="annottext">submitCreateContainer :: Manager
-&gt; CreateContainer -&gt; ExceptT DockerClientError IO ByteString
</span><a href="Docker.API.Client.Internal.Requests.html#submitCreateContainer"><span class="hs-identifier hs-var hs-var">submitCreateContainer</span></a></span></span><span> </span><span id="local-6989586621679107710"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107710"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107709"><span class="annot"><span class="annottext">CreateContainer
</span><a href="#local-6989586621679107709"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107708"><span class="annot"><span class="annottext">reqBody :: RequestBody
</span><a href="#local-6989586621679107708"><span class="hs-identifier hs-var hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">RequestBodyLBS</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RequestBody) -&gt; ByteString -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CreateContainer -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">CreateContainer
</span><a href="#local-6989586621679107709"><span class="hs-identifier hs-var">object</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107706"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107706"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>            </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/create&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-238"></span><span>            </span><span class="annot"><span class="annottext">requestBody :: RequestBody
</span><span class="hs-identifier hs-var">requestBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679107708"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>            </span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><span class="hs-identifier hs-var">requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-identifier hs-var">hContentType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/json&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679107703"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107703"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; ExceptT DockerClientError IO (Response ByteString))
-&gt; IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107706"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107710"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107702"><span class="annot"><span class="annottext">result :: ExceptT DockerClientError IO ByteString
</span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-comment">-- In the ExceptT world, return is used where you would use Right</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107701"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status201</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT DockerClientError IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107700"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-comment">-- And throwError is used where you would use Left</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ExceptT DockerClientError IO ByteString
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ExceptT DockerClientError IO ByteString)
-&gt; DockerClientError -&gt; ExceptT DockerClientError IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#ContainerCreationFailedError"><span class="hs-identifier hs-var">ContainerCreationFailedError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107701"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107700"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>          </span><span id="local-6989586621679107700"><span class="annot"><span class="annottext">body :: ByteString
</span><a href="#local-6989586621679107700"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107703"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-249"></span><span>          </span><span id="local-6989586621679107701"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107701"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107703"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">ExceptT DockerClientError IO ByteString
</span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#startContainer"><span class="hs-identifier hs-type">startContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span>
</span><span id="line-253"></span><span id="startContainer"><span class="annot"><span class="annottext">startContainer :: Manager -&gt; String -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#startContainer"><span class="hs-identifier hs-var hs-var">startContainer</span></a></span></span><span> </span><span id="local-6989586621679107698"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107698"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107697"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107697"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107696"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107696"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107697"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/start&quot;</span></span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679107695"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; ExceptT DockerClientError IO (Response ByteString))
-&gt; IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107696"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107698"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107694"><span class="annot"><span class="annottext">result :: ClientErrorMonad String
</span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-comment">-- In the ExceptT world, return is used where you would use Right</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status204</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ClientErrorMonad String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107697"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-comment">-- And throwError is used where you would use Left</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad String)
-&gt; DockerClientError -&gt; ClientErrorMonad String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#ContainerCreationFailedError"><span class="hs-identifier hs-var">ContainerCreationFailedError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>          </span><span id="local-6989586621679107692"><span class="annot"><span class="annottext">body :: ByteString
</span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span id="local-6989586621679107693"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">ClientErrorMonad String
</span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#submitWaitContainer"><span class="hs-identifier hs-type">submitWaitContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span>
</span><span id="line-271"></span><span id="submitWaitContainer"><span class="annot"><span class="annottext">submitWaitContainer :: Manager -&gt; String -&gt; ExceptT DockerClientError IO ByteString
</span><a href="Docker.API.Client.Internal.Requests.html#submitWaitContainer"><span class="hs-identifier hs-var hs-var">submitWaitContainer</span></a></span></span><span> </span><span id="local-6989586621679107691"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107690"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107689"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107689"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-274"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/wait&quot;</span></span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679107688"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; ExceptT DockerClientError IO (Response ByteString))
-&gt; IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107689"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107687"><span class="annot"><span class="annottext">result :: ExceptT DockerClientError IO ByteString
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-comment">-- In the ExceptT world, return is used where you would use Right</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107686"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT DockerClientError IO ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ExceptT DockerClientError IO ByteString)
-&gt; ByteString -&gt; ExceptT DockerClientError IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-comment">-- And throwError is used where you would use Left</span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ExceptT DockerClientError IO ByteString
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ExceptT DockerClientError IO ByteString)
-&gt; DockerClientError -&gt; ExceptT DockerClientError IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#ContainerCreationFailedError"><span class="hs-identifier hs-var">ContainerCreationFailedError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107686"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107685"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>          </span><span id="local-6989586621679107685"><span class="annot"><span class="annottext">body :: ByteString
</span><a href="#local-6989586621679107685"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-285"></span><span>          </span><span id="local-6989586621679107686"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107686"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">ExceptT DockerClientError IO ByteString
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Remove a container, equivalent to the `docker container rm` command</span><span>
</span><span id="line-289"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#removeContainer"><span class="hs-identifier hs-type">removeContainer</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">-- | The connection manager for the docker daemon</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-comment">-- | Enable force removal?</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-comment">-- | Also remove container's volumes?</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span>
</span><span id="line-298"></span><span id="removeContainer"><span class="annot"><span class="annottext">removeContainer :: Manager -&gt; Bool -&gt; Bool -&gt; String -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#removeContainer"><span class="hs-identifier hs-var hs-var">removeContainer</span></a></span></span><span> </span><span id="local-6989586621679107683"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621679107682"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">isForceful</span></a></span></span><span> </span><span id="local-6989586621679107681"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107681"><span class="hs-identifier hs-var">alsoRemoveVolumes</span></a></span></span><span> </span><span id="local-6989586621679107680"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107679"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621679107679"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">setQueryString</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;force&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var">force</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;v&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-301"></span><span>          </span><span class="annot"><span class="annottext">Request
</span><span class="hs-identifier hs-var">defaultRequest</span></span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DELETE&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>              </span><span class="annot"><span class="annottext">path :: ByteString
</span><span class="hs-identifier hs-var">path</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Docker.API.Client.Internal.Requests.html#dockerAPIVersion"><span class="hs-identifier hs-var">dockerAPIVersion</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/containers/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621679107678"><span class="annot"><span class="annottext">force :: ByteString
</span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var hs-var">force</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">isForceful</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-307"></span><span>          </span><span id="local-6989586621679107677"><span class="annot"><span class="annottext">v :: ByteString
</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107681"><span class="hs-identifier hs-var">alsoRemoveVolumes</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679107676"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107676"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; ExceptT DockerClientError IO (Response ByteString))
-&gt; IO (Response ByteString)
-&gt; ExceptT DockerClientError IO (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107679"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107675"><span class="annot"><span class="annottext">result :: ClientErrorMonad String
</span><a href="#local-6989586621679107675"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status204</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ClientErrorMonad String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad String)
-&gt; DockerClientError -&gt; ClientErrorMonad String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#ContainerCreationFailedError"><span class="hs-identifier hs-var">ContainerCreationFailedError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; ByteString -&gt; String
</span><a href="Docker.API.Client.Internal.Requests.html#formatRequestError"><span class="hs-identifier hs-var">formatRequestError</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107673"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>          </span><span id="local-6989586621679107673"><span class="annot"><span class="annottext">body :: ByteString
</span><a href="#local-6989586621679107673"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107676"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-314"></span><span>          </span><span id="local-6989586621679107674"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679107676"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">ClientErrorMonad String
</span><a href="#local-6989586621679107675"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Parses the response body of a create container request</span><span>
</span><span id="line-318"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#parseCreateContainerResult"><span class="hs-identifier hs-type">parseCreateContainerResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#ContainerId"><span class="hs-identifier hs-type">ContainerId</span></a></span><span>
</span><span id="line-319"></span><span id="parseCreateContainerResult"><span class="annot"><span class="annottext">parseCreateContainerResult :: ByteString -&gt; ClientErrorMonad String
</span><a href="Docker.API.Client.Internal.Requests.html#parseCreateContainerResult"><span class="hs-identifier hs-var hs-var">parseCreateContainerResult</span></a></span></span><span> </span><span id="local-6989586621679107672"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107672"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String CreateContainerResponse
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107672"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679107671"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107671"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad String
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad String)
-&gt; DockerClientError -&gt; ClientErrorMonad String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#UnrecognizedJSONResponseError"><span class="hs-identifier hs-var">UnrecognizedJSONResponseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107671"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679107669"><span class="annot"><span class="annottext">CreateContainerResponse
</span><a href="#local-6989586621679107669"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ClientErrorMonad String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ClientErrorMonad String)
-&gt; String -&gt; ClientErrorMonad String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CreateContainerResponse -&gt; String
</span><a href="Docker.API.Client.Internal.Schemas.html#createContainerResponseId"><span class="hs-identifier hs-var hs-var">createContainerResponseId</span></a></span><span> </span><span class="annot"><span class="annottext">CreateContainerResponse
</span><a href="#local-6989586621679107669"><span class="hs-identifier hs-var">object</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | Parses the response body of an await container request</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#parseWaitContainerResult"><span class="hs-identifier hs-type">parseWaitContainerResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LBS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#WaitContainerResponse"><span class="hs-identifier hs-type">WaitContainerResponse</span></a></span><span>
</span><span id="line-325"></span><span id="parseWaitContainerResult"><span class="annot"><span class="annottext">parseWaitContainerResult :: ByteString -&gt; ExceptT DockerClientError IO WaitContainerResponse
</span><a href="Docker.API.Client.Internal.Requests.html#parseWaitContainerResult"><span class="hs-identifier hs-var hs-var">parseWaitContainerResult</span></a></span></span><span> </span><span id="local-6989586621679107667"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107667"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String WaitContainerResponse
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107667"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679107666"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107666"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError
-&gt; ExceptT DockerClientError IO WaitContainerResponse
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError
 -&gt; ExceptT DockerClientError IO WaitContainerResponse)
-&gt; DockerClientError
-&gt; ExceptT DockerClientError IO WaitContainerResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#UnrecognizedJSONResponseError"><span class="hs-identifier hs-var">UnrecognizedJSONResponseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107666"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679107665"><span class="annot"><span class="annottext">WaitContainerResponse
</span><a href="#local-6989586621679107665"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse
-&gt; ExceptT DockerClientError IO WaitContainerResponse
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse
</span><a href="#local-6989586621679107665"><span class="hs-identifier hs-var">object</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Checks the status code value of a WaitContainerResponse</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Docker.API.Client.Internal.Requests.html#checkExitStatusCode"><span class="hs-identifier hs-type">checkExitStatusCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Schemas.html#WaitContainerResponse"><span class="hs-identifier hs-type">WaitContainerResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Docker.API.Client.Internal.Types.html#ClientErrorMonad"><span class="hs-identifier hs-type">ClientErrorMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="checkExitStatusCode"><span class="annot"><span class="annottext">checkExitStatusCode :: WaitContainerResponse -&gt; ClientErrorMonad ()
</span><a href="Docker.API.Client.Internal.Requests.html#checkExitStatusCode"><span class="hs-identifier hs-var hs-var">checkExitStatusCode</span></a></span></span><span> </span><span id="local-6989586621679107664"><span class="annot"><span class="annottext">WaitContainerResponse
</span><a href="#local-6989586621679107664"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; ClientErrorMonad ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse -&gt; Maybe WaitContainerError
</span><a href="Docker.API.Client.Internal.Schemas.html#waitContainerResponseError"><span class="hs-identifier hs-var hs-var">waitContainerResponseError</span></a></span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse
</span><a href="#local-6989586621679107664"><span class="hs-identifier hs-var">response</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-comment">-- Docker will only sometimes return the associated errors</span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107661"><span class="annot"><span class="annottext">WaitContainerError
</span><a href="#local-6989586621679107661"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad ())
-&gt; DockerClientError -&gt; ClientErrorMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#NonZeroExitCode"><span class="hs-identifier hs-var">NonZeroExitCode</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WaitContainerError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">WaitContainerError
</span><a href="#local-6989586621679107661"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><span class="annottext">Maybe WaitContainerError
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DockerClientError -&gt; ClientErrorMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(DockerClientError -&gt; ClientErrorMonad ())
-&gt; DockerClientError -&gt; ClientErrorMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; DockerClientError
</span><a href="Docker.API.Client.Internal.Types.html#NonZeroExitCode"><span class="hs-identifier hs-var">NonZeroExitCode</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; DockerClientError) -&gt; String -&gt; DockerClientError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Container status code was &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with no error message&quot;</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679107663"><span class="annot"><span class="annottext">code :: Int
</span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse -&gt; Int
</span><a href="Docker.API.Client.Internal.Schemas.html#waitContainerResponseStatusCode"><span class="hs-identifier hs-var hs-var">waitContainerResponseStatusCode</span></a></span><span> </span><span class="annot"><span class="annottext">WaitContainerResponse
</span><a href="#local-6989586621679107664"><span class="hs-identifier hs-var">response</span></a></span><span>
</span><span id="line-340"></span></pre></body></html>