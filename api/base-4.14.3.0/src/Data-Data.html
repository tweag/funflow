<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Data/Data.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE BangPatterns #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE GADTs #-}</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE NoImplicitPrelude #-}</span>
<a name="line-7"></a><span class='hs-comment'>{-# LANGUAGE DataKinds #-}</span>
<a name="line-8"></a><span class='hs-comment'>{-# LANGUAGE PolyKinds #-}</span>
<a name="line-9"></a><span class='hs-comment'>{-# LANGUAGE RankNTypes #-}</span>
<a name="line-10"></a><span class='hs-comment'>{-# LANGUAGE ScopedTypeVariables #-}</span>
<a name="line-11"></a><span class='hs-comment'>{-# LANGUAGE StandaloneDeriving #-}</span>
<a name="line-12"></a><span class='hs-comment'>{-# LANGUAGE Trustworthy #-}</span>
<a name="line-13"></a><span class='hs-comment'>{-# LANGUAGE TypeOperators #-}</span>
<a name="line-14"></a>
<a name="line-15"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-16"></a><span class='hs-comment'>-- |</span>
<a name="line-17"></a><span class='hs-comment'>-- Module      :  Data.Data</span>
<a name="line-18"></a><span class='hs-comment'>-- Copyright   :  (c) The University of Glasgow, CWI 2001--2004</span>
<a name="line-19"></a><span class='hs-comment'>-- License     :  BSD-style (see the file libraries/base/LICENSE)</span>
<a name="line-20"></a><span class='hs-comment'>--</span>
<a name="line-21"></a><span class='hs-comment'>-- Maintainer  :  libraries@haskell.org</span>
<a name="line-22"></a><span class='hs-comment'>-- Stability   :  experimental</span>
<a name="line-23"></a><span class='hs-comment'>-- Portability :  non-portable (local universal quantification)</span>
<a name="line-24"></a><span class='hs-comment'>--</span>
<a name="line-25"></a><span class='hs-comment'>-- \"Scrap your boilerplate\" --- Generic programming in Haskell.  See</span>
<a name="line-26"></a><span class='hs-comment'>-- &lt;<a href="http://www.haskell.org/haskellwiki/Research_papers/Generics#Scrap_your_boilerplate.21">http://www.haskell.org/haskellwiki/Research_papers/Generics#Scrap_your_boilerplate.21</a>&gt;.</span>
<a name="line-27"></a><span class='hs-comment'>-- This module provides the 'Data' class with its primitives for</span>
<a name="line-28"></a><span class='hs-comment'>-- generic programming, along with instances for many datatypes. It</span>
<a name="line-29"></a><span class='hs-comment'>-- corresponds to a merge between the previous "Data.Generics.Basics"</span>
<a name="line-30"></a><span class='hs-comment'>-- and almost all of "Data.Generics.Instances". The instances that are</span>
<a name="line-31"></a><span class='hs-comment'>-- not present in this module were moved to the</span>
<a name="line-32"></a><span class='hs-comment'>-- @Data.Generics.Instances@ module in the @syb@ package.</span>
<a name="line-33"></a><span class='hs-comment'>--</span>
<a name="line-34"></a><span class='hs-comment'>-- For more information, please visit the new</span>
<a name="line-35"></a><span class='hs-comment'>-- SYB wiki: &lt;<a href="http://www.cs.uu.nl/wiki/bin/view/GenericProgramming/SYB">http://www.cs.uu.nl/wiki/bin/view/GenericProgramming/SYB</a>&gt;.</span>
<a name="line-36"></a><span class='hs-comment'>--</span>
<a name="line-37"></a><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<a name="line-38"></a>
<a name="line-39"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data.Data</span> <span class='hs-layout'>(</span>
<a name="line-40"></a>
<a name="line-41"></a>        <span class='hs-comment'>-- * Module Data.Typeable re-exported for convenience</span>
<a name="line-42"></a>        <span class='hs-keyword'>module</span> <span class='hs-conid'>Data.Typeable</span><span class='hs-layout'>,</span>
<a name="line-43"></a>
<a name="line-44"></a>        <span class='hs-comment'>-- * The Data class for processing constructor applications</span>
<a name="line-45"></a>        <span class='hs-conid'>Data</span><span class='hs-layout'>(</span>
<a name="line-46"></a>                <span class='hs-varid'>gfoldl</span><span class='hs-layout'>,</span>
<a name="line-47"></a>                <span class='hs-varid'>gunfold</span><span class='hs-layout'>,</span>
<a name="line-48"></a>                <span class='hs-varid'>toConstr</span><span class='hs-layout'>,</span>
<a name="line-49"></a>                <span class='hs-varid'>dataTypeOf</span><span class='hs-layout'>,</span>
<a name="line-50"></a>                <span class='hs-varid'>dataCast1</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- mediate types and unary type constructors</span>
<a name="line-51"></a>                <span class='hs-varid'>dataCast2</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- mediate types and binary type constructors</span>
<a name="line-52"></a>                <span class='hs-comment'>-- Generic maps defined in terms of gfoldl</span>
<a name="line-53"></a>                <span class='hs-varid'>gmapT</span><span class='hs-layout'>,</span>
<a name="line-54"></a>                <span class='hs-varid'>gmapQ</span><span class='hs-layout'>,</span>
<a name="line-55"></a>                <span class='hs-varid'>gmapQl</span><span class='hs-layout'>,</span>
<a name="line-56"></a>                <span class='hs-varid'>gmapQr</span><span class='hs-layout'>,</span>
<a name="line-57"></a>                <span class='hs-varid'>gmapQi</span><span class='hs-layout'>,</span>
<a name="line-58"></a>                <span class='hs-varid'>gmapM</span><span class='hs-layout'>,</span>
<a name="line-59"></a>                <span class='hs-varid'>gmapMp</span><span class='hs-layout'>,</span>
<a name="line-60"></a>                <span class='hs-varid'>gmapMo</span>
<a name="line-61"></a>            <span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-62"></a>
<a name="line-63"></a>        <span class='hs-comment'>-- * Datatype representations</span>
<a name="line-64"></a>        <span class='hs-conid'>DataType</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- abstract</span>
<a name="line-65"></a>        <span class='hs-comment'>-- ** Constructors</span>
<a name="line-66"></a>        <span class='hs-varid'>mkDataType</span><span class='hs-layout'>,</span>
<a name="line-67"></a>        <span class='hs-varid'>mkIntType</span><span class='hs-layout'>,</span>
<a name="line-68"></a>        <span class='hs-varid'>mkFloatType</span><span class='hs-layout'>,</span>
<a name="line-69"></a>        <span class='hs-varid'>mkCharType</span><span class='hs-layout'>,</span>
<a name="line-70"></a>        <span class='hs-varid'>mkNoRepType</span><span class='hs-layout'>,</span>
<a name="line-71"></a>        <span class='hs-comment'>-- ** Observers</span>
<a name="line-72"></a>        <span class='hs-varid'>dataTypeName</span><span class='hs-layout'>,</span>
<a name="line-73"></a>        <span class='hs-conid'>DataRep</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-74"></a>        <span class='hs-varid'>dataTypeRep</span><span class='hs-layout'>,</span>
<a name="line-75"></a>        <span class='hs-comment'>-- ** Convenience functions</span>
<a name="line-76"></a>        <span class='hs-varid'>repConstr</span><span class='hs-layout'>,</span>
<a name="line-77"></a>        <span class='hs-varid'>isAlgType</span><span class='hs-layout'>,</span>
<a name="line-78"></a>        <span class='hs-varid'>dataTypeConstrs</span><span class='hs-layout'>,</span>
<a name="line-79"></a>        <span class='hs-varid'>indexConstr</span><span class='hs-layout'>,</span>
<a name="line-80"></a>        <span class='hs-varid'>maxConstrIndex</span><span class='hs-layout'>,</span>
<a name="line-81"></a>        <span class='hs-varid'>isNorepType</span><span class='hs-layout'>,</span>
<a name="line-82"></a>
<a name="line-83"></a>        <span class='hs-comment'>-- * Data constructor representations</span>
<a name="line-84"></a>        <span class='hs-conid'>Constr</span><span class='hs-layout'>,</span>         <span class='hs-comment'>-- abstract</span>
<a name="line-85"></a>        <span class='hs-conid'>ConIndex</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- alias for Int, start at 1</span>
<a name="line-86"></a>        <span class='hs-conid'>Fixity</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-87"></a>        <span class='hs-comment'>-- ** Constructors</span>
<a name="line-88"></a>        <span class='hs-varid'>mkConstr</span><span class='hs-layout'>,</span>
<a name="line-89"></a>        <span class='hs-varid'>mkIntegralConstr</span><span class='hs-layout'>,</span>
<a name="line-90"></a>        <span class='hs-varid'>mkRealConstr</span><span class='hs-layout'>,</span>
<a name="line-91"></a>        <span class='hs-varid'>mkCharConstr</span><span class='hs-layout'>,</span>
<a name="line-92"></a>        <span class='hs-comment'>-- ** Observers</span>
<a name="line-93"></a>        <span class='hs-varid'>constrType</span><span class='hs-layout'>,</span>
<a name="line-94"></a>        <span class='hs-conid'>ConstrRep</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-95"></a>        <span class='hs-varid'>constrRep</span><span class='hs-layout'>,</span>
<a name="line-96"></a>        <span class='hs-varid'>constrFields</span><span class='hs-layout'>,</span>
<a name="line-97"></a>        <span class='hs-varid'>constrFixity</span><span class='hs-layout'>,</span>
<a name="line-98"></a>        <span class='hs-comment'>-- ** Convenience function: algebraic data types</span>
<a name="line-99"></a>        <span class='hs-varid'>constrIndex</span><span class='hs-layout'>,</span>
<a name="line-100"></a>        <span class='hs-comment'>-- ** From strings to constructors and vice versa: all data types</span>
<a name="line-101"></a>        <span class='hs-varid'>showConstr</span><span class='hs-layout'>,</span>
<a name="line-102"></a>        <span class='hs-varid'>readConstr</span><span class='hs-layout'>,</span>
<a name="line-103"></a>
<a name="line-104"></a>        <span class='hs-comment'>-- * Convenience functions: take type constructors apart</span>
<a name="line-105"></a>        <span class='hs-varid'>tyconUQname</span><span class='hs-layout'>,</span>
<a name="line-106"></a>        <span class='hs-varid'>tyconModule</span><span class='hs-layout'>,</span>
<a name="line-107"></a>
<a name="line-108"></a>        <span class='hs-comment'>-- * Generic operations defined in terms of 'gunfold'</span>
<a name="line-109"></a>        <span class='hs-varid'>fromConstr</span><span class='hs-layout'>,</span>
<a name="line-110"></a>        <span class='hs-varid'>fromConstrB</span><span class='hs-layout'>,</span>
<a name="line-111"></a>        <span class='hs-varid'>fromConstrM</span>
<a name="line-112"></a>
<a name="line-113"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-114"></a>
<a name="line-115"></a>
<a name="line-116"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-117"></a>
<a name="line-118"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Functor.Const</span>
<a name="line-119"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Either</span>
<a name="line-120"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Eq</span>
<a name="line-121"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Maybe</span>
<a name="line-122"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Monoid</span>
<a name="line-123"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Ord</span>
<a name="line-124"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Typeable</span>
<a name="line-125"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Version</span><span class='hs-layout'>(</span> <span class='hs-conid'>Version</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span> <span class='hs-layout'>)</span>
<a name="line-126"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Base</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>Any</span><span class='hs-layout'>,</span> <span class='hs-conid'>IntRep</span><span class='hs-layout'>,</span> <span class='hs-conid'>FloatRep</span><span class='hs-layout'>)</span>
<a name="line-127"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.List</span>
<a name="line-128"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Num</span>
<a name="line-129"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Read</span>
<a name="line-130"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Show</span>
<a name="line-131"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.Read</span><span class='hs-layout'>(</span> <span class='hs-varid'>reads</span> <span class='hs-layout'>)</span>
<a name="line-132"></a>
<a name="line-133"></a><span class='hs-comment'>-- Imports for the instances</span>
<a name="line-134"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Applicative</span> <span class='hs-layout'>(</span><span class='hs-conid'>WrappedArrow</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>WrappedMonad</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>ZipList</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-135"></a>       <span class='hs-comment'>-- So we can give them Data instances</span>
<a name="line-136"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Functor.Identity</span> <span class='hs-comment'>-- So we can give Data instance for Identity</span>
<a name="line-137"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Int</span>              <span class='hs-comment'>-- So we can give Data instance for Int8, ...</span>
<a name="line-138"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Type.Coercion</span>
<a name="line-139"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Word</span>             <span class='hs-comment'>-- So we can give Data instance for Word8, ...</span>
<a name="line-140"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Real</span>              <span class='hs-comment'>-- So we can give Data instance for Ratio</span>
<a name="line-141"></a><span class='hs-comment'>--import GHC.IOBase            -- So we can give Data instance for IO, Handle</span>
<a name="line-142"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Ptr</span>               <span class='hs-comment'>-- So we can give Data instance for Ptr</span>
<a name="line-143"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.ForeignPtr</span>        <span class='hs-comment'>-- So we can give Data instance for ForeignPtr</span>
<a name="line-144"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign.Ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>IntPtr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>WordPtr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-145"></a>                             <span class='hs-comment'>-- So we can give Data instance for IntPtr and WordPtr</span>
<a name="line-146"></a><span class='hs-comment'>--import GHC.Stable            -- So we can give Data instance for StablePtr</span>
<a name="line-147"></a><span class='hs-comment'>--import GHC.ST                -- So we can give Data instance for ST</span>
<a name="line-148"></a><span class='hs-comment'>--import GHC.Conc              -- So we can give Data instance for MVar &amp; Co.</span>
<a name="line-149"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Arr</span>               <span class='hs-comment'>-- So we can give Data instance for Array</span>
<a name="line-150"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>GHC.Generics</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Generics</span> <span class='hs-layout'>(</span><span class='hs-conid'>Fixity</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-151"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Generics</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>Fixity</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-152"></a>                             <span class='hs-comment'>-- So we can give Data instance for U1, V1, ...</span>
<a name="line-153"></a>
<a name="line-154"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-155"></a><span class='hs-comment'>--</span>
<a name="line-156"></a><span class='hs-comment'>--      The Data class</span>
<a name="line-157"></a><span class='hs-comment'>--</span>
<a name="line-158"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-159"></a>
<a name="line-160"></a><span class='hs-comment'>{- |
<a name="line-161"></a>The 'Data' class comprehends a fundamental primitive 'gfoldl' for
<a name="line-162"></a>folding over constructor applications, say terms. This primitive can
<a name="line-163"></a>be instantiated in several ways to map over the immediate subterms
<a name="line-164"></a>of a term; see the @gmap@ combinators later in this class.  Indeed, a
<a name="line-165"></a>generic programmer does not necessarily need to use the ingenious gfoldl
<a name="line-166"></a>primitive but rather the intuitive @gmap@ combinators.  The 'gfoldl'
<a name="line-167"></a>primitive is completed by means to query top-level constructors, to
<a name="line-168"></a>turn constructor representations into proper terms, and to list all
<a name="line-169"></a>possible datatype constructors.  This completion allows us to serve
<a name="line-170"></a>generic programming scenarios like read, show, equality, term generation.
<a name="line-171"></a>
<a name="line-172"></a>The combinators 'gmapT', 'gmapQ', 'gmapM', etc are all provided with
<a name="line-173"></a>default definitions in terms of 'gfoldl', leaving open the opportunity
<a name="line-174"></a>to provide datatype-specific definitions.
<a name="line-175"></a>(The inclusion of the @gmap@ combinators as members of class 'Data'
<a name="line-176"></a>allows the programmer or the compiler to derive specialised, and maybe
<a name="line-177"></a>more efficient code per datatype.  /Note/: 'gfoldl' is more higher-order
<a name="line-178"></a>than the @gmap@ combinators.  This is subject to ongoing benchmarking
<a name="line-179"></a>experiments.  It might turn out that the @gmap@ combinators will be
<a name="line-180"></a>moved out of the class 'Data'.)
<a name="line-181"></a>
<a name="line-182"></a>Conceptually, the definition of the @gmap@ combinators in terms of the
<a name="line-183"></a>primitive 'gfoldl' requires the identification of the 'gfoldl' function
<a name="line-184"></a>arguments.  Technically, we also need to identify the type constructor
<a name="line-185"></a>@c@ for the construction of the result type from the folded term type.
<a name="line-186"></a>
<a name="line-187"></a>In the definition of @gmapQ@/x/ combinators, we use phantom type
<a name="line-188"></a>constructors for the @c@ in the type of 'gfoldl' because the result type
<a name="line-189"></a>of a query does not involve the (polymorphic) type of the term argument.
<a name="line-190"></a>In the definition of 'gmapQl' we simply use the plain constant type
<a name="line-191"></a>constructor because 'gfoldl' is left-associative anyway and so it is
<a name="line-192"></a>readily suited to fold a left-associative binary operation over the
<a name="line-193"></a>immediate subterms.  In the definition of gmapQr, extra effort is
<a name="line-194"></a>needed. We use a higher-order accumulation trick to mediate between
<a name="line-195"></a>left-associative constructor application vs. right-associative binary
<a name="line-196"></a>operation (e.g., @(:)@).  When the query is meant to compute a value
<a name="line-197"></a>of type @r@, then the result type withing generic folding is @r -&gt; r@.
<a name="line-198"></a>So the result of folding is a function to which we finally pass the
<a name="line-199"></a>right unit.
<a name="line-200"></a>
<a name="line-201"></a>With the @-XDeriveDataTypeable@ option, GHC can generate instances of the
<a name="line-202"></a>'Data' class automatically.  For example, given the declaration
<a name="line-203"></a>
<a name="line-204"></a>&gt; data T a b = C1 a b | C2 deriving (Typeable, Data)
<a name="line-205"></a>
<a name="line-206"></a>GHC will generate an instance that is equivalent to
<a name="line-207"></a>
<a name="line-208"></a>&gt; instance (Data a, Data b) =&gt; Data (T a b) where
<a name="line-209"></a>&gt;     gfoldl k z (C1 a b) = z C1 `k` a `k` b
<a name="line-210"></a>&gt;     gfoldl k z C2       = z C2
<a name="line-211"></a>&gt;
<a name="line-212"></a>&gt;     gunfold k z c = case constrIndex c of
<a name="line-213"></a>&gt;                         1 -&gt; k (k (z C1))
<a name="line-214"></a>&gt;                         2 -&gt; z C2
<a name="line-215"></a>&gt;
<a name="line-216"></a>&gt;     toConstr (C1 _ _) = con_C1
<a name="line-217"></a>&gt;     toConstr C2       = con_C2
<a name="line-218"></a>&gt;
<a name="line-219"></a>&gt;     dataTypeOf _ = ty_T
<a name="line-220"></a>&gt;
<a name="line-221"></a>&gt; con_C1 = mkConstr ty_T "C1" [] Prefix
<a name="line-222"></a>&gt; con_C2 = mkConstr ty_T "C2" [] Prefix
<a name="line-223"></a>&gt; ty_T   = mkDataType "Module.T" [con_C1, con_C2]
<a name="line-224"></a>
<a name="line-225"></a>This is suitable for datatypes that are exported transparently.
<a name="line-226"></a>
<a name="line-227"></a>-}</span>
<a name="line-228"></a>
<a name="line-229"></a><a name="Data"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<a name="line-230"></a>
<a name="line-231"></a>  <span class='hs-comment'>-- | Left-associative fold operation for constructor applications.</span>
<a name="line-232"></a>  <span class='hs-comment'>--</span>
<a name="line-233"></a>  <span class='hs-comment'>-- The type of 'gfoldl' is a headache, but operationally it is a simple</span>
<a name="line-234"></a>  <span class='hs-comment'>-- generalisation of a list fold.</span>
<a name="line-235"></a>  <span class='hs-comment'>--</span>
<a name="line-236"></a>  <span class='hs-comment'>-- The default definition for 'gfoldl' is @'const' 'id'@, which is</span>
<a name="line-237"></a>  <span class='hs-comment'>-- suitable for abstract datatypes with no substructures.</span>
<a name="line-238"></a>  <span class='hs-varid'>gfoldl</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span> <span class='hs-varid'>b</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-239"></a>                <span class='hs-comment'>-- ^ defines how nonempty constructor applications are</span>
<a name="line-240"></a>                <span class='hs-comment'>-- folded.  It takes the folded tail of the constructor</span>
<a name="line-241"></a>                <span class='hs-comment'>-- application and its head, i.e., an immediate subterm,</span>
<a name="line-242"></a>                <span class='hs-comment'>-- and combines them in some way.</span>
<a name="line-243"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>g</span><span class='hs-varop'>.</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<a name="line-244"></a>                <span class='hs-comment'>-- ^ defines how the empty constructor application is</span>
<a name="line-245"></a>                <span class='hs-comment'>-- folded, like the neutral \/ start element for list</span>
<a name="line-246"></a>                <span class='hs-comment'>-- folding.</span>
<a name="line-247"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-248"></a>                <span class='hs-comment'>-- ^ structure to be folded.</span>
<a name="line-249"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>a</span>
<a name="line-250"></a>                <span class='hs-comment'>-- ^ result, with a type defined in terms of @a@, but</span>
<a name="line-251"></a>                <span class='hs-comment'>-- variability is achieved by means of type constructor</span>
<a name="line-252"></a>                <span class='hs-comment'>-- @c@ for the construction of the actual result type.</span>
<a name="line-253"></a>
<a name="line-254"></a>  <span class='hs-comment'>-- See the 'Data' instances in this file for an illustration of 'gfoldl'.</span>
<a name="line-255"></a>
<a name="line-256"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span>
<a name="line-257"></a>
<a name="line-258"></a>  <span class='hs-comment'>-- | Unfolding constructor applications</span>
<a name="line-259"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>b</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-260"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-261"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-262"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-varid'>a</span>
<a name="line-263"></a>
<a name="line-264"></a>  <span class='hs-comment'>-- | Obtaining the constructor from a given datum.</span>
<a name="line-265"></a>  <span class='hs-comment'>-- For proper terms, this is meant to be the top-level constructor.</span>
<a name="line-266"></a>  <span class='hs-comment'>-- Primitive datatypes are here viewed as potentially infinite sets of</span>
<a name="line-267"></a>  <span class='hs-comment'>-- values (i.e., constructors).</span>
<a name="line-268"></a>  <span class='hs-varid'>toConstr</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-269"></a>
<a name="line-270"></a>
<a name="line-271"></a>  <span class='hs-comment'>-- | The outer type constructor of the type</span>
<a name="line-272"></a>  <span class='hs-varid'>dataTypeOf</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-273"></a>
<a name="line-274"></a>
<a name="line-275"></a>
<a name="line-276"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-277"></a><span class='hs-comment'>--</span>
<a name="line-278"></a><span class='hs-comment'>-- Mediate types and type constructors</span>
<a name="line-279"></a><span class='hs-comment'>--</span>
<a name="line-280"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-281"></a>
<a name="line-282"></a>  <span class='hs-comment'>-- | Mediate types and unary type constructors.</span>
<a name="line-283"></a>  <span class='hs-comment'>--</span>
<a name="line-284"></a>  <span class='hs-comment'>-- In 'Data' instances of the form</span>
<a name="line-285"></a>  <span class='hs-comment'>--</span>
<a name="line-286"></a>  <span class='hs-comment'>-- @</span>
<a name="line-287"></a>  <span class='hs-comment'>--     instance (Data a, ...) =&gt; Data (T a)</span>
<a name="line-288"></a>  <span class='hs-comment'>-- @</span>
<a name="line-289"></a>  <span class='hs-comment'>--</span>
<a name="line-290"></a>  <span class='hs-comment'>-- 'dataCast1' should be defined as 'gcast1'.</span>
<a name="line-291"></a>  <span class='hs-comment'>--</span>
<a name="line-292"></a>  <span class='hs-comment'>-- The default definition is @'const' 'Nothing'@, which is appropriate</span>
<a name="line-293"></a>  <span class='hs-comment'>-- for instances of other forms.</span>
<a name="line-294"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>t</span>
<a name="line-295"></a>            <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-296"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-297"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-298"></a>
<a name="line-299"></a>  <span class='hs-comment'>-- | Mediate types and binary type constructors.</span>
<a name="line-300"></a>  <span class='hs-comment'>--</span>
<a name="line-301"></a>  <span class='hs-comment'>-- In 'Data' instances of the form</span>
<a name="line-302"></a>  <span class='hs-comment'>--</span>
<a name="line-303"></a>  <span class='hs-comment'>-- @</span>
<a name="line-304"></a>  <span class='hs-comment'>--     instance (Data a, Data b, ...) =&gt; Data (T a b)</span>
<a name="line-305"></a>  <span class='hs-comment'>-- @</span>
<a name="line-306"></a>  <span class='hs-comment'>--</span>
<a name="line-307"></a>  <span class='hs-comment'>-- 'dataCast2' should be defined as 'gcast2'.</span>
<a name="line-308"></a>  <span class='hs-comment'>--</span>
<a name="line-309"></a>  <span class='hs-comment'>-- The default definition is @'const' 'Nothing'@, which is appropriate</span>
<a name="line-310"></a>  <span class='hs-comment'>-- for instances of other forms.</span>
<a name="line-311"></a>  <span class='hs-varid'>dataCast2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>t</span>
<a name="line-312"></a>            <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-313"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-314"></a>  <span class='hs-varid'>dataCast2</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span>
<a name="line-315"></a>
<a name="line-316"></a>
<a name="line-317"></a>
<a name="line-318"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-319"></a><span class='hs-comment'>--</span>
<a name="line-320"></a><span class='hs-comment'>--      Typical generic maps defined in terms of gfoldl</span>
<a name="line-321"></a><span class='hs-comment'>--</span>
<a name="line-322"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-323"></a>
<a name="line-324"></a>
<a name="line-325"></a>  <span class='hs-comment'>-- | A generic transformation that maps over the immediate subterms</span>
<a name="line-326"></a>  <span class='hs-comment'>--</span>
<a name="line-327"></a>  <span class='hs-comment'>-- The default definition instantiates the type constructor @c@ in the</span>
<a name="line-328"></a>  <span class='hs-comment'>-- type of 'gfoldl' to an identity datatype constructor, using the</span>
<a name="line-329"></a>  <span class='hs-comment'>-- isomorphism pair as injection and projection.</span>
<a name="line-330"></a>  <span class='hs-varid'>gmapT</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>b</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-331"></a>
<a name="line-332"></a>  <span class='hs-comment'>-- Use the Identity datatype constructor</span>
<a name="line-333"></a>  <span class='hs-comment'>-- to instantiate the type constructor c in the type of gfoldl,</span>
<a name="line-334"></a>  <span class='hs-comment'>-- and perform injections Identity and projections runIdentity accordingly.</span>
<a name="line-335"></a>  <span class='hs-comment'>--</span>
<a name="line-336"></a>  <span class='hs-varid'>gmapT</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>runIdentity</span> <span class='hs-layout'>(</span><span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-conid'>Identity</span> <span class='hs-varid'>x0</span><span class='hs-layout'>)</span>
<a name="line-337"></a>    <span class='hs-keyword'>where</span>
<a name="line-338"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Identity</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span><span class='hs-keyglyph'>-&gt;</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Identity</span> <span class='hs-varid'>b</span>
<a name="line-339"></a>      <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Identity</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Identity</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-340"></a>
<a name="line-341"></a>
<a name="line-342"></a>  <span class='hs-comment'>-- | A generic query with a left-associative binary operator</span>
<a name="line-343"></a>  <span class='hs-varid'>gmapQl</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span> <span class='hs-varid'>r'</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span>
<a name="line-344"></a>  <span class='hs-varid'>gmapQl</span> <span class='hs-varid'>o</span> <span class='hs-varid'>r</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getConst</span> <span class='hs-varop'>.</span> <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span>
<a name="line-345"></a>    <span class='hs-keyword'>where</span>
<a name="line-346"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Const</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span><span class='hs-keyglyph'>-&gt;</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Const</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b</span>
<a name="line-347"></a>      <span class='hs-varid'>k</span> <span class='hs-varid'>c</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Const</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>getConst</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>`o`</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<a name="line-348"></a>      <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Const</span> <span class='hs-varid'>r</span> <span class='hs-varid'>g</span>
<a name="line-349"></a>      <span class='hs-varid'>z</span> <span class='hs-keyword'>_</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Const</span> <span class='hs-varid'>r</span>
<a name="line-350"></a>
<a name="line-351"></a>  <span class='hs-comment'>-- | A generic query with a right-associative binary operator</span>
<a name="line-352"></a>  <span class='hs-varid'>gmapQr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span> <span class='hs-varid'>r'</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-varid'>r'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span>
<a name="line-353"></a>  <span class='hs-varid'>gmapQr</span> <span class='hs-varid'>o</span> <span class='hs-varid'>r0</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unQr</span> <span class='hs-layout'>(</span><span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>const</span> <span class='hs-layout'>(</span><span class='hs-conid'>Qr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>x0</span><span class='hs-layout'>)</span> <span class='hs-varid'>r0</span>
<a name="line-354"></a>    <span class='hs-keyword'>where</span>
<a name="line-355"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Qr</span> <span class='hs-varid'>r</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span><span class='hs-keyglyph'>-&gt;</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Qr</span> <span class='hs-varid'>r</span> <span class='hs-varid'>b</span>
<a name="line-356"></a>      <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Qr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qr</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`o`</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-357"></a>
<a name="line-358"></a>
<a name="line-359"></a>  <span class='hs-comment'>-- | A generic query that processes the immediate subterms and returns a list</span>
<a name="line-360"></a>  <span class='hs-comment'>-- of results.  The list is given in the same order as originally specified</span>
<a name="line-361"></a>  <span class='hs-comment'>-- in the declaration of the data constructors.</span>
<a name="line-362"></a>  <span class='hs-varid'>gmapQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>u</span><span class='hs-keyglyph'>]</span>
<a name="line-363"></a>  <span class='hs-varid'>gmapQ</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gmapQr</span> <span class='hs-layout'>(</span><span class='hs-conop'>:</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>f</span>
<a name="line-364"></a>
<a name="line-365"></a>
<a name="line-366"></a>  <span class='hs-comment'>-- | A generic query that processes one child by index (zero-based)</span>
<a name="line-367"></a>  <span class='hs-varid'>gmapQi</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>u</span><span class='hs-varop'>.</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>u</span>
<a name="line-368"></a>  <span class='hs-varid'>gmapQi</span> <span class='hs-varid'>i</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-conid'>Qi</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>q</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>fromJust</span> <span class='hs-varid'>q</span> <span class='hs-layout'>}</span>
<a name="line-369"></a>    <span class='hs-keyword'>where</span>
<a name="line-370"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Qi</span> <span class='hs-varid'>u</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Qi</span> <span class='hs-varid'>u</span> <span class='hs-varid'>b</span>
<a name="line-371"></a>      <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Qi</span> <span class='hs-varid'>i'</span> <span class='hs-varid'>q</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qi</span> <span class='hs-layout'>(</span><span class='hs-varid'>i'</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>i</span><span class='hs-varop'>==</span><span class='hs-varid'>i'</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>q</span><span class='hs-layout'>)</span>
<a name="line-372"></a>      <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Qi</span> <span class='hs-varid'>q</span> <span class='hs-varid'>g</span>
<a name="line-373"></a>      <span class='hs-varid'>z</span> <span class='hs-keyword'>_</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qi</span> <span class='hs-num'>0</span> <span class='hs-conid'>Nothing</span>
<a name="line-374"></a>
<a name="line-375"></a>
<a name="line-376"></a>  <span class='hs-comment'>-- | A generic monadic transformation that maps over the immediate subterms</span>
<a name="line-377"></a>  <span class='hs-comment'>--</span>
<a name="line-378"></a>  <span class='hs-comment'>-- The default definition instantiates the type constructor @c@ in</span>
<a name="line-379"></a>  <span class='hs-comment'>-- the type of 'gfoldl' to the monad datatype constructor, defining</span>
<a name="line-380"></a>  <span class='hs-comment'>-- injection and projection using 'return' and '&gt;&gt;='.</span>
<a name="line-381"></a>  <span class='hs-varid'>gmapM</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>m</span><span class='hs-varop'>.</span> <span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-382"></a>
<a name="line-383"></a>  <span class='hs-comment'>-- Use immediately the monad datatype constructor</span>
<a name="line-384"></a>  <span class='hs-comment'>-- to instantiate the type constructor c in the type of gfoldl,</span>
<a name="line-385"></a>  <span class='hs-comment'>-- so injection and projection is done by return and &gt;&gt;=.</span>
<a name="line-386"></a>  <span class='hs-comment'>--</span>
<a name="line-387"></a>  <span class='hs-varid'>gmapM</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>return</span>
<a name="line-388"></a>    <span class='hs-keyword'>where</span>
<a name="line-389"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span>
<a name="line-390"></a>      <span class='hs-varid'>k</span> <span class='hs-varid'>c</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-varid'>c'</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>c</span>
<a name="line-391"></a>                 <span class='hs-varid'>x'</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span>
<a name="line-392"></a>                 <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>c'</span> <span class='hs-varid'>x'</span><span class='hs-layout'>)</span>
<a name="line-393"></a>
<a name="line-394"></a>
<a name="line-395"></a>  <span class='hs-comment'>-- | Transformation of at least one immediate subterm does not fail</span>
<a name="line-396"></a>  <span class='hs-varid'>gmapMp</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>m</span><span class='hs-varop'>.</span> <span class='hs-conid'>MonadPlus</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-397"></a>
<a name="line-398"></a><span class='hs-comment'>{-
<a name="line-399"></a>
<a name="line-400"></a>The type constructor that we use here simply keeps track of the fact
<a name="line-401"></a>if we already succeeded for an immediate subterm; see Mp below. To
<a name="line-402"></a>this end, we couple the monadic computation with a Boolean.
<a name="line-403"></a>
<a name="line-404"></a>-}</span>
<a name="line-405"></a>
<a name="line-406"></a>  <span class='hs-varid'>gmapMp</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unMp</span> <span class='hs-layout'>(</span><span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>x'</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-407"></a>                <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>return</span> <span class='hs-varid'>x'</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>mzero</span>
<a name="line-408"></a>    <span class='hs-keyword'>where</span>
<a name="line-409"></a>      <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>g</span>
<a name="line-410"></a>      <span class='hs-varid'>z</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mp</span> <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-layout'>,</span><span class='hs-conid'>False</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-411"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span>
<a name="line-412"></a>      <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Mp</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span>
<a name="line-413"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mp</span> <span class='hs-layout'>(</span> <span class='hs-varid'>c</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-414"></a>                 <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>y</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>y'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varid'>y'</span><span class='hs-layout'>,</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-415"></a>                 <span class='hs-varop'>`mplus`</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-416"></a>             <span class='hs-layout'>)</span>
<a name="line-417"></a>
<a name="line-418"></a>  <span class='hs-comment'>-- | Transformation of one immediate subterm with success</span>
<a name="line-419"></a>  <span class='hs-varid'>gmapMo</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>m</span><span class='hs-varop'>.</span> <span class='hs-conid'>MonadPlus</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-420"></a>
<a name="line-421"></a><span class='hs-comment'>{-
<a name="line-422"></a>
<a name="line-423"></a>We use the same pairing trick as for gmapMp,
<a name="line-424"></a>i.e., we use an extra Bool component to keep track of the
<a name="line-425"></a>fact whether an immediate subterm was processed successfully.
<a name="line-426"></a>However, we cut of mapping over subterms once a first subterm
<a name="line-427"></a>was transformed successfully.
<a name="line-428"></a>
<a name="line-429"></a>-}</span>
<a name="line-430"></a>
<a name="line-431"></a>  <span class='hs-varid'>gmapMo</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>unMp</span> <span class='hs-layout'>(</span><span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>x'</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-432"></a>                <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>return</span> <span class='hs-varid'>x'</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>mzero</span>
<a name="line-433"></a>    <span class='hs-keyword'>where</span>
<a name="line-434"></a>      <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>g</span>
<a name="line-435"></a>      <span class='hs-varid'>z</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mp</span> <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-layout'>,</span><span class='hs-conid'>False</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-436"></a>      <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span>
<a name="line-437"></a>      <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Mp</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>y</span>
<a name="line-438"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mp</span> <span class='hs-layout'>(</span> <span class='hs-varid'>c</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span>
<a name="line-439"></a>                        <span class='hs-keyword'>then</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-440"></a>                        <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>y</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>y'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varid'>y'</span><span class='hs-layout'>,</span><span class='hs-conid'>True</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-441"></a>                             <span class='hs-varop'>`mplus`</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-442"></a>             <span class='hs-layout'>)</span>
<a name="line-443"></a>
<a name="line-444"></a>
<a name="line-445"></a><a name="Qi"></a><span class='hs-comment'>-- | Type constructor for adding counters to queries</span>
<a name="line-446"></a><a name="Qi"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Qi</span> <span class='hs-varid'>q</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qi</span> <span class='hs-conid'>Int</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-varid'>q</span><span class='hs-layout'>)</span>
<a name="line-447"></a>
<a name="line-448"></a>
<a name="line-449"></a><a name="Qr"></a><span class='hs-comment'>-- | The type constructor used in definition of gmapQr</span>
<a name="line-450"></a><a name="Qr"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Qr</span> <span class='hs-varid'>r</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Qr</span> <span class='hs-layout'>{</span> <span class='hs-varid'>unQr</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span> <span class='hs-layout'>}</span>
<a name="line-451"></a>
<a name="line-452"></a>
<a name="line-453"></a><a name="Mp"></a><span class='hs-comment'>-- | The type constructor used in definition of gmapMp</span>
<a name="line-454"></a><a name="Mp"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Mp</span> <span class='hs-varid'>m</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Mp</span> <span class='hs-layout'>{</span> <span class='hs-varid'>unMp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-455"></a>
<a name="line-456"></a>
<a name="line-457"></a>
<a name="line-458"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-459"></a><span class='hs-comment'>--</span>
<a name="line-460"></a><span class='hs-comment'>--      Generic unfolding</span>
<a name="line-461"></a><span class='hs-comment'>--</span>
<a name="line-462"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-463"></a>
<a name="line-464"></a>
<a name="line-465"></a><a name="fromConstr"></a><span class='hs-comment'>-- | Build a term skeleton</span>
<a name="line-466"></a><span class='hs-definition'>fromConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-467"></a><span class='hs-definition'>fromConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromConstrB</span> <span class='hs-layout'>(</span><span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.fromConstr"</span><span class='hs-layout'>)</span>
<a name="line-468"></a>
<a name="line-469"></a>
<a name="line-470"></a><a name="fromConstrB"></a><span class='hs-comment'>-- | Build a term and use a generic function for subterms</span>
<a name="line-471"></a><span class='hs-definition'>fromConstrB</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span>
<a name="line-472"></a>            <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-473"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-474"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-475"></a><span class='hs-definition'>fromConstrB</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>runIdentity</span> <span class='hs-varop'>.</span> <span class='hs-varid'>gunfold</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span>
<a name="line-476"></a> <span class='hs-keyword'>where</span>
<a name="line-477"></a>  <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>b</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Identity</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Identity</span> <span class='hs-varid'>r</span>
<a name="line-478"></a>  <span class='hs-varid'>k</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Identity</span> <span class='hs-layout'>(</span><span class='hs-varid'>runIdentity</span> <span class='hs-varid'>c</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-479"></a>
<a name="line-480"></a>  <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Identity</span> <span class='hs-varid'>r</span>
<a name="line-481"></a>  <span class='hs-varid'>z</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Identity</span>
<a name="line-482"></a>
<a name="line-483"></a>
<a name="line-484"></a><a name="fromConstrM"></a><span class='hs-comment'>-- | Monadic variation on 'fromConstrB'</span>
<a name="line-485"></a><span class='hs-definition'>fromConstrM</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-486"></a>            <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>forall</span> <span class='hs-varid'>d</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-487"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-488"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-489"></a><span class='hs-definition'>fromConstrM</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gunfold</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span>
<a name="line-490"></a> <span class='hs-keyword'>where</span>
<a name="line-491"></a>  <span class='hs-varid'>k</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>b</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>r</span>
<a name="line-492"></a>  <span class='hs-varid'>k</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span> <span class='hs-layout'>{</span> <span class='hs-varid'>c'</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>c</span><span class='hs-layout'>;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>f</span><span class='hs-layout'>;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>c'</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-493"></a>
<a name="line-494"></a>  <span class='hs-varid'>z</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>r</span><span class='hs-varop'>.</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>r</span>
<a name="line-495"></a>  <span class='hs-varid'>z</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span>
<a name="line-496"></a>
<a name="line-497"></a>
<a name="line-498"></a>
<a name="line-499"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-500"></a><span class='hs-comment'>--</span>
<a name="line-501"></a><span class='hs-comment'>--      Datatype and constructor representations</span>
<a name="line-502"></a><span class='hs-comment'>--</span>
<a name="line-503"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-504"></a>
<a name="line-505"></a>
<a name="line-506"></a><a name="DataType"></a><span class='hs-comment'>--</span>
<a name="line-507"></a><a name="DataType"></a><span class='hs-comment'>-- | Representation of datatypes.</span>
<a name="line-508"></a><a name="DataType"></a><span class='hs-comment'>-- A package of constructor representations with names of type and module.</span>
<a name="line-509"></a><a name="DataType"></a><span class='hs-comment'>--</span>
<a name="line-510"></a><a name="DataType"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DataType</span>
<a name="line-511"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>tycon</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span>
<a name="line-512"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>datarep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataRep</span>
<a name="line-513"></a>                        <span class='hs-layout'>}</span>
<a name="line-514"></a>
<a name="line-515"></a>              <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Show</span> <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-516"></a>
<a name="line-517"></a><a name="Constr"></a><span class='hs-comment'>-- | Representation of constructors. Note that equality on constructors</span>
<a name="line-518"></a><a name="Constr"></a><span class='hs-comment'>-- with different types may not work -- i.e. the constructors for 'False' and</span>
<a name="line-519"></a><a name="Constr"></a><span class='hs-comment'>-- 'Nothing' may compare equal.</span>
<a name="line-520"></a><a name="Constr"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Constr</span>
<a name="line-521"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>conrep</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ConstrRep</span>
<a name="line-522"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>constring</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span>
<a name="line-523"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>confields</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- for AlgRep only</span>
<a name="line-524"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>confixity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Fixity</span>   <span class='hs-comment'>-- for AlgRep only</span>
<a name="line-525"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>datatype</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-526"></a>                        <span class='hs-layout'>}</span>
<a name="line-527"></a>
<a name="line-528"></a><a name="instance%20Show%20Constr"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-529"></a><a name="instance%20Show%20Constr"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-conid'>Constr</span> <span class='hs-keyword'>where</span>
<a name="line-530"></a> <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>constring</span>
<a name="line-531"></a>
<a name="line-532"></a>
<a name="line-533"></a><a name="instance%20Eq%20Constr"></a><span class='hs-comment'>-- | Equality of constructors</span>
<a name="line-534"></a><a name="instance%20Eq%20Constr"></a><span class='hs-comment'>--</span>
<a name="line-535"></a><a name="instance%20Eq%20Constr"></a><span class='hs-comment'>-- @since 4.0.0.0</span>
<a name="line-536"></a><a name="instance%20Eq%20Constr"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Eq</span> <span class='hs-conid'>Constr</span> <span class='hs-keyword'>where</span>
<a name="line-537"></a>  <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-varid'>c'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c'</span>
<a name="line-538"></a>
<a name="line-539"></a>
<a name="line-540"></a><a name="DataRep"></a><span class='hs-comment'>-- | Public representation of datatypes</span>
<a name="line-541"></a><a name="DataRep"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>DataRep</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AlgRep</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Constr</span><span class='hs-keyglyph'>]</span>
<a name="line-542"></a>             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IntRep</span>
<a name="line-543"></a>             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FloatRep</span>
<a name="line-544"></a>             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>CharRep</span>
<a name="line-545"></a>             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NoRep</span>
<a name="line-546"></a>
<a name="line-547"></a>            <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Eq</span>   <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-548"></a>                     <span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-549"></a>                     <span class='hs-layout'>)</span>
<a name="line-550"></a><span class='hs-comment'>-- The list of constructors could be an array, a balanced tree, or others.</span>
<a name="line-551"></a>
<a name="line-552"></a>
<a name="line-553"></a><a name="ConstrRep"></a><span class='hs-comment'>-- | Public representation of constructors</span>
<a name="line-554"></a><a name="ConstrRep"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>ConstrRep</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AlgConstr</span>    <span class='hs-conid'>ConIndex</span>
<a name="line-555"></a>               <span class='hs-keyglyph'>|</span> <span class='hs-conid'>IntConstr</span>    <span class='hs-conid'>Integer</span>
<a name="line-556"></a>               <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FloatConstr</span>  <span class='hs-conid'>Rational</span>
<a name="line-557"></a>               <span class='hs-keyglyph'>|</span> <span class='hs-conid'>CharConstr</span>   <span class='hs-conid'>Char</span>
<a name="line-558"></a>
<a name="line-559"></a>               <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Eq</span>   <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-560"></a>                        <span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-561"></a>                        <span class='hs-layout'>)</span>
<a name="line-562"></a>
<a name="line-563"></a>
<a name="line-564"></a><a name="ConIndex"></a><span class='hs-comment'>-- | Unique index for datatype constructors,</span>
<a name="line-565"></a><a name="ConIndex"></a><span class='hs-comment'>-- counting from 1 in the order they are given in the program text.</span>
<a name="line-566"></a><a name="ConIndex"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>ConIndex</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<a name="line-567"></a>
<a name="line-568"></a>
<a name="line-569"></a><a name="Fixity"></a><span class='hs-comment'>-- | Fixity of constructors</span>
<a name="line-570"></a><a name="Fixity"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Fixity</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Prefix</span>
<a name="line-571"></a>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Infix</span>     <span class='hs-comment'>-- Later: add associativity and precedence</span>
<a name="line-572"></a>
<a name="line-573"></a>            <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Eq</span>   <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-574"></a>                     <span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-comment'>-- ^ @since 4.0.0.0</span>
<a name="line-575"></a>                     <span class='hs-layout'>)</span>
<a name="line-576"></a>
<a name="line-577"></a>
<a name="line-578"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-579"></a><span class='hs-comment'>--</span>
<a name="line-580"></a><span class='hs-comment'>--      Observers for datatype representations</span>
<a name="line-581"></a><span class='hs-comment'>--</span>
<a name="line-582"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-583"></a>
<a name="line-584"></a>
<a name="line-585"></a><a name="dataTypeName"></a><span class='hs-comment'>-- | Gets the type constructor including the module</span>
<a name="line-586"></a><span class='hs-definition'>dataTypeName</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-587"></a><span class='hs-definition'>dataTypeName</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tycon</span>
<a name="line-588"></a>
<a name="line-589"></a>
<a name="line-590"></a>
<a name="line-591"></a><a name="dataTypeRep"></a><span class='hs-comment'>-- | Gets the public presentation of a datatype</span>
<a name="line-592"></a><span class='hs-definition'>dataTypeRep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataRep</span>
<a name="line-593"></a><span class='hs-definition'>dataTypeRep</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>datarep</span>
<a name="line-594"></a>
<a name="line-595"></a>
<a name="line-596"></a><a name="constrType"></a><span class='hs-comment'>-- | Gets the datatype of a constructor</span>
<a name="line-597"></a><span class='hs-definition'>constrType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-598"></a><span class='hs-definition'>constrType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>datatype</span>
<a name="line-599"></a>
<a name="line-600"></a>
<a name="line-601"></a><a name="constrRep"></a><span class='hs-comment'>-- | Gets the public presentation of constructors</span>
<a name="line-602"></a><span class='hs-definition'>constrRep</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConstrRep</span>
<a name="line-603"></a><span class='hs-definition'>constrRep</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>conrep</span>
<a name="line-604"></a>
<a name="line-605"></a>
<a name="line-606"></a><a name="repConstr"></a><span class='hs-comment'>-- | Look up a constructor by its representation</span>
<a name="line-607"></a><span class='hs-definition'>repConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConstrRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-608"></a><span class='hs-definition'>repConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>cr</span> <span class='hs-keyglyph'>=</span>
<a name="line-609"></a>      <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>dataTypeRep</span> <span class='hs-varid'>dt</span><span class='hs-layout'>,</span> <span class='hs-varid'>cr</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-610"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cs</span><span class='hs-layout'>,</span> <span class='hs-conid'>AlgConstr</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>cs</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-611"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>IntRep</span><span class='hs-layout'>,</span>    <span class='hs-conid'>IntConstr</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>i</span>
<a name="line-612"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>FloatRep</span><span class='hs-layout'>,</span>  <span class='hs-conid'>FloatConstr</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkRealConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>f</span>
<a name="line-613"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>CharRep</span><span class='hs-layout'>,</span>   <span class='hs-conid'>CharConstr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkCharConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>c</span>
<a name="line-614"></a>        <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.repConstr: The given ConstrRep does not fit to the given DataType."</span>
<a name="line-615"></a>
<a name="line-616"></a>
<a name="line-617"></a>
<a name="line-618"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-619"></a><span class='hs-comment'>--</span>
<a name="line-620"></a><span class='hs-comment'>--      Representations of algebraic data types</span>
<a name="line-621"></a><span class='hs-comment'>--</span>
<a name="line-622"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-623"></a>
<a name="line-624"></a>
<a name="line-625"></a><a name="mkDataType"></a><span class='hs-comment'>-- | Constructs an algebraic datatype</span>
<a name="line-626"></a><span class='hs-definition'>mkDataType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Constr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-627"></a><span class='hs-definition'>mkDataType</span> <span class='hs-varid'>str</span> <span class='hs-varid'>cs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DataType</span>
<a name="line-628"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>tycon</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>str</span>
<a name="line-629"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>datarep</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cs</span>
<a name="line-630"></a>                        <span class='hs-layout'>}</span>
<a name="line-631"></a>
<a name="line-632"></a>
<a name="line-633"></a><a name="mkConstr"></a><span class='hs-comment'>-- | Constructs a constructor</span>
<a name="line-634"></a><span class='hs-definition'>mkConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Fixity</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-635"></a><span class='hs-definition'>mkConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-varid'>fields</span> <span class='hs-varid'>fix</span> <span class='hs-keyglyph'>=</span>
<a name="line-636"></a>        <span class='hs-conid'>Constr</span>
<a name="line-637"></a>                <span class='hs-layout'>{</span> <span class='hs-varid'>conrep</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>AlgConstr</span> <span class='hs-varid'>idx</span>
<a name="line-638"></a>                <span class='hs-layout'>,</span> <span class='hs-varid'>constring</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>str</span>
<a name="line-639"></a>                <span class='hs-layout'>,</span> <span class='hs-varid'>confields</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fields</span>
<a name="line-640"></a>                <span class='hs-layout'>,</span> <span class='hs-varid'>confixity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fix</span>
<a name="line-641"></a>                <span class='hs-layout'>,</span> <span class='hs-varid'>datatype</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dt</span>
<a name="line-642"></a>                <span class='hs-layout'>}</span>
<a name="line-643"></a>  <span class='hs-keyword'>where</span>
<a name="line-644"></a>    <span class='hs-varid'>idx</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>head</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>dataTypeConstrs</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>`zip`</span> <span class='hs-keyglyph'>[</span><span class='hs-num'>1</span><span class='hs-keyglyph'>..</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-645"></a>                     <span class='hs-varid'>showConstr</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-varid'>str</span> <span class='hs-keyglyph'>]</span>
<a name="line-646"></a>
<a name="line-647"></a>
<a name="line-648"></a><a name="dataTypeConstrs"></a><span class='hs-comment'>-- | Gets the constructors of an algebraic datatype</span>
<a name="line-649"></a><span class='hs-definition'>dataTypeConstrs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Constr</span><span class='hs-keyglyph'>]</span>
<a name="line-650"></a><span class='hs-definition'>dataTypeConstrs</span> <span class='hs-varid'>dt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-651"></a>                        <span class='hs-layout'>(</span><span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cons</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>cons</span>
<a name="line-652"></a>                        <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.dataTypeConstrs is not supported for "</span>
<a name="line-653"></a>                                    <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-654"></a>                                    <span class='hs-str'>", as it is not an algebraic data type."</span>
<a name="line-655"></a>
<a name="line-656"></a>
<a name="line-657"></a><a name="constrFields"></a><span class='hs-comment'>-- | Gets the field labels of a constructor.  The list of labels</span>
<a name="line-658"></a><span class='hs-comment'>-- is returned in the same order as they were given in the original</span>
<a name="line-659"></a><span class='hs-comment'>-- constructor declaration.</span>
<a name="line-660"></a><span class='hs-definition'>constrFields</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>String</span><span class='hs-keyglyph'>]</span>
<a name="line-661"></a><span class='hs-definition'>constrFields</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>confields</span>
<a name="line-662"></a>
<a name="line-663"></a>
<a name="line-664"></a><a name="constrFixity"></a><span class='hs-comment'>-- | Gets the fixity of a constructor</span>
<a name="line-665"></a><span class='hs-definition'>constrFixity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Fixity</span>
<a name="line-666"></a><span class='hs-definition'>constrFixity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>confixity</span>
<a name="line-667"></a>
<a name="line-668"></a>
<a name="line-669"></a>
<a name="line-670"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-671"></a><span class='hs-comment'>--</span>
<a name="line-672"></a><span class='hs-comment'>--      From strings to constr's and vice versa: all data types</span>
<a name="line-673"></a><span class='hs-comment'>--</span>
<a name="line-674"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-675"></a>
<a name="line-676"></a>
<a name="line-677"></a><a name="showConstr"></a><span class='hs-comment'>-- | Gets the string for a constructor</span>
<a name="line-678"></a><span class='hs-definition'>showConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-679"></a><span class='hs-definition'>showConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>constring</span>
<a name="line-680"></a>
<a name="line-681"></a>
<a name="line-682"></a><a name="readConstr"></a><span class='hs-comment'>-- | Lookup a constructor via a string</span>
<a name="line-683"></a><span class='hs-definition'>readConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Constr</span>
<a name="line-684"></a><span class='hs-definition'>readConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-keyglyph'>=</span>
<a name="line-685"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>dataTypeRep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-686"></a>        <span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cons</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>idx</span> <span class='hs-varid'>cons</span>
<a name="line-687"></a>        <span class='hs-conid'>IntRep</span>      <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkReadCon</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>i</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-688"></a>        <span class='hs-conid'>FloatRep</span>    <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkReadCon</span> <span class='hs-varid'>ffloat</span>
<a name="line-689"></a>        <span class='hs-conid'>CharRep</span>     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkReadCon</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>c</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-layout'>(</span><span class='hs-conid'>CharConstr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-690"></a>        <span class='hs-conid'>NoRep</span>       <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>
<a name="line-691"></a>  <span class='hs-keyword'>where</span>
<a name="line-692"></a>
<a name="line-693"></a>    <span class='hs-comment'>-- Read a value and build a constructor</span>
<a name="line-694"></a>    <span class='hs-varid'>mkReadCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Read</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>t</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Constr</span>
<a name="line-695"></a>    <span class='hs-varid'>mkReadCon</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-layout'>(</span><span class='hs-varid'>reads</span> <span class='hs-varid'>str</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-696"></a>                    <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>t</span><span class='hs-layout'>,</span><span class='hs-str'>""</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-697"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nothing</span>
<a name="line-698"></a>
<a name="line-699"></a>    <span class='hs-comment'>-- Traverse list of algebraic datatype constructors</span>
<a name="line-700"></a>    <span class='hs-varid'>idx</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Constr</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Constr</span>
<a name="line-701"></a>    <span class='hs-varid'>idx</span> <span class='hs-varid'>cons</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>fit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filter</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-varid'>str</span> <span class='hs-varop'>.</span> <span class='hs-varid'>showConstr</span><span class='hs-layout'>)</span> <span class='hs-varid'>cons</span>
<a name="line-702"></a>                <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>fit</span> <span class='hs-varop'>==</span> <span class='hs-conid'>[]</span>
<a name="line-703"></a>                     <span class='hs-keyword'>then</span> <span class='hs-conid'>Nothing</span>
<a name="line-704"></a>                     <span class='hs-keyword'>else</span> <span class='hs-conid'>Just</span> <span class='hs-layout'>(</span><span class='hs-varid'>head</span> <span class='hs-varid'>fit</span><span class='hs-layout'>)</span>
<a name="line-705"></a>
<a name="line-706"></a>    <span class='hs-varid'>ffloat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-707"></a>    <span class='hs-varid'>ffloat</span> <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-varop'>.</span> <span class='hs-conid'>FloatConstr</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toRational</span>
<a name="line-708"></a>
<a name="line-709"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-710"></a><span class='hs-comment'>--</span>
<a name="line-711"></a><span class='hs-comment'>--      Convenience functions: algebraic data types</span>
<a name="line-712"></a><span class='hs-comment'>--</span>
<a name="line-713"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-714"></a>
<a name="line-715"></a>
<a name="line-716"></a><a name="isAlgType"></a><span class='hs-comment'>-- | Test for an algebraic type</span>
<a name="line-717"></a><span class='hs-definition'>isAlgType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-718"></a><span class='hs-definition'>isAlgType</span> <span class='hs-varid'>dt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-719"></a>                 <span class='hs-layout'>(</span><span class='hs-conid'>AlgRep</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<a name="line-720"></a>                 <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>False</span>
<a name="line-721"></a>
<a name="line-722"></a>
<a name="line-723"></a><a name="indexConstr"></a><span class='hs-comment'>-- | Gets the constructor for an index (algebraic datatypes only)</span>
<a name="line-724"></a><span class='hs-definition'>indexConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConIndex</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-725"></a><span class='hs-definition'>indexConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>idx</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-726"></a>                        <span class='hs-layout'>(</span><span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>cs</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>idx</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<a name="line-727"></a>                        <span class='hs-keyword'>_</span>           <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.indexConstr is not supported for "</span>
<a name="line-728"></a>                                               <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-729"></a>                                               <span class='hs-str'>", as it is not an algebraic data type."</span>
<a name="line-730"></a>
<a name="line-731"></a>
<a name="line-732"></a><a name="constrIndex"></a><span class='hs-comment'>-- | Gets the index of a constructor (algebraic datatypes only)</span>
<a name="line-733"></a><span class='hs-definition'>constrIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConIndex</span>
<a name="line-734"></a><span class='hs-definition'>constrIndex</span> <span class='hs-varid'>con</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>con</span> <span class='hs-keyword'>of</span>
<a name="line-735"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>AlgConstr</span> <span class='hs-varid'>idx</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>idx</span>
<a name="line-736"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.constrIndex is not supported for "</span>
<a name="line-737"></a>                                 <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-layout'>(</span><span class='hs-varid'>constrType</span> <span class='hs-varid'>con</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span>
<a name="line-738"></a>                                 <span class='hs-str'>", as it is not an algebraic data type."</span>
<a name="line-739"></a>
<a name="line-740"></a>
<a name="line-741"></a><a name="maxConstrIndex"></a><span class='hs-comment'>-- | Gets the maximum constructor index of an algebraic datatype</span>
<a name="line-742"></a><span class='hs-definition'>maxConstrIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConIndex</span>
<a name="line-743"></a><span class='hs-definition'>maxConstrIndex</span> <span class='hs-varid'>dt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>dataTypeRep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-744"></a>                        <span class='hs-conid'>AlgRep</span> <span class='hs-varid'>cs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>length</span> <span class='hs-varid'>cs</span>
<a name="line-745"></a>                        <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.maxConstrIndex is not supported for "</span>
<a name="line-746"></a>                                                 <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-747"></a>                                                 <span class='hs-str'>", as it is not an algebraic data type."</span>
<a name="line-748"></a>
<a name="line-749"></a>
<a name="line-750"></a>
<a name="line-751"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-752"></a><span class='hs-comment'>--</span>
<a name="line-753"></a><span class='hs-comment'>--      Representation of primitive types</span>
<a name="line-754"></a><span class='hs-comment'>--</span>
<a name="line-755"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-756"></a>
<a name="line-757"></a>
<a name="line-758"></a><a name="mkIntType"></a><span class='hs-comment'>-- | Constructs the 'Int' type</span>
<a name="line-759"></a><span class='hs-definition'>mkIntType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-760"></a><span class='hs-definition'>mkIntType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkPrimType</span> <span class='hs-conid'>IntRep</span>
<a name="line-761"></a>
<a name="line-762"></a>
<a name="line-763"></a><a name="mkFloatType"></a><span class='hs-comment'>-- | Constructs the 'Float' type</span>
<a name="line-764"></a><span class='hs-definition'>mkFloatType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-765"></a><span class='hs-definition'>mkFloatType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkPrimType</span> <span class='hs-conid'>FloatRep</span>
<a name="line-766"></a>
<a name="line-767"></a>
<a name="line-768"></a><a name="mkCharType"></a><span class='hs-comment'>-- | Constructs the 'Char' type</span>
<a name="line-769"></a><span class='hs-definition'>mkCharType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-770"></a><span class='hs-definition'>mkCharType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkPrimType</span> <span class='hs-conid'>CharRep</span>
<a name="line-771"></a>
<a name="line-772"></a>
<a name="line-773"></a><a name="mkPrimType"></a><span class='hs-comment'>-- | Helper for 'mkIntType', 'mkFloatType'</span>
<a name="line-774"></a><span class='hs-definition'>mkPrimType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-775"></a><span class='hs-definition'>mkPrimType</span> <span class='hs-varid'>dr</span> <span class='hs-varid'>str</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DataType</span>
<a name="line-776"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>tycon</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>str</span>
<a name="line-777"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>datarep</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dr</span>
<a name="line-778"></a>                        <span class='hs-layout'>}</span>
<a name="line-779"></a>
<a name="line-780"></a>
<a name="line-781"></a><a name="mkPrimCon"></a><span class='hs-comment'>-- Makes a constructor for primitive types</span>
<a name="line-782"></a><span class='hs-definition'>mkPrimCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ConstrRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-783"></a><span class='hs-definition'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>str</span> <span class='hs-varid'>cr</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Constr</span>
<a name="line-784"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>datatype</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dt</span>
<a name="line-785"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>conrep</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cr</span>
<a name="line-786"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>constring</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>str</span>
<a name="line-787"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>confields</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.confields"</span>
<a name="line-788"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>confixity</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.confixity"</span>
<a name="line-789"></a>                        <span class='hs-layout'>}</span>
<a name="line-790"></a>
<a name="line-791"></a><a name="mkIntegralConstr"></a><span class='hs-definition'>mkIntegralConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-792"></a><span class='hs-definition'>mkIntegralConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-793"></a>                  <span class='hs-conid'>IntRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-layout'>(</span><span class='hs-varid'>toInteger</span>  <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-794"></a>                  <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.mkIntegralConstr is not supported for "</span>
<a name="line-795"></a>                               <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-796"></a>                               <span class='hs-str'>", as it is not an Integral data type."</span>
<a name="line-797"></a>
<a name="line-798"></a><a name="mkRealConstr"></a><span class='hs-definition'>mkRealConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Real</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-799"></a><span class='hs-definition'>mkRealConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-800"></a>                    <span class='hs-conid'>FloatRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>FloatConstr</span> <span class='hs-layout'>(</span><span class='hs-varid'>toRational</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-801"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.mkRealConstr is not supported for "</span>
<a name="line-802"></a>                                 <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-803"></a>                                 <span class='hs-str'>", as it is not a Real data type."</span>
<a name="line-804"></a>
<a name="line-805"></a><a name="mkCharConstr"></a><span class='hs-comment'>-- | Makes a constructor for 'Char'.</span>
<a name="line-806"></a><span class='hs-definition'>mkCharConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Constr</span>
<a name="line-807"></a><span class='hs-definition'>mkCharConstr</span> <span class='hs-varid'>dt</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-808"></a>                   <span class='hs-conid'>CharRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mkPrimCon</span> <span class='hs-varid'>dt</span> <span class='hs-layout'>(</span><span class='hs-varid'>show</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>CharConstr</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-809"></a>                   <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.mkCharConstr is not supported for "</span>
<a name="line-810"></a>                                <span class='hs-varop'>++</span> <span class='hs-varid'>dataTypeName</span> <span class='hs-varid'>dt</span> <span class='hs-varop'>++</span>
<a name="line-811"></a>                                <span class='hs-str'>", as it is not an Char data type."</span>
<a name="line-812"></a>
<a name="line-813"></a>
<a name="line-814"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-815"></a><span class='hs-comment'>--</span>
<a name="line-816"></a><span class='hs-comment'>--      Non-representations for non-representable types</span>
<a name="line-817"></a><span class='hs-comment'>--</span>
<a name="line-818"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-819"></a>
<a name="line-820"></a>
<a name="line-821"></a><a name="mkNoRepType"></a><span class='hs-comment'>-- | Constructs a non-representation for a non-representable type</span>
<a name="line-822"></a><span class='hs-definition'>mkNoRepType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>DataType</span>
<a name="line-823"></a><span class='hs-definition'>mkNoRepType</span> <span class='hs-varid'>str</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DataType</span>
<a name="line-824"></a>                        <span class='hs-layout'>{</span> <span class='hs-varid'>tycon</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>str</span>
<a name="line-825"></a>                        <span class='hs-layout'>,</span> <span class='hs-varid'>datarep</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NoRep</span>
<a name="line-826"></a>                        <span class='hs-layout'>}</span>
<a name="line-827"></a>
<a name="line-828"></a><a name="isNorepType"></a><span class='hs-comment'>-- | Test for a non-representable type</span>
<a name="line-829"></a><span class='hs-definition'>isNorepType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-830"></a><span class='hs-definition'>isNorepType</span> <span class='hs-varid'>dt</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>datarep</span> <span class='hs-varid'>dt</span> <span class='hs-keyword'>of</span>
<a name="line-831"></a>                   <span class='hs-conid'>NoRep</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span>
<a name="line-832"></a>                   <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>False</span>
<a name="line-833"></a>
<a name="line-834"></a>
<a name="line-835"></a>
<a name="line-836"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-837"></a><span class='hs-comment'>--</span>
<a name="line-838"></a><span class='hs-comment'>--      Convenience for qualified type constructors</span>
<a name="line-839"></a><span class='hs-comment'>--</span>
<a name="line-840"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-841"></a>
<a name="line-842"></a>
<a name="line-843"></a><a name="tyconUQname"></a><span class='hs-comment'>-- | Gets the unqualified type constructor:</span>
<a name="line-844"></a><span class='hs-comment'>-- drop *.*.*... before name</span>
<a name="line-845"></a><span class='hs-comment'>--</span>
<a name="line-846"></a><span class='hs-definition'>tyconUQname</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-847"></a><span class='hs-definition'>tyconUQname</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>x'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dropWhile</span> <span class='hs-layout'>(</span><span class='hs-varid'>not</span> <span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-chr'>'.'</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span>
<a name="line-848"></a>                 <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>x'</span> <span class='hs-varop'>==</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>tyconUQname</span> <span class='hs-layout'>(</span><span class='hs-varid'>tail</span> <span class='hs-varid'>x'</span><span class='hs-layout'>)</span>
<a name="line-849"></a>
<a name="line-850"></a>
<a name="line-851"></a><a name="tyconModule"></a><span class='hs-comment'>-- | Gets the module of a type constructor:</span>
<a name="line-852"></a><span class='hs-comment'>-- take *.*.*... before name</span>
<a name="line-853"></a><span class='hs-definition'>tyconModule</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-854"></a><span class='hs-definition'>tyconModule</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>break</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-chr'>'.'</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span>
<a name="line-855"></a>                 <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-varop'>==</span> <span class='hs-str'>""</span>
<a name="line-856"></a>                      <span class='hs-keyword'>then</span> <span class='hs-varid'>b</span>
<a name="line-857"></a>                      <span class='hs-keyword'>else</span> <span class='hs-varid'>a</span> <span class='hs-varop'>++</span> <span class='hs-varid'>tyconModule'</span> <span class='hs-layout'>(</span><span class='hs-varid'>tail</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-858"></a>  <span class='hs-keyword'>where</span>
<a name="line-859"></a>    <span class='hs-varid'>tyconModule'</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>y'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tyconModule</span> <span class='hs-varid'>y</span>
<a name="line-860"></a>                      <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>y'</span> <span class='hs-varop'>==</span> <span class='hs-str'>""</span> <span class='hs-keyword'>then</span> <span class='hs-str'>""</span> <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-chr'>'.'</span><span class='hs-conop'>:</span><span class='hs-varid'>y'</span><span class='hs-layout'>)</span>
<a name="line-861"></a>
<a name="line-862"></a>
<a name="line-863"></a>
<a name="line-864"></a>
<a name="line-865"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-866"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-867"></a><span class='hs-comment'>--</span>
<a name="line-868"></a><span class='hs-comment'>--      Instances of the Data class for Prelude-like types.</span>
<a name="line-869"></a><span class='hs-comment'>--      We define top-level definitions for representations.</span>
<a name="line-870"></a><span class='hs-comment'>--</span>
<a name="line-871"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-872"></a>
<a name="line-873"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-874"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Bool</span>
<a name="line-875"></a>
<a name="line-876"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-877"></a>
<a name="line-878"></a><a name="charType"></a><span class='hs-definition'>charType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-879"></a><span class='hs-definition'>charType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkCharType</span> <span class='hs-str'>"Prelude.Char"</span>
<a name="line-880"></a>
<a name="line-881"></a><a name="instance%20Data%20Char"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-882"></a><a name="instance%20Data%20Char"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Char</span> <span class='hs-keyword'>where</span>
<a name="line-883"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkCharConstr</span> <span class='hs-varid'>charType</span> <span class='hs-varid'>x</span>
<a name="line-884"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-885"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>CharConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span>
<a name="line-886"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-887"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Char."</span>
<a name="line-888"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>charType</span>
<a name="line-889"></a>
<a name="line-890"></a>
<a name="line-891"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-892"></a>
<a name="line-893"></a><a name="floatType"></a><span class='hs-definition'>floatType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-894"></a><span class='hs-definition'>floatType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkFloatType</span> <span class='hs-str'>"Prelude.Float"</span>
<a name="line-895"></a>
<a name="line-896"></a><a name="instance%20Data%20Float"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-897"></a><a name="instance%20Data%20Float"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Float</span> <span class='hs-keyword'>where</span>
<a name="line-898"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkRealConstr</span> <span class='hs-varid'>floatType</span>
<a name="line-899"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-900"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>FloatConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>realToFrac</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-901"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-902"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Float."</span>
<a name="line-903"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>floatType</span>
<a name="line-904"></a>
<a name="line-905"></a>
<a name="line-906"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-907"></a>
<a name="line-908"></a><a name="doubleType"></a><span class='hs-definition'>doubleType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-909"></a><span class='hs-definition'>doubleType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkFloatType</span> <span class='hs-str'>"Prelude.Double"</span>
<a name="line-910"></a>
<a name="line-911"></a><a name="instance%20Data%20Double"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-912"></a><a name="instance%20Data%20Double"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Double</span> <span class='hs-keyword'>where</span>
<a name="line-913"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkRealConstr</span> <span class='hs-varid'>doubleType</span>
<a name="line-914"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-915"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>FloatConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>realToFrac</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-916"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-917"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Double."</span>
<a name="line-918"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>doubleType</span>
<a name="line-919"></a>
<a name="line-920"></a>
<a name="line-921"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-922"></a>
<a name="line-923"></a><a name="intType"></a><span class='hs-definition'>intType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-924"></a><span class='hs-definition'>intType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Prelude.Int"</span>
<a name="line-925"></a>
<a name="line-926"></a><a name="instance%20Data%20Int"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-927"></a><a name="instance%20Data%20Int"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>where</span>
<a name="line-928"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>intType</span> <span class='hs-varid'>x</span>
<a name="line-929"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-930"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-931"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-932"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Int."</span>
<a name="line-933"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intType</span>
<a name="line-934"></a>
<a name="line-935"></a>
<a name="line-936"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-937"></a>
<a name="line-938"></a><a name="integerType"></a><span class='hs-definition'>integerType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-939"></a><span class='hs-definition'>integerType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Prelude.Integer"</span>
<a name="line-940"></a>
<a name="line-941"></a><a name="instance%20Data%20Integer"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-942"></a><a name="instance%20Data%20Integer"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Integer</span> <span class='hs-keyword'>where</span>
<a name="line-943"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>integerType</span>
<a name="line-944"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-945"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-varid'>x</span>
<a name="line-946"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-947"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Integer."</span>
<a name="line-948"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerType</span>
<a name="line-949"></a>
<a name="line-950"></a>
<a name="line-951"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-952"></a>
<a name="line-953"></a><a name="naturalType"></a><span class='hs-comment'>-- This follows the same style as the other integral 'Data' instances</span>
<a name="line-954"></a><span class='hs-comment'>-- defined in "Data.Data"</span>
<a name="line-955"></a><span class='hs-definition'>naturalType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-956"></a><span class='hs-definition'>naturalType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Numeric.Natural.Natural"</span>
<a name="line-957"></a>
<a name="line-958"></a><a name="instance%20Data%20Natural"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-959"></a><a name="instance%20Data%20Natural"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Natural</span> <span class='hs-keyword'>where</span>
<a name="line-960"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>naturalType</span> <span class='hs-varid'>x</span>
<a name="line-961"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-962"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-963"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-964"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Natural"</span>
<a name="line-965"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>naturalType</span>
<a name="line-966"></a>
<a name="line-967"></a>
<a name="line-968"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-969"></a>
<a name="line-970"></a><a name="int8Type"></a><span class='hs-definition'>int8Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-971"></a><span class='hs-definition'>int8Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Int.Int8"</span>
<a name="line-972"></a>
<a name="line-973"></a><a name="instance%20Data%20Int8"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-974"></a><a name="instance%20Data%20Int8"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Int8</span> <span class='hs-keyword'>where</span>
<a name="line-975"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>int8Type</span> <span class='hs-varid'>x</span>
<a name="line-976"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-977"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-978"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-979"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Int8."</span>
<a name="line-980"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int8Type</span>
<a name="line-981"></a>
<a name="line-982"></a>
<a name="line-983"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-984"></a>
<a name="line-985"></a><a name="int16Type"></a><span class='hs-definition'>int16Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-986"></a><span class='hs-definition'>int16Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Int.Int16"</span>
<a name="line-987"></a>
<a name="line-988"></a><a name="instance%20Data%20Int16"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-989"></a><a name="instance%20Data%20Int16"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Int16</span> <span class='hs-keyword'>where</span>
<a name="line-990"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>int16Type</span> <span class='hs-varid'>x</span>
<a name="line-991"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-992"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-993"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-994"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Int16."</span>
<a name="line-995"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int16Type</span>
<a name="line-996"></a>
<a name="line-997"></a>
<a name="line-998"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-999"></a>
<a name="line-1000"></a><a name="int32Type"></a><span class='hs-definition'>int32Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1001"></a><span class='hs-definition'>int32Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Int.Int32"</span>
<a name="line-1002"></a>
<a name="line-1003"></a><a name="instance%20Data%20Int32"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1004"></a><a name="instance%20Data%20Int32"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Int32</span> <span class='hs-keyword'>where</span>
<a name="line-1005"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>int32Type</span> <span class='hs-varid'>x</span>
<a name="line-1006"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1007"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1008"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1009"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Int32."</span>
<a name="line-1010"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int32Type</span>
<a name="line-1011"></a>
<a name="line-1012"></a>
<a name="line-1013"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1014"></a>
<a name="line-1015"></a><a name="int64Type"></a><span class='hs-definition'>int64Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1016"></a><span class='hs-definition'>int64Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Int.Int64"</span>
<a name="line-1017"></a>
<a name="line-1018"></a><a name="instance%20Data%20Int64"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1019"></a><a name="instance%20Data%20Int64"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Int64</span> <span class='hs-keyword'>where</span>
<a name="line-1020"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>int64Type</span> <span class='hs-varid'>x</span>
<a name="line-1021"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1022"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1023"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1024"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Int64."</span>
<a name="line-1025"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int64Type</span>
<a name="line-1026"></a>
<a name="line-1027"></a>
<a name="line-1028"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1029"></a>
<a name="line-1030"></a><a name="wordType"></a><span class='hs-definition'>wordType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1031"></a><span class='hs-definition'>wordType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Word.Word"</span>
<a name="line-1032"></a>
<a name="line-1033"></a><a name="instance%20Data%20Word"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1034"></a><a name="instance%20Data%20Word"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Word</span> <span class='hs-keyword'>where</span>
<a name="line-1035"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>wordType</span> <span class='hs-varid'>x</span>
<a name="line-1036"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1037"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1038"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1039"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Word"</span>
<a name="line-1040"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>wordType</span>
<a name="line-1041"></a>
<a name="line-1042"></a>
<a name="line-1043"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1044"></a>
<a name="line-1045"></a><a name="word8Type"></a><span class='hs-definition'>word8Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1046"></a><span class='hs-definition'>word8Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Word.Word8"</span>
<a name="line-1047"></a>
<a name="line-1048"></a><a name="instance%20Data%20Word8"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1049"></a><a name="instance%20Data%20Word8"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>where</span>
<a name="line-1050"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>word8Type</span> <span class='hs-varid'>x</span>
<a name="line-1051"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1052"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1053"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1054"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Word8."</span>
<a name="line-1055"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word8Type</span>
<a name="line-1056"></a>
<a name="line-1057"></a>
<a name="line-1058"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1059"></a>
<a name="line-1060"></a><a name="word16Type"></a><span class='hs-definition'>word16Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1061"></a><span class='hs-definition'>word16Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Word.Word16"</span>
<a name="line-1062"></a>
<a name="line-1063"></a><a name="instance%20Data%20Word16"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1064"></a><a name="instance%20Data%20Word16"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Word16</span> <span class='hs-keyword'>where</span>
<a name="line-1065"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>word16Type</span> <span class='hs-varid'>x</span>
<a name="line-1066"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1067"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1068"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1069"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Word16."</span>
<a name="line-1070"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word16Type</span>
<a name="line-1071"></a>
<a name="line-1072"></a>
<a name="line-1073"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1074"></a>
<a name="line-1075"></a><a name="word32Type"></a><span class='hs-definition'>word32Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1076"></a><span class='hs-definition'>word32Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Word.Word32"</span>
<a name="line-1077"></a>
<a name="line-1078"></a><a name="instance%20Data%20Word32"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1079"></a><a name="instance%20Data%20Word32"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Word32</span> <span class='hs-keyword'>where</span>
<a name="line-1080"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>word32Type</span> <span class='hs-varid'>x</span>
<a name="line-1081"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1082"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1083"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1084"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Word32."</span>
<a name="line-1085"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word32Type</span>
<a name="line-1086"></a>
<a name="line-1087"></a>
<a name="line-1088"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1089"></a>
<a name="line-1090"></a><a name="word64Type"></a><span class='hs-definition'>word64Type</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1091"></a><span class='hs-definition'>word64Type</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntType</span> <span class='hs-str'>"Data.Word.Word64"</span>
<a name="line-1092"></a>
<a name="line-1093"></a><a name="instance%20Data%20Word64"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1094"></a><a name="instance%20Data%20Word64"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Word64</span> <span class='hs-keyword'>where</span>
<a name="line-1095"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkIntegralConstr</span> <span class='hs-varid'>word64Type</span> <span class='hs-varid'>x</span>
<a name="line-1096"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrRep</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1097"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>IntConstr</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-1098"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Data.Data.gunfold: Constructor "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>c</span>
<a name="line-1099"></a>                                 <span class='hs-varop'>++</span> <span class='hs-str'>" is not of type Word64."</span>
<a name="line-1100"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word64Type</span>
<a name="line-1101"></a>
<a name="line-1102"></a>
<a name="line-1103"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1104"></a>
<a name="line-1105"></a><a name="ratioConstr"></a><span class='hs-definition'>ratioConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span>
<a name="line-1106"></a><span class='hs-definition'>ratioConstr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkConstr</span> <span class='hs-varid'>ratioDataType</span> <span class='hs-str'>":%"</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>Infix</span>
<a name="line-1107"></a>
<a name="line-1108"></a><a name="ratioDataType"></a><span class='hs-definition'>ratioDataType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1109"></a><span class='hs-definition'>ratioDataType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataType</span> <span class='hs-str'>"GHC.Real.Ratio"</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ratioConstr</span><span class='hs-keyglyph'>]</span>
<a name="line-1110"></a>
<a name="line-1111"></a><span class='hs-comment'>-- NB: This Data instance intentionally uses the (%) smart constructor instead</span>
<a name="line-1112"></a><span class='hs-comment'>-- of the internal (:%) constructor to preserve the invariant that a Ratio</span>
<a name="line-1113"></a><span class='hs-comment'>-- value is reduced to normal form. See #10011.</span>
<a name="line-1114"></a>
<a name="line-1115"></a><a name="instance%20Data%20(Ratio%20a)"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1116"></a><a name="instance%20Data%20(Ratio%20a)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ratio</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1117"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-conop'>:%</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varop'>%</span><span class='hs-layout'>)</span> <span class='hs-varop'>`k`</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`k`</span> <span class='hs-varid'>b</span>
<a name="line-1118"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ratioConstr</span>
<a name="line-1119"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>constrIndex</span> <span class='hs-varid'>c</span> <span class='hs-varop'>==</span> <span class='hs-num'>1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varop'>%</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1120"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.gunfold(Ratio)"</span>
<a name="line-1121"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ratioDataType</span>
<a name="line-1122"></a>
<a name="line-1123"></a>
<a name="line-1124"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1125"></a>
<a name="line-1126"></a><a name="nilConstr"></a><span class='hs-definition'>nilConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span>
<a name="line-1127"></a><span class='hs-definition'>nilConstr</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkConstr</span> <span class='hs-varid'>listDataType</span> <span class='hs-str'>"[]"</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>Prefix</span>
<a name="line-1128"></a><a name="consConstr"></a><span class='hs-definition'>consConstr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Constr</span>
<a name="line-1129"></a><span class='hs-definition'>consConstr</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkConstr</span> <span class='hs-varid'>listDataType</span> <span class='hs-str'>"(:)"</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>Infix</span>
<a name="line-1130"></a>
<a name="line-1131"></a><a name="listDataType"></a><span class='hs-definition'>listDataType</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataType</span>
<a name="line-1132"></a><span class='hs-definition'>listDataType</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkDataType</span> <span class='hs-str'>"Prelude.[]"</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>nilConstr</span><span class='hs-layout'>,</span><span class='hs-varid'>consConstr</span><span class='hs-keyglyph'>]</span>
<a name="line-1133"></a>
<a name="line-1134"></a><a name="instance%20Data%20%5ba%5d"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1135"></a><a name="instance%20Data%20%5ba%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>where</span>
<a name="line-1136"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>z</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span> <span class='hs-conid'>[]</span>
<a name="line-1137"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-conop'>:</span><span class='hs-layout'>)</span> <span class='hs-varop'>`f`</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`f`</span> <span class='hs-varid'>xs</span>
<a name="line-1138"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-conid'>[]</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nilConstr</span>
<a name="line-1139"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>consConstr</span>
<a name="line-1140"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-varid'>k</span> <span class='hs-varid'>z</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>constrIndex</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>of</span>
<a name="line-1141"></a>                    <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>z</span> <span class='hs-conid'>[]</span>
<a name="line-1142"></a>                    <span class='hs-num'>2</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-conop'>:</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1143"></a>                    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.gunfold(List)"</span>
<a name="line-1144"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>listDataType</span>
<a name="line-1145"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-varid'>f</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast1</span> <span class='hs-varid'>f</span>
<a name="line-1146"></a>
<a name="line-1147"></a><span class='hs-comment'>--</span>
<a name="line-1148"></a><span class='hs-comment'>-- The gmaps are given as an illustration.</span>
<a name="line-1149"></a><span class='hs-comment'>-- This shows that the gmaps for lists are different from list maps.</span>
<a name="line-1150"></a><span class='hs-comment'>--</span>
<a name="line-1151"></a>  <span class='hs-varid'>gmapT</span>  <span class='hs-keyword'>_</span>   <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-1152"></a>  <span class='hs-varid'>gmapT</span>  <span class='hs-varid'>f</span>   <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>f</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<a name="line-1153"></a>  <span class='hs-varid'>gmapQ</span>  <span class='hs-keyword'>_</span>   <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span>
<a name="line-1154"></a>  <span class='hs-varid'>gmapQ</span>  <span class='hs-varid'>f</span>   <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>f</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>f</span> <span class='hs-varid'>xs</span><span class='hs-keyglyph'>]</span>
<a name="line-1155"></a>  <span class='hs-varid'>gmapM</span>  <span class='hs-keyword'>_</span>   <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <span class='hs-conid'>[]</span>
<a name="line-1156"></a>  <span class='hs-varid'>gmapM</span>  <span class='hs-varid'>f</span>   <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>x'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>f</span> <span class='hs-varid'>xs</span> <span class='hs-varop'>&gt;&gt;=</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>xs'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-layout'>(</span><span class='hs-varid'>x'</span><span class='hs-conop'>:</span><span class='hs-varid'>xs'</span><span class='hs-layout'>)</span>
<a name="line-1157"></a>
<a name="line-1158"></a>
<a name="line-1159"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1160"></a>
<a name="line-1161"></a><span class='hs-comment'>-- | @since 4.14.0.0</span>
<a name="line-1162"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span>
<a name="line-1163"></a>                   <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1164"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>WrappedArrow</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1165"></a>
<a name="line-1166"></a><span class='hs-comment'>-- | @since 4.14.0.0</span>
<a name="line-1167"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1168"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>WrappedMonad</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1169"></a>
<a name="line-1170"></a><span class='hs-comment'>-- | @since 4.14.0.0</span>
<a name="line-1171"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>ZipList</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1172"></a>
<a name="line-1173"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1174"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>NonEmpty</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1175"></a>
<a name="line-1176"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1177"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1178"></a>
<a name="line-1179"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1180"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Ordering</span>
<a name="line-1181"></a>
<a name="line-1182"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1183"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1184"></a>
<a name="line-1185"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1186"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>()</span>
<a name="line-1187"></a>
<a name="line-1188"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1189"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1190"></a>
<a name="line-1191"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1192"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-1193"></a>
<a name="line-1194"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1195"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-1196"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-1197"></a>
<a name="line-1198"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1199"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1200"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-1201"></a>
<a name="line-1202"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1203"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>e</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-1204"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>,</span><span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-1205"></a>
<a name="line-1206"></a><span class='hs-comment'>-- | @since 4.0.0.0</span>
<a name="line-1207"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>e</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<a name="line-1208"></a>         <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span><span class='hs-varid'>c</span><span class='hs-layout'>,</span><span class='hs-varid'>d</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>,</span><span class='hs-varid'>f</span><span class='hs-layout'>,</span><span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<a name="line-1209"></a>
<a name="line-1210"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1211"></a>
<a name="line-1212"></a><a name="instance%20Data%20(Ptr%20a)"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1213"></a><a name="instance%20Data%20(Ptr%20a)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1214"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyword'>_</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.toConstr(Ptr)"</span>
<a name="line-1215"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.gunfold(Ptr)"</span>
<a name="line-1216"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkNoRepType</span> <span class='hs-str'>"GHC.Ptr.Ptr"</span>
<a name="line-1217"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-varid'>x</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast1</span> <span class='hs-varid'>x</span>
<a name="line-1218"></a>
<a name="line-1219"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1220"></a>
<a name="line-1221"></a><a name="instance%20Data%20(ForeignPtr%20a)"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1222"></a><a name="instance%20Data%20(ForeignPtr%20a)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>ForeignPtr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-1223"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyword'>_</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.toConstr(ForeignPtr)"</span>
<a name="line-1224"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.gunfold(ForeignPtr)"</span>
<a name="line-1225"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkNoRepType</span> <span class='hs-str'>"GHC.ForeignPtr.ForeignPtr"</span>
<a name="line-1226"></a>  <span class='hs-varid'>dataCast1</span> <span class='hs-varid'>x</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast1</span> <span class='hs-varid'>x</span>
<a name="line-1227"></a>
<a name="line-1228"></a><span class='hs-comment'>-- | @since 4.11.0.0</span>
<a name="line-1229"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>IntPtr</span>
<a name="line-1230"></a>
<a name="line-1231"></a><span class='hs-comment'>-- | @since 4.11.0.0</span>
<a name="line-1232"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>WordPtr</span>
<a name="line-1233"></a>
<a name="line-1234"></a><a name="instance%20Data%20(Array%20a%20b)"></a><span class='hs-comment'>------------------------------------------------------------------------------</span>
<a name="line-1235"></a><a name="instance%20Data%20(Array%20a%20b)"></a><span class='hs-comment'>-- The Data instance for Array preserves data abstraction at the cost of</span>
<a name="line-1236"></a><a name="instance%20Data%20(Array%20a%20b)"></a><span class='hs-comment'>-- inefficiency. We omit reflection services for the sake of data abstraction.</span>
<a name="line-1237"></a><a name="instance%20Data%20(Array%20a%20b)"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1238"></a><a name="instance%20Data%20(Array%20a%20b)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ix</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Array</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1239"></a> <span class='hs-keyword'>where</span>
<a name="line-1240"></a>  <span class='hs-varid'>gfoldl</span> <span class='hs-varid'>f</span> <span class='hs-varid'>z</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>z</span> <span class='hs-layout'>(</span><span class='hs-varid'>listArray</span> <span class='hs-layout'>(</span><span class='hs-varid'>bounds</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>`f`</span> <span class='hs-layout'>(</span><span class='hs-varid'>elems</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1241"></a>  <span class='hs-varid'>toConstr</span> <span class='hs-keyword'>_</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.toConstr(Array)"</span>
<a name="line-1242"></a>  <span class='hs-varid'>gunfold</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>errorWithoutStackTrace</span> <span class='hs-str'>"Data.Data.gunfold(Array)"</span>
<a name="line-1243"></a>  <span class='hs-varid'>dataTypeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkNoRepType</span> <span class='hs-str'>"Data.Array.Array"</span>
<a name="line-1244"></a>  <span class='hs-varid'>dataCast2</span> <span class='hs-varid'>x</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcast2</span> <span class='hs-varid'>x</span>
<a name="line-1245"></a>
<a name="line-1246"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-1247"></a><span class='hs-comment'>-- Data instance for Proxy</span>
<a name="line-1248"></a>
<a name="line-1249"></a><span class='hs-comment'>-- | @since 4.7.0.0</span>
<a name="line-1250"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-1251"></a>
<a name="line-1252"></a><span class='hs-comment'>-- | @since 4.7.0.0</span>
<a name="line-1253"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-conop'>:~:</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1254"></a>
<a name="line-1255"></a><span class='hs-comment'>-- | @since 4.10.0.0</span>
<a name="line-1256"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-varid'>i</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>j</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span>
<a name="line-1257"></a>                    <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varop'>~~</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1258"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-conop'>:~~:</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1259"></a>
<a name="line-1260"></a><span class='hs-comment'>-- | @since 4.7.0.0</span>
<a name="line-1261"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Coercible</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Coercion</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1262"></a>
<a name="line-1263"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1264"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Identity</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1265"></a>
<a name="line-1266"></a><span class='hs-comment'>-- | @since 4.10.0.0</span>
<a name="line-1267"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Const</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-1268"></a>
<a name="line-1269"></a><span class='hs-comment'>-- | @since 4.7.0.0</span>
<a name="line-1270"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Version</span>
<a name="line-1271"></a>
<a name="line-1272"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-1273"></a><span class='hs-comment'>-- Data instances for Data.Monoid wrappers</span>
<a name="line-1274"></a>
<a name="line-1275"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1276"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dual</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1277"></a>
<a name="line-1278"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1279"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>All</span>
<a name="line-1280"></a>
<a name="line-1281"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1282"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Any</span>
<a name="line-1283"></a>
<a name="line-1284"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1285"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Sum</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1286"></a>
<a name="line-1287"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1288"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Product</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1289"></a>
<a name="line-1290"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1291"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>First</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1292"></a>
<a name="line-1293"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1294"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Last</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1295"></a>
<a name="line-1296"></a><span class='hs-comment'>-- | @since 4.8.0.0</span>
<a name="line-1297"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Alt</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1298"></a>
<a name="line-1299"></a><span class='hs-comment'>-- | @since 4.12.0.0</span>
<a name="line-1300"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ap</span> <span class='hs-varid'>f</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-1301"></a>
<a name="line-1302"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-1303"></a><span class='hs-comment'>-- Data instances for GHC.Generics representations</span>
<a name="line-1304"></a>
<a name="line-1305"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1306"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>U1</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1307"></a>
<a name="line-1308"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1309"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Par1</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1310"></a>
<a name="line-1311"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1312"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Rec1</span> <span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1313"></a>
<a name="line-1314"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1315"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-varid'>i</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>K1</span> <span class='hs-varid'>i</span> <span class='hs-varid'>c</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1316"></a>
<a name="line-1317"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1318"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>c</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>i</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span>
<a name="line-1319"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>M1</span> <span class='hs-varid'>i</span> <span class='hs-varid'>c</span> <span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1320"></a>
<a name="line-1321"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1322"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>g</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1323"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1324"></a>
<a name="line-1325"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1326"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Type</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-1327"></a>          <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1328"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-conop'>:.:</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1329"></a>
<a name="line-1330"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1331"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>V1</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1332"></a>
<a name="line-1333"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1334"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span> <span class='hs-varid'>g</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-varid'>g</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-1335"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-conop'>:*:</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-1336"></a>
<a name="line-1337"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1338"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Generics.Fixity</span>
<a name="line-1339"></a>
<a name="line-1340"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1341"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>Associativity</span>
<a name="line-1342"></a>
<a name="line-1343"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1344"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>SourceUnpackedness</span>
<a name="line-1345"></a>
<a name="line-1346"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1347"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>SourceStrictness</span>
<a name="line-1348"></a>
<a name="line-1349"></a><span class='hs-comment'>-- | @since 4.9.0.0</span>
<a name="line-1350"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-conid'>DecidedStrictness</span>
<a name="line-1351"></a>
<a name="line-1352"></a><span class='hs-comment'>----------------------------------------------------------------------------</span>
<a name="line-1353"></a><span class='hs-comment'>-- Data instances for Data.Ord</span>
<a name="line-1354"></a>
<a name="line-1355"></a><span class='hs-comment'>-- | @since 4.12.0.0</span>
<a name="line-1356"></a><span class='hs-keyword'>deriving</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Data</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Down</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
</pre></body>
</html>
