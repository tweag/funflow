<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.ForeignPtr</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">base-4.14.3.0: Basic libraries</span><ul class="links" id="page-menu"><li><a href="src/GHC-ForeignPtr.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) The University of Glasgow 1992-2003</td></tr><tr><th>License</th><td>see libraries/base/LICENSE</td></tr><tr><th>Maintainer</th><td>cvs-ghc@haskell.org</td></tr><tr><th>Stability</th><td>internal</td></tr><tr><th>Portability</th><td>non-portable (GHC extensions)</td></tr><tr><th>Safe Haskell</th><td>Unsafe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.ForeignPtr</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>GHC's implementation of the <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> data type.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:ForeignPtr">ForeignPtr</a> a = <a href="#v:ForeignPtr">ForeignPtr</a> <a href="GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> <a href="GHC-ForeignPtr.html#t:ForeignPtrContents" title="GHC.ForeignPtr">ForeignPtrContents</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ForeignPtrContents">ForeignPtrContents</a><ul class="subs"><li>= <a href="#v:PlainForeignPtr">PlainForeignPtr</a> !(<a href="Data-IORef.html#t:IORef" title="Data.IORef">IORef</a> <a href="GHC-ForeignPtr.html#t:Finalizers" title="GHC.ForeignPtr">Finalizers</a>)</li><li>| <a href="#v:MallocPtr">MallocPtr</a> (<a href="GHC-Exts.html#t:MutableByteArray-35-" title="GHC.Exts">MutableByteArray#</a> <a href="Control-Monad-ST-Safe.html#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a>) !(<a href="Data-IORef.html#t:IORef" title="Data.IORef">IORef</a> <a href="GHC-ForeignPtr.html#t:Finalizers" title="GHC.ForeignPtr">Finalizers</a>)</li><li>| <a href="#v:PlainPtr">PlainPtr</a> (<a href="GHC-Exts.html#t:MutableByteArray-35-" title="GHC.Exts">MutableByteArray#</a> <a href="Control-Monad-ST-Safe.html#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a>)</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Finalizers">Finalizers</a><ul class="subs"><li>= <a href="#v:NoFinalizers">NoFinalizers</a></li><li>| <a href="#v:CFinalizers">CFinalizers</a> (<a href="GHC-Exts.html#t:Weak-35-" title="GHC.Exts">Weak#</a> ())</li><li>| <a href="#v:HaskellFinalizers">HaskellFinalizers</a> [<a href="System-IO.html#t:IO" title="System.IO">IO</a> ()]</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:FinalizerPtr">FinalizerPtr</a> a = <a href="Foreign-Ptr.html#t:FunPtr" title="Foreign.Ptr">FunPtr</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ())</li><li class="src short"><span class="keyword">type</span> <a href="#t:FinalizerEnvPtr">FinalizerEnvPtr</a> env a = <a href="Foreign-Ptr.html#t:FunPtr" title="Foreign.Ptr">FunPtr</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> env -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ())</li><li class="src short"><a href="#v:newForeignPtr_">newForeignPtr_</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocForeignPtr">mallocForeignPtr</a> :: <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocPlainForeignPtr">mallocPlainForeignPtr</a> :: <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocForeignPtrBytes">mallocForeignPtrBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocPlainForeignPtrBytes">mallocPlainForeignPtrBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocForeignPtrAlignedBytes">mallocForeignPtrAlignedBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:mallocPlainForeignPtrAlignedBytes">mallocPlainForeignPtrAlignedBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:addForeignPtrFinalizer">addForeignPtrFinalizer</a> :: <a href="GHC-ForeignPtr.html#t:FinalizerPtr" title="GHC.ForeignPtr">FinalizerPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:addForeignPtrFinalizerEnv">addForeignPtrFinalizerEnv</a> :: <a href="GHC-ForeignPtr.html#t:FinalizerEnvPtr" title="GHC.ForeignPtr">FinalizerEnvPtr</a> env a -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> env -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:touchForeignPtr">touchForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:unsafeForeignPtrToPtr">unsafeForeignPtrToPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a</li><li class="src short"><a href="#v:castForeignPtr">castForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> b</li><li class="src short"><a href="#v:plusForeignPtr">plusForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> b</li><li class="src short"><a href="#v:newConcForeignPtr">newConcForeignPtr</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</li><li class="src short"><a href="#v:addForeignPtrConcFinalizer">addForeignPtrConcFinalizer</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:finalizeForeignPtr">finalizeForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ForeignPtr" class="def">ForeignPtr</a> a <a href="src/GHC-ForeignPtr.html#ForeignPtr" class="link">Source</a> <a href="#t:ForeignPtr" class="selflink">#</a></p><div class="doc"><p>The type <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> represents references to objects that are
 maintained in a foreign language, i.e., that are not part of the
 data structures usually managed by the Haskell storage manager.
 The essential difference between <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code>s and vanilla memory
 references of type <code>Ptr a</code> is that the former may be associated
 with <em>finalizers</em>. A finalizer is a routine that is invoked when
 the Haskell storage manager detects that - within the Haskell heap
 and stack - there are no more references left that are pointing to
 the <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code>.  Typically, the finalizer will, then, invoke
 routines in the foreign language that free the resources bound by
 the foreign object.</p><p>The <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> is parameterised in the same way as <code><a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a></code>.  The
 type argument of <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> should normally be an instance of
 class <code><a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ForeignPtr" class="def">ForeignPtr</a> <a href="GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> <a href="GHC-ForeignPtr.html#t:ForeignPtrContents" title="GHC.ForeignPtr">ForeignPtrContents</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ForeignPtr">Instances</h4><details id="i:ForeignPtr" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ForeignPtr:Eq:1"></span> <a href="Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</span> <a href="#t:ForeignPtr" class="selflink">#</a></td><td class="doc"><p><em>Since: base-2.1</em></p></td></tr><tr><td colspan="2"><details id="i:id:ForeignPtr:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-ForeignPtr.html">GHC.ForeignPtr</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%3D%3D" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%2F%3D" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ForeignPtr:Data:2"></span> <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> a =&gt; <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</span> <a href="#t:Data" class="selflink">#</a></td><td class="doc"><p><em>Since: base-4.8.0.0</em></p></td></tr><tr><td colspan="2"><details id="i:id:ForeignPtr:Data:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Data.html">Data.Data</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:gfoldl">gfoldl</a> :: (<span class="keyword">forall</span> d b. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; c (d -&gt; b) -&gt; d -&gt; c b) -&gt; (<span class="keyword">forall</span> g. g -&gt; c g) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; c (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/Data-Data.html#gfoldl" class="link">Source</a> <a href="#v:gfoldl" class="selflink">#</a></p><p class="src"><a href="#v:gunfold">gunfold</a> :: (<span class="keyword">forall</span> b r. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> b =&gt; c (b -&gt; r) -&gt; c r) -&gt; (<span class="keyword">forall</span> r. r -&gt; c r) -&gt; <a href="Data-Data.html#t:Constr" title="Data.Data">Constr</a> -&gt; c (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/Data-Data.html#gunfold" class="link">Source</a> <a href="#v:gunfold" class="selflink">#</a></p><p class="src"><a href="#v:toConstr">toConstr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Data.html#t:Constr" title="Data.Data">Constr</a> <a href="src/Data-Data.html#toConstr" class="link">Source</a> <a href="#v:toConstr" class="selflink">#</a></p><p class="src"><a href="#v:dataTypeOf">dataTypeOf</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Data.html#t:DataType" title="Data.Data">DataType</a> <a href="src/Data-Data.html#dataTypeOf" class="link">Source</a> <a href="#v:dataTypeOf" class="selflink">#</a></p><p class="src"><a href="#v:dataCast1">dataCast1</a> :: <a href="Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t =&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; c (t d)) -&gt; <a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (c (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)) <a href="src/Data-Data.html#dataCast1" class="link">Source</a> <a href="#v:dataCast1" class="selflink">#</a></p><p class="src"><a href="#v:dataCast2">dataCast2</a> :: <a href="Type-Reflection.html#t:Typeable" title="Type.Reflection">Typeable</a> t =&gt; (<span class="keyword">forall</span> d e. (<a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d, <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> e) =&gt; c (t d e)) -&gt; <a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (c (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)) <a href="src/Data-Data.html#dataCast2" class="link">Source</a> <a href="#v:dataCast2" class="selflink">#</a></p><p class="src"><a href="#v:gmapT">gmapT</a> :: (<span class="keyword">forall</span> b. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> b =&gt; b -&gt; b) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a <a href="src/Data-Data.html#gmapT" class="link">Source</a> <a href="#v:gmapT" class="selflink">#</a></p><p class="src"><a href="#v:gmapQl">gmapQl</a> :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; r') -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; r <a href="src/Data-Data.html#gmapQl" class="link">Source</a> <a href="#v:gmapQl" class="selflink">#</a></p><p class="src"><a href="#v:gmapQr">gmapQr</a> :: <span class="keyword">forall</span> r r'. (r' -&gt; r -&gt; r) -&gt; r -&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; r') -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; r <a href="src/Data-Data.html#gmapQr" class="link">Source</a> <a href="#v:gmapQr" class="selflink">#</a></p><p class="src"><a href="#v:gmapQ">gmapQ</a> :: (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; u) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; [u] <a href="src/Data-Data.html#gmapQ" class="link">Source</a> <a href="#v:gmapQ" class="selflink">#</a></p><p class="src"><a href="#v:gmapQi">gmapQi</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; u) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; u <a href="src/Data-Data.html#gmapQi" class="link">Source</a> <a href="#v:gmapQi" class="selflink">#</a></p><p class="src"><a href="#v:gmapM">gmapM</a> :: <a href="Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; m d) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; m (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/Data-Data.html#gmapM" class="link">Source</a> <a href="#v:gmapM" class="selflink">#</a></p><p class="src"><a href="#v:gmapMp">gmapMp</a> :: <a href="Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; m d) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; m (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/Data-Data.html#gmapMp" class="link">Source</a> <a href="#v:gmapMp" class="selflink">#</a></p><p class="src"><a href="#v:gmapMo">gmapMo</a> :: <a href="Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; (<span class="keyword">forall</span> d. <a href="Data-Data.html#t:Data" title="Data.Data">Data</a> d =&gt; d -&gt; m d) -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; m (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/Data-Data.html#gmapMo" class="link">Source</a> <a href="#v:gmapMo" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ForeignPtr:Ord:3"></span> <a href="Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</span> <a href="#t:ForeignPtr" class="selflink">#</a></td><td class="doc"><p><em>Since: base-2.1</em></p></td></tr><tr><td colspan="2"><details id="i:id:ForeignPtr:Ord:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-ForeignPtr.html">GHC.ForeignPtr</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#compare" class="link">Source</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%3C" class="link">Source</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%3C%3D" class="link">Source</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%3E" class="link">Source</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#%3E%3D" class="link">Source</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#max" class="link">Source</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a <a href="../ghc-prim-0.6.1/src/GHC-Classes.html#min" class="link">Source</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ForeignPtr:Show:4"></span> <a href="Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a)</span> <a href="#t:ForeignPtr" class="selflink">#</a></td><td class="doc"><p><em>Since: base-2.1</em></p></td></tr><tr><td colspan="2"><details id="i:id:ForeignPtr:Show:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="GHC-ForeignPtr.html">GHC.ForeignPtr</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="src/GHC-Show.html#showsPrec" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-String.html#t:String" title="Data.String">String</a> <a href="src/GHC-Show.html#show" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a] -&gt; <a href="Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="src/GHC-Show.html#showList" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ForeignPtrContents" class="def">ForeignPtrContents</a> <a href="src/GHC-ForeignPtr.html#ForeignPtrContents" class="link">Source</a> <a href="#t:ForeignPtrContents" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PlainForeignPtr" class="def">PlainForeignPtr</a> !(<a href="Data-IORef.html#t:IORef" title="Data.IORef">IORef</a> <a href="GHC-ForeignPtr.html#t:Finalizers" title="GHC.ForeignPtr">Finalizers</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:MallocPtr" class="def">MallocPtr</a> (<a href="GHC-Exts.html#t:MutableByteArray-35-" title="GHC.Exts">MutableByteArray#</a> <a href="Control-Monad-ST-Safe.html#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a>) !(<a href="Data-IORef.html#t:IORef" title="Data.IORef">IORef</a> <a href="GHC-ForeignPtr.html#t:Finalizers" title="GHC.ForeignPtr">Finalizers</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PlainPtr" class="def">PlainPtr</a> (<a href="GHC-Exts.html#t:MutableByteArray-35-" title="GHC.Exts">MutableByteArray#</a> <a href="Control-Monad-ST-Safe.html#t:RealWorld" title="Control.Monad.ST.Safe">RealWorld</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Finalizers" class="def">Finalizers</a> <a href="src/GHC-ForeignPtr.html#Finalizers" class="link">Source</a> <a href="#t:Finalizers" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:NoFinalizers" class="def">NoFinalizers</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CFinalizers" class="def">CFinalizers</a> (<a href="GHC-Exts.html#t:Weak-35-" title="GHC.Exts">Weak#</a> ())</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:HaskellFinalizers" class="def">HaskellFinalizers</a> [<a href="System-IO.html#t:IO" title="System.IO">IO</a> ()]</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FinalizerPtr" class="def">FinalizerPtr</a> a = <a href="Foreign-Ptr.html#t:FunPtr" title="Foreign.Ptr">FunPtr</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()) <a href="src/GHC-ForeignPtr.html#FinalizerPtr" class="link">Source</a> <a href="#t:FinalizerPtr" class="selflink">#</a></p><div class="doc"><p>A finalizer is represented as a pointer to a foreign function that, at
 finalisation time, gets as an argument a plain pointer variant of the
 foreign pointer that the finalizer is associated with.</p><p>Note that the foreign function <em>must</em> use the <code>ccall</code> calling convention.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:FinalizerEnvPtr" class="def">FinalizerEnvPtr</a> env a = <a href="Foreign-Ptr.html#t:FunPtr" title="Foreign.Ptr">FunPtr</a> (<a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> env -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> ()) <a href="src/GHC-ForeignPtr.html#FinalizerEnvPtr" class="link">Source</a> <a href="#t:FinalizerEnvPtr" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:newForeignPtr_" class="def">newForeignPtr_</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#newForeignPtr_" class="link">Source</a> <a href="#v:newForeignPtr_" class="selflink">#</a></p><div class="doc"><p>Turns a plain memory reference into a foreign pointer that may be
 associated with finalizers by using <code><a href="GHC-ForeignPtr.html#v:addForeignPtrFinalizer" title="GHC.ForeignPtr">addForeignPtrFinalizer</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:mallocForeignPtr" class="def">mallocForeignPtr</a> :: <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocForeignPtr" class="link">Source</a> <a href="#v:mallocForeignPtr" class="selflink">#</a></p><div class="doc"><p>Allocate some memory and return a <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> to it.  The memory
 will be released automatically when the <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> is discarded.</p><p><code><a href="GHC-ForeignPtr.html#v:mallocForeignPtr" title="GHC.ForeignPtr">mallocForeignPtr</a></code> is equivalent to</p><pre>   do { p &lt;- malloc; newForeignPtr finalizerFree p }</pre><p>although it may be implemented differently internally: you may not
 assume that the memory returned by <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtr" title="GHC.ForeignPtr">mallocForeignPtr</a></code> has been
 allocated with <code><a href="Foreign-Marshal-Alloc.html#v:malloc" title="Foreign.Marshal.Alloc">malloc</a></code>.</p><p>GHC notes: <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtr" title="GHC.ForeignPtr">mallocForeignPtr</a></code> has a heavily optimised
 implementation in GHC.  It uses pinned memory in the garbage
 collected heap, so the <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> does not require a finalizer to
 free the memory.  Use of <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtr" title="GHC.ForeignPtr">mallocForeignPtr</a></code> and associated
 functions is strongly recommended in preference to
 <code><a href="Foreign-ForeignPtr.html#v:newForeignPtr" title="Foreign.ForeignPtr">newForeignPtr</a></code> with a finalizer.</p></div></div><div class="top"><p class="src"><a id="v:mallocPlainForeignPtr" class="def">mallocPlainForeignPtr</a> :: <a href="Foreign-Storable.html#t:Storable" title="Foreign.Storable">Storable</a> a =&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocPlainForeignPtr" class="link">Source</a> <a href="#v:mallocPlainForeignPtr" class="selflink">#</a></p><div class="doc"><p>Allocate some memory and return a <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> to it.  The memory
 will be released automatically when the <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> is discarded.</p><p>GHC notes: <code><a href="GHC-ForeignPtr.html#v:mallocPlainForeignPtr" title="GHC.ForeignPtr">mallocPlainForeignPtr</a></code> has a heavily optimised
 implementation in GHC.  It uses pinned memory in the garbage
 collected heap, as for mallocForeignPtr. Unlike mallocForeignPtr, a
 ForeignPtr created with mallocPlainForeignPtr carries no finalizers.
 It is not possible to add a finalizer to a ForeignPtr created with
 mallocPlainForeignPtr. This is useful for ForeignPtrs that will live
 only inside Haskell (such as those created for packed strings).
 Attempts to add a finalizer to a ForeignPtr created this way, or to
 finalize such a pointer, will throw an exception.</p></div></div><div class="top"><p class="src"><a id="v:mallocForeignPtrBytes" class="def">mallocForeignPtrBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocForeignPtrBytes" class="link">Source</a> <a href="#v:mallocForeignPtrBytes" class="selflink">#</a></p><div class="doc"><p>This function is similar to <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtr" title="GHC.ForeignPtr">mallocForeignPtr</a></code>, except that the
 size of the memory required is given explicitly as a number of bytes.</p></div></div><div class="top"><p class="src"><a id="v:mallocPlainForeignPtrBytes" class="def">mallocPlainForeignPtrBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocPlainForeignPtrBytes" class="link">Source</a> <a href="#v:mallocPlainForeignPtrBytes" class="selflink">#</a></p><div class="doc"><p>This function is similar to <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtrBytes" title="GHC.ForeignPtr">mallocForeignPtrBytes</a></code>, except that
 the internally an optimised ForeignPtr representation with no
 finalizer is used. Attempts to add a finalizer will cause an
 exception to be thrown.</p></div></div><div class="top"><p class="src"><a id="v:mallocForeignPtrAlignedBytes" class="def">mallocForeignPtrAlignedBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocForeignPtrAlignedBytes" class="link">Source</a> <a href="#v:mallocForeignPtrAlignedBytes" class="selflink">#</a></p><div class="doc"><p>This function is similar to <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtrBytes" title="GHC.ForeignPtr">mallocForeignPtrBytes</a></code>, except that the
 size and alignment of the memory required is given explicitly as numbers of
 bytes.</p></div></div><div class="top"><p class="src"><a id="v:mallocPlainForeignPtrAlignedBytes" class="def">mallocPlainForeignPtrAlignedBytes</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#mallocPlainForeignPtrAlignedBytes" class="link">Source</a> <a href="#v:mallocPlainForeignPtrAlignedBytes" class="selflink">#</a></p><div class="doc"><p>This function is similar to <code><a href="GHC-ForeignPtr.html#v:mallocForeignPtrAlignedBytes" title="GHC.ForeignPtr">mallocForeignPtrAlignedBytes</a></code>, except that
 the internally an optimised ForeignPtr representation with no
 finalizer is used. Attempts to add a finalizer will cause an
 exception to be thrown.</p></div></div><div class="top"><p class="src"><a id="v:addForeignPtrFinalizer" class="def">addForeignPtrFinalizer</a> :: <a href="GHC-ForeignPtr.html#t:FinalizerPtr" title="GHC.ForeignPtr">FinalizerPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC-ForeignPtr.html#addForeignPtrFinalizer" class="link">Source</a> <a href="#v:addForeignPtrFinalizer" class="selflink">#</a></p><div class="doc"><p>This function adds a finalizer to the given foreign object.  The
 finalizer will run <em>before</em> all other finalizers for the same
 object which have already been registered.</p></div></div><div class="top"><p class="src"><a id="v:addForeignPtrFinalizerEnv" class="def">addForeignPtrFinalizerEnv</a> :: <a href="GHC-ForeignPtr.html#t:FinalizerEnvPtr" title="GHC.ForeignPtr">FinalizerEnvPtr</a> env a -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> env -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC-ForeignPtr.html#addForeignPtrFinalizerEnv" class="link">Source</a> <a href="#v:addForeignPtrFinalizerEnv" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="GHC-ForeignPtr.html#v:addForeignPtrFinalizer" title="GHC.ForeignPtr">addForeignPtrFinalizer</a></code> but the finalizer is passed an additional
 environment parameter.</p></div></div><div class="top"><p class="src"><a id="v:touchForeignPtr" class="def">touchForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC-ForeignPtr.html#touchForeignPtr" class="link">Source</a> <a href="#v:touchForeignPtr" class="selflink">#</a></p><div class="doc"><p>This function ensures that the foreign object in
 question is alive at the given place in the sequence of IO
 actions. In particular <code><a href="Foreign-ForeignPtr.html#v:withForeignPtr" title="Foreign.ForeignPtr">withForeignPtr</a></code>
 does a <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code> after it
 executes the user action.</p><p>Note that this function should not be used to express dependencies
 between finalizers on <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code>s.  For example, if the finalizer
 for a <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> <code>F1</code> calls <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code> on a second
 <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> <code>F2</code>, then the only guarantee is that the finalizer
 for <code>F2</code> is never started before the finalizer for <code>F1</code>.  They
 might be started together if for example both <code>F1</code> and <code>F2</code> are
 otherwise unreachable, and in that case the scheduler might end up
 running the finalizer for <code>F2</code> first.</p><p>In general, it is not recommended to use finalizers on separate
 objects with ordering constraints between them.  To express the
 ordering robustly requires explicit synchronisation using <code>MVar</code>s
 between the finalizers, but even then the runtime sometimes runs
 multiple finalizers sequentially in a single thread (for
 performance reasons), so synchronisation between finalizers could
 result in artificial deadlock.  Another alternative is to use
 explicit reference counting.</p></div></div><div class="top"><p class="src"><a id="v:unsafeForeignPtrToPtr" class="def">unsafeForeignPtrToPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a <a href="src/GHC-ForeignPtr.html#unsafeForeignPtrToPtr" class="link">Source</a> <a href="#v:unsafeForeignPtrToPtr" class="selflink">#</a></p><div class="doc"><p>This function extracts the pointer component of a foreign
 pointer.  This is a potentially dangerous operations, as if the
 argument to <code><a href="GHC-ForeignPtr.html#v:unsafeForeignPtrToPtr" title="GHC.ForeignPtr">unsafeForeignPtrToPtr</a></code> is the last usage
 occurrence of the given foreign pointer, then its finalizer(s) will
 be run, which potentially invalidates the plain pointer just
 obtained.  Hence, <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code> must be used
 wherever it has to be guaranteed that the pointer lives on - i.e.,
 has another usage occurrence.</p><p>To avoid subtle coding errors, hand written marshalling code
 should preferably use <code><a href="Foreign-ForeignPtr.html#v:withForeignPtr" title="Foreign.ForeignPtr">withForeignPtr</a></code> rather
 than combinations of <code><a href="GHC-ForeignPtr.html#v:unsafeForeignPtrToPtr" title="GHC.ForeignPtr">unsafeForeignPtrToPtr</a></code> and
 <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code>.  However, the latter routines
 are occasionally preferred in tool generated marshalling code.</p></div></div><div class="top"><p class="src"><a id="v:castForeignPtr" class="def">castForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> b <a href="src/GHC-ForeignPtr.html#castForeignPtr" class="link">Source</a> <a href="#v:castForeignPtr" class="selflink">#</a></p><div class="doc"><p>This function casts a <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code>
 parameterised by one type into another type.</p></div></div><div class="top"><p class="src"><a id="v:plusForeignPtr" class="def">plusForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> b <a href="src/GHC-ForeignPtr.html#plusForeignPtr" class="link">Source</a> <a href="#v:plusForeignPtr" class="selflink">#</a></p><div class="doc"><p>Advances the given address by the given offset in bytes.</p><p>The new <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> shares the finalizer of the original,
 equivalent from a finalization standpoint to just creating another
 reference to the original. That is, the finalizer will not be
 called before the new <code><a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a></code> is unreachable, nor will it be
 called an additional time due to this call, and the finalizer will
 be called with the same address that it would have had this call
 not happened, *not* the new address.</p><p><em>Since: base-4.10.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:newConcForeignPtr" class="def">newConcForeignPtr</a> :: <a href="Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> (<a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a) <a href="src/GHC-ForeignPtr.html#newConcForeignPtr" class="link">Source</a> <a href="#v:newConcForeignPtr" class="selflink">#</a></p><div class="doc"><p>Turns a plain memory reference into a foreign object by
 associating a finalizer - given by the monadic operation - with the
 reference.  The storage manager will start the finalizer, in a
 separate thread, some time after the last reference to the
 <code>ForeignPtr</code> is dropped.  There is no guarantee of promptness, and
 in fact there is no guarantee that the finalizer will eventually
 run at all.</p><p>Note that references from a finalizer do not necessarily prevent
 another object from being finalized.  If A's finalizer refers to B
 (perhaps using <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code>, then the only guarantee is that
 B's finalizer will never be started before A's.  If both A and B
 are unreachable, then both finalizers will start together.  See
 <code><a href="GHC-ForeignPtr.html#v:touchForeignPtr" title="GHC.ForeignPtr">touchForeignPtr</a></code> for more on finalizer ordering.</p></div></div><div class="top"><p class="src"><a id="v:addForeignPtrConcFinalizer" class="def">addForeignPtrConcFinalizer</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC-ForeignPtr.html#addForeignPtrConcFinalizer" class="link">Source</a> <a href="#v:addForeignPtrConcFinalizer" class="selflink">#</a></p><div class="doc"><p>This function adds a finalizer to the given <code>ForeignPtr</code>.  The
 finalizer will run <em>before</em> all other finalizers for the same
 object which have already been registered.</p><p>This is a variant of <code>addForeignPtrFinalizer</code>, where the finalizer
 is an arbitrary <code>IO</code> action.  When it is invoked, the finalizer
 will run in a new thread.</p><p>NB. Be very careful with these finalizers.  One common trap is that
 if a finalizer references another finalized value, it does not
 prevent that value from being finalized.  In particular, <code><a href="System-IO.html#v:Handle" title="System.IO">Handle</a></code>s
 are finalized objects, so a finalizer should not refer to a
 <code><a href="System-IO.html#v:Handle" title="System.IO">Handle</a></code> (including <code><a href="System-IO.html#v:stdout" title="System.IO">stdout</a></code>, <code><a href="System-IO.html#v:stdin" title="System.IO">stdin</a></code>, or
 <code><a href="System-IO.html#v:stderr" title="System.IO">stderr</a></code>).</p></div></div><div class="top"><p class="src"><a id="v:finalizeForeignPtr" class="def">finalizeForeignPtr</a> :: <a href="GHC-ForeignPtr.html#t:ForeignPtr" title="GHC.ForeignPtr">ForeignPtr</a> a -&gt; <a href="System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/GHC-ForeignPtr.html#finalizeForeignPtr" class="link">Source</a> <a href="#v:finalizeForeignPtr" class="selflink">#</a></p><div class="doc"><p>Causes the finalizers associated with a foreign pointer to be run
 immediately.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>