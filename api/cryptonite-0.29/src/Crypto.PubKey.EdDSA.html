<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.PubKey.EdDSA</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- EdDSA signature generation and verification, implemented in Haskell and</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- parameterized with elliptic curve and hash algorithm.  Only edwards25519 is</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- supported at the moment.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- The module provides \&quot;context\&quot; and \&quot;prehash\&quot; variants defined in</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &lt;https://tools.ietf.org/html/rfc8032 RFC 8032&gt;.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- This implementation is most useful when wanting to customize the hash</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- algorithm.  See module &quot;Crypto.PubKey.Ed25519&quot; for faster Ed25519 with</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- SHA-512.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE DataKinds                  #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts           #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes                 #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables        #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies               #-}</span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.PubKey.EdDSA</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier">SecretKey</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier">PublicKey</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier">Signature</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Curves with EdDSA implementation</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier">EllipticCurveEdDSA</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier">CurveDigestSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier">publicKeySize</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier">secretKeySize</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier">signatureSize</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Smart constructors</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword">signature</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier">publicKey</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier">secretKey</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Methods</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier">toPublic</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier">sign</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier">signCtx</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier">signPh</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier">verifyCtx</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier">verifyPh</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier">generateSecretKey</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArray</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Bytes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScrubbedBytes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">View</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.ECC.html"><span class="hs-identifier">Crypto.ECC</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.ECC.Edwards25519.html"><span class="hs-identifier">Crypto.ECC.Edwards25519</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Edwards25519</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Error.html"><span class="hs-identifier">Crypto.Error</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Hash.html"><span class="hs-identifier">Crypto.Hash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier">Digest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Hash.IO.html"><span class="hs-identifier">Crypto.Hash.IO</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Random.html"><span class="hs-identifier">Crypto.Random</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Builder.html"><span class="hs-identifier">Crypto.Internal.Builder</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Compat.html"><span class="hs-identifier">Crypto.Internal.Compat</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Imports.html"><span class="hs-identifier">Crypto.Internal.Imports</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Nat.html"><span class="hs-identifier">Crypto.Internal.Nat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier">integralNatVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign.Storable</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- API</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | An EdDSA Secret key</span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="SecretKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span></span><span> </span><span id="local-6989586621679210939"><span class="annot"><a href="#local-6989586621679210939"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SecretKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScrubbedBytes</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210698"><span id="local-6989586621679210700"><span id="local-6989586621679210702"><span class="annot"><span class="annottext">Int -&gt; SecretKey curve -&gt; ShowS
[SecretKey curve] -&gt; ShowS
SecretKey curve -&gt; String
(Int -&gt; SecretKey curve -&gt; ShowS)
-&gt; (SecretKey curve -&gt; String)
-&gt; ([SecretKey curve] -&gt; ShowS)
-&gt; Show (SecretKey curve)
forall curve. Int -&gt; SecretKey curve -&gt; ShowS
forall curve. [SecretKey curve] -&gt; ShowS
forall curve. SecretKey curve -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SecretKey curve] -&gt; ShowS
$cshowList :: forall curve. [SecretKey curve] -&gt; ShowS
show :: SecretKey curve -&gt; String
$cshow :: forall curve. SecretKey curve -&gt; String
showsPrec :: Int -&gt; SecretKey curve -&gt; ShowS
$cshowsPrec :: forall curve. Int -&gt; SecretKey curve -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210693"><span id="local-6989586621679210695"><span class="annot"><span class="annottext">SecretKey curve -&gt; SecretKey curve -&gt; Bool
(SecretKey curve -&gt; SecretKey curve -&gt; Bool)
-&gt; (SecretKey curve -&gt; SecretKey curve -&gt; Bool)
-&gt; Eq (SecretKey curve)
forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SecretKey curve -&gt; SecretKey curve -&gt; Bool
$c/= :: forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
== :: SecretKey curve -&gt; SecretKey curve -&gt; Bool
$c== :: forall curve. SecretKey curve -&gt; SecretKey curve -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210686"><span id="local-6989586621679210688"><span id="local-6989586621679210690"><span class="annot"><span class="annottext">SecretKey curve -&gt; Int
SecretKey curve -&gt; Ptr p -&gt; IO ()
SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
(SecretKey curve -&gt; Int)
-&gt; (forall p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. SecretKey curve -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess (SecretKey curve)
forall curve. SecretKey curve -&gt; Int
forall p. SecretKey curve -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve p. SecretKey curve -&gt; Ptr p -&gt; IO ()
forall p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: SecretKey curve -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve p. SecretKey curve -&gt; Ptr p -&gt; IO ()
withByteArray :: SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve p a. SecretKey curve -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: SecretKey curve -&gt; Int
$clength :: forall curve. SecretKey curve -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210683"><span class="annot"><span class="annottext">SecretKey curve -&gt; ()
(SecretKey curve -&gt; ()) -&gt; NFData (SecretKey curve)
forall curve. SecretKey curve -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: SecretKey curve -&gt; ()
$crnf :: forall curve. SecretKey curve -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | An EdDSA public key</span><span>
</span><span id="line-80"></span><span class="hs-keyword">newtype</span><span> </span><span id="PublicKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span id="local-6989586621679210954"><span class="annot"><a href="#local-6989586621679210954"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679210953"><span class="annot"><a href="#local-6989586621679210953"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PublicKey"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210675"><span id="local-6989586621679210677"><span id="local-6989586621679210679"><span class="annot"><span class="annottext">Int -&gt; PublicKey curve hash -&gt; ShowS
[PublicKey curve hash] -&gt; ShowS
PublicKey curve hash -&gt; String
(Int -&gt; PublicKey curve hash -&gt; ShowS)
-&gt; (PublicKey curve hash -&gt; String)
-&gt; ([PublicKey curve hash] -&gt; ShowS)
-&gt; Show (PublicKey curve hash)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall curve hash. Int -&gt; PublicKey curve hash -&gt; ShowS
forall curve hash. [PublicKey curve hash] -&gt; ShowS
forall curve hash. PublicKey curve hash -&gt; String
showList :: [PublicKey curve hash] -&gt; ShowS
$cshowList :: forall curve hash. [PublicKey curve hash] -&gt; ShowS
show :: PublicKey curve hash -&gt; String
$cshow :: forall curve hash. PublicKey curve hash -&gt; String
showsPrec :: Int -&gt; PublicKey curve hash -&gt; ShowS
$cshowsPrec :: forall curve hash. Int -&gt; PublicKey curve hash -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210671"><span id="local-6989586621679210673"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
(PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool)
-&gt; (PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool)
-&gt; Eq (PublicKey curve hash)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
/= :: PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
$c/= :: forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
== :: PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
$c== :: forall curve hash.
PublicKey curve hash -&gt; PublicKey curve hash -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210665"><span id="local-6989586621679210667"><span id="local-6989586621679210669"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; Int
PublicKey curve hash -&gt; Ptr p -&gt; IO ()
PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
(PublicKey curve hash -&gt; Int)
-&gt; (forall p a. PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. PublicKey curve hash -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess (PublicKey curve hash)
forall p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve hash. PublicKey curve hash -&gt; Int
forall p a. PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve hash p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
forall curve hash p a.
PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: PublicKey curve hash -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve hash p. PublicKey curve hash -&gt; Ptr p -&gt; IO ()
withByteArray :: PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve hash p a.
PublicKey curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: PublicKey curve hash -&gt; Int
$clength :: forall curve hash. PublicKey curve hash -&gt; Int
</span><a href="#local-6989586621679210665"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210663"><span class="annot"><span class="annottext">PublicKey curve hash -&gt; ()
(PublicKey curve hash -&gt; ()) -&gt; NFData (PublicKey curve hash)
forall a. (a -&gt; ()) -&gt; NFData a
forall curve hash. PublicKey curve hash -&gt; ()
rnf :: PublicKey curve hash -&gt; ()
$crnf :: forall curve hash. PublicKey curve hash -&gt; ()
</span><a href="#local-6989586621679210663"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | An EdDSA signature</span><span>
</span><span id="line-84"></span><span class="hs-keyword">newtype</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span id="local-6989586621679210934"><span class="annot"><a href="#local-6989586621679210934"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679210933"><span class="annot"><a href="#local-6989586621679210933"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210656"><span id="local-6989586621679210658"><span id="local-6989586621679210660"><span class="annot"><span class="annottext">Int -&gt; Signature curve hash -&gt; ShowS
[Signature curve hash] -&gt; ShowS
Signature curve hash -&gt; String
(Int -&gt; Signature curve hash -&gt; ShowS)
-&gt; (Signature curve hash -&gt; String)
-&gt; ([Signature curve hash] -&gt; ShowS)
-&gt; Show (Signature curve hash)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall curve hash. Int -&gt; Signature curve hash -&gt; ShowS
forall curve hash. [Signature curve hash] -&gt; ShowS
forall curve hash. Signature curve hash -&gt; String
showList :: [Signature curve hash] -&gt; ShowS
$cshowList :: forall curve hash. [Signature curve hash] -&gt; ShowS
show :: Signature curve hash -&gt; String
$cshow :: forall curve hash. Signature curve hash -&gt; String
showsPrec :: Int -&gt; Signature curve hash -&gt; ShowS
$cshowsPrec :: forall curve hash. Int -&gt; Signature curve hash -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210652"><span id="local-6989586621679210654"><span class="annot"><span class="annottext">Signature curve hash -&gt; Signature curve hash -&gt; Bool
(Signature curve hash -&gt; Signature curve hash -&gt; Bool)
-&gt; (Signature curve hash -&gt; Signature curve hash -&gt; Bool)
-&gt; Eq (Signature curve hash)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
/= :: Signature curve hash -&gt; Signature curve hash -&gt; Bool
$c/= :: forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
== :: Signature curve hash -&gt; Signature curve hash -&gt; Bool
$c== :: forall curve hash.
Signature curve hash -&gt; Signature curve hash -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210646"><span id="local-6989586621679210648"><span id="local-6989586621679210650"><span class="annot"><span class="annottext">Signature curve hash -&gt; Int
Signature curve hash -&gt; Ptr p -&gt; IO ()
Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
(Signature curve hash -&gt; Int)
-&gt; (forall p a. Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. Signature curve hash -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess (Signature curve hash)
forall p. Signature curve hash -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall curve hash. Signature curve hash -&gt; Int
forall p a. Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
forall curve hash p. Signature curve hash -&gt; Ptr p -&gt; IO ()
forall curve hash p a.
Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: Signature curve hash -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall curve hash p. Signature curve hash -&gt; Ptr p -&gt; IO ()
withByteArray :: Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall curve hash p a.
Signature curve hash -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: Signature curve hash -&gt; Int
$clength :: forall curve hash. Signature curve hash -&gt; Int
</span><a href="#local-6989586621679210646"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679210644"><span class="annot"><span class="annottext">Signature curve hash -&gt; ()
(Signature curve hash -&gt; ()) -&gt; NFData (Signature curve hash)
forall a. (a -&gt; ()) -&gt; NFData a
forall curve hash. Signature curve hash -&gt; ()
rnf :: Signature curve hash -&gt; ()
$crnf :: forall curve hash. Signature curve hash -&gt; ()
</span><a href="#local-6989586621679210644"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Elliptic curves with an implementation of EdDSA</span><span>
</span><span id="line-88"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.ECC.html#EllipticCurveBasepointArith"><span class="hs-identifier hs-type">EllipticCurveBasepointArith</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="EllipticCurveEdDSA"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-var">EllipticCurveEdDSA</span></a></span></span><span> </span><span id="local-6989586621679210942"><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- | Size of the digest for this curve (in bytes)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CurveDigestSize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-var">CurveDigestSize</span></a></span></span><span> </span><span id="local-6989586621679210942"><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- | Size of secret keys for this curve (in bytes)</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679210941"><span id="secretKeySize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-type">secretKeySize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679210941"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- hash with specified parameters</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679210839"><span id="local-6989586621679210840"><span id="local-6989586621679210841"><span id="local-6989586621679210842"><span id="hashWithDom"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-type">hashWithDom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210842"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210841"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210840"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210839"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210842"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210841"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Internal.Builder.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210840"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span></span></span></span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- conversion between scalar, point and public key</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679210909"><span id="local-6989586621679210910"><span id="pointPublic"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#pointPublic"><span class="hs-identifier hs-type">pointPublic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679210910"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210909"><span class="hs-identifier hs-type">hash</span></a></span></span></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679210806"><span id="local-6989586621679210807"><span id="publicPoint"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicPoint"><span class="hs-identifier hs-type">publicPoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679210807"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210806"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679210790"><span id="local-6989586621679210791"><span id="encodeScalarLE"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#encodeScalarLE"><span class="hs-identifier hs-type">encodeScalarLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679210791"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210790"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210791"><span class="hs-identifier hs-type">bs</span></a></span></span></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679210781"><span id="local-6989586621679210782"><span id="decodeScalarLE"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-type">decodeScalarLE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210782"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210781"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210782"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- how to use bits in a secret key</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679210901"><span id="local-6989586621679210902"><span id="scheduleSecret"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-type">scheduleSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210902"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-110"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210902"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-111"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210901"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-113"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210902"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-114"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-115"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210942"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">View</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Size of public keys for this curve (in bytes)</span><span>
</span><span id="line-118"></span><span id="local-6989586621679210957"><span id="local-6989586621679210958"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-type">publicKeySize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210958"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210957"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210958"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-119"></span><span id="publicKeySize"><span class="annot"><span class="annottext">publicKeySize :: proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var hs-var">publicKeySize</span></a></span></span><span> </span><span id="local-6989586621679210637"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210637"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210637"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Size of signatures for this curve (in bytes)</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-type">signatureSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679210974"><span class="annot"><a href="#local-6989586621679210974"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679210976"><span class="annot"><a href="#local-6989586621679210976"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210976"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-123"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210974"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210976"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-124"></span><span id="signatureSize"><span class="annot"><span class="annottext">signatureSize :: proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var hs-var">signatureSize</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (CurveDigestSize curve) -&gt; Int
forall (bitlen :: Nat) a (proxy :: Nat -&gt; *).
(KnownNat bitlen, Num a) =&gt;
proxy bitlen -&gt; a
</span><a href="Crypto.Internal.Nat.html#integralNatVal"><span class="hs-identifier hs-var">integralNatVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (CurveDigestSize curve)
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210976"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- Constructors</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Try to build a public key from a bytearray</span><span>
</span><span id="line-130"></span><span id="local-6989586621679210631"><span id="local-6989586621679210632"><span id="local-6989586621679210633"><span id="local-6989586621679210634"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier hs-type">publicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210634"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-131"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210633"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-132"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210633"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210634"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-133"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210632"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-134"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210631"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210634"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210633"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210632"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210634"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210633"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-136"></span><span id="publicKey"><span class="annot"><span class="annottext">publicKey :: proxy curve -&gt; hash -&gt; ba -&gt; CryptoFailable (PublicKey curve hash)
</span><a href="Crypto.PubKey.EdDSA.html#publicKey"><span class="hs-identifier hs-var hs-var">publicKey</span></a></span></span><span> </span><span id="local-6989586621679210630"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210630"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="annot"><span class="annottext">hash
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679210629"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210629"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ba -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210629"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210630"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">PublicKey curve hash -&gt; CryptoFailable (PublicKey curve hash)
forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; PublicKey curve hash
forall curve hash. Bytes -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes -&gt; PublicKey curve hash) -&gt; Bytes -&gt; PublicKey curve hash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ba -&gt; Bytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210629"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable (PublicKey curve hash)
forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_PublicKeySizeInvalid"><span class="hs-identifier hs-var">CryptoError_PublicKeySizeInvalid</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Try to build a secret key from a bytearray</span><span>
</span><span id="line-143"></span><span id="local-6989586621679210621"><span id="local-6989586621679210622"><span id="local-6989586621679210623"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier hs-type">secretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210623"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210622"><span class="hs-identifier hs-type">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210621"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210623"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210622"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210623"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-145"></span><span id="secretKey"><span class="annot"><span class="annottext">secretKey :: proxy curve -&gt; ba -&gt; CryptoFailable (SecretKey curve)
</span><a href="Crypto.PubKey.EdDSA.html#secretKey"><span class="hs-identifier hs-var hs-var">secretKey</span></a></span></span><span> </span><span id="local-6989586621679210620"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210620"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210619"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210619"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ba -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210619"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-var">secretKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210620"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">SecretKey curve -&gt; CryptoFailable (SecretKey curve)
forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; SecretKey curve
forall curve. ScrubbedBytes -&gt; SecretKey curve
</span><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; SecretKey curve)
-&gt; ScrubbedBytes -&gt; SecretKey curve
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ba -&gt; ScrubbedBytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210619"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                        </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable (SecretKey curve)
forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_SecretKeyStructureInvalid"><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Try to build a signature from a bytearray</span><span>
</span><span id="line-152"></span><span id="local-6989586621679210614"><span id="local-6989586621679210615"><span id="local-6989586621679210616"><span id="local-6989586621679210617"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword hs-type">signature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210617"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-153"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210616"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-154"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210616"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210617"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-155"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210615"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-156"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210614"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210617"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210616"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210615"><span class="hs-identifier hs-type">ba</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210617"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210616"><span class="hs-identifier hs-type">hash</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-158"></span><span id="signature"><span class="annot"><span class="annottext">signature :: proxy curve -&gt; hash -&gt; ba -&gt; CryptoFailable (Signature curve hash)
</span><a href="Crypto.PubKey.EdDSA.html#signature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span id="local-6989586621679210613"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210613"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="annot"><span class="annottext">hash
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679210612"><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210612"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ba -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210612"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210613"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">Signature curve hash -&gt; CryptoFailable (Signature curve hash)
forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; Signature curve hash
forall curve hash. Bytes -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes -&gt; Signature curve hash) -&gt; Bytes -&gt; Signature curve hash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ba -&gt; Bytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">ba
</span><a href="#local-6989586621679210612"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable (Signature curve hash)
forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_SecretKeyStructureInvalid"><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Conversions</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Generate a secret key</span><span>
</span><span id="line-168"></span><span id="local-6989586621679210609"><span id="local-6989586621679210610"><span id="local-6989586621679210611"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier hs-type">generateSecretKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210611"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Random.Types.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210610"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210609"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210611"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210610"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210611"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-170"></span><span id="generateSecretKey"><span class="annot"><span class="annottext">generateSecretKey :: proxy curve -&gt; m (SecretKey curve)
</span><a href="Crypto.PubKey.EdDSA.html#generateSecretKey"><span class="hs-identifier hs-var hs-var">generateSecretKey</span></a></span></span><span> </span><span id="local-6989586621679210608"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210608"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; SecretKey curve
forall curve. ScrubbedBytes -&gt; SecretKey curve
</span><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-var">SecretKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; SecretKey curve)
-&gt; m ScrubbedBytes -&gt; m (SecretKey curve)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m ScrubbedBytes
forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><a href="Crypto.Random.Types.html#getRandomBytes"><span class="hs-identifier hs-var">getRandomBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#secretKeySize"><span class="hs-identifier hs-var">secretKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210608"><span class="hs-identifier hs-var">prx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Create a public key from a secret key</span><span>
</span><span id="line-173"></span><span id="local-6989586621679210603"><span id="local-6989586621679210604"><span id="local-6989586621679210605"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier hs-type">toPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210605"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210604"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210604"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210605"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210603"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210605"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210604"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210605"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210605"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210604"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span><span>
</span><span id="line-178"></span><span id="toPublic"><span class="annot"><span class="annottext">toPublic :: proxy curve -&gt; hash -&gt; SecretKey curve -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#toPublic"><span class="hs-identifier hs-var hs-var">toPublic</span></a></span></span><span> </span><span id="local-6989586621679210602"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210602"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210601"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210601"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210600"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210600"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679210599"><span class="annot"><span class="annottext">p :: Point curve
</span><a href="#local-6989586621679210599"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Scalar curve -&gt; Point curve
forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointBaseSmul"><span class="hs-identifier hs-var">pointBaseSmul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210602"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy curve -&gt; hash -&gt; SecretKey curve -&gt; Scalar curve
forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve -&gt; hash -&gt; SecretKey curve -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-var">secretScalar</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210602"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210601"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210600"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Point curve -&gt; PublicKey curve hash
forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Point curve -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#pointPublic"><span class="hs-identifier hs-var">pointPublic</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210602"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210599"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679210911"><span id="local-6989586621679210914"><span id="local-6989586621679210915"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-type">secretScalar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210915"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210914"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210914"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210915"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210911"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210915"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210914"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210915"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210915"><span class="hs-identifier hs-type">curve</span></a></span></span></span></span><span>
</span><span id="line-187"></span><span id="secretScalar"><span class="annot"><span class="annottext">secretScalar :: proxy curve -&gt; hash -&gt; SecretKey curve -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#secretScalar"><span class="hs-identifier hs-var hs-var">secretScalar</span></a></span></span><span> </span><span id="local-6989586621679210596"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210596"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210595"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210595"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210594"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210594"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Scalar curve, View Bytes) -&gt; Scalar curve
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
</span><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-var">scheduleSecret</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210596"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210595"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210594"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- EdDSA signature generation &amp; verification</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Sign a message using the key pair</span><span>
</span><span id="line-193"></span><span id="local-6989586621679210590"><span id="local-6989586621679210591"><span id="local-6989586621679210592"><span id="local-6989586621679210593"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210592"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210592"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210591"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210590"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210592"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210591"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210593"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210592"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span><span>
</span><span id="line-199"></span><span id="sign"><span class="annot"><span class="annottext">sign :: proxy curve
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679210589"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210589"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bytes
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-var">signCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210589"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var">emptyCtx</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Verify a message</span><span>
</span><span id="line-202"></span><span id="local-6989586621679210584"><span id="local-6989586621679210585"><span id="local-6989586621679210586"><span id="local-6989586621679210587"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210587"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-203"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210586"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-204"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210586"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210587"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210585"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210584"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210587"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210587"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210586"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210585"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210587"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210586"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span><span>
</span><span id="line-208"></span><span id="verify"><span class="annot"><span class="annottext">verify :: proxy curve
-&gt; PublicKey curve hash -&gt; msg -&gt; Signature curve hash -&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span id="local-6989586621679210583"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210583"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bytes
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-var">verifyCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210583"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var">emptyCtx</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Sign a message using the key pair under context @ctx@</span><span>
</span><span id="line-211"></span><span id="local-6989586621679210892"><span id="local-6989586621679210893"><span id="local-6989586621679210894"><span id="local-6989586621679210895"><span id="local-6989586621679210896"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-type">signCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-212"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210895"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-213"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210895"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-214"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210894"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-215"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210893"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-216"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210892"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210894"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210895"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210893"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210896"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210895"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span></span><span>
</span><span id="line-218"></span><span id="signCtx"><span class="annot"><span class="annottext">signCtx :: proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signCtx"><span class="hs-identifier hs-var hs-var">signCtx</span></a></span></span><span> </span><span id="local-6989586621679210582"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210582"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var">signPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210582"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Verify a message under context @ctx@</span><span>
</span><span id="line-221"></span><span id="local-6989586621679210883"><span id="local-6989586621679210884"><span id="local-6989586621679210885"><span id="local-6989586621679210886"><span id="local-6989586621679210887"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-type">verifyCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210887"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-222"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210886"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-223"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210886"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210887"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-224"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210885"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-225"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210884"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-226"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210883"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210887"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210885"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210887"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210886"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210884"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210887"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210886"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-228"></span><span id="verifyCtx"><span class="annot"><span class="annottext">verifyCtx :: proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyCtx"><span class="hs-identifier hs-var hs-var">verifyCtx</span></a></span></span><span> </span><span id="local-6989586621679210580"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210580"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var">verifyPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210580"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Sign a prehashed message using the key pair under context @ctx@</span><span>
</span><span id="line-231"></span><span id="local-6989586621679210574"><span id="local-6989586621679210575"><span id="local-6989586621679210576"><span id="local-6989586621679210577"><span id="local-6989586621679210578"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier hs-type">signPh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210577"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210577"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210576"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210575"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210576"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210577"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210574"><span class="hs-identifier hs-type">prehash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210578"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210577"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span></span></span><span>
</span><span id="line-237"></span><span id="signPh"><span class="annot"><span class="annottext">signPh :: proxy curve
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPh"><span class="hs-identifier hs-var hs-var">signPh</span></a></span></span><span> </span><span id="local-6989586621679210573"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210573"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var">signPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210573"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Verify a prehashed message under context @ctx@</span><span>
</span><span id="line-240"></span><span id="local-6989586621679210568"><span id="local-6989586621679210569"><span id="local-6989586621679210570"><span id="local-6989586621679210571"><span id="local-6989586621679210572"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier hs-type">verifyPh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210572"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210571"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210571"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210572"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-243"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210570"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210569"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210572"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210570"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210572"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210571"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#Digest"><span class="hs-identifier hs-type">Digest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210568"><span class="hs-identifier hs-type">prehash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210572"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210571"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-246"></span><span id="verifyPh"><span class="annot"><span class="annottext">verifyPh :: proxy curve
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPh"><span class="hs-identifier hs-var hs-var">verifyPh</span></a></span></span><span> </span><span id="local-6989586621679210567"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210567"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Digest prehash
-&gt; Signature curve hash
-&gt; Bool
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var">verifyPhCtx</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210567"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-type">signPhCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679210873"><span class="annot"><a href="#local-6989586621679210873"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679210877"><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679210876"><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span id="local-6989586621679210875"><span class="annot"><a href="#local-6989586621679210875"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679210874"><span class="annot"><a href="#local-6989586621679210874"><span class="hs-identifier hs-type">msg</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-249"></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-250"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-251"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-252"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210875"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-253"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210874"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-254"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210873"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210875"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#SecretKey"><span class="hs-identifier hs-type">SecretKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210874"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210877"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-256"></span><span id="signPhCtx"><span class="annot"><span class="annottext">signPhCtx :: proxy curve
-&gt; Bool
-&gt; ctx
-&gt; SecretKey curve
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#signPhCtx"><span class="hs-identifier hs-var hs-var">signPhCtx</span></a></span></span><span> </span><span id="local-6989586621679210566"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210565"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210565"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679210564"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210564"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679210563"><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210563"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span id="local-6989586621679210562"><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679210562"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679210561"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210561"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679210560"><span class="annot"><span class="annottext">alg :: hash
</span><a href="#local-6989586621679210560"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">hash
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679210876"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679210558"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210558"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679210557"><span class="annot"><span class="annottext">View Bytes
</span><a href="#local-6989586621679210557"><span class="hs-identifier hs-var">prefix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; hash -&gt; SecretKey curve -&gt; (Scalar curve, View Bytes)
</span><a href="Crypto.PubKey.EdDSA.html#scheduleSecret"><span class="hs-identifier hs-var">scheduleSecret</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210560"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey curve
</span><a href="#local-6989586621679210563"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679210556"><span class="annot"><span class="annottext">digR :: Bytes
</span><a href="#local-6989586621679210556"><span class="hs-identifier hs-var hs-var">digR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-var">hashWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210560"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210565"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210564"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">View Bytes -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">View Bytes
</span><a href="#local-6989586621679210557"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210561"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679210554"><span class="annot"><span class="annottext">r :: Scalar curve
</span><a href="#local-6989586621679210554"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Bytes -&gt; Scalar curve
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210556"><span class="hs-identifier hs-var">digR</span></a></span><span>
</span><span id="line-261"></span><span>        </span><span id="local-6989586621679210552"><span class="annot"><span class="annottext">pR :: Point curve
</span><a href="#local-6989586621679210552"><span class="hs-identifier hs-var hs-var">pR</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Scalar curve -&gt; Point curve
forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointBaseSmul"><span class="hs-identifier hs-var">pointBaseSmul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210554"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-262"></span><span>        </span><span id="local-6989586621679210551"><span class="annot"><span class="annottext">bsR :: Bytes
</span><a href="#local-6989586621679210551"><span class="hs-identifier hs-var hs-var">bsR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Point curve -&gt; Bytes
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
</span><a href="Crypto.ECC.html#encodePoint"><span class="hs-identifier hs-var">encodePoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210552"><span class="hs-identifier hs-var">pR</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span id="local-6989586621679210549"><span class="annot"><span class="annottext">sK :: Scalar curve
</span><a href="#local-6989586621679210549"><span class="hs-identifier hs-var hs-var">sK</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var">getK</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210565"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210564"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679210562"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210551"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210561"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679210547"><span class="annot"><span class="annottext">sS :: Scalar curve
</span><a href="#local-6989586621679210547"><span class="hs-identifier hs-var hs-var">sS</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
</span><a href="Crypto.ECC.html#scalarAdd"><span class="hs-identifier hs-var">scalarAdd</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210554"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve -&gt; Scalar curve -&gt; Scalar curve -&gt; Scalar curve
</span><a href="Crypto.ECC.html#scalarMul"><span class="hs-identifier hs-var">scalarMul</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210549"><span class="hs-identifier hs-var">sK</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210558"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; (Bytes, Point curve, Scalar curve) -&gt; Signature curve hash
forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve
-&gt; (Bytes, Point curve, Scalar curve) -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-var">encodeSignature</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210566"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210551"><span class="hs-identifier hs-var">bsR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210552"><span class="hs-identifier hs-var">pR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210547"><span class="hs-identifier hs-var">sS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679210863"><span id="local-6989586621679210864"><span id="local-6989586621679210865"><span id="local-6989586621679210866"><span id="local-6989586621679210867"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-type">verifyPhCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210867"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-268"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210866"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-269"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210866"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210867"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-270"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210865"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-271"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210864"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-272"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210863"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210867"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210865"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210867"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210866"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210864"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210867"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210866"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-274"></span><span id="verifyPhCtx"><span class="annot"><span class="annottext">verifyPhCtx :: proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; msg
-&gt; Signature curve hash
-&gt; Bool
</span><a href="Crypto.PubKey.EdDSA.html#verifyPhCtx"><span class="hs-identifier hs-var hs-var">verifyPhCtx</span></a></span></span><span> </span><span id="local-6989586621679210543"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210542"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210542"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679210541"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210541"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679210540"><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679210540"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679210539"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210539"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679210538"><span class="annot"><span class="annottext">Signature curve hash
</span><a href="#local-6989586621679210538"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CryptoFailable Bool
</span><a href="#local-6989586621679210537"><span class="hs-identifier hs-var">doVerify</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-type">CryptoPassed</span></a></span><span> </span><span id="local-6989586621679210536"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210536"><span class="hs-identifier hs-var">verified</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210536"><span class="hs-identifier hs-var">verified</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-type">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679210537"><span class="annot"><span class="annottext">doVerify :: CryptoFailable Bool
</span><a href="#local-6989586621679210537"><span class="hs-identifier hs-var hs-var">doVerify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679210535"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210535"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679210534"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210534"><span class="hs-identifier hs-var">pR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679210533"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210533"><span class="hs-identifier hs-var">sS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Signature curve hash
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
forall curve hash (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve,
 HashDigestSize hash ~ CurveDigestSize curve) =&gt;
proxy curve
-&gt; Signature curve hash
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-var">decodeSignature</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Signature curve hash
</span><a href="#local-6989586621679210538"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621679210531"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210531"><span class="hs-identifier hs-var">nPub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Point curve -&gt; Point curve
forall curve (proxy :: * -&gt; *).
EllipticCurveArith curve =&gt;
proxy curve -&gt; Point curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointNegate"><span class="hs-identifier hs-var">pointNegate</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">(Point curve -&gt; Point curve)
-&gt; CryptoFailable (Point curve) -&gt; CryptoFailable (Point curve)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; PublicKey curve hash -&gt; CryptoFailable (Point curve)
forall curve (proxy :: * -&gt; *) hash.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; PublicKey curve hash -&gt; CryptoFailable (Point curve)
</span><a href="Crypto.PubKey.EdDSA.html#publicPoint"><span class="hs-identifier hs-var">publicPoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679210540"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679210529"><span class="annot"><span class="annottext">sK :: Scalar curve
</span><a href="#local-6989586621679210529"><span class="hs-identifier hs-var hs-var">sK</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
forall (proxy :: * -&gt; *) curve hash ctx msg.
(EllipticCurveEdDSA curve, HashAlgorithm hash,
 HashDigestSize hash ~ CurveDigestSize curve, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var">getK</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210542"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210541"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey curve hash
</span><a href="#local-6989586621679210540"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210535"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210539"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-283"></span><span>            </span><span id="local-6989586621679210528"><span class="annot"><span class="annottext">pR' :: Point curve
</span><a href="#local-6989586621679210528"><span class="hs-identifier hs-var hs-var">pR'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve
-&gt; Scalar curve -&gt; Scalar curve -&gt; Point curve -&gt; Point curve
forall curve (proxy :: * -&gt; *).
EllipticCurveBasepointArith curve =&gt;
proxy curve
-&gt; Scalar curve -&gt; Scalar curve -&gt; Point curve -&gt; Point curve
</span><a href="Crypto.ECC.html#pointsSmulVarTime"><span class="hs-identifier hs-var">pointsSmulVarTime</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210543"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210533"><span class="hs-identifier hs-var">sS</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210529"><span class="hs-identifier hs-var">sK</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210531"><span class="hs-identifier hs-var">nPub</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; CryptoFailable Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210534"><span class="hs-identifier hs-var">pR</span></a></span><span> </span><span class="annot"><span class="annottext">Point curve -&gt; Point curve -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210528"><span class="hs-identifier hs-var">pR'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-type">emptyCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span>
</span><span id="line-287"></span><span id="emptyCtx"><span class="annot"><span class="annottext">emptyCtx :: Bytes
</span><a href="Crypto.PubKey.EdDSA.html#emptyCtx"><span class="hs-identifier hs-var hs-var">emptyCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes
forall a. ByteArray a =&gt; a
</span><span class="hs-identifier hs-var">B.empty</span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-type">getK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679210826"><span class="annot"><a href="#local-6989586621679210826"><span class="hs-identifier hs-type">proxy</span></a></span></span><span> </span><span id="local-6989586621679210830"><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span></span><span> </span><span id="local-6989586621679210829"><span class="annot"><a href="#local-6989586621679210829"><span class="hs-identifier hs-type">hash</span></a></span></span><span> </span><span id="local-6989586621679210828"><span class="annot"><a href="#local-6989586621679210828"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621679210827"><span class="annot"><a href="#local-6989586621679210827"><span class="hs-identifier hs-type">msg</span></a></span></span><span> </span><span class="hs-operator">.</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210829"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210829"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210828"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210827"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210826"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210828"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210829"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210827"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210830"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-297"></span><span id="getK"><span class="annot"><span class="annottext">getK :: proxy curve
-&gt; Bool
-&gt; ctx
-&gt; PublicKey curve hash
-&gt; Bytes
-&gt; msg
-&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#getK"><span class="hs-identifier hs-var hs-var">getK</span></a></span></span><span> </span><span id="local-6989586621679210525"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210525"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210524"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210524"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679210523"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210523"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-type">PublicKey</span></a></span><span> </span><span id="local-6989586621679210522"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210522"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679210521"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210521"><span class="hs-identifier hs-var">bsR</span></a></span></span><span> </span><span id="local-6989586621679210520"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210520"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679210519"><span class="annot"><span class="annottext">alg :: hash
</span><a href="#local-6989586621679210519"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">hash
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679210829"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621679210518"><span class="annot"><span class="annottext">digK :: Bytes
</span><a href="#local-6989586621679210518"><span class="hs-identifier hs-var hs-var">digK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
forall curve hash ctx msg (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, HashAlgorithm hash, ByteArrayAccess ctx,
 ByteArrayAccess msg) =&gt;
proxy curve -&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#hashWithDom"><span class="hs-identifier hs-var">hashWithDom</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210525"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210519"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210524"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210523"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210521"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210522"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210520"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-300"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Bytes -&gt; Scalar curve
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210525"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210518"><span class="hs-identifier hs-var">digK</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621679210822"><span id="local-6989586621679210823"><span id="local-6989586621679210824"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-type">encodeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210824"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-303"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210823"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210824"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-304"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210824"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210824"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210824"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210822"><span class="hs-identifier hs-type">hash</span></a></span></span></span></span><span>
</span><span id="line-306"></span><span id="encodeSignature"><span class="annot"><span class="annottext">encodeSignature :: proxy curve
-&gt; (Bytes, Point curve, Scalar curve) -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#encodeSignature"><span class="hs-identifier hs-var hs-var">encodeSignature</span></a></span></span><span> </span><span id="local-6989586621679210517"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210517"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210516"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210516"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679210515"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210515"><span class="hs-identifier hs-var">sS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Signature curve hash
forall curve hash. Bytes -&gt; Signature curve hash
</span><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes -&gt; Signature curve hash) -&gt; Bytes -&gt; Signature curve hash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Bytes
forall ba. ByteArray ba =&gt; Builder -&gt; ba
</span><a href="Crypto.Internal.Builder.html#buildAndFreeze"><span class="hs-identifier hs-var">buildAndFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Bytes) -&gt; Builder -&gt; Bytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">Bytes -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210516"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210513"><span class="hs-identifier hs-var">bsS</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679210511"><span class="hs-identifier hs-var">len0</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679210513"><span class="annot"><span class="annottext">bsS :: Bytes
</span><a href="#local-6989586621679210513"><span class="hs-identifier hs-var hs-var">bsS</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Scalar curve -&gt; Bytes
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArray bs) =&gt;
proxy curve -&gt; Scalar curve -&gt; bs
</span><a href="Crypto.PubKey.EdDSA.html#encodeScalarLE"><span class="hs-identifier hs-var">encodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210517"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210515"><span class="hs-identifier hs-var">sS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679210511"><span class="annot"><span class="annottext">len0 :: Int
</span><a href="#local-6989586621679210511"><span class="hs-identifier hs-var hs-var">len0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall (proxy :: * -&gt; *) curve.
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#signatureSize"><span class="hs-identifier hs-var">signatureSize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210517"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210516"><span class="hs-identifier hs-var">bsR</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210513"><span class="hs-identifier hs-var">bsS</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span id="local-6989586621679210814"><span id="local-6989586621679210815"><span id="local-6989586621679210816"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-type">decodeSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-313"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashDigestSize"><span class="hs-identifier hs-type">HashDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210815"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-type">CurveDigestSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-314"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210814"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span>
</span><span id="line-316"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210815"><span class="hs-identifier hs-type">hash</span></a></span><span>
</span><span id="line-317"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210816"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-318"></span><span id="decodeSignature"><span class="annot"><span class="annottext">decodeSignature :: proxy curve
-&gt; Signature curve hash
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeSignature"><span class="hs-identifier hs-var hs-var">decodeSignature</span></a></span></span><span> </span><span id="local-6989586621679210510"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210510"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679210509"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210509"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679210508"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210508"><span class="hs-identifier hs-var">bsR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679210507"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210507"><span class="hs-identifier hs-var">bsS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bytes -&gt; (Bytes, Bytes)
forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy curve -&gt; Int
forall curve (proxy :: * -&gt; *).
EllipticCurveEdDSA curve =&gt;
proxy curve -&gt; Int
</span><a href="Crypto.PubKey.EdDSA.html#publicKeySize"><span class="hs-identifier hs-var">publicKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210510"><span class="hs-identifier hs-var">prx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210509"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679210505"><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210505"><span class="hs-identifier hs-var">pR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Bytes -&gt; CryptoFailable (Point curve)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
</span><a href="Crypto.ECC.html#decodePoint"><span class="hs-identifier hs-var">decodePoint</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210510"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210508"><span class="hs-identifier hs-var">bsR</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679210503"><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210503"><span class="hs-identifier hs-var">sS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; Bytes -&gt; CryptoFailable (Scalar curve)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-var">decodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210510"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210507"><span class="hs-identifier hs-var">bsS</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">(Bytes, Point curve, Scalar curve)
-&gt; CryptoFailable (Bytes, Point curve, Scalar curve)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210508"><span class="hs-identifier hs-var">bsR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point curve
</span><a href="#local-6989586621679210505"><span class="hs-identifier hs-var">pR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Scalar curve
</span><a href="#local-6989586621679210503"><span class="hs-identifier hs-var">sS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- implementations are supposed to decode any scalar up to the size of the digest</span><span>
</span><span id="line-325"></span><span id="local-6989586621679210835"><span id="local-6989586621679210836"><span id="local-6989586621679210837"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-type">decodeScalarNoErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210837"><span class="hs-identifier hs-type">curve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210836"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210835"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210837"><span class="hs-identifier hs-type">curve</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210836"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.ECC.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210837"><span class="hs-identifier hs-type">curve</span></a></span></span></span></span><span>
</span><span id="line-327"></span><span id="decodeScalarNoErr"><span class="annot"><span class="annottext">decodeScalarNoErr :: proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var hs-var">decodeScalarNoErr</span></a></span></span><span> </span><span id="local-6989586621679210502"><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210502"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CryptoFailable (Scalar curve) -&gt; Scalar curve
forall a. String -&gt; CryptoFailable a -&gt; a
</span><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;decodeScalarNoErr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (Scalar curve) -&gt; Scalar curve)
-&gt; (bs -&gt; CryptoFailable (Scalar curve)) -&gt; bs -&gt; Scalar curve
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">proxy curve -&gt; bs -&gt; CryptoFailable (Scalar curve)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Scalar curve)
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarLE"><span class="hs-identifier hs-var">decodeScalarLE</span></a></span><span> </span><span class="annot"><span class="annottext">proxy curve
</span><a href="#local-6989586621679210502"><span class="hs-identifier hs-var">prx</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="local-6989586621679210777"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-type">unwrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210777"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="unwrap"><span class="annot"><span class="annottext">unwrap :: String -&gt; CryptoFailable a -&gt; a
</span><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621679210499"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679210499"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-type">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679210499"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: assumption failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-type">CryptoPassed</span></a></span><span> </span><span id="local-6989586621679210497"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679210497"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679210497"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- Ed25519 implementation</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.PubKey.EdDSA.html#EllipticCurveEdDSA"><span class="hs-identifier hs-type">EllipticCurveEdDSA</span></a></span><span> </span><span class="annot"><a href="Crypto.ECC.html#Curve_Edwards25519"><span class="hs-identifier hs-type">Curve_Edwards25519</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="CurveDigestSize"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#CurveDigestSize"><span class="hs-identifier hs-var">CurveDigestSize</span></a></span></span><span> </span><span class="annot"><a href="Crypto.ECC.html#Curve_Edwards25519"><span class="hs-identifier hs-type">Curve_Edwards25519</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679210486"><span class="annot"><span class="annottext">secretKeySize :: proxy Curve_Edwards25519 -&gt; Int
</span><a href="#local-6989586621679210486"><span class="hs-identifier hs-var hs-var hs-var hs-var">secretKeySize</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679210485"><span class="annot"><span class="annottext">hashWithDom :: proxy Curve_Edwards25519
-&gt; hash -&gt; Bool -&gt; ctx -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="#local-6989586621679210485"><span class="hs-identifier hs-var hs-var hs-var hs-var">hashWithDom</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679210484"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210484"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210483"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210483"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span id="local-6989586621679210482"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210482"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679210481"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210481"><span class="hs-identifier hs-var">bss</span></a></span></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210483"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ctx -&gt; Bool
forall a. ByteArrayAccess a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">B.null</span></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210482"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">hash -&gt; Builder -&gt; msg -&gt; Bytes
forall alg msg.
(HashAlgorithm alg, ByteArrayAccess msg) =&gt;
alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var">digestDomMsg</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210484"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210481"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">hash -&gt; Builder -&gt; msg -&gt; Bytes
forall alg msg.
(HashAlgorithm alg, ByteArrayAccess msg) =&gt;
alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var">digestDomMsg</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210484"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210476"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210481"><span class="hs-identifier hs-var">bss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679210476"><span class="annot"><span class="annottext">dom :: Builder
</span><a href="#local-6989586621679210476"><span class="hs-identifier hs-var hs-var">dom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;SigEd25519 no Ed25519 collisions&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-344"></span><span>                  </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#byte"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679210483"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-345"></span><span>                  </span><span class="annot"><span class="annottext">Word8 -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#byte"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ctx -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210482"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-346"></span><span>                  </span><span class="annot"><span class="annottext">ctx -&gt; Builder
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Builder
</span><a href="Crypto.Internal.Builder.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621679210482"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679210474"><span class="annot"><span class="annottext">pointPublic :: proxy Curve_Edwards25519
-&gt; Point Curve_Edwards25519 -&gt; PublicKey Curve_Edwards25519 hash
</span><a href="#local-6989586621679210474"><span class="hs-identifier hs-var hs-var hs-var hs-var">pointPublic</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; PublicKey Curve_Edwards25519 hash
forall curve hash. Bytes -&gt; PublicKey curve hash
</span><a href="Crypto.PubKey.EdDSA.html#PublicKey"><span class="hs-identifier hs-var">PublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Bytes -&gt; PublicKey Curve_Edwards25519 hash)
-&gt; (Point -&gt; Bytes) -&gt; Point -&gt; PublicKey Curve_Edwards25519 hash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; Bytes
forall bs. ByteArray bs =&gt; Point -&gt; bs
</span><a href="Crypto.ECC.Edwards25519.html#pointEncode"><span class="hs-identifier hs-var">Edwards25519.pointEncode</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679210472"><span class="annot"><span class="annottext">publicPoint :: proxy Curve_Edwards25519
-&gt; PublicKey Curve_Edwards25519 hash
-&gt; CryptoFailable (Point Curve_Edwards25519)
</span><a href="#local-6989586621679210472"><span class="hs-identifier hs-var hs-var hs-var hs-var">publicPoint</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PublicKey Curve_Edwards25519 hash
-&gt; CryptoFailable (Point Curve_Edwards25519)
forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable Point
</span><a href="Crypto.ECC.Edwards25519.html#pointDecode"><span class="hs-identifier hs-var">Edwards25519.pointDecode</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621679210470"><span class="annot"><span class="annottext">encodeScalarLE :: proxy Curve_Edwards25519 -&gt; Scalar Curve_Edwards25519 -&gt; bs
</span><a href="#local-6989586621679210470"><span class="hs-identifier hs-var hs-var hs-var hs-var">encodeScalarLE</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar Curve_Edwards25519 -&gt; bs
forall bs. ByteArray bs =&gt; Scalar -&gt; bs
</span><a href="Crypto.ECC.Edwards25519.html#scalarEncode"><span class="hs-identifier hs-var">Edwards25519.scalarEncode</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679210468"><span class="annot"><span class="annottext">decodeScalarLE :: proxy Curve_Edwards25519
-&gt; bs -&gt; CryptoFailable (Scalar Curve_Edwards25519)
</span><a href="#local-6989586621679210468"><span class="hs-identifier hs-var hs-var hs-var hs-var">decodeScalarLE</span></a></span></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">bs -&gt; CryptoFailable (Scalar Curve_Edwards25519)
forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable Scalar
</span><a href="Crypto.ECC.Edwards25519.html#scalarDecodeLong"><span class="hs-identifier hs-var">Edwards25519.scalarDecodeLong</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621679210466"><span class="annot"><span class="annottext">scheduleSecret :: proxy Curve_Edwards25519
-&gt; hash
-&gt; SecretKey Curve_Edwards25519
-&gt; (Scalar Curve_Edwards25519, View Bytes)
</span><a href="#local-6989586621679210466"><span class="hs-identifier hs-var hs-var hs-var hs-var">scheduleSecret</span></a></span></span><span> </span><span id="local-6989586621679210465"><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><a href="#local-6989586621679210465"><span class="hs-identifier hs-var">prx</span></a></span></span><span> </span><span id="local-6989586621679210464"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210464"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210463"><span class="annot"><span class="annottext">SecretKey Curve_Edwards25519
</span><a href="#local-6989586621679210463"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">proxy Curve_Edwards25519 -&gt; Bytes -&gt; Scalar Curve_Edwards25519
forall curve bs (proxy :: * -&gt; *).
(EllipticCurveEdDSA curve, ByteArrayAccess bs) =&gt;
proxy curve -&gt; bs -&gt; Scalar curve
</span><a href="Crypto.PubKey.EdDSA.html#decodeScalarNoErr"><span class="hs-identifier hs-var">decodeScalarNoErr</span></a></span><span> </span><span class="annot"><span class="annottext">proxy Curve_Edwards25519
</span><a href="#local-6989586621679210465"><span class="hs-identifier hs-var">prx</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210462"><span class="hs-identifier hs-var">clamped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Int -&gt; View Bytes
forall bytes. ByteArrayAccess bytes =&gt; bytes -&gt; Int -&gt; View bytes
</span><span class="hs-identifier hs-var">B.dropView</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210460"><span class="hs-identifier hs-var">hashed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>        </span><span id="local-6989586621679210460"><span class="annot"><span class="annottext">hashed :: Bytes
</span><a href="#local-6989586621679210460"><span class="hs-identifier hs-var hs-var">hashed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">hash
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
forall alg.
HashAlgorithm alg =&gt;
alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679210464"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">(((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
 -&gt; Bytes)
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679210458"><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679210458"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey Curve_Edwards25519 -&gt; IO ()
forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679210458"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey Curve_Edwards25519
</span><a href="#local-6989586621679210463"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="#local-6989586621679210462"><span class="hs-identifier hs-type">clamped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621679210462"><span class="annot"><span class="annottext">clamped :: Bytes
</span><a href="#local-6989586621679210462"><span class="hs-identifier hs-var hs-var">clamped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View Bytes -&gt; (Ptr Word8 -&gt; IO ()) -&gt; Bytes
forall bs1 bs2 p.
(ByteArrayAccess bs1, ByteArray bs2) =&gt;
bs1 -&gt; (Ptr p -&gt; IO ()) -&gt; bs2
</span><span class="hs-identifier hs-var">B.copyAndFreeze</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; Int -&gt; View Bytes
forall bytes. ByteArrayAccess bytes =&gt; bytes -&gt; Int -&gt; View bytes
</span><span class="hs-identifier hs-var">B.takeView</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679210460"><span class="hs-identifier hs-var">hashed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; Bytes) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; Bytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679210455"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679210455"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>                      </span><span id="local-6989586621679210454"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679210454"><span class="hs-identifier hs-var">b0</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679210455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-361"></span><span>                      </span><span id="local-6989586621679210452"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679210452"><span class="hs-identifier hs-var">b31</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679210455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-362"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679210455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679210452"><span class="hs-identifier hs-var">b31</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x7F</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x40</span></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679210455"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679210454"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0xF8</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">{-
  Optimize hashing by limiting the number of roundtrips between Haskell and C.
  Hash &quot;update&quot; functions do not use unsafe FFI call, so better concanetate
  small fragments together and call the update function once.

  Using the IO hash interface avoids context buffer copies.

  Data type Digest is not used directly but converted to Bytes early. Any use of
  withByteArray on the unpinned Digest backend would require copy through a
  pinned trampoline.
-}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span id="local-6989586621679210761"><span id="local-6989586621679210762"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-type">digestDomMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210762"><span class="hs-identifier hs-type">alg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210761"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210762"><span class="hs-identifier hs-type">alg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Internal.Builder.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210761"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span></span></span><span>
</span><span id="line-380"></span><span id="digestDomMsg"><span class="annot"><span class="annottext">digestDomMsg :: alg -&gt; Builder -&gt; msg -&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digestDomMsg"><span class="hs-identifier hs-var hs-var">digestDomMsg</span></a></span></span><span> </span><span id="local-6989586621679210448"><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679210448"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210447"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210447"><span class="hs-identifier hs-var">bss</span></a></span></span><span> </span><span id="local-6989586621679210446"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210446"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
forall alg.
HashAlgorithm alg =&gt;
alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var">digest</span></a></span><span> </span><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679210448"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">(((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
 -&gt; Bytes)
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679210445"><span class="annot"><span class="annottext">forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679210445"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">Bytes -&gt; IO ()
forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679210445"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Bytes
forall ba. ByteArray ba =&gt; Builder -&gt; ba
</span><a href="Crypto.Internal.Builder.html#buildAndFreeze"><span class="hs-identifier hs-var">buildAndFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679210447"><span class="hs-identifier hs-var">bss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">msg -&gt; IO ()
forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()
</span><a href="#local-6989586621679210445"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679210446"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621679210739"><span class="annot"><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-type">digest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Hash.Types.html#HashAlgorithm"><span class="hs-identifier hs-type">HashAlgorithm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679210739"><span class="hs-identifier hs-type">alg</span></a></span><span>
</span><span id="line-384"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210739"><span class="hs-identifier hs-type">alg</span></a></span><span>
</span><span id="line-385"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679210740"><span class="annot"><a href="#local-6989586621679210740"><span class="hs-identifier hs-type">bs</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679210740"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679210740"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bytes</span></span></span><span>
</span><span id="line-387"></span><span id="digest"><span class="annot"><span class="annottext">digest :: alg
-&gt; ((forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ())
-&gt; Bytes
</span><a href="Crypto.PubKey.EdDSA.html#digest"><span class="hs-identifier hs-var hs-var">digest</span></a></span></span><span> </span><span id="local-6989586621679210444"><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679210444"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679210443"><span class="annot"><span class="annottext">(forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ()
</span><a href="#local-6989586621679210443"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest alg -&gt; Bytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">(Digest alg -&gt; Bytes) -&gt; Digest alg -&gt; Bytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Digest alg) -&gt; Digest alg
forall a. IO a -&gt; a
</span><a href="Crypto.Internal.Compat.html#unsafeDoIO"><span class="hs-identifier hs-var">unsafeDoIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Digest alg) -&gt; Digest alg) -&gt; IO (Digest alg) -&gt; Digest alg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621679210441"><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679210441"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">alg -&gt; IO (MutableContext alg)
forall alg. HashAlgorithm alg =&gt; alg -&gt; IO (MutableContext alg)
</span><a href="Crypto.Hash.IO.html#hashMutableInitWith"><span class="hs-identifier hs-var">hashMutableInitWith</span></a></span><span> </span><span class="annot"><span class="annottext">alg
</span><a href="#local-6989586621679210444"><span class="hs-identifier hs-var">alg</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">(forall bs. ByteArrayAccess bs =&gt; bs -&gt; IO ()) -&gt; IO ()
</span><a href="#local-6989586621679210443"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MutableContext alg -&gt; bs -&gt; IO ()
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
MutableContext a -&gt; ba -&gt; IO ()
</span><a href="Crypto.Hash.IO.html#hashMutableUpdate"><span class="hs-identifier hs-var">hashMutableUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679210441"><span class="hs-identifier hs-var">mc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">MutableContext alg -&gt; IO (Digest alg)
forall a. HashAlgorithm a =&gt; MutableContext a -&gt; IO (Digest a)
</span><a href="Crypto.Hash.IO.html#hashMutableFinalize"><span class="hs-identifier hs-var">hashMutableFinalize</span></a></span><span> </span><span class="annot"><span class="annottext">MutableContext alg
</span><a href="#local-6989586621679210441"><span class="hs-identifier hs-var">mc</span></a></span><span>
</span><span id="line-391"></span></pre></body></html>