<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes, ScopedTypeVariables, CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  Data.Generics.Twins</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow, CWI 2001--2004</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD-style (see the LICENSE file)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  generics@haskell.org</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  non-portable (local universal quantification)</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- \&quot;Scrap your boilerplate\&quot; --- Generic programming in Haskell</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- See &lt;http://www.cs.uu.nl/wiki/GenericProgramming/SYB&gt;. The present module</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- provides support for multi-parameter traversal, which is also</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- demonstrated with generic operations like equality.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Generics.Twins</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Generic folds and maps that also accumulate</span></span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier">gfoldlAccum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier">gmapAccumT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier">gmapAccumM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQl"><span class="hs-identifier">gmapAccumQl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier">gmapAccumQr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier">gmapAccumQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumA"><span class="hs-identifier">gmapAccumA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Mapping combinators for twin traversal</span></span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gzipWithT"><span class="hs-identifier">gzipWithT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier">gzipWithM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier">gzipWithQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Typical twin traversals</span></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#geq"><span class="hs-identifier">geq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier">gzip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><a href="Data.Generics.Twins.html#gcompare"><span class="hs-identifier">gcompare</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span class="hs-cpp">

#ifdef __HADDOCK__
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html"><span class="hs-identifier">Data.Generics.Aliases</span></a></span><span class="hs-cpp">

#ifdef __GLASGOW_HASKELL__
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">GT</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span>         </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">mappend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mconcat</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-60"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">--      Generic folds and maps that also accumulate</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{--------------------------------------------------------------

A list map can be elaborated to perform accumulation.
In the same sense, we can elaborate generic maps over terms.

We recall the type of map:
map :: (a -&gt; b) -&gt; [a] -&gt; [b]

We recall the type of an accumulating map (see Data.List):
mapAccumL :: (a -&gt; b -&gt; (a,c)) -&gt; a -&gt; [b] -&gt; (a,[c])

Applying the same scheme we obtain an accumulating gfoldl.

--------------------------------------------------------------}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | gfoldl with accumulation</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679044922"><span id="local-6989586621679044923"><span id="local-6989586621679044924"><span class="annot"><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-type">gfoldlAccum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044924"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044949"><span class="annot"><a href="#local-6989586621679044949"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679044946"><span class="annot"><a href="#local-6989586621679044946"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044949"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044922"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044949"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044949"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044922"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044945"><span class="annot"><a href="#local-6989586621679044945"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044945"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044922"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044945"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044924"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044922"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044924"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="gfoldlAccum"><span class="annot"><span class="annottext">gfoldlAccum :: (forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var hs-var">gfoldlAccum</span></a></span></span><span> </span><span id="local-6989586621679044759"><span class="annot"><span class="annottext">forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r)
</span><a href="#local-6989586621679044759"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044758"><span class="annot"><span class="annottext">forall g. a -&gt; g -&gt; (a, c g)
</span><a href="#local-6989586621679044758"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044757"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044757"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679044756"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044756"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">A a c d -&gt; a -&gt; (a, c d)
forall a (c :: * -&gt; *) d. A a c d -&gt; a -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#unA"><span class="hs-identifier hs-var hs-var">unA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall d b. Data d =&gt; A a c (d -&gt; b) -&gt; d -&gt; A a c b)
-&gt; (forall g. g -&gt; A a c g) -&gt; d -&gt; A a c d
forall a (c :: * -&gt; *).
Data a =&gt;
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a
</span><span class="hs-identifier hs-var">gfoldl</span></span><span> </span><span class="annot"><span class="annottext">forall d b. Data d =&gt; A a c (d -&gt; b) -&gt; d -&gt; A a c b
</span><a href="#local-6989586621679044753"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. g -&gt; A a c g
</span><a href="#local-6989586621679044752"><span class="hs-identifier hs-var">z'</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044756"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044757"><span class="hs-identifier hs-var">a0</span></a></span><span>
</span><span id="line-92"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679044753"><span class="annot"><span class="annottext">k' :: A a c (e -&gt; d) -&gt; e -&gt; A a c d
</span><a href="#local-6989586621679044753"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679044751"><span class="annot"><span class="annottext">A a c (e -&gt; d)
</span><a href="#local-6989586621679044751"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044750"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044750"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, c d)) -&gt; A a c d
forall a (c :: * -&gt; *) d. (a -&gt; (a, c d)) -&gt; A a c d
</span><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044748"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044748"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044747"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044747"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044746"><span class="annot"><span class="annottext">c (e -&gt; d)
</span><a href="#local-6989586621679044746"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">A a c (e -&gt; d) -&gt; a -&gt; (a, c (e -&gt; d))
forall a (c :: * -&gt; *) d. A a c d -&gt; a -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#unA"><span class="hs-identifier hs-var hs-var">unA</span></a></span><span> </span><span class="annot"><span class="annottext">A a c (e -&gt; d)
</span><a href="#local-6989586621679044751"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044748"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; c (e -&gt; d) -&gt; e -&gt; (a, c d)
forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r)
</span><a href="#local-6989586621679044759"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044747"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">c (e -&gt; d)
</span><a href="#local-6989586621679044746"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044750"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679044752"><span class="annot"><span class="annottext">z' :: d -&gt; A a c d
</span><a href="#local-6989586621679044752"><span class="hs-identifier hs-var hs-var">z'</span></a></span></span><span> </span><span id="local-6989586621679044745"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044745"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, c d)) -&gt; A a c d
forall a (c :: * -&gt; *) d. (a -&gt; (a, c d)) -&gt; A a c d
</span><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044744"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044744"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; d -&gt; (a, c d)
forall g. a -&gt; g -&gt; (a, c g)
</span><a href="#local-6989586621679044758"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044744"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044745"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | A type constructor for accumulation</span><span>
</span><span id="line-98"></span><span class="hs-keyword">newtype</span><span> </span><span id="A"><span class="annot"><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a></span></span><span> </span><span id="local-6989586621679044942"><span class="annot"><a href="#local-6989586621679044942"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679044941"><span class="annot"><a href="#local-6989586621679044941"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679044940"><span class="annot"><a href="#local-6989586621679044940"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="A"><span class="annot"><a href="Data.Generics.Twins.html#A"><span class="hs-identifier hs-var">A</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unA"><span class="annot"><span class="annottext">A a c d -&gt; a -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#unA"><span class="hs-identifier hs-var hs-var">unA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044942"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044941"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044940"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | gmapT with accumulation</span><span>
</span><span id="line-102"></span><span id="local-6989586621679044837"><span id="local-6989586621679044838"><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier hs-type">gmapAccumT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044838"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-103"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044928"><span class="annot"><a href="#local-6989586621679044928"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044928"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044928"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044928"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044838"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044838"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-105"></span><span id="gmapAccumT"><span class="annot"><span class="annottext">gmapAccumT :: (forall e. Data e =&gt; a -&gt; e -&gt; (a, e)) -&gt; a -&gt; d -&gt; (a, d)
</span><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier hs-var hs-var">gmapAccumT</span></a></span></span><span> </span><span id="local-6989586621679044743"><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, e)
</span><a href="#local-6989586621679044743"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044742"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044742"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679044741"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044741"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044740"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044740"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044739"><span class="annot"><span class="annottext">ID d
</span><a href="#local-6989586621679044739"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall e r. Data e =&gt; a -&gt; ID (e -&gt; r) -&gt; e -&gt; (a, ID r))
-&gt; (forall g. a -&gt; g -&gt; (a, ID g)) -&gt; a -&gt; d -&gt; (a, ID d)
forall d a (c :: * -&gt; *).
Data d =&gt;
(forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a></span><span> </span><span class="annot"><span class="annottext">forall e r. Data e =&gt; a -&gt; ID (e -&gt; r) -&gt; e -&gt; (a, ID r)
</span><a href="#local-6989586621679044738"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. a -&gt; g -&gt; (a, ID g)
forall a x. a -&gt; x -&gt; (a, ID x)
</span><a href="#local-6989586621679044737"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044742"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044741"><span class="hs-identifier hs-var">d0</span></a></span><span>
</span><span id="line-106"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044740"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ID d -&gt; d
forall x. ID x -&gt; x
</span><a href="Data.Generics.Twins.html#unID"><span class="hs-identifier hs-var hs-var">unID</span></a></span><span> </span><span class="annot"><span class="annottext">ID d
</span><a href="#local-6989586621679044739"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679044738"><span class="annot"><span class="annottext">k :: a -&gt; ID (t -&gt; x) -&gt; t -&gt; (a, ID x)
</span><a href="#local-6989586621679044738"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044735"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044735"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-type">ID</span></a></span><span> </span><span id="local-6989586621679044733"><span class="annot"><span class="annottext">t -&gt; x
</span><a href="#local-6989586621679044733"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679044732"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044732"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044731"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044730"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044730"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; t -&gt; (a, t)
forall e. Data e =&gt; a -&gt; e -&gt; (a, e)
</span><a href="#local-6989586621679044743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044735"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044732"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-109"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044731"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x -&gt; ID x
forall x. x -&gt; ID x
</span><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; x
</span><a href="#local-6989586621679044733"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044730"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679044737"><span class="annot"><span class="annottext">z :: a -&gt; x -&gt; (a, ID x)
</span><a href="#local-6989586621679044737"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044729"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044729"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044728"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679044728"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044729"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">x -&gt; ID x
forall x. x -&gt; ID x
</span><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679044728"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Applicative version</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumA"><span class="hs-identifier hs-type">gmapAccumA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044727"><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679044726"><span class="annot"><a href="#local-6989586621679044726"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621679044725"><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044726"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044916"><span class="annot"><a href="#local-6989586621679044916"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044916"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044916"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044916"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044726"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044726"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="gmapAccumA"><span class="annot"><span class="annottext">gmapAccumA :: (forall e. Data e =&gt; b -&gt; e -&gt; (b, a e)) -&gt; b -&gt; d -&gt; (b, a d)
</span><a href="Data.Generics.Twins.html#gmapAccumA"><span class="hs-identifier hs-var hs-var">gmapAccumA</span></a></span></span><span> </span><span id="local-6989586621679044724"><span class="annot"><span class="annottext">forall e. Data e =&gt; b -&gt; e -&gt; (b, a e)
</span><a href="#local-6989586621679044724"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044723"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044723"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679044722"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044722"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall e r. Data e =&gt; b -&gt; a (e -&gt; r) -&gt; e -&gt; (b, a r))
-&gt; (forall g. b -&gt; g -&gt; (b, a g)) -&gt; b -&gt; d -&gt; (b, a d)
forall d a (c :: * -&gt; *).
Data d =&gt;
(forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a></span><span> </span><span class="annot"><span class="annottext">forall e r. Data e =&gt; b -&gt; a (e -&gt; r) -&gt; e -&gt; (b, a r)
</span><a href="#local-6989586621679044721"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. b -&gt; g -&gt; (b, a g)
forall t c (a' :: * -&gt; *). Applicative a' =&gt; t -&gt; c -&gt; (t, a' c)
</span><a href="#local-6989586621679044720"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044723"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044722"><span class="hs-identifier hs-var">d0</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><a href="#local-6989586621679044721"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044719"><span class="annot"><a href="#local-6989586621679044719"><span class="hs-identifier hs-type">d'</span></a></span></span><span> </span><span id="local-6989586621679044718"><span class="annot"><a href="#local-6989586621679044718"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044719"><span class="hs-identifier hs-type">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-120"></span><span>           </span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044719"><span class="hs-identifier hs-type">d'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044718"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044719"><span class="hs-identifier hs-type">d'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044727"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044718"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>      </span><span id="local-6989586621679044721"><span class="annot"><span class="annottext">k :: b -&gt; a (d' -&gt; e) -&gt; d' -&gt; (b, a e)
</span><a href="#local-6989586621679044721"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044717"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044717"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044716"><span class="annot"><span class="annottext">a (d' -&gt; e)
</span><a href="#local-6989586621679044716"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044715"><span class="annot"><span class="annottext">d'
</span><a href="#local-6989586621679044715"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044714"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044714"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044713"><span class="annot"><span class="annottext">a d'
</span><a href="#local-6989586621679044713"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; d' -&gt; (b, a d')
forall e. Data e =&gt; b -&gt; e -&gt; (b, a e)
</span><a href="#local-6989586621679044724"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044717"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">d'
</span><a href="#local-6989586621679044715"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-122"></span><span>                    </span><span id="local-6989586621679044712"><span class="annot"><span class="annottext">c' :: a e
</span><a href="#local-6989586621679044712"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a (d' -&gt; e)
</span><a href="#local-6989586621679044716"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a (d' -&gt; e) -&gt; a d' -&gt; a e
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">a d'
</span><a href="#local-6989586621679044713"><span class="hs-identifier hs-var">d'</span></a></span><span>
</span><span id="line-123"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044714"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a e
</span><a href="#local-6989586621679044712"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><a href="#local-6989586621679044720"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044911"><span class="annot"><a href="#local-6989586621679044911"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679044910"><span class="annot"><a href="#local-6989586621679044910"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679044912"><span class="annot"><a href="#local-6989586621679044912"><span class="hs-identifier hs-type">a'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679044912"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-125"></span><span>           </span><span class="annot"><a href="#local-6989586621679044911"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044910"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044911"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044912"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044910"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621679044720"><span class="annot"><span class="annottext">z :: t -&gt; c -&gt; (t, a' c)
</span><a href="#local-6989586621679044720"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044711"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044711"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044710"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044710"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044711"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c -&gt; a' c
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679044710"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | gmapM with accumulation</span><span>
</span><span id="line-130"></span><span id="local-6989586621679044819"><span id="local-6989586621679044820"><span id="local-6989586621679044821"><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier hs-type">gmapAccumM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044821"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679044820"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044900"><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044820"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044900"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044821"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044819"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044820"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044821"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-133"></span><span id="gmapAccumM"><span class="annot"><span class="annottext">gmapAccumM :: (forall e. Data e =&gt; a -&gt; e -&gt; (a, m e)) -&gt; a -&gt; d -&gt; (a, m d)
</span><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier hs-var hs-var">gmapAccumM</span></a></span></span><span> </span><span id="local-6989586621679044709"><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, m e)
</span><a href="#local-6989586621679044709"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall e r. Data e =&gt; a -&gt; m (e -&gt; r) -&gt; e -&gt; (a, m r))
-&gt; (forall g. a -&gt; g -&gt; (a, m g)) -&gt; a -&gt; d -&gt; (a, m d)
forall d a (c :: * -&gt; *).
Data d =&gt;
(forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a></span><span> </span><span class="annot"><span class="annottext">forall e r. Data e =&gt; a -&gt; m (e -&gt; r) -&gt; e -&gt; (a, m r)
</span><a href="#local-6989586621679044708"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. a -&gt; g -&gt; (a, m g)
forall (m :: * -&gt; *) a a. Monad m =&gt; a -&gt; a -&gt; (a, m a)
</span><a href="#local-6989586621679044707"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-134"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679044708"><span class="annot"><span class="annottext">k :: a -&gt; m (t -&gt; b) -&gt; t -&gt; (a, m b)
</span><a href="#local-6989586621679044708"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044706"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044706"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044705"><span class="annot"><span class="annottext">m (t -&gt; b)
</span><a href="#local-6989586621679044705"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679044704"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044704"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044703"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044703"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044702"><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679044702"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; t -&gt; (a, m t)
forall e. Data e =&gt; a -&gt; e -&gt; (a, m e)
</span><a href="#local-6989586621679044709"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044706"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044704"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-136"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044703"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679044702"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">m t -&gt; (t -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679044701"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044701"><span class="hs-identifier hs-var">d''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (t -&gt; b)
</span><a href="#local-6989586621679044705"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">m (t -&gt; b) -&gt; ((t -&gt; b) -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679044700"><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679044700"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679044700"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679044701"><span class="hs-identifier hs-var">d''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679044707"><span class="annot"><span class="annottext">z :: a -&gt; a -&gt; (a, m a)
</span><a href="#local-6989586621679044707"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044699"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044699"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044698"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044698"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044699"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044698"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | gmapQl with accumulation</span><span>
</span><span id="line-141"></span><span id="local-6989586621679044694"><span id="local-6989586621679044695"><span id="local-6989586621679044696"><span id="local-6989586621679044697"><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQl"><span class="hs-identifier hs-type">gmapAccumQl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044697"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-142"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044696"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044695"><span class="hs-identifier hs-type">r'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044696"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044696"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044885"><span class="annot"><a href="#local-6989586621679044885"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044885"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044885"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044695"><span class="hs-identifier hs-type">r'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044697"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044696"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-146"></span><span id="gmapAccumQl"><span class="annot"><span class="annottext">gmapAccumQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall e. Data e =&gt; a -&gt; e -&gt; (a, r')) -&gt; a -&gt; d -&gt; (a, r)
</span><a href="Data.Generics.Twins.html#gmapAccumQl"><span class="hs-identifier hs-var hs-var">gmapAccumQl</span></a></span></span><span> </span><span id="local-6989586621679044693"><span class="annot"><span class="annottext">r -&gt; r' -&gt; r
</span><a href="#local-6989586621679044693"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679044692"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044692"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679044691"><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, r')
</span><a href="#local-6989586621679044691"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044690"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044690"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679044689"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044689"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044688"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044688"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044687"><span class="annot"><span class="annottext">CONST r d
</span><a href="#local-6989586621679044687"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall e r.
 Data e =&gt;
 a -&gt; CONST r (e -&gt; r) -&gt; e -&gt; (a, CONST r r))
-&gt; (forall g. a -&gt; g -&gt; (a, CONST r g)) -&gt; a -&gt; d -&gt; (a, CONST r d)
forall d a (c :: * -&gt; *).
Data d =&gt;
(forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a></span><span> </span><span class="annot"><span class="annottext">forall e r. Data e =&gt; a -&gt; CONST r (e -&gt; r) -&gt; e -&gt; (a, CONST r r)
forall e a a. Data e =&gt; a -&gt; CONST r a -&gt; e -&gt; (a, CONST r a)
</span><a href="#local-6989586621679044686"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. a -&gt; g -&gt; (a, CONST r g)
forall a p a. a -&gt; p -&gt; (a, CONST r a)
</span><a href="#local-6989586621679044685"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044690"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044689"><span class="hs-identifier hs-var">d0</span></a></span><span>
</span><span id="line-147"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044688"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CONST r d -&gt; r
forall c a. CONST c a -&gt; c
</span><a href="Data.Generics.Twins.html#unCONST"><span class="hs-identifier hs-var hs-var">unCONST</span></a></span><span> </span><span class="annot"><span class="annottext">CONST r d
</span><a href="#local-6989586621679044687"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679044686"><span class="annot"><span class="annottext">k :: a -&gt; CONST r a -&gt; e -&gt; (a, CONST r a)
</span><a href="#local-6989586621679044686"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044683"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044683"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-type">CONST</span></a></span><span> </span><span id="local-6989586621679044681"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044681"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679044680"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044680"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044679"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044679"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044678"><span class="annot"><span class="annottext">r'
</span><a href="#local-6989586621679044678"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; e -&gt; (a, r')
forall e. Data e =&gt; a -&gt; e -&gt; (a, r')
</span><a href="#local-6989586621679044691"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044683"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044680"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-150"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044679"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r -&gt; CONST r a
forall c a. c -&gt; CONST c a
</span><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044681"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r' -&gt; r
</span><a href="#local-6989586621679044693"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">r'
</span><a href="#local-6989586621679044678"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679044685"><span class="annot"><span class="annottext">z :: a -&gt; p -&gt; (a, CONST r a)
</span><a href="#local-6989586621679044685"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044677"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044677"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044677"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r -&gt; CONST r a
forall c a. c -&gt; CONST c a
</span><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044692"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | gmapQr with accumulation</span><span>
</span><span id="line-155"></span><span id="local-6989586621679044850"><span id="local-6989586621679044851"><span id="local-6989586621679044852"><span id="local-6989586621679044853"><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier hs-type">gmapAccumQr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044853"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044852"><span class="hs-identifier hs-type">r'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044851"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044851"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044851"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044871"><span class="annot"><a href="#local-6989586621679044871"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044871"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044850"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044871"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044852"><span class="hs-identifier hs-type">r'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044850"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044853"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679044851"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-160"></span><span id="gmapAccumQr"><span class="annot"><span class="annottext">gmapAccumQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall e. Data e =&gt; a -&gt; e -&gt; (a, r')) -&gt; a -&gt; d -&gt; (a, r)
</span><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier hs-var hs-var">gmapAccumQr</span></a></span></span><span> </span><span id="local-6989586621679044676"><span class="annot"><span class="annottext">r' -&gt; r -&gt; r
</span><a href="#local-6989586621679044676"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679044675"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044675"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679044674"><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, r')
</span><a href="#local-6989586621679044674"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044673"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044673"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span id="local-6989586621679044672"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044672"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044671"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044671"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044670"><span class="annot"><span class="annottext">Qr r d
</span><a href="#local-6989586621679044670"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall e r. Data e =&gt; a -&gt; Qr r (e -&gt; r) -&gt; e -&gt; (a, Qr r r))
-&gt; (forall g. a -&gt; g -&gt; (a, Qr r g)) -&gt; a -&gt; d -&gt; (a, Qr r d)
forall d a (c :: * -&gt; *).
Data d =&gt;
(forall e r. Data e =&gt; a -&gt; c (e -&gt; r) -&gt; e -&gt; (a, c r))
-&gt; (forall g. a -&gt; g -&gt; (a, c g)) -&gt; a -&gt; d -&gt; (a, c d)
</span><a href="Data.Generics.Twins.html#gfoldlAccum"><span class="hs-identifier hs-var">gfoldlAccum</span></a></span><span> </span><span class="annot"><span class="annottext">forall e r. Data e =&gt; a -&gt; Qr r (e -&gt; r) -&gt; e -&gt; (a, Qr r r)
forall e a a. Data e =&gt; a -&gt; Qr r a -&gt; e -&gt; (a, Qr r a)
</span><a href="#local-6989586621679044669"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall g. a -&gt; g -&gt; (a, Qr r g)
forall a p r a. a -&gt; p -&gt; (a, Qr r a)
</span><a href="#local-6989586621679044668"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044673"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044672"><span class="hs-identifier hs-var">d0</span></a></span><span>
</span><span id="line-161"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044671"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Qr r d -&gt; r -&gt; r
forall r a. Qr r a -&gt; r -&gt; r
</span><a href="Data.Generics.Twins.html#unQr"><span class="hs-identifier hs-var hs-var">unQr</span></a></span><span> </span><span class="annot"><span class="annottext">Qr r d
</span><a href="#local-6989586621679044670"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044675"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679044669"><span class="annot"><span class="annottext">k :: a -&gt; Qr r a -&gt; e -&gt; (a, Qr r a)
</span><a href="#local-6989586621679044669"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679044666"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044666"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-type">Qr</span></a></span><span> </span><span id="local-6989586621679044664"><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621679044664"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679044663"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044663"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679044662"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044662"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679044661"><span class="annot"><span class="annottext">r'
</span><a href="#local-6989586621679044661"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; e -&gt; (a, r')
forall e. Data e =&gt; a -&gt; e -&gt; (a, r')
</span><a href="#local-6989586621679044674"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044666"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679044663"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-164"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044662"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; Qr r a
forall r a. (r -&gt; r) -&gt; Qr r a
</span><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044660"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044660"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; r
</span><a href="#local-6989586621679044664"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r'
</span><a href="#local-6989586621679044661"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">r' -&gt; r -&gt; r
</span><a href="#local-6989586621679044676"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679044660"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679044668"><span class="annot"><span class="annottext">z :: a -&gt; p -&gt; (a, Qr r a)
</span><a href="#local-6989586621679044668"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679044659"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044659"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044659"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; Qr r a
forall r a. (r -&gt; r) -&gt; Qr r a
</span><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | gmapQ with accumulation</span><span>
</span><span id="line-169"></span><span id="local-6989586621679044806"><span id="local-6989586621679044807"><span id="local-6989586621679044808"><span class="annot"><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier hs-type">gmapAccumQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044808"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-170"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679044857"><span class="annot"><a href="#local-6989586621679044857"><span class="hs-identifier hs-type">e</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044857"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044857"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679044806"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044808"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679044807"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044806"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-172"></span><span id="gmapAccumQ"><span class="annot"><span class="annottext">gmapAccumQ :: (forall e. Data e =&gt; a -&gt; e -&gt; (a, q)) -&gt; a -&gt; d -&gt; (a, [q])
</span><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier hs-var hs-var">gmapAccumQ</span></a></span></span><span> </span><span id="local-6989586621679044657"><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, q)
</span><a href="#local-6989586621679044657"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(q -&gt; [q] -&gt; [q])
-&gt; [q]
-&gt; (forall e. Data e =&gt; a -&gt; e -&gt; (a, q))
-&gt; a
-&gt; d
-&gt; (a, [q])
forall d r' r a.
Data d =&gt;
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall e. Data e =&gt; a -&gt; e -&gt; (a, r')) -&gt; a -&gt; d -&gt; (a, r)
</span><a href="Data.Generics.Twins.html#gmapAccumQr"><span class="hs-identifier hs-var">gmapAccumQr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall e. Data e =&gt; a -&gt; e -&gt; (a, q)
</span><a href="#local-6989586621679044657"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--      Helper type constructors</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | The identity type constructor needed for the definition of gmapAccumT</span><span>
</span><span id="line-184"></span><span class="hs-keyword">newtype</span><span> </span><span id="ID"><span class="annot"><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a></span></span><span> </span><span id="local-6989586621679044919"><span class="annot"><a href="#local-6989586621679044919"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ID"><span class="annot"><a href="Data.Generics.Twins.html#ID"><span class="hs-identifier hs-var">ID</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unID"><span class="annot"><span class="annottext">ID x -&gt; x
</span><a href="Data.Generics.Twins.html#unID"><span class="hs-identifier hs-var hs-var">unID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044919"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | The constant type constructor needed for the definition of gmapAccumQl</span><span>
</span><span id="line-188"></span><span class="hs-keyword">newtype</span><span> </span><span id="CONST"><span class="annot"><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a></span></span><span> </span><span id="local-6989586621679044875"><span class="annot"><a href="#local-6989586621679044875"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679044874"><span class="annot"><a href="#local-6989586621679044874"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CONST"><span class="annot"><a href="Data.Generics.Twins.html#CONST"><span class="hs-identifier hs-var">CONST</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unCONST"><span class="annot"><span class="annottext">CONST c a -&gt; c
</span><a href="Data.Generics.Twins.html#unCONST"><span class="hs-identifier hs-var hs-var">unCONST</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044875"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | The type constructor needed for the definition of gmapAccumQr</span><span>
</span><span id="line-192"></span><span class="hs-keyword">newtype</span><span> </span><span id="Qr"><span class="annot"><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a></span></span><span> </span><span id="local-6989586621679044860"><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679044859"><span class="annot"><a href="#local-6989586621679044859"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Qr"><span class="annot"><a href="Data.Generics.Twins.html#Qr"><span class="hs-identifier hs-var">Qr</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unQr"><span class="annot"><span class="annottext">Qr r a -&gt; r -&gt; r
</span><a href="Data.Generics.Twins.html#unQr"><span class="hs-identifier hs-var hs-var">unQr</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044860"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">--      Mapping combinators for twin traversal</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Twin map for transformation</span><span>
</span><span id="line-204"></span><span class="annot"><a href="Data.Generics.Twins.html#gzipWithT"><span class="hs-identifier hs-type">gzipWithT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericT"><span class="hs-identifier hs-type">GenericT</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericT"><span class="hs-identifier hs-type">GenericT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span id="gzipWithT"><span class="annot"><span class="annottext">gzipWithT :: GenericQ GenericT -&gt; GenericQ GenericT
</span><a href="Data.Generics.Twins.html#gzipWithT"><span class="hs-identifier hs-var hs-var">gzipWithT</span></a></span></span><span> </span><span id="local-6989586621679044656"><span class="annot"><span class="annottext">GenericQ GenericT
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044655"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044655"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044654"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044654"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(forall e. Data e =&gt; [GenericT'] -&gt; e -&gt; ([GenericT'], e))
-&gt; [GenericT'] -&gt; a -&gt; ([GenericT'], a)
forall d a.
Data d =&gt;
(forall e. Data e =&gt; a -&gt; e -&gt; (a, e)) -&gt; a -&gt; d -&gt; (a, d)
</span><a href="Data.Generics.Twins.html#gmapAccumT"><span class="hs-identifier hs-var">gmapAccumT</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. Data e =&gt; [GenericT'] -&gt; e -&gt; ([GenericT'], e)
</span><a href="#local-6989586621679044653"><span class="hs-identifier hs-var">perkid</span></a></span><span> </span><span class="annot"><span class="annottext">[GenericT']
</span><a href="#local-6989586621679044652"><span class="hs-identifier hs-var">funs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044654"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044651"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044651"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044651"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-207"></span><span>                    </span><span class="annot"><span class="annottext">([GenericT'], a)
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;gzipWithT&quot;</span></span><span>
</span><span id="line-208"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679044653"><span class="annot"><span class="annottext">perkid :: [GenericT'] -&gt; b -&gt; ([GenericT'], b)
</span><a href="#local-6989586621679044653"><span class="hs-identifier hs-var hs-var">perkid</span></a></span></span><span> </span><span id="local-6989586621679044649"><span class="annot"><span class="annottext">[GenericT']
</span><a href="#local-6989586621679044649"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044648"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044648"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericT'] -&gt; [GenericT']
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[GenericT']
</span><a href="#local-6989586621679044649"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenericT' -&gt; b -&gt; b
GenericT' -&gt; GenericT
</span><a href="Data.Generics.Aliases.html#unGT"><span class="hs-identifier hs-var hs-var">unGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericT'] -&gt; GenericT'
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[GenericT']
</span><a href="#local-6989586621679044649"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044648"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679044652"><span class="annot"><span class="annottext">funs :: [GenericT']
</span><a href="#local-6989586621679044652"><span class="hs-identifier hs-var hs-var">funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; GenericT') -&gt; a -&gt; [GenericT']
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044643"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044643"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenericT -&gt; GenericT'
</span><a href="Data.Generics.Aliases.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; GenericT
GenericQ GenericT
</span><a href="#local-6989586621679044656"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044643"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044655"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Twin map for monadic transformation</span><span>
</span><span id="line-215"></span><span id="local-6989586621679044787"><span class="annot"><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier hs-type">gzipWithM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679044787"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044787"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044787"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span id="gzipWithM"><span class="annot"><span class="annottext">gzipWithM :: GenericQ (GenericM m) -&gt; GenericQ (GenericM m)
</span><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier hs-var hs-var">gzipWithM</span></a></span></span><span> </span><span id="local-6989586621679044641"><span class="annot"><span class="annottext">GenericQ (GenericM m)
</span><a href="#local-6989586621679044641"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044640"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044640"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044639"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044639"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(forall e. Data e =&gt; [GenericM' m] -&gt; e -&gt; ([GenericM' m], m e))
-&gt; [GenericM' m] -&gt; a -&gt; ([GenericM' m], m a)
forall d (m :: * -&gt; *) a.
(Data d, Monad m) =&gt;
(forall e. Data e =&gt; a -&gt; e -&gt; (a, m e)) -&gt; a -&gt; d -&gt; (a, m d)
</span><a href="Data.Generics.Twins.html#gmapAccumM"><span class="hs-identifier hs-var">gmapAccumM</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. Data e =&gt; [GenericM' m] -&gt; e -&gt; ([GenericM' m], m e)
forall a (m :: * -&gt; *).
Data a =&gt;
[GenericM' m] -&gt; a -&gt; ([GenericM' m], m a)
</span><a href="#local-6989586621679044638"><span class="hs-identifier hs-var">perkid</span></a></span><span> </span><span class="annot"><span class="annottext">[GenericM' m]
</span><a href="#local-6989586621679044637"><span class="hs-identifier hs-var">funs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044639"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044636"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679044636"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679044636"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-218"></span><span>                    </span><span class="annot"><span class="annottext">([GenericM' m], m a)
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;gzipWithM&quot;</span></span><span>
</span><span id="line-219"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679044638"><span class="annot"><span class="annottext">perkid :: [GenericM' m] -&gt; a -&gt; ([GenericM' m], m a)
</span><a href="#local-6989586621679044638"><span class="hs-identifier hs-var hs-var">perkid</span></a></span></span><span> </span><span id="local-6989586621679044635"><span class="annot"><span class="annottext">[GenericM' m]
</span><a href="#local-6989586621679044635"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044634"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044634"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericM' m] -&gt; [GenericM' m]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[GenericM' m]
</span><a href="#local-6989586621679044635"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenericM' m -&gt; a -&gt; m a
forall (m :: * -&gt; *). GenericM' m -&gt; forall a. Data a =&gt; a -&gt; m a
</span><a href="Data.Generics.Aliases.html#unGM"><span class="hs-identifier hs-var hs-var">unGM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericM' m] -&gt; GenericM' m
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[GenericM' m]
</span><a href="#local-6989586621679044635"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044634"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679044637"><span class="annot"><span class="annottext">funs :: [GenericM' m]
</span><a href="#local-6989586621679044637"><span class="hs-identifier hs-var hs-var">funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; GenericM' m) -&gt; a -&gt; [GenericM' m]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044632"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044632"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenericM m -&gt; GenericM' m
forall (m :: * -&gt; *). (forall a. Data a =&gt; a -&gt; m a) -&gt; GenericM' m
</span><a href="Data.Generics.Aliases.html#GM"><span class="hs-identifier hs-var">GM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; GenericM m
GenericQ (GenericM m)
</span><a href="#local-6989586621679044641"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044632"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044640"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Twin map for queries</span><span>
</span><span id="line-225"></span><span id="local-6989586621679044793"><span class="annot"><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-type">gzipWithQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679044793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679044793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-226"></span><span id="gzipWithQ"><span class="annot"><span class="annottext">gzipWithQ :: GenericQ (GenericQ r) -&gt; GenericQ (GenericQ [r])
</span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var hs-var">gzipWithQ</span></a></span></span><span> </span><span id="local-6989586621679044630"><span class="annot"><span class="annottext">GenericQ (GenericQ r)
</span><a href="#local-6989586621679044630"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679044629"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044628"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044628"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(forall e. Data e =&gt; [GenericQ' r] -&gt; e -&gt; ([GenericQ' r], r))
-&gt; [GenericQ' r] -&gt; a -&gt; ([GenericQ' r], [r])
forall d a q.
Data d =&gt;
(forall e. Data e =&gt; a -&gt; e -&gt; (a, q)) -&gt; a -&gt; d -&gt; (a, [q])
</span><a href="Data.Generics.Twins.html#gmapAccumQ"><span class="hs-identifier hs-var">gmapAccumQ</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. Data e =&gt; [GenericQ' r] -&gt; e -&gt; ([GenericQ' r], r)
forall a b. Data a =&gt; [GenericQ' b] -&gt; a -&gt; ([GenericQ' b], b)
</span><a href="#local-6989586621679044627"><span class="hs-identifier hs-var">perkid</span></a></span><span> </span><span class="annot"><span class="annottext">[GenericQ' r]
</span><a href="#local-6989586621679044626"><span class="hs-identifier hs-var">funs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044628"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>                   </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679044625"><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621679044625"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[r]
</span><a href="#local-6989586621679044625"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-228"></span><span>                   </span><span class="annot"><span class="annottext">([GenericQ' r], [r])
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [r]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;gzipWithQ&quot;</span></span><span>
</span><span id="line-229"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679044627"><span class="annot"><span class="annottext">perkid :: [GenericQ' b] -&gt; a -&gt; ([GenericQ' b], b)
</span><a href="#local-6989586621679044627"><span class="hs-identifier hs-var hs-var">perkid</span></a></span></span><span> </span><span id="local-6989586621679044624"><span class="annot"><span class="annottext">[GenericQ' b]
</span><a href="#local-6989586621679044624"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679044623"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044623"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericQ' b] -&gt; [GenericQ' b]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[GenericQ' b]
</span><a href="#local-6989586621679044624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GenericQ' b -&gt; a -&gt; b
forall r. GenericQ' r -&gt; forall a. Data a =&gt; a -&gt; r
</span><a href="Data.Generics.Aliases.html#unGQ"><span class="hs-identifier hs-var hs-var">unGQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GenericQ' b] -&gt; GenericQ' b
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[GenericQ' b]
</span><a href="#local-6989586621679044624"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044623"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679044626"><span class="annot"><span class="annottext">funs :: [GenericQ' r]
</span><a href="#local-6989586621679044626"><span class="hs-identifier hs-var hs-var">funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; GenericQ' r) -&gt; a -&gt; [GenericQ' r]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044621"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044621"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GenericQ r -&gt; GenericQ' r
forall r. (forall a. Data a =&gt; a -&gt; r) -&gt; GenericQ' r
</span><a href="Data.Generics.Aliases.html#GQ"><span class="hs-identifier hs-var">GQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; GenericQ r
GenericQ (GenericQ r)
</span><a href="#local-6989586621679044630"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679044621"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044629"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span class="hs-comment">--      Typical twin traversals</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Generic equality: an alternative to \&quot;deriving Eq\&quot;</span><span>
</span><span id="line-242"></span><span id="local-6989586621679044619"><span class="annot"><a href="Data.Generics.Twins.html#geq"><span class="hs-identifier hs-type">geq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">{-

Testing for equality of two terms goes like this. Firstly, we
establish the equality of the two top-level datatype
constructors. Secondly, we use a twin gmap combinator, namely tgmapQ,
to compare the two lists of immediate subterms.

(Note for the experts: the type of the worker geq' is rather general
but precision is recovered via the restrictive type of the top-level
operation geq. The imprecision of geq' is caused by the type system's
unability to express the type equivalence for the corresponding
couples of immediate subterms from the two given input terms.)

-}</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span id="geq"><span class="annot"><span class="annottext">geq :: a -&gt; a -&gt; Bool
</span><a href="Data.Generics.Twins.html#geq"><span class="hs-identifier hs-var hs-var">geq</span></a></span></span><span> </span><span id="local-6989586621679044618"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044618"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679044617"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044617"><span class="hs-identifier hs-var">y0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
GenericQ (GenericQ Bool)
</span><a href="#local-6989586621679044616"><span class="hs-identifier hs-var">geq'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044618"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044617"><span class="hs-identifier hs-var">y0</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="#local-6989586621679044616"><span class="hs-identifier hs-type">geq'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679044616"><span class="annot"><span class="annottext">geq' :: a -&gt; GenericQ Bool
</span><a href="#local-6989586621679044616"><span class="hs-identifier hs-var hs-var">geq'</span></a></span></span><span> </span><span id="local-6989586621679044615"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044614"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044614"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Constr -&gt; Constr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044614"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericQ (GenericQ Bool) -&gt; a -&gt; a -&gt; [Bool]
forall r. GenericQ (GenericQ r) -&gt; GenericQ (GenericQ [r])
</span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var">gzipWithQ</span></a></span><span> </span><span class="annot"><span class="annottext">GenericQ (GenericQ Bool)
</span><a href="#local-6989586621679044616"><span class="hs-identifier hs-var">geq'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044614"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Generic zip controlled by a function with type-specific branches</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier hs-type">gzip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- See testsuite/.../Generics/gzip.hs for an illustration</span><span>
</span><span id="line-269"></span><span id="gzip"><span class="annot"><span class="annottext">gzip :: GenericQ (GenericM Maybe) -&gt; GenericQ (GenericM Maybe)
</span><a href="Data.Generics.Twins.html#gzip"><span class="hs-identifier hs-var hs-var">gzip</span></a></span></span><span> </span><span id="local-6989586621679044610"><span class="annot"><span class="annottext">GenericQ (GenericM Maybe)
</span><a href="#local-6989586621679044610"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Maybe a
GenericQ (GenericM Maybe)
</span><a href="#local-6989586621679044609"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="#local-6989586621679044609"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Generics.Aliases.html#GenericQ"><span class="hs-identifier hs-type">GenericQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Generics.Aliases.html#GenericM"><span class="hs-identifier hs-type">GenericM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679044609"><span class="annot"><span class="annottext">go :: a -&gt; GenericM Maybe
</span><a href="#local-6989586621679044609"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679044608"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044608"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044607"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Maybe a
GenericQ (GenericM Maybe)
</span><a href="#local-6989586621679044610"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044608"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="Data.Generics.Aliases.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044608"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Constr -&gt; Constr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GenericQ (GenericM Maybe) -&gt; a -&gt; a -&gt; Maybe a
forall (m :: * -&gt; *).
Monad m =&gt;
GenericQ (GenericM m) -&gt; GenericQ (GenericM m)
</span><a href="Data.Generics.Twins.html#gzipWithM"><span class="hs-identifier hs-var">gzipWithM</span></a></span><span> </span><span class="annot"><span class="annottext">GenericQ (GenericM Maybe)
</span><a href="#local-6989586621679044609"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044608"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044607"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Generic comparison: an alternative to \&quot;deriving Ord\&quot;</span><span>
</span><span id="line-280"></span><span id="local-6989586621679044605"><span class="annot"><a href="Data.Generics.Twins.html#gcompare"><span class="hs-identifier hs-type">gcompare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span><span>
</span><span id="line-281"></span><span id="gcompare"><span class="annot"><span class="annottext">gcompare :: a -&gt; a -&gt; Ordering
</span><a href="Data.Generics.Twins.html#gcompare"><span class="hs-identifier hs-var hs-var">gcompare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a b. (Data a, Data b) =&gt; a -&gt; b -&gt; Ordering
</span><a href="#local-6989586621679044604"><span class="hs-identifier hs-var">gcompare'</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679044784"><span id="local-6989586621679044785"><span class="annot"><a href="#local-6989586621679044604"><span class="hs-identifier hs-type">gcompare'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044785"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679044784"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679044784"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span></span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679044604"><span class="annot"><span class="annottext">gcompare' :: a -&gt; b -&gt; Ordering
</span><a href="#local-6989586621679044604"><span class="hs-identifier hs-var hs-var">gcompare'</span></a></span></span><span> </span><span id="local-6989586621679044603"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044603"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679044602"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679044601"><span class="annot"><span class="annottext">repX :: ConstrRep
</span><a href="#local-6989586621679044601"><span class="hs-identifier hs-var hs-var">repX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constr -&gt; ConstrRep
</span><span class="hs-identifier hs-var">constrRep</span></span><span> </span><span class="annot"><span class="annottext">(Constr -&gt; ConstrRep) -&gt; Constr -&gt; ConstrRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044603"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-286"></span><span>            </span><span id="local-6989586621679044599"><span class="annot"><span class="annottext">repY :: ConstrRep
</span><a href="#local-6989586621679044599"><span class="hs-identifier hs-var hs-var">repY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constr -&gt; ConstrRep
</span><span class="hs-identifier hs-var">constrRep</span></span><span> </span><span class="annot"><span class="annottext">(Constr -&gt; ConstrRep) -&gt; Constr -&gt; ConstrRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Constr
forall a. Data a =&gt; a -&gt; Constr
</span><span class="hs-identifier hs-var">toConstr</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstrRep
</span><a href="#local-6989586621679044601"><span class="hs-identifier hs-var">repX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstrRep
</span><a href="#local-6989586621679044599"><span class="hs-identifier hs-var">repY</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AlgConstr</span></span><span> </span><span id="local-6989586621679044597"><span class="annot"><span class="annottext">ConIndex
</span><a href="#local-6989586621679044597"><span class="hs-identifier hs-var">nX</span></a></span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier hs-type">AlgConstr</span></span><span> </span><span id="local-6989586621679044596"><span class="annot"><span class="annottext">ConIndex
</span><a href="#local-6989586621679044596"><span class="hs-identifier hs-var">nY</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">ConIndex
</span><a href="#local-6989586621679044597"><span class="hs-identifier hs-var">nX</span></a></span><span> </span><span class="annot"><span class="annottext">ConIndex -&gt; ConIndex -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">ConIndex
</span><a href="#local-6989586621679044596"><span class="hs-identifier hs-var">nY</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">[Ordering] -&gt; Ordering
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericQ (GenericQ Ordering) -&gt; a -&gt; b -&gt; [Ordering]
forall r. GenericQ (GenericQ r) -&gt; GenericQ (GenericQ [r])
</span><a href="Data.Generics.Twins.html#gzipWithQ"><span class="hs-identifier hs-var">gzipWithQ</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679044594"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044594"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a b. (Data a, Data b) =&gt; a -&gt; b -&gt; Ordering
</span><a href="#local-6989586621679044604"><span class="hs-identifier hs-var">gcompare'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044594"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679044603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679044602"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntConstr</span></span><span> </span><span id="local-6989586621679044592"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">iX</span></a></span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier hs-type">IntConstr</span></span><span> </span><span id="local-6989586621679044591"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679044591"><span class="hs-identifier hs-var">iY</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679044592"><span class="hs-identifier hs-var">iX</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679044591"><span class="hs-identifier hs-var">iY</span></a></span><span>
</span><span id="line-292"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FloatConstr</span></span><span> </span><span id="local-6989586621679044589"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679044589"><span class="hs-identifier hs-var">rX</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FloatConstr</span></span><span> </span><span id="local-6989586621679044588"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679044588"><span class="hs-identifier hs-var">rY</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679044589"><span class="hs-identifier hs-var">rX</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679044588"><span class="hs-identifier hs-var">rY</span></a></span><span>
</span><span id="line-293"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CharConstr</span></span><span> </span><span id="local-6989586621679044586"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679044586"><span class="hs-identifier hs-var">cX</span></a></span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CharConstr</span></span><span> </span><span id="local-6989586621679044585"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">cY</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679044586"><span class="hs-identifier hs-var">cX</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679044585"><span class="hs-identifier hs-var">cY</span></a></span><span>
</span><span id="line-294"></span><span>          </span><span class="annot"><span class="annottext">(ConstrRep, ConstrRep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ordering
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;type incompatibility in gcompare&quot;</span></span><span>
</span><span id="line-295"></span></pre></body></html>